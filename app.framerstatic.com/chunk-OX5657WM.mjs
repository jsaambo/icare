import{a as Vm,b as Km}from"https://app.framerstatic.com/chunk-C25CXIAS.mjs";import{b as Ka,c as Hm,k as Qm,p as Um,q as Wm,u as zm}from"https://app.framerstatic.com/chunk-NOA5YT74.mjs";import{i as Pn,s as Zm}from"https://app.framerstatic.com/chunk-XOOG2GMT.mjs";import{e as Qa}from"https://app.framerstatic.com/chunk-OTIFPWYF.mjs";import{a as nf}from"https://app.framerstatic.com/chunk-HF5XMP3Y.mjs";import{a as sf}from"https://app.framerstatic.com/chunk-WAFDZ45U.mjs";import{a as Ym}from"https://app.framerstatic.com/chunk-YE25YANI.mjs";import{a as of}from"https://app.framerstatic.com/chunk-EWEZCJKH.mjs";import{b as TA,c as Dm}from"https://app.framerstatic.com/chunk-SQD5XUIU.mjs";import{a as oe}from"https://app.framerstatic.com/chunk-D7MEQ7Y3.mjs";import{i as qa}from"https://app.framerstatic.com/chunk-5CTYCHND.mjs";import{e as Mm,g as xl,q as _m}from"https://app.framerstatic.com/chunk-6ITRUDEE.mjs";import{a as E6,b as d7,c as $6,e as Nm,f as xm,g as Kh,h as te,i as Lm,k as qm,n as Jm,q as ql}from"https://app.framerstatic.com/chunk-3YEJT6GO.mjs";import{c as rf}from"https://app.framerstatic.com/chunk-2YI7VWM5.mjs";import{a as qe}from"https://app.framerstatic.com/chunk-K24ZPX62.mjs";import{a as wm,d as Va,g as yr,h as ef,i as tf,l as za}from"https://app.framerstatic.com/chunk-GXDC2KXO.mjs";import{$ as lo,$a as Vk,A as io,C as vp,Cb as Sl,Cf as Sr,D as Tp,Ee as pt,Fc as Na,Fe as ee,G as Dt,Ga as Jp,H as Pp,I as ga,Ia as _a,Ic as em,J as qh,K as xp,Kc as tm,Kg as vm,L as Op,Lc as rm,Ld as Oa,Md as $m,Na as Da,Nc as om,O as ha,P as al,Pa as Fl,Pe as Im,Q as Ra,Qa as Nk,Ra as xk,Rf as wa,Sa as Ok,Sc as nm,Tc as Lt,Ua as wk,Ub as ye,Uc as Ir,Ue as Fm,Ug as bn,Ve as Fr,Vg as Tm,We as Gm,Wg as La,Xe as Sm,Yg as Pm,Za as Lk,_a as qk,_c as Bo,_e as ym,a as un,ab as Kk,ac as zk,ad as im,af as vl,ag as Ml,bb as Hk,bd as am,bg as Cm,cd as sm,cg as Cn,db as Qk,dc as Xk,dd as lm,dg as _l,ec as Yk,ed as cm,ef as Gr,eg as bm,f as Z6,fc as Zk,fe as Bm,gb as Gl,gc as yl,gd as Cl,ha as Lp,ib as Uk,ig as Dl,ja as qp,jc as Am,jd as um,jf as Tl,ka as Kp,ld as go,md as Cj,ne as gm,o as pn,qa as $n,qd as pm,r as jl,rd as xa,s as el,sa as Bn,t as fr,ta as Ia,u as tl,v as rl,vd as km,w as mn,wd as mm,we as hm,x as ol,xc as jm,xe as Rm,y as nl,yd as fm,yf as Pl,z as fn,zd as Em}from"https://app.framerstatic.com/chunk-FEMUQY7R.mjs";import{e as mr,g as dn,h as Y6,q as Jk,u as Wk,v as Ce}from"https://app.framerstatic.com/chunk-XP3D7M44.mjs";import{a as bl,d as dm}from"https://app.framerstatic.com/chunk-XFNBDXCA.mjs";import{a as Vh,f as mA}from"https://app.framerstatic.com/chunk-XBM64GTP.mjs";import{He as Nl}from"https://app.framerstatic.com/chunk-D4BIMG4Z.mjs";import{a as Pi,b as u7,c as Af,d as Ua,e as Wa,g as jf,h as tj,i as Xa,l as Vl,n as re}from"https://app.framerstatic.com/chunk-PKXMCYET.mjs";import{a as Tn,b as Ja,c as Ha,d as Xm}from"https://app.framerstatic.com/chunk-IYBTX7V5.mjs";import{a as Ll,b as vn}from"https://app.framerstatic.com/chunk-RWORSJPX.mjs";import{m as af}from"https://app.framerstatic.com/chunk-SWNEK4MT.mjs";import{$d as hk,$e as UA,Ac as po,Ad as $k,Bc as ok,C as xt,Cb as Hp,Cc as nk,Cd as ba,Db as Fa,Dc as ik,Df as Bl,E as Sj,Eb as cl,Eg as _A,Ei as Dk,F as En,Fb as Qp,Fg as $o,Gd as Bk,Gg as Sn,Hc as ak,Hg as ut,Ic as sk,K as il,Ka as Ot,Kb as Up,Kf as yj,La as sl,Lc as Se,Lf as gl,Mb as Ga,Mc as ml,Md as fl,Mg as hr,Nc as CA,Oc as ya,Od as fe,Oe as Ik,Pb as Sa,Pd as gk,Pe as Ta,Qb as Wp,Qc as ko,Qd as El,Qe as Pa,R as Mp,Rb as zp,Rc as lk,Re as Fk,Sc as ck,Sd as Br,Se as Ma,Sg as Ee,T as _p,Tc as Er,U as Dp,Uc as dk,V as Np,Vc as $r,Wc as uk,_a as wp,_b as Xp,_f as Ck,a as Ea,ac as dl,b as Cp,bg as bk,c as bp,cc as ul,dd as pk,e as kn,fa as Kj,ff as Gk,fg as vk,g as Al,hg as hl,hh as Pk,ic as Yp,jf as Sk,jg as Tk,k as vA,kc as me,l as ao,lb as ll,ld as Ca,le as Gn,nc as pl,nf as $l,ng as Rl,o as $a,oc as Ak,oh as Mk,p as Ba,pc as gn,qc as hn,qg as Eo,qh as yn,r as Le,rc as Rn,rd as kk,rf as yk,ri as Il,sb as xj,sc as jk,sd as mo,sh as _k,ta as ct,tc as ek,ub as Vp,uc as tk,v as so,vc as In,wc as kl,wd as fo,xc as rk,xf as gr,y as Nt,yc as co,ye as va,yf as wt,zc as uo,zd as Ek,ze as Rk,zi as Rr}from"https://app.framerstatic.com/chunk-ZI4WEUOX.mjs";import{$b as Xe,$c as Re,$d as Xr,$f as An,$g as en,$h as ku,$q as ep,$s as ma,Ab as jj,Ad as zo,Aj as Iu,At as ur,Bb as hA,Bd as Xo,Be as nu,Bg as Yi,Bj as ra,Bl as ot,Bn as wu,Br as dr,Cb as P7,Cd as QA,Ci as et,Ck as Fu,Cm as xu,Cs as ro,Cu as yp,D as dj,Db as M7,Dd as W,Dg as yt,Dl as bt,Dn as z6,Dp as at,E as F6,Eb as Qo,Ed as Yo,Ee as oj,Ei as ea,Em as U6,Er as kA,F as G6,Fd as ht,Fg as Zi,Fo as Yu,G as lA,Gc as Q7,Gd as uj,Ge as $A,Gi as Bj,Gp as jp,Gs as oo,H as h7,Hc as Wr,Hd as ue,He as _6,Hi as rn,Ht as pr,Id as RA,Ii as gj,Ik as q6,Jc as Wo,Jd as Zo,Jl as Tu,Jo as Zu,Jr as to,Js as fp,K as xi,Kb as _7,Kd as Rt,Kj as N6,Kk as VA,Kn as Lu,Lb as D7,Lc as qA,Lk as Zr,Lr as ip,M as R7,N as q,Na as y6,Nb as N7,Ni as $u,Nt as Ip,O as S6,Ob as Li,Oc as zr,Oi as Bu,Oj as x6,Ol as Pu,Ou as st,Pc as Wj,Pt as Fp,Pu as lt,Qd as W7,Qi as gu,R as Jo,Rb as x7,Rd as z7,Rk as V6,Rl as ia,Rm as sn,Rn as qu,Rt as wA,Sh as pu,Si as ta,So as Ap,Sq as eo,St as V,Te as iu,Th as jt,Tk as Gu,Tr as we,Ua as C7,Ub as Uo,Ud as Ji,Ut as Nj,Uu as dt,Va as C6,Vc as U7,Vk as Su,Vl as aa,Vq as lr,Vu as Fn,Wa as b6,Wb as or,Wc as qi,Wk as ej,Wm as it,Wt as Gj,Xa as b7,Xb as O7,Xc as De,Xi as hu,Xk as oa,Xt as g,Xu as mk,Ya as v6,Yd as Hi,Yh as ir,Yj as rt,Yt as kr,Yu as fk,Z as Mj,Zb as Yj,Zd as X7,Zk as on,Zl as nt,Zs as Ep,_c as he,_d as Qi,_g as cu,_l as H6,_q as cr,_r as ap,_s as ka,ac as aA,ad as Vi,ar as tp,bc as Zj,be as It,bm as Mu,br as Fe,bs as sp,bu as Ge,c as B6,ca as Oi,ce as Yr,ci as D6,cl as nn,cr as rp,cu as _t,d as Be,de as Y7,dl as yu,dm as Q6,dr as op,ds as lp,e as g6,ec as L7,ee as Ft,ei as mu,ek as Oe,el as sr,eo as Vu,es as cp,et as je,fe as Z7,fi as Aa,fj as tt,fl as Cu,fm as _u,fo as Ku,ge as Ui,gh as du,gi as fu,gm as Du,go as Ju,gs as da,gt as $p,h as p7,he as Au,hl as K6,ho as Hu,hr as np,hu as Gp,ic as q7,io as Qu,ir as ln,is as X6,jb as v7,jc as V7,je as Wi,jm as Nu,jo as Uu,js as dp,jt as Mt,k as k7,ke as Gt,kg as Ij,ki as tn,kj as ar,kk as O6,ko as Wu,ks as up,l as L,la as Qr,lc as K7,ld as Ne,le as St,lg as jn,lm as MA,ls as pp,lt as fa,m as bA,md as gt,me as ju,mm as pj,ms as kp,mu as no,nd as pA,ne as zi,nm as sa,ns as Tt,nt as Bp,nu as Sp,od as JA,oe as Ze,og as au,om as Ao,os as Fj,ot as gp,pd as Ye,pn as Ou,po as zu,ps as ua,qc as J7,qd as Ie,qe as xe,qk as w6,qs as pa,qt as hp,r as Ko,rd as M6,re as eu,ri as Eu,rn as jo,rs as Pt,s as h6,se as tu,sg as su,sj as Ru,sl as bu,sm as an,tb as wi,td as Ki,te as At,tg as lu,tm as pe,ub as Uj,ud as eA,ue as ru,ul as J6,um as kj,uo as Xu,va as F7,vb as Ur,vd as ZA,ve as ou,vg as Xi,vr as ke,wb as Ho,wd as de,wi as zj,wk as L6,wm as IA,xb as T7,xd as w,xh as nr,xi as ja,xn as la,xr as cn,yb as aj,yd as Ae,yh as Ct,yl as vu,yn as W6,yr as ca,zc as H7,zd as fj,zh as uu,zl as na,zs as mp,zt as Rp}from"https://app.framerstatic.com/chunk-Q5MQYIKV.mjs";import{t as w7}from"https://app.framerstatic.com/chunk-JH66VPYF.mjs";import{a as Zp}from"https://app.framerstatic.com/chunk-LH43QRIB.mjs";import{a as rr,b as _i}from"https://app.framerstatic.com/chunk-4AQCMAAQ.mjs";import{a as Om,c as Ol,d as wl}from"https://app.framerstatic.com/chunk-IEAVFMRN.mjs";import{b as cj}from"https://app.framerstatic.com/chunk-AUNF3KWQ.mjs";import{b as Di,d as m7,e as R6,f as f7,j as Ni,l as I6,p as E7,q as $7,r as B7,t as g7}from"https://app.framerstatic.com/chunk-Y3X6G54E.mjs";import{b as T6,d as P6,p as OA}from"https://app.framerstatic.com/chunk-RJOTTV32.mjs";import{a as Bt,b as _,d as Y,e as _j,f as ij,g as G7,i as sA,j as ce,k as S7,l as Dj,o as ge,q as y7}from"https://app.framerstatic.com/chunk-ZQUNXESX.mjs";import{Xd as vt,a as Mi,b as Hr,zc as I7}from"https://app.framerstatic.com/chunk-BWUNBOFS.mjs";import{g as Qj}from"https://app.framerstatic.com/chunk-4CB4BQFV.mjs";import{a as $t,b as s7,c as l7,d as c7,e as Jr,g as Ti}from"https://app.framerstatic.com/chunk-ORIFM75E.mjs";import{c as f6,f as ze}from"https://app.framerstatic.com/chunk-66XIMNKS.mjs";import{A as r7,B as $e,C as YA,D as Rj,F as le,G as yi,H as Ue,I as Ci,J as er,K as oA,L as o7,M as Kr,P as bi,Q as m6,R as n7,S as We,T as i7,U as a7,X as xA,_ as _e,a as j7,ca as vi,da as tr,e as p6,i as Vr,l as yA,n as k6,o as e7,p as Pe,r as t7,u as gA,y as jr,z as se}from"https://app.framerstatic.com/chunk-IZV4HDYJ.mjs";import{a as $,b as iA}from"https://app.framerstatic.com/chunk-WNSBRACC.mjs";import{a as Me}from"https://app.framerstatic.com/chunk-LQILWJHN.mjs";import{e as Pj,j as I,k as rA,l as NA,m as FA,n as Vo,o as u6}from"https://app.framerstatic.com/chunk-AHQIRSXG.mjs";var cf=Pj(Vh());var df=Pj(Mi());var LC=df.default.createContext("not-defined");var lf={store_internal:2,store_browse:2,store_use_installed:2},Kl={},Ya=new cf.FramerTracking({sourceName:"framer-x",trackingURL:Me().events+"/track",verbose:window.localStorage&&window.localStorage.getItem("debug-metrics")==="active",addContext:j=>{for(let A in Kl)j[A]===void 0&&(j[A]=Kl[A])}}),Jh;(t=>(t.init=function(r){let{appVersion:o,projectId:n}=r;Object.assign(Kl,{appVersion:o,projectId:n}),Ya.setUserId(r.userId)},t.push=function(r){let{name:o,type:n,...a}=r;r.type==="store_internal"?(delete a.action,Ya.track({type:"track",event:o,version:2,...a})):Ya.track({type:"track",event:n,version:lf[n],name:o,...a})},t.pushEvent=function(r){let{event:o,...n}=r;Ya.track({...n,type:"track",event:o,version:lf[o]})}))(Jh||={});var Hh=new Set(Uo({fillImageLocalized:!0,formInputPlaceholderLocalized:!0,htmlLocalized:!0,altAttributeLocalized:!0,titleLocalized:!0,descriptionLocalized:!0,linkLocalized:!0}));function Jl(j){return Hh.has(j)}function Za(j){return j.map(A=>_j(A)?As(A):ij(A)?Za(A):A)}function Qh(j){return j.endsWith("Localized")}function As(j){let A={};for(let e in j){if(Qh(e))continue;let t=j[e];_j(t)?A[e]=As(t):ij(t)?A[e]=Za(t):A[e]=t}return A}function UC(j){let A={};for(let e in j){if(Jl(e))continue;if(!q6(e)){A[e]=j[e];continue}let t=j[e];_j(t)?A[e]=As(t):ij(t)?A[e]=Za(t):A[e]=t}return A}function uf(j){let A={};for(let e in j){if(Jl(e))continue;if(!q6(e)){A[e]=j[e];continue}let t=j[e];_j(t)?A[e]=As(t):ij(t)?A[e]=Za(t):A[e]=t}return A}var{onewayMethodTemplate:ab,voidMethodTemplate:pf,valueMethodTemplate:Hl,streamMethodTemplate:sb}=Ti,Ql;(A=>A.service={id:"__ElectronWebRendering__",fingerprint:"55e7a2685b81eb6008c3d91a35ec44f1",methods:{collectMetrics:{},openSaveDialog:{},willOpenWindow:{},writeToClipboard:{},writeToDisk:{}},newOutgoingWrapper:e=>({collectMetrics:Hl.bind(-1,"collectMetrics",!1,e),openSaveDialog:Hl.bind(-1,"openSaveDialog",!0,e),willOpenWindow:Hl.bind(-1,"willOpenWindow",!0,e),writeToClipboard:pf.bind(-1,"writeToClipboard",!0,e),writeToDisk:pf.bind(-1,"writeToDisk",!0,e)})})(Ql||={});var Ul;(t=>{t.service=Ql.service;function A(r){let o=$t.shared();return{expect:()=>o.expectWithoutDiscovery(t.service,r),discover:n=>o.discover(t.service,r,n),register:n=>o.register({channel:r,service:t.service,implementation:n})}}t.on=A;async function e(r){$t.shared().unregister(r)}t.unregister=e})(Ul||={});var{onewayMethodTemplate:Gb,voidMethodTemplate:kf,valueMethodTemplate:js,streamMethodTemplate:Sb}=Ti,Wl;(A=>A.service={id:"__ElectronWebRenderingV2__",fingerprint:"6c902a5850607b51714e2b27dafbde81",methods:{collectMetrics:{},openSaveDialog:{},willOpenWindow:{},writeToClipboard:{},writeToDisk:{},getImageData:{}},newOutgoingWrapper:e=>({collectMetrics:js.bind(-1,"collectMetrics",!1,e),openSaveDialog:js.bind(-1,"openSaveDialog",!0,e),willOpenWindow:js.bind(-1,"willOpenWindow",!0,e),writeToClipboard:kf.bind(-1,"writeToClipboard",!0,e),writeToDisk:kf.bind(-1,"writeToDisk",!0,e),getImageData:js.bind(-1,"getImageData",!0,e)})})(Wl||={});var zl;(t=>{t.service=Wl.service;function A(r){let o=$t.shared();return{expect:()=>o.expectWithoutDiscovery(t.service,r),discover:n=>o.discover(t.service,r,n),register:n=>o.register({channel:r,service:t.service,implementation:n})}}t.on=A;async function e(r){$t.shared().unregister(r)}t.unregister=e})(zl||={});var Uh={track:!0};function mf(j){let A={...j,event:"canvas_page_add"};cj(A,Uh)}var Wh={track:!0};function ff(j){let A={...j,event:"canvas_page_select"};cj(A,Wh)}var zh={track:!0};function Ef(j){let A={...j,event:"component_canvas_create"};cj(A,zh)}var Xh={track:!0};function $f(j){let A={...j,event:"component_canvas_enter"};cj(A,Xh)}var Yh={track:!0};function Bf(j){let A={...j,event:"component_canvas_variant_create"};cj(A,Yh)}var Zh={track:!0};function Xl(j){let A={...j,event:"component_design_instance"};cj(A,Zh)}var AR={track:!0};function Yl(j){let A={...j,event:"export_bitmap"};cj(A,AR)}var jR={track:!0};function gf(j){let A={...j,event:"external_component_insert"};cj(A,jR)}var eR={track:!0};function hf(j){let A={...j,event:"property_layout_update"};cj(A,eR)}var tR={track:!0};function Rf(j){let A={...j,event:"variable_reference_create"};cj(A,tR)}function If(j,A,e){return Bt(e)?e:$A(A)?A.constraintsLocked:!1}function fv(j,A,e,t){let r=j.tree,o={x:Math.round(e.x-t.width/2),y:Math.round(e.y-t.height/2)},n=r.getNode(A);if(!A||!n)return{left:o.x,top:o.y};let a=Ep(j.tree,A),i=a?j.tree.getViewportRect(a):null,s=r.getRect(n),l=r.convertPointToNode(n,o),c={x:l.x,y:l.y,width:t.width,height:t.height},u=c.width/c.height,p=dl(c,{sizing:s,positioning:s,viewport:i,layout:Ne(n)},null,{aspectRatio:u,shouldGuessPinToBottom:pt(r,null,n),shouldGuessPinToRight:ee(r,null,n)});return p.aspectRatio=u,p}var Zl=(j,A,e,t)=>{let r=A.getGroundNodes().map(o=>j.getRect(o));return t!==void 0&&r.push(...t),r.find(o=>q.intersects(e,o))===void 0},rR=(j,A,e,t,r)=>{let o=A.getGroundNodes().map(i=>j.getRect(i));t!==void 0&&o.push(...t);let a=o.sort((i,s)=>q.maxX(i)>q.maxX(s)?-1:1)[0];return a!==void 0?ec(a,e,r):null},oR=(j,A,e,t,r)=>{let o=A.getGroundNodes().map(s=>j.getRect(s));t!==void 0&&o.push(...t);let i=o.filter(s=>s.width===e.width&&s.height===e.height||s.height===e.width&&s.width===e.height).sort((s,l)=>q.maxX(s)>q.maxX(l)?-1:1)[0];return i!==void 0?ec(i,e,r):null},nR=(j,A,e)=>A.map(t=>j.getNode(t)).filter(t=>Xi.equals(t.rect(null),e));function jc({tree:j,activeScope:A,node:e,size:t,filledRects:r,offsetDistance:o}){let n={...j.getRect(e),...t},a=A.getGroundNodes().map(l=>l.rect());r&&a.push(...r);let i=n,s=0;for(;i;){if(sA(o.x)||(n.x=Ac("x",i,o.x)),sA(o.y)||(n.y=Ac("y",i,o.y)),i=a.find(l=>q.intersects(l,n)),s>a.length)return n;s++}return n}var Gf=(j,A,e,t,r={x:100,y:void 0},o)=>jc({tree:j,activeScope:A,node:e,size:t,filledRects:o,offsetDistance:r}),Mn=(j,A,e,t,r=100,o)=>jc({tree:j,activeScope:A,node:e,size:t,filledRects:o,offsetDistance:{x:r}}),Ev=(j,A,e,t,r=100,o)=>jc({tree:j,activeScope:A,node:e,size:t,filledRects:o,offsetDistance:{y:r}});function Ac(j,A,e){return(j==="x"?q.maxX:q.maxY)(A)+e}function ec(j,A,e=100){return{...j,x:Ac("x",j,e),...A}}var iR=(j,A,e,t,r,o,n)=>{if(o){let s=j.getNode(o);if(s)return Mn(j,A,s,e,n,r)}if(t){let s=nR(j,t,e);if(s.length){let c=s.map(p=>ec(p.rect(),e,n)).find(p=>Zl(j,A,p,r));if(c)return c;let u=s[0];return $(u,"Equal frame must be defined"),Mn(j,A,u,e,n,r)}}let a=oR(j,A,e,r,n);if(a!==null&&Zl(j,A,a,r))return a;let i=rR(j,A,e,r,n);return i!==null&&Zl(j,A,i,r)?i:{...e,x:0,y:0}},$v=(j,A,e,t,r)=>{let o=j.getRect(e),n=j.getParent(e.id),a;RA(e)&&(a=Math.min(o.width,100));let i=iR(j,A,o,t,r,e.id,a);return r.push(i),dl(i,null,Tt(e)?Pt(e):null,{shouldGuessPinToBottom:!0,shouldGuessPinToRight:ee(j,e,n)})},Bv=(j,A,e,t)=>{if(e.length>0){let r=e[e.length-1],o=j.getGroundFrameAncestor(r,!0);if(o)return o.id}for(let r of j.sortVisually(j.getNodesAtPoint(A,t)).reverse())if(r instanceof ye&&j.getParent(r.id)===Bj){if(hA(r))continue;return r.id}return Bj},gv=(j,A,e)=>{let r=j.tree.newId(),o={top:A.y,left:A.x,width:A.width,height:A.height,overflow:Oe(),isScreen:!0};return o.framePreset=e,j.createFrame(Bj,{id:r,...o}),r},hv=(j,A)=>{let e=j.tree,t=e.newId(),r={top:A.y,left:A.x,width:A.width,height:A.height,overflow:Oe(),isScreen:!0};return j.createFrame(Bj,{id:t,...r}),j.stores.scopeStore.active.getGroundNodes(n=>{let a=e.getRect(n);return n.id!==t&&q.containsRect(A,a)}).forEach(n=>{let a=e.getParent(n.id),i=e.getRect(n),s=q.offset(i,lA.reverse(A));j.moveNode(n.id,t),j.tree.current(n)?.set(n.updateForRect({rect:s,parentSizeInfo:{sizing:A,positioning:A,viewport:null,layout:Ne(a)},constraintsLocked:If(j,n),shouldGuessPinToBottom:!0,shouldGuessPinToRight:ee(j.tree,n,a)}))}),t},Ff=["#9ef","#4cf","#3af","#38f","#26f"],Rv=(()=>{let j=-1,A=Ff.length;return()=>(j++,Ff[j%A])})();function yv(j,A){if(!j||j.changes.length===0)return!1;for(let e of j.changes){let t=A.get(e.id);if(!z7(t)&&!W7(t)&&!(!t&&e.added==="RedirectRouteNode"))return!1}return!0}function yf(j,A){if(!j||j.changes.length===0)return!1;for(let e of j.changes){let t=A.get(e.id);return!t||!nt(t)?!1:"variables"in e.from}return!0}function Cf(j,A){if(!j||j.changes.length===0)return!1;for(let e of j.changes){let t=A.get(e.id);if(!gt(t))return!1;let r="locales";return!!(r in e.from||e.from._deleted?.includes(r))}return!0}var bf=class extends me{constructor(){super(...arguments);I(this,"active",0)}};function tc(j){return j.userIsViewer?xl:Qj.isAutomation||Qj.isTest?Mm:j.acl.find(e=>e.user.id===j.userId)?.permissions??xl}var _n=class{constructor(A){this.aclPermissions=A}get canDesign(){return this.aclPermissions.canDesign==="on"}get canEditContent(){return this.aclPermissions.canEditContent==="on"}get canPublish(){return this.aclPermissions.canPublish==="on"}get canEditSiteSettings(){return this.canDesign&&this.canEditContent&&this.canPublish}get canPublishToStaging(){return this.canDesign||this.canEditContent||this.canPublish}get canInviteCollaborators(){return this.canDesign||this.canEditContent||this.canPublish}get canEditVariables(){return this.canDesign}get canAddCollections(){return this.canDesign}get canEditAnalytics(){return this.canDesign||this.canEditContent}get canEditLocales(){return this.canDesign}get canEditLocalizedValues(){return this.canEditContent}get canSendDiffs(){return this.canDesign||this.canEditContent}},Ov=hu({canDesign:"Design",canEditContent:"Content",canPublish:"Deploy",canEditSiteSettings:"Design and Content and Deploy",canPublishToStaging:"Design or Content or Deploy",canInviteCollaborators:"Design or Content or Deploy",canEditVariables:"Design",canAddCollections:"Design",canEditAnalytics:"Design or Content",canEditLocales:"Design",canEditLocalizedValues:"Content",canSendDiffs:"Design or Content"});function wv(j){let A=tc(j);return new _n(A)}var rc=j=>[j.chromeStore,j.projectStore,j.sessionStore],es=([j,A,e])=>({userIsViewer:j.userIsViewer,acl:A.acl,userId:e.user.id});function Lv(j,A,e,{signal:t}){let r=rc(j),o=es(r),n=A.changes.observe(...r,()=>{let a=es(r);Yj(o,a)||(o=a,e(a))});t.addEventListener("abort",()=>{A.changes.removeObserver(n)},{once:!0})}function Jv(){let j=um();return $(oc(j),"Expected OnPageEngine"),j}function oc(j){return j.name==="OnPageEngine"}var vf=j=>[j.loadingStore,...rc(j)],nc=([j,...A])=>({isReady:j.isReady,...es(A)});function aR(j,A){if(!j.isReady||j.userIsViewer)return!0;let e=tc(j);return!new _n(e)[A]}function Dn(j,A){return go(j)?aR(nc(vf(j.stores)),A):!oc(j)}function Xv(j,A,e,{signal:t}){let r=vf(j),o=nc(r),n=A.changes.observe(...r,()=>{let a=nc(r);Yj(o,a)||(o=a,e(a))});t.addEventListener("abort",()=>{A.changes.removeObserver(n)},{once:!0})}var Tf=class extends me{constructor(e,t){super();this.addChanges=e;this.effectsStore=t;I(this,"update",0);I(this,"tooltip");I(this,"shapeToolActive",!1);I(this,"feedbackModeActive",!1);I(this,"handle",null);I(this,"straightLineAnchorIndex",0);I(this,"proseMirrorView",null);I(this,"proseMirrorState",null);I(this,"textLink",null);I(this,"editedTextLink");I(this,"stackInsertionIndicator",null);I(this,"replaceableFloatingPositionNode",null);I(this,"activeTool",0);I(this,"nodeInTextEditor",Bj);I(this,"nodeInPathEditorOffset",null);I(this,"dragAndDropPlaceholders",null);I(this,"codeComponentInProgressInsertionIndicatorNodeIDs",new Set)}get tool(){return this.activeTool}postProcess(e){this.update=e}get isDefaultToolActive(){return this.tool===0||this.tool===1}updateDragAndDropPlaceholder(e){if(e){let t=e.cache.placeholders,r=t?{id:e.id,placeholders:t}:null;if(Qr(r,this.dragAndDropPlaceholders))return;this.dragAndDropPlaceholders=r}else this.dragAndDropPlaceholders=null}setTool(e){En.canEditTree(e)&&e!==6&&this.effectsStore.exitPreview(),this.shapeToolActive=lR(e),cR(e)||(this.feedbackModeActive=!1),this.tool===6&&e!==6&&this.addChanges("ExitMove"),this.tool!==e&&this.addChanges("Tool"),this.activeTool=e}};function sR(j){switch(j){case 30:case 21:case 10:case 22:case 24:case 23:case 12:case 11:case 20:case 13:case 19:case 14:case 46:case 29:case 40:case 45:case 27:case 39:case 28:case 25:return!1;case 41:case 42:case 15:case 17:case 16:case 18:case 1:case 37:case 33:case 43:case 0:case 44:case 9:case 38:case 6:case 31:case 3:case 34:case 36:case 7:case 26:case 8:case 35:case 47:case 2:case 48:case 32:case 4:case 5:return!0;default:iA(j)}}function lR(j){switch(j){case 30:case 41:case 42:case 21:case 10:case 22:case 24:case 23:case 12:case 11:case 20:case 13:case 19:case 14:case 46:case 1:case 37:case 33:case 43:case 0:case 44:case 40:case 45:case 38:case 6:case 31:case 3:case 36:case 7:case 26:case 27:case 28:case 29:case 8:case 35:case 47:case 2:case 39:case 25:case 48:case 32:case 4:case 5:return!1;case 15:case 17:case 16:case 18:case 9:case 34:return!0;default:iA(j)}}function cR(j){switch(j){case 41:case 42:case 3:case 4:case 5:return!0;case 0:case 1:case 2:case 6:case 7:case 47:case 8:case 9:case 30:case 10:case 11:case 12:case 46:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 24:case 23:case 25:case 26:case 27:case 28:case 29:case 31:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 43:case 48:case 32:case 44:case 45:return!1;default:iA(j)}}function iT(j){switch(j){case 4:case 5:return!0;case 0:case 1:case 2:case 3:case 6:case 7:case 47:case 8:case 9:case 30:case 10:case 11:case 12:case 46:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 24:case 23:case 25:case 26:case 27:case 28:case 29:case 31:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 48:case 32:case 44:case 45:return!1;default:iA(j)}}function _f(j){switch(j){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 41:case 42:case 48:case 45:return!0;case 7:case 47:case 8:case 9:case 30:case 10:case 11:case 12:case 46:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 24:case 23:case 25:case 26:case 27:case 28:case 29:case 31:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 43:case 32:case 44:return!1;default:iA(j)}}function aT(j){switch(j){case 3:case 4:case 45:return!0;case 5:case 6:case 0:case 1:case 2:case 41:case 42:case 48:case 7:case 47:case 8:case 9:case 30:case 10:case 11:case 12:case 46:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 24:case 23:case 25:case 26:case 27:case 28:case 29:case 31:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 43:case 32:case 44:return!1;default:iA(j)}}function Df(j){switch(j){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 48:return!0;case 41:case 42:case 7:case 47:case 8:case 9:case 30:case 10:case 11:case 12:case 46:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 24:case 23:case 25:case 26:case 27:case 28:case 29:case 31:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 43:case 32:case 44:case 45:return!1;default:iA(j)}}function sT(j,A){return j.stores.historyStore.isLoadingDocument?A===45:Dn(j,"canDesign")?_f(A):j.stores.chromeStore.isPreviewingFeaturedTemplate?Df(A):!0}function lT(j,A){return A==="VectorSet"?sR(j):!(A==="WebPage"&&j===40)}function cT(j,A){if(Dn(j,"canDesign")&&!_f(A))throw Error("Viewer mode: Tool "+A+" is a forbidden action.");if(j.stores.chromeStore.isPreviewingFeaturedTemplate&&!Df(A))throw Error("Previwing template mode: Tool "+A+" is a forbidden action.")}var dT=j=>j===20||j===21||j===22||j===24||j===23||j===19;function uT(j){return j===8||j===7||j===47||j===31||j===33}var dR={0:!0,1:!0,2:!0,3:!0,4:!0,6:!0,5:!0};function fT(j){return Y(j)&&dR[j]===!0}var ic=new Map;function $T(j,A){ic.set(j,A)}function BT(j){ic.delete(j)}function Nf(j){ic.get(j)?.()}var uR="__page_input";function pR(j){return`${uR}_${j}`}function ts(j){let A=pR(j);Nf(A)}function rs(j){return eA(j)||w(j)}async function xf({messages:j,model:A,schema:e,signal:t}){let r=await qa.post("/ai/v2/chat/",{model:A,messages:j,response_format:{type:"json_schema",json_schema:{strict:!0,name:"schema",schema:e}}},t);try{return JSON.parse(r?.choices?.[0]?.message?.content??"")}catch(o){throw new Error(`Could not process JSON response: ${o}`,{cause:r})}}function Nn(j,A){if(sA(j))return j;let e=[];for(let t of j)e.push(A.get(t)??t);return e.length>0?e:void 0}function Ke(j,A){if(!kj(A))return null;let e=j.getNode(A.originalid);return $(e,"The original variant node should exist"),e}function kR(j,A,e){let t=kA.inheritedReplicaNode(j,A.replicaInfo.inheritsFrom),r=dr(A.replicaInfo.overrides,t?.replicaInfo.overrides);for(let o of e.walk()){let n=r[o.id];if(!n)continue;let{_deleted:a,itemsOrder:i,...s}=n;a?.forEach(l=>s[l]=void 0),j.current(o)?.set(s)}}function Of(j,A){let e=j.getNode(A.originalid),t=kA.getReplicaForTemplateNode(j,A);if(!e||!t||!MA(t))return[];if(!t.replicaInfo.inheritsFrom)return[e];let r=j.getNode(t.replicaInfo.inheritsFrom);if(!r)return[e];let o=ke(r.id,e.id),n=j.getNode(o);return n?[e,n]:[e]}function OT(j,A,e,t){let r=kA.getReplicaForTemplateNode(j.tree,A);$(r,"replica should exist when moving node out of replica"),$(MA(r),"replica must be a variant"),kR(j.tree,r,e),A.isVisible()&&!e.isVisible()&&j.tree.current(e)?.set({visible:!0}),t.delete(A.id),t.add(e.id)}function xn(j,A,e,t,r){if(!e||!t)return A.id;$(hA(e),"Fail to update variant nodes: parent must be a replica");let o=kA.getReplicaForTemplateNode(j.tree,e);if($(o,"Fail to update variant nodes: replica should exist"),$(MA(o),"Fail to update variant nodes: replica must be an variant"),fa(j.tree,e)){j.tree.current(A)?.set({visible:!1});let a={visible:!0};ur(A)&&r&&(a.itemsOrder=Nn(A.itemsOrder,r)),bn(j.tree,o,A.id,a)}return ke(o.id,A.id)}function ac(j,A,e,t,r,o){let n=xn(j,A,e,t,o);return r.delete(A.id),r.add(n),n}function wT(j,A,e){let t=Of(j.tree,A),r=Of(j.tree,e),o=t.find((n,a)=>!n.isVisible()||n.cache.visible===!0?!1:r[a]?.cache.visible??!1);o&&(j.tree.get(o.id)?.set({visible:!1}),A.set({visible:!0},j.tree,!0))}function wf(j,A,e){Mt(j.tree,A).forEach(({replicaRoot:t})=>{if(Object.keys(t.replicaInfo.overrides).every(i=>!e.has(i)))return;let n={...t.replicaInfo},a={...n.overrides};n.overrides=a,e.forEach((i,s)=>{if(s in a){let l={...a[s]},c=l.itemsOrder;"itemsOrder"in l&&Array.isArray(c)&&(l.itemsOrder=Nn(c,e)),a[i]=uf(l)}}),j.tree.get(t.id)?.set({replicaInfo:n})})}var mR={type:{type:Ko.type,value:h6.type},variantId:{type:Ko.variantId,value:void 0},pauseOffscreen:{type:Ko.pauseOffscreen,value:h6.pauseOffscreen}},WT={type:"type",variantId:"variantId",pauseOffscreen:"pauseOffscreen"},fR={cycle:!0,set:!0};function zT(j){return _(j)&&j in fR}function Je(j){return ea(j)&&j.actionIdentifier==="framer/useSetVariant"}function Lf(j){return j.controls.type?.value!=="set"?null:j.controls.variantId?.value??null}function XT(j){return Array.isArray(j)&&j.some(Je)}function YT(j){return Array.isArray(j)&&j.some(A=>Je(A)&&A.controls.type?.value==="set"&&!A.controls.variantId?.value)}function ZT(j,A){return cp(j,Je,A)}function AP(j,A,e){let t=lp(A,Je,e),r=[];return t.forEach(o=>{switch(o.controls.type?.value){case"set":{let a=o.controls.variantId?.value;a&&r.push(a);break}case"cycle":{let a=j.getScopeNodeFor(A);if(!eA(a))return;let i=a.getTopLevelVariants();if(i.length<=1)return;let s=j.getGroundNodeFor(A),l=i.findIndex(f=>f.id===s.id);if(l===-1)return;let c=l+1,u=c>=i.length?0:c,p=i[u];p&&r.push(p.id);break}}}),r}function jP(j){let A={};return Object.entries(j).forEach(([e,t])=>{A[e]=t?.value}),A}function ER(j,A){return!(j?.inputValue!==A?.inputValue||j?.delay!==A?.delay||j?.key!==A?.key)}function eP(j,A,e){let t=Array.isArray(j)?[...j]:[],r=t.findIndex(Je),o=t[r];if(Je(o)&&ER(o.meta,e)){let n={...o.controls,...qf(A)},a={...o,controls:n,meta:{...o.meta,...e}};t[r]=a}else{let n=$R(A,void 0,e);t.push(n)}return t}function qf(j){let A={};return Object.entries(j).forEach(([e,t])=>{A[e]={type:Ko[e],value:t}}),A}function $R(j,A,e){let t=qf({...j}),r={identifier:A||vt(),actionIdentifier:"framer/useSetVariant",controls:{...mR,...t}};return e&&Object.assign(r,{meta:e}),r}function tP(j,A){let e={...j.controls,...A};return{...j,controls:e}}function Vf(j,A){let e=A.get(j);return Ji(e)?e:null}function sc(j,A,e="transparent"){if(sA(j))return e;if(!ot(j))return j;let t=na(j);return(t?Vf(t,A):null)?.light??e}function Cr(j,A,e,t=!1){if(Tp(A)){j.has(A)||j.ensureEntityTypeRootNode(A);return}let r=t?Ia(e):Bn(e);if(j.has(r))return;let o=new $n({id:r});j.insertNode(o,A)}function BR(j,A){let e=j.tree.get(A);if(Dj(e))return;let t=j.tree.get(e.parentid);if(!Dj(t))return t.children?.findIndex(r=>r.id===A)}function kP(j,A,e){let t=j.tree.getEntityReferenceNode(A);if(Dj(t))return;let r=Bn(e),o=new $n({id:r}),n=BR(j,t.id),a=ce(n)?n+1:void 0;j.tree.insertNode(o,t.parentid,a)}function mP(j,A){let e=j.tree.get(A);Dj(e)||(j.tree.removeNode(e),gR(j,A))}function gR(j,A,e){let{isCodeFile:t=!1}=e??{},r=t?Ia(A):Bn(A);j.tree.remove(r)}function os(j,A){return j===fr?Ia(A):Bn(A)}function hR(j){return A=>xe(A)&&A.name===j}function Kf(j,A){return j.children.find(hR(A))??null}function GP(j,A){return j.children.find(e=>xe(e)&&e.getName()===A)??null}function SP(j,A){let t=FR(j.tree,A).map(n=>j.tree.get(n));$(t.length>0,"unreferenced nodes parent node must exist");let r=t.flatMap(n=>n?.children??[]);if(!r||r.length===0)return;let o=RR[A];j.tree.beginAllowPartialScopeAccess();for(let n of r){if(!o(n))continue;let a=os(A,n.id);if(j.tree.get(a))continue;let i=new $n({id:a});j.tree.insertNode(i,A)}j.tree.endAllowPartialScopeAccess()}function Jf(j){return Br(j)&&j.save.type==="codeFile"}var RR={[jl]:j=>Au(j),[tl]:j=>Gt(j),[ol]:j=>Ft(j),[nl]:j=>Yr(j),[el]:j=>Wi(j)||Ui(j)||Xr(j),[fr]:j=>Jf(j),[mn]:j=>eA(j)||Jf(j),[rl]:j=>Ji(j),[fn]:j=>ZA(j),[io]:j=>de(j)},IR={[jl]:Lt,[tl]:Lt,[ol]:Lt,[nl]:Lt,[el]:Lt,[fr]:fe,[rl]:Da};function FR(j,A){return A===fn||A===io?[j.root.id]:A===mn?[j.root.id,fe]:[IR[A]]}var GR="__entity_input";function yP(j,A){return`${GR}_${j}_${A?"popout":"panel"}`}function lc(j){return vp(j)||xe(j)}function CP(j,A,e){let t=e;for(let[r,o]of A.entries()){let n=r===A.length-1,a=j.getNode(t);if(!a||!lc(a))return!1;let i=!1;for(let s of a.children){if(eu(s)&&o===s.getName())return!0;if(xe(s)&&o===s.getName()){if(n)return!0;i=!0,t=s.id;break}}if(!i)return!1}return!1}function ns(j,A,e){let t=ij(A)?A:SR(A);if(t.length===0)return e;let r=j.get(e);$(r&&lc(r),"A reference must be in a folder.");for(let o of t){let n=Kf(r,o);if(n){r=n;continue}r=j.insertNode(new xk({name:o}),r.id)}return r.id}function OP(j,A){let e=j.tree.get(A);if(!xe(e))return"";let t=[e.name];for(let r of e.ancestors()){if(!xe(r))break;t.unshift(r.name)}return`/${t.join("/")}`}function wP(j,A,e){let t=j.tree.get(A);$(t,"Node must exist");let r=os(e,A),o=j.tree.get(r),n=[t.name];if(o)for(let a of o.ancestors()){if(!xe(a))break;n.unshift(a.name)}return`/${n.join("/")}`}function SR(j){return fl(j).slice(0,-1)}function LP(j,A,e,t){let r=fl(e);if(r.length===0)return;let o=r.pop(),n=ns(j.tree,e,t),a=t===fr;return Cr(j.tree,n,A.id,a),A.set({name:o}),n}function ho(j){return jn(j)}function Hf(j,A){if(!on(A))return!1;let e=Al(A.codeComponentIdentifier);if(!e)return!1;let t=j.getNode(e);return!!(t&&w(t))}function WP(j,A){let e=Al(A.codeComponentIdentifier);$(e,"WebPageInstance should have a local canvas component id");let t=j.getNode(e);return $(t,"SmartComponentInstance should have a local WebPageNode"),$(w(t),"WebPageInstance its WebPageNode should be a web page"),t}var wn=(j,A)=>j.length===0?[]:typeof j[0]=="string"?A.withoutDescendants(A.getNodes(j)):j;function is(j,A){let e=A.reactComponentForIdentifier(j.codeComponentIdentifier);return e?Bk(e.properties,j.getControlProps(e.properties)):{}}var yR={type:"None",source:"undefined"},Qf=class extends me{constructor(e){super();this.scheduler=e;I(this,"_stack",[]);I(this,"dismiss",()=>{this._stack=_e.pop(this._stack)});I(this,"isVisible",()=>this.active.type!=="None");I(this,"shouldBlockUndoRedo",(e,t)=>{switch(this.active.type){case"None":return!1;case"Variables":return!yf(e,t);case"LocaleSettings":return!Cf(e,t);default:return!0}})}get stack(){return this._stack}get active(){return this._stack[this._stack.length-1]??yR}trackModalOpen({type:e,source:t}){mA("modal_open",{modalType:e,source:t})}push(e){this._stack=_e.push(this._stack,e),this.trackModalOpen(e)}set(e){this._stack=[e],this.trackModalOpen(e)}dismissAll(){this._stack.length!==0&&(this._stack=[])}dismissModal(e){this._stack=_e.filter(this._stack,t=>t.type!==e)}displayComponentIsolationModal({source:e}){let t="componentIsolationModal",r="1";Qj.isAutomation||Qj.isE2E||Qj.isTest||localStorage.getItem(t)!==r&&(localStorage.setItem(t,r),setTimeout(()=>{this.scheduler.processWhenReady(()=>{this.set({type:"ComponentIsolationModal",source:e})})},0))}};function Uf(j){if(_(j))return[j];if("id"in j)return[j.id];let A=[];for(let e of j)_(e)?A.push(e):A.push(e.id);return A}function Ln(j,A){if(j===A)return!0;if(j.length!==A.length)return!1;let e=new Set(j);for(let t of A)if(!e.has(t))return!1;return!0}var Wf=class extends me{constructor(e,t,r){super();this.guides=e;this.chromeStore=t;this.overlayStore=r;I(this,"_previousIds",[]);I(this,"_ids",[]);I(this,"_nodes",[]);I(this,"_isSticky",!1);I(this,"_commonGroundNode");I(this,"gradientStopId")}get ids(){return this._ids}get nodes(){return this._nodes}get isSticky(){return this._isSticky}get commonGroundNode(){return this._commonGroundNode}get commonGroundNodeId(){return this._commonGroundNode?.id??null}get previousIds(){return this._previousIds}set(e,t={}){let r=Uf(e);if(Ln(this._ids,r))return;this._previousIds=this._ids,this._ids=r,this._isSticky=t.sticky??r.length>1,r.length>0&&this.guides.clearSelected();let{switchToLayers:n=!1,tree:a}=t;this.chromeStore.onCanvasSelectionChange(r,n),this.overlayStore.onCanvasSelectionChange(r,{tree:a})}toggle(e,{switchToLayers:t=!1}={}){let r=Uf(e),o=new Set(this.ids);for(let n of r)o.has(n)?o.delete(n):o.add(n);this._ids=Array.from(o),this.chromeStore.onCanvasSelectionChange(this.ids,t),this.overlayStore.onCanvasSelectionChange(o,{toggle:!0})}clear(){this.set([])}updateNodes(e){let t=e.getNodes(this.ids),r=!or(this.nodes,t);r&&(this._nodes=t),(r||this.commonGroundNode&&!e.isGroundNode(this.commonGroundNode))&&this.updateCommonGroundNode(e)}updateCommonGroundNode(e){let t;for(let r of this.nodes){let o=e.getGroundNodeFor(r);if(!t)t=o;else if(t!==o){t=void 0;break}}this._commonGroundNode=t}postProcess(e,t,r,o=this.gradientStopId,n=this._ids){this.gradientStopId=o;let a=[];for(let i of n){let s=e.getNode(i);if(s){e.isAncestorOfNode(s,t.id)&&a.push(i);continue}let l=r.getNode(i);if(!ue(l))continue;let c=e.getNode(l.parentid);if(uj(c)){a.splice(0,a.length,c.id);break}}this.set(a,{tree:e}),this.updateNodes(e)}};function cc(j){let A=L.componentForIdentifier(j.codeComponentIdentifier);if(!A?.properties)return null;let e=Object.entries(A.properties).find(([,n])=>n&&n.title==="Variant"&&n.type==="enum");if(!e)return null;let[t,r]=e;if(r.options.length<=1)return null;let o=r.defaultValue??r.options[0];return _(o)?{key:t,control:r,defaultVariant:o}:null}function dc(j,{control:A}){let e=j.toLowerCase().trim(),r=(A.optionTitles??A.options).findIndex(n=>_(n)&&n.toLowerCase()===e);if(r===-1)return null;let o=A.options[r];return _(o)?o:null}function zf(j,A,e){let t={};for(let r of e.walk()){if(!W(r))continue;let o=cc(r);if(!o)continue;let n=dc(A,o);if(!n)continue;let a=r;if(jj(r)&&(a=j.tree.getNode(r.originalid)),!a||(a.getRawControlProp(o.key)??o.defaultVariant)===n)continue;let s={type:"enum",value:n};t[a.id]={[VA(o.key)]:s}}return Object.keys(t).length>0?t:null}var Xf=["blur","backgroundBlur","brightness","contrast","grayscale","hueRotate","invert","saturate","sepia"];var ss={left:"position",right:"position",top:"position",bottom:"position",centerAnchorX:"position",centerAnchorY:"position",constraintsLocked:"position",x:"position",y:"position",width:"size",widthType:"size",height:"size",heightType:"size",aspectRatio:"size",itemsOrder:"itemsOrder",layout:"layout",gap:"layout",gridAlignment:"layout",gridColumnCount:"layout",gridColumnWidthType:"layout",gridColumnWidth:"layout",gridColumnMinWidth:"layout",gridRowHeightType:"layout",gridRowHeight:"layout",gridRowCount:"layout",stackDirection:"layout",stackDistribution:"layout",stackAlignment:"layout",stackWrapEnabled:"layout",gridItemFillCellWidth:"size",gridItemFillCellHeight:"size",gridItemHorizontalAlignment:"position",gridItemVerticalAlignment:"position",gridItemColumnSpan:"size",gridItemRowSpan:"size",minHeight:"sizeConstraints",minWidth:"sizeConstraints",maxHeight:"sizeConstraints",maxWidth:"sizeConstraints",paragraphSpacing:"paragraphSpacing",position:"positionType",positionStickyTop:"positionType",positionStickyRight:"positionType",positionStickyBottom:"positionType",positionStickyLeft:"positionType",intrinsicWidth:"intrinsicSize",intrinsicHeight:"intrinsicSize",fillColor:"fill",fillEnabled:"fill",fillImage:"fill",fillImageOriginalName:"fill",fillImagePixelHeight:"fill",fillImagePixelWidth:"fill",fillImageResize:"fill",fillImagePositionX:"fill",fillImagePositionY:"fill",fillImageTileSize:"fill",fillType:"fill",fillRadialGradient:"fill",fillLinearGradient:"fill",fillConicGradient:"fill",tapHighlightColor:"tapHighlight",textSelection:"textSelection",masks:"mask",radius:"radius",radiusBottomLeft:"radius",radiusBottomRight:"radius",radiusIsRelative:"radius",radiusPerCorner:"radius",radiusTopLeft:"radius",radiusTopRight:"radius",borderTop:"border",borderBottom:"border",borderLeft:"border",borderRight:"border",borderEnabled:"border",borderWidth:"border",borderStyle:"border",borderColor:"border",borderPerSide:"border",rotation:"rotation",rotate3d:"rotation",rotateX:"rotation",rotateY:"rotation",blendingMode:"blending",opacity:"opacity",backgroundBlur:"backgroundBlur",overflow:"overflow",overflowY:"overflowY",overflowX:"overflowX",overscrollBehavior:"overscroll",visible:"visibility",brightness:"brightness",contrast:"contrast",grayscale:"grayscale",hueRotate:"hueRotate",invert:"invert",saturate:"saturate",sepia:"sepia",blur:"blur",boxShadows:"shadows",shadows:"shadows",guidesX:"canvasSettings",guidesY:"canvasSettings",exportOptions:"canvasSettings",overlayGrid:"canvasSettings",gesture:"canvasSettings",sizeToFit:"canvasSettings",framePreset:"canvasSettings",isVariant:"canvasSettings",onTap:"action",onTapStart:"action",onClick:"action",onMouseUp:"action",onMouseDown:"action",onMouseEnter:"action",onMouseLeave:"action",onAppear:"action",onKeyDown:"action",padding:"padding",paddingPerSide:"padding",paddingTop:"padding",paddingRight:"padding",paddingBottom:"padding",paddingLeft:"padding",name:"name",strokeEnabled:"stroke",strokeAlignment:"stroke",strokeWidth:"stroke",strokeColor:"stroke",lineJoin:"stroke",lineCap:"stroke",strokeMiterLimit:"stroke",strokeDashArray:"stroke",strokeDashOffset:"stroke",html:"richText",htmlLocalized:"richText",htmlContent:"richText",textFitScale:"richText",textFitViewBoxSize:"richText",textFitViewBoxSizeLocalized:"richText",stylePresetHeading1:"stylePresets",stylePresetHeading2:"stylePresets",stylePresetHeading3:"stylePresets",stylePresetHeading4:"stylePresets",stylePresetHeading5:"stylePresets",stylePresetHeading6:"stylePresets",stylePresetParagraph:"stylePresets",stylePresetLink:"stylePresets",stylePresetAnchorLink:"stylePresets",stylePresetBlockquote:"stylePresets",stylePresetTable:"stylePresets",stylePresetInlineCode:"stylePresets",stylePresetImage:"stylePresets",anchorLinkOffsetY:"anchorLinkOffsetY",styledText:"styledText",getStyledText:"styledText",font:"font",rootFontSize:"rootFontSize",textColor:"textColor",textBackgroundColor:"textBackgroundColor",textBackgroundRadius:"textBackgroundRadius",textBackgroundPadding:"textBackgroundPadding",fontSize:"fontSize",letterSpacing:"letterSpacing",textTransform:"textTransform",textDecoration:"textDecoration",textDecorationColor:"textDecoration",textDecorationThickness:"textDecoration",textDecorationStyle:"textDecoration",textDecorationSkipInk:"textDecoration",textDecorationOffset:"textDecoration",lineHeight:"lineHeight",textAlignment:"textAlignment",textStrokeWidth:"textStroke",textStrokeColor:"textStroke",textWrapBalance:"textWrapBalance",openTypeFontFeatures:"openTypeFontFeatures",link:"link",linkOpenInNewTab:"link",linkSmoothScroll:"link",linkClickTrackingId:"link",linkLocalized:"link",linkRelValues:"link",linkPreserveParams:"link",getLink:"link",linkFont:"linkStyle",linkTextColor:"linkStyle",linkFontSize:"linkStyle",linkTextTransform:"linkStyle",linkTextDecoration:"linkStyle",linkTextDecorationColor:"linkStyle",linkTextDecorationThickness:"linkStyle",linkTextDecorationStyle:"linkStyle",linkTextDecorationSkipInk:"linkStyle",linkTextDecorationOffset:"linkStyle",linkTextBackgroundColor:"linkStyle",linkTextBackgroundRadius:"linkStyle",linkTextBackgroundPadding:"linkStyle",linkHoverFont:"linkStyle",linkHoverTextColor:"linkStyle",linkHoverFontSize:"linkStyle",linkHoverTextTransform:"linkStyle",linkHoverTextDecoration:"linkStyle",linkHoverTextDecorationColor:"linkStyle",linkHoverTextDecorationThickness:"linkStyle",linkHoverTextDecorationStyle:"linkStyle",linkHoverTextDecorationSkipInk:"linkStyle",linkHoverTextDecorationOffset:"linkStyle",linkHoverTextBackgroundColor:"linkStyle",linkHoverTextBackgroundRadius:"linkStyle",linkHoverTextBackgroundPadding:"linkStyle",linkCurrentFont:"linkStyle",linkCurrentTextColor:"linkStyle",linkCurrentFontSize:"linkStyle",linkCurrentTextTransform:"linkStyle",linkCurrentTextDecoration:"linkStyle",linkCurrentTextDecorationColor:"linkStyle",linkCurrentTextDecorationThickness:"linkStyle",linkCurrentTextDecorationStyle:"linkStyle",linkCurrentTextDecorationSkipInk:"linkStyle",linkCurrentTextDecorationOffset:"linkStyle",linkCurrentTextBackgroundColor:"linkStyle",linkCurrentTextBackgroundRadius:"linkStyle",linkCurrentTextBackgroundPadding:"linkStyle",textContent:"textContent",textVerticalAlignment:"textVerticalAlignment",variantTransition:"transition",pathSegments:"vectorPath",pathClosed:"vectorPath",spikeCount:"vectorPath",spikeDepth:"vectorPath",polygonSides:"vectorPath",elementId:"scrollTarget",scrollMarginTop:"scrollTarget",scrollTargetEnabled:"scrollTarget",altAttribute:"accessibility",altAttributeLocalized:"accessibility",cursor:"cursor",customCursorSmartComponentId:"customCursor",customCursorFollow:"customCursor",customCursorOffsetX:"customCursor",customCursorOffsetY:"customCursor",customCursorVariant:"customCursor",customCursorType:"customCursor",customCursorTransitionEnabled:"customCursor",customCursorTransition:"customCursor",customCursorPlacement:"customCursor",customCursorAlignment:"customCursor",pointerEvents:"pointerEvents",userSelect:"userSelect",zIndex:"zIndex",draggable:"draggable",imageRendering:"imageRendering",viewportHeight:"canvasSettings",isBreakpoint:"canvasSettings",backdropFill:"overlay",backdropFillEnabled:"overlay",backdropDismissible:"overlay",blockDocumentScrolling:"overlay",backdropExitTransition:"overlayTransition",backdropEnterTransition:"overlayTransition",backdropTransitionLocked:"overlayTransition",hideScrollbars:"scrollbars",customizations:"customizations",customizationsDescription:"customizations",customizationsSectionId:"customizations",isApplyingCustomizations:"customizations",translateZ:"translateZ",scale:"scale",skewX:"skew",skewY:"skew",backfaceVisibility:"backfaceVisibility",perspective:"perspective",transformStylePreserve3d:"transformStylePreserve3d",transformOriginX:"transformOrigin",transformOriginY:"transformOrigin",transition:"transition",formInputFontSize:"formInputFont",formInputFontFamily:"formInputFont",formInputFontSelector:"formInputFont",formInputFontWeight:"formInputFont",formInputFontStyle:"formInputFont",formInputPlaceholderColor:"formPlaceholderColor",formInputFontColor:"formInputColor",formInputFontLetterSpacing:"formInputFont",formInputFontLetterSpacingUnit:"formInputFont",formInputFontLineHeight:"formInputFont",formInputFontLineHeightUnit:"formInputFont",formInputFontTextAlignment:"formInputFont",formInputOpenTypeFontFeatures:"formInputFont",formTextInputType:"formTextInputType",formTextAreaResizable:"formInputTextAreaResize",formTextInputMinNumber:"formTextInputTypeMin",formTextInputMaxNumber:"formTextInputTypeMax",formInputMaxLength:"formInputMaxLength",formInputStep:"formInputStep",formBooleanInputType:"formBooleanInputType",formBooleanInputValue:"formBooleanInputValue",formBooleanInputCheckedBorderColor:"formBooleanInputCheckedEffect",formBooleanInputCheckedBorderWidth:"formBooleanInputCheckedEffect",formBooleanInputCheckedBorderStyle:"formBooleanInputCheckedEffect",formBooleanInputCheckedBoxShadow:"formBooleanInputCheckedEffect",formBooleanInputCheckedFillColor:"formBooleanInputCheckedEffect",formBooleanInputCheckedTransition:"formBooleanInputCheckedEffect",formInputFocusedBackgroundColor:"formInputFocusedFill",formInputFocusedBorderColor:"formInputFocusedBorder",formInputFocusedBorderStyle:"formInputFocusedBorder",formInputFocusedBorderWidth:"formInputFocusedBorder",formInputFocusedBoxShadow:"formInputFocusedBoxShadow",formInputFocusedTransition:"formInputFocusedTransition",formInputInvalidTextColor:"formInputInvalidTextColor",formInputIconImage:"formInputIcon",formInputIconColor:"formInputIcon",viewTransitionNone:"viewTransitionNone"};function IM(j){let A=[],e;for(e in ss){let t=ss[e];j.includes(t)&&A.push(e)}return A}function Yf(j,A){let e=L.componentForIdentifier(A.codeComponentIdentifier);if(!e?.properties)return{};let t={};return Object.entries(e.properties).forEach(([r,o])=>{if(!o||pe(A)&&o.type==="slot")return;let n=VA(r),a=j[n];Aa(a)&&a.type&&Lu(o.type,a.type)&&(o.type==="enum"&&!Ru(o,a.value)||(t[n]=a))}),t}function U(j,A){return A?new Set(ij(A)?A:[A]).has(j):!0}function ls(j,A,e,t,r,o){let n=j.getScopeNodeFor(e);function a(s){return!aA(s)||n&&nt(n)&&n.hasVariable(s.id)?s:r?.[s.id]??s}let i={};if(ka(j,e)||Fe(A)&&(A.widthType===4&&(i.widthType=1),A.heightType===4&&(i.heightType=1)),U("visibility",o)&&Eo(A)&&Eo(e)&&(i.visible=a(A.visible)),U("border",o)&&ct(A)&&ct(e)&&(i.borderEnabled=A.borderEnabled,i.borderWidth=A.borderWidth,i.borderColor=A.borderColor,i.borderStyle=A.borderStyle,i.borderPerSide=A.borderPerSide,i.borderLeft=A.borderLeft,i.borderTop=A.borderTop,i.borderRight=A.borderRight,i.borderBottom=A.borderBottom),U("border",o)&&ct(A)&&Ee(e))if(qA(A.borderEnabled)){let s=A.resolveValue("borderEnabled");ar(s)?(i.strokeEnabled=!0,i.strokeWidth=s.borderWidth,i.strokeColor=s.borderColor):i.strokeEnabled=!1}else i.strokeEnabled=A.borderEnabled,i.strokeWidth=A.borderWidth,i.strokeColor=A.borderColor;if(U("stroke",o)&&Ee(A)&&Ee(e)&&(i.strokeEnabled=A.strokeEnabled,i.strokeColor=A.strokeColor,i.strokeWidth=A.strokeWidth,i.strokeAlignment=A.strokeAlignment,i.lineJoin=A.lineJoin,i.lineCap=A.lineCap,i.strokeMiterLimit=A.strokeMiterLimit,i.strokeDashArray=A.strokeDashArray,i.strokeDashOffset=A.strokeDashOffset),U("stroke",o)&&Ee(A)&&ct(e)&&(i.borderEnabled=A.strokeEnabled,i.borderWidth=A.resolveValue("strokeWidth"),i.borderColor=A.resolveValue("strokeColor")),U("formInputTextAreaResize",o)&&Fu(A)&&(i.formTextAreaResizable=A.formTextAreaResizable),U("formInputFocusedFill",o)&&it(A)&&it(e)&&(i.formInputFocusedBackgroundColor=A.formInputFocusedBackgroundColor),U("formInputFocusedBorder",o)&&it(A)&&it(e)&&(i.formInputFocusedBorderColor=A.formInputFocusedBorderColor,i.formInputFocusedBorderWidth=A.formInputFocusedBorderWidth,i.formInputFocusedBorderStyle=A.formInputFocusedBorderStyle),U("formInputFocusedBoxShadow",o)&&it(A)&&it(e)&&(i.formInputFocusedBoxShadow=A.formInputFocusedBoxShadow?[...A.formInputFocusedBoxShadow]:void 0),U("formInputFocusedTransition",o)&&it(A)&&it(e)&&(i.formInputFocusedTransition=A.formInputFocusedTransition),U("formInputColor",o)&&Sr(A)&&Sr(e)&&(i.formInputFontColor=A.formInputFontColor),U("formPlaceholderColor",o)&&Pl(A)&&Pl(e)&&(i.formInputPlaceholderColor=A.formInputPlaceholderColor),U("formInputPadding",o)&&jt(A)&&jt(e)&&(i.padding=A.padding,i.paddingPerSide=A.paddingPerSide,i.paddingTop=A.paddingTop,i.paddingRight=A.paddingRight,i.paddingBottom=A.paddingBottom,i.paddingLeft=A.paddingLeft),U("shadows",o)&&sr(A)&&sr(e)){let s=a(A.boxShadows);yu(e)?i.boxShadows=s:qA(s)||(i.boxShadows=s?.filter(l=>l.type!=="realistic"))}if(U("shadows",o)&&K6(A)&&K6(e)&&(i.shadows=A.shadows),U("rotation",o)&&Nt(A)&&Nt(e)&&(i.rotation=A.rotation,yj(e)&&yj(A)&&(i.rotate3d=A.rotate3d,i.rotateX=A.rotateX,i.rotateY=A.rotateY)),U("overflow",o)&&rt(A)&&rt(e)&&(i.overflow=a(A.overflow)),U("overscroll",o)&&O6(A)&&O6(e)&&(i.overscrollBehavior=a(A.overscrollBehavior)),U("cursor",o)&&sn(A)&&sn(e)&&(i.cursor=a(A.cursor)),U("customCursor",o)&&sn(A)&&sn(e)&&(i.customCursorType=A.customCursorType,i.customCursorSmartComponentId=A.customCursorSmartComponentId,i.customCursorVariant=A.customCursorVariant,i.customCursorFollow=A.customCursorFollow,i.customCursorOffsetX=A.customCursorOffsetX,i.customCursorOffsetY=A.customCursorOffsetY,i.customCursorTransitionEnabled=A.customCursorTransitionEnabled,i.customCursorTransition=A.customCursorTransition,i.customCursorPlacement=A.customCursorPlacement,i.customCursorAlignment=A.customCursorAlignment),Gn(A)&&Gn(e))for(let s of Xf){let l=ss[s];U(l,o)&&(i[s]=a(A[s]))}if(U("blending",o)&&N6(A)&&N6(e)&&(i.blendingMode=a(A.blendingMode)),U("transition",o)&&hl(A)&&hl(e)){let s=MA(A)?A.variantTransition:A.transition;MA(e)?i.variantTransition=s:i.transition=s}if(U("fill",o)&&Ge(A)&&Ge(e)){i.fillColor=a(A.fillColor),i.fillType=A.fillType,i.fillLinearGradient=A.fillLinearGradient,i.fillRadialGradient=A.fillRadialGradient,i.fillConicGradient=A.fillConicGradient,i.fillType==="conic-gradient"&&!Gp(e)&&(i.fillType=e.fillType??"color");let s=a(A.fillImage);qA(s)?qA(s)&&e.supportsDynamicValues()&&(i.fillImage=s):i.fillImage=s,i.fillImageResize=A.fillImageResize,i.fillImagePixelWidth=A.fillImagePixelWidth,i.fillImagePixelHeight=A.fillImagePixelHeight,i.fillImagePositionX=A.fillImagePositionX,i.fillImagePositionY=A.fillImagePositionY,i.fillImageTileSize=A.fillImageTileSize}if(U("fill",o)&&_t(A)&&_t(e)&&(i.fillEnabled=A.fillEnabled),(U("size",o)||U("fill",o))&&Fe(A)&&Fe(e)){let s=i.fillType??(Ge(e)?e.fillType:void 0),l=i.heightType??e.heightType;(i.widthType??e.widthType)===5&&s!=="image"&&(i.width=e.rect().width,i.widthType=0),l===5&&s!=="image"&&(i.height=e.rect().height,i.heightType=0)}if(U("opacity",o)&&Bl(A)&&Bl(e)&&(i.opacity=a(A.opacity)),U("radius",o)&&Ot(A)&&Ot(e)&&(i.radius=a(A.radius),sl(A)&&sl(e)&&(i.radiusIsRelative=A.radiusIsRelative),ir(A)&&ir(e)&&(i.radiusPerCorner=A.radiusPerCorner,i.radiusBottomLeft=A.radiusBottomLeft,i.radiusBottomRight=A.radiusBottomRight,i.radiusTopLeft=A.radiusTopLeft,i.radiusTopRight=A.radiusTopRight)),U("pointerEvents",o)&&w6(A)&&w6(e)&&!fj(n)&&(i.pointerEvents=a(A.pointerEvents)),U("draggable",o)&&$l(A)&&$l(e)&&(i.draggable=a(A.draggable)),U("userSelect",o)&&L6(A)&&L6(e)&&(i.userSelect=a(A.userSelect)),U("imageRendering",o)&&x6(A)&&x6(e)&&(i.imageRendering=a(A.imageRendering)),U("overflowX",o)&&rt(A)&&rt(e)&&(i.overflowX=a(A.overflowX)),U("overflowY",o)&&rt(A)&&rt(e)&&(i.overflowY=a(A.overflowY)),U("zIndex",o)&&U6(A)&&U6(e)&&(i.zIndex=a(A.zIndex)),U("scrollbars",o)&&Sl(A)&&Sl(e)&&(i.hideScrollbars=a(A.hideScrollbars)),U("textVerticalAlignment",o)&&Cl(A)&&Cl(e)&&(i.textVerticalAlignment=A.textVerticalAlignment),U("textWrapBalance",o)&&ll(A)&&ll(e)&&(i.textWrapBalance=A.textWrapBalance),U("styledText",o)&&xj(A)&&np(e)){i.font=A.getFonts(!1)[0],i.textColor=A.getTextColors(!1)[0];let s=A.getFontSizes(!1)[0];i.fontSize=en(s)?s[0]:s;let l=A.getLetterSpacings(!1)[0];i.letterSpacing=sA(l)?l:du(l),i.textTransform=A.getTextTransforms(!1)[0],i.textDecoration=A.getTextDecorations(!1)[0],i.lineHeight=A.getLineHeights(!1)[0],i.textAlignment=A.getTextAlignments(!1)[0],i.styledText=e.styledText.setFont(void 0,!1).setTextColor(void 0,!1).setFontSize(void 0,!1).setLetterSpacing(void 0,!1).setTextTransform(void 0,!1).setTextDecoration(void 0,!1).setLineHeight(void 0).setTextAlignment(void 0)}if(U("link",o)&&xj(A)&&xj(e)&&(i.linkFont=A.linkFont,i.linkTextColor=A.linkTextColor,i.linkFontSize=A.linkFontSize,i.linkTextTransform=A.linkTextTransform,i.linkTextDecoration=A.linkTextDecoration,i.linkHoverFont=A.linkHoverFont,i.linkHoverTextColor=A.linkHoverTextColor,i.linkHoverFontSize=A.linkHoverFontSize,i.linkHoverTextTransform=A.linkHoverTextTransform,i.linkHoverTextDecoration=A.linkHoverTextDecoration,i.linkCurrentFont=A.linkCurrentFont,i.linkCurrentTextColor=A.linkCurrentTextColor,i.linkCurrentFontSize=A.linkCurrentFontSize,i.linkCurrentTextTransform=A.linkCurrentTextTransform,i.linkCurrentTextDecoration=A.linkCurrentTextDecoration),U("mask",o)&&il(A)&&il(e)&&(i.masks=A.masks),QA(A)&&QA(e)){if(U("fontSize",o)&&(i.textFitScale=A.textFitScale,i.textFitViewBoxSize=A.textFitViewBoxSize),U("paragraphSpacing",o)&&(i.paragraphSpacing=A.paragraphSpacing),U("styledText",o)){let s=A.getTextStrokeWidths(!1)[0],l=A.getTextStrokeColors(!1)[0];sA(s)||(i.textStrokeWidth=s),l&&(i.textStrokeColor=l)}if(U("richText",o))for(let s of cm){let l=A[s];j.has(l)&&(i[s]=l)}}if(U("codeComponentProps",o)&&on(A)&&on(e)){let s=Yf(A,e);Object.assign(i,s)}if(U("codeOverride",o)&&eo(A)&&eo(e)&&(i.codeOverrideEnabled=A.codeOverrideEnabled,i.codeOverrideIdentifier=A.codeOverrideIdentifier),U("formInputFont",o)&&Sr(A)&&Sr(e)&&(i.formInputFontFamily=A.formInputFontFamily,i.formInputFontWeight=A.formInputFontWeight,i.formInputFontStyle=A.formInputFontStyle,i.formInputFontSize=A.formInputFontSize,i.formInputFontSelector=A.formInputFontSelector,i.formInputFontLetterSpacing=A.formInputFontLetterSpacing,i.formInputFontLetterSpacingUnit=A.formInputFontLetterSpacingUnit,i.formInputFontLineHeight=A.formInputFontLineHeight,i.formInputFontLineHeightUnit=A.formInputFontLineHeightUnit,i.formInputFontTextAlignment=A.formInputFontTextAlignment,i.formInputOpenTypeFontFeatures=A.formInputOpenTypeFontFeatures),U("layout",o)&&JA(A)&&pA(e)&&(kj(e)||(i.layout=A.layout),i.stackDirection=A.stackDirection,i.stackDistribution=A.stackDistribution,i.stackAlignment=A.stackAlignment,i.gap=A.gap,i.padding=A.padding,i.paddingPerSide=A.paddingPerSide,i.paddingTop=A.paddingTop,i.paddingRight=A.paddingRight,i.paddingBottom=A.paddingBottom,i.paddingLeft=A.paddingLeft),U("position",o)&&Object.assign(i,so(A,t)),U("perspective",o)&&yj(A)&&yj(e)&&(i.perspective=a(A.perspective)),U("overlay",o)&&Fj(A)&&Fj(e)&&t){let s=Pt(A);Object.assign(i,s)}if(U("effects",o)&&yn(A)&&yn(e)&&Object.assign(i,_k(e,A)),U("transformOrigin",o)&&yj(A)&&yj(e)&&Object.assign(i,{transformOriginX:A.transformOriginX,transformOriginY:A.transformOriginY}),U("backfaceVisibility",o)&&yj(A)&&yj(e)&&Object.assign(i,{backfaceVisibility:A.backfaceVisibility}),U("transformStylePreserve3d",o)&&yj(A)&&yj(e)&&Object.assign(i,{transformStylePreserve3d:A.transformStylePreserve3d}),U("translateZ",o)&&yj(A)&&yj(e)&&Object.assign(i,{translateZ:A.translateZ}),U("scale",o)&&yj(A)&&yj(e)&&Object.assign(i,{scale:A.scale}),U("skew",o)&&yj(A)&&yj(e)&&Object.assign(i,{skewX:A.skewX,skewY:A.skewY}),U("formBooleanInputType",o)&&Gr(A)&&Gr(e)&&Object.assign(i,{formBooleanInputType:A.formBooleanInputType}),U("formBooleanInputValue",o)&&Gr(A)&&Gr(e)&&Object.assign(i,{formBooleanInputValue:A.formBooleanInputValue}),U("formBooleanInputCheckedEffect",o)&&Gr(A)&&Gr(e)){let s={formBooleanInputCheckedBorderColor:A.formBooleanInputCheckedBorderColor,formBooleanInputCheckedBorderWidth:A.formBooleanInputCheckedBorderWidth,formBooleanInputCheckedBorderStyle:A.formBooleanInputCheckedBorderStyle,formBooleanInputCheckedFillColor:A.formBooleanInputCheckedFillColor,formBooleanInputCheckedBoxShadow:A.formBooleanInputCheckedBoxShadow,formBooleanInputCheckedTransition:A.formBooleanInputCheckedTransition};Object.assign(i,s)}return U("formInputIcon",o)&&Tl(A)&&Tl(e)&&Object.assign(i,{formInputIconImage:A.formInputIconImage,formInputIconColor:A.formInputIconColor}),U("viewTransitionNone",o)&&Rl(A)&&Rl(e)&&(i.viewTransitionNone=A.viewTransitionNone),i}function Zf(j,A,e,t,r){if(Ze(t))return;let o=ej(A)?2:0,n=dj(e.x,o),a=dj(e.y,o);if(Ct(r.x)?(r.x=n,r.y=a):(!se(r.x)&&r.x!==n&&(r.x=jr),!se(r.y)&&r.y!==a&&(r.y=jr)),!$A(A)||!t)return;let i=j.getParentSizeInfo(A);if(!i?.positioning)return;let s=i.positioning,l=dj(s.width-q.maxX(e),o),c=dj(s.height-q.maxY(e),o);Ct(r.right)?(r.right=l,r.bottom=c):(!se(r.right)&&r.right!==l&&(r.right=jr),!se(r.bottom)&&r.bottom!==c&&(r.bottom=jr))}var Oj={padding:0,gridRowCount:2,gridColumnCount:2,gridRowHeight:200,gridColumnWidth:200};Object.freeze(Oj);function FD(j){switch(j){case 20:return 0;case 21:return 1;case 23:return 4;case 24:return 3;case 22:return 2;case 19:return 5}}var CR=(j,A,e=!0)=>{let t=j.stores.persistedUserDefaults.layoutGap;return{layout:"stack",stackDirection:A,stackDistribution:"start",stackAlignment:"center",gap:t,stackWrapEnabled:!1,paddingPerSide:!1,padding:e?t:Oj.padding,paddingTop:Oj.padding,paddingBottom:Oj.padding,paddingLeft:Oj.padding,paddingRight:Oj.padding}},bR={gridItemFillCellWidth:!0,gridItemFillCellHeight:!0,gridItemHorizontalAlignment:"center",gridItemVerticalAlignment:"center",gridItemColumnSpan:1,gridItemRowSpan:1},vR=j=>({layout:"grid",gridColumnCount:Oj.gridColumnCount,gridAlignment:"center",gridColumnWidthType:"minmax",gridColumnWidth:Oj.gridColumnWidth,gridColumnMinWidth:50,gridRowHeightType:"auto",gridRowCount:Oj.gridRowCount,gridRowHeight:Oj.gridRowHeight,gap:j.stores.persistedUserDefaults.layoutGap,paddingPerSide:!1,padding:Oj.padding,paddingTop:Oj.padding,paddingBottom:Oj.padding,paddingLeft:Oj.padding,paddingRight:Oj.padding}),jE=new Set(["#BDF","#CEF","#9DF"]);function TR(j){let A=Array.from(jE).filter(e=>e!==j);return A.length=2,A}var eE=(j,A={},e={})=>{let{index:t=0,lastColor:r,parentColor:o,source:n}=e,a=TR(o),i=a.length,s=a[0];if(t>0)s=a[Math.ceil(t/i)%i];else if(_(r))if(jE.has(r)){let c=(a.indexOf(r)+1)%i;s=a[c]}else s=r;n&&mA("layout_frame",{source:n});let l={fillEnabled:!0,fillColor:s};return JA(j)&&!j.stackWrapEnabled&&(j.widthType!==2&&(l.width=1,l.widthType=3),j.heightType!==2&&(l.height=1,l.heightType=3)),Object.assign(l,A),new ye(l)},GD=(j,A)=>{switch(j){case 0:case 1:{A.layout="stack",A.stackDirection=j===0?"vertical":"horizontal";break}case 2:case 3:case 4:A.overflow=Oe();break}},PR=(j,A,e,t,r,o)=>{let n=new ye({...CR(j,e,r),fillEnabled:!1,...A});$(JA(n));let a=o?{widthType:0,width:o.width,heightType:0,height:o.height}:void 0;for(let i=0;i<t;i++){let s=eE(n,a,{index:i});n.addChild(s)}return n},AE=(j,A,e,t)=>{let r=new ye({...vR(j),fillEnabled:!1,...A});$(Ye(r));for(let o=0;o<e;o++){let n={};switch(t){case 3:o===0&&(n.gridItemRowSpan=2);break;case 4:o+1===e&&(n.gridItemColumnSpan=2);break;default:break}let a=eE(r,{...bR,...n},{index:o});r.addChild(a)}return r},SD=(j,A,e,t=!1)=>{if(A===2)return AE(j,e,t?0:4);if(A===3||A===4)return AE(j,e,t?0:3,A);let r=t?0:2;return PR(j,e,e.stackDirection??"horizontal",r,!1)},tE=mp.width,MR=(j,A,e,t,r,o)=>{let n={x:nr,y:nr,right:nr,bottom:nr};Zf(j,A,e,t,n),Di(n.x)&&Di(n.right)&&r-n.x-n.right<200&&(o.left=0,o.right=0)},_R=(j,A)=>{j.stackDirection==="horizontal"&&!j.stackWrapEnabled&&(A.stackDirection="vertical"),j.stackWrapEnabled&&j.stackDistribution==="start"&&(A.stackDistribution="center")},DR=j=>{let A={};return j.children?.forEach(e=>{if(!oo(e))return;let t=e.originalid??e.id;A[t]={maxWidth:"100%"}}),A},NR=(j,A)=>{Di(j.gridColumnCount)&&(A.gridColumnCount=1)},xR=(j,A,e,t,r,o)=>{MR(j,A,e,t,r,o),!(r>tE)&&(JA(A)&&_R(A,o),Ye(A)&&NR(A,o))},uc=(j,A,e,t,r,o)=>{let n=A.originalid??A.id,a={};if(xR(j,A,e,t,r,a),o[n]=a,Re(A)&&A.stackWrapEnabled&&r<=tE){let s=DR(A);for(let l in s)o[l]={...o[l],...s[l]}}};function yD(j,A,e){let t=j.tree.getNode(A);if(!t||!Ie(t))return;let r=j.tree.getNode(e);if(!r||!pj(r)||!IA(r))return;let o=j.tree.getScopeNodeFor(r);if(!o||!w(o))return;let n=j.tree.getRect(t),a=o.getBreakpointValues();for(let i in a){if(i===e)continue;let s=j.tree.getNode(i);if(!s||!aj(s)||!oj(s))continue;let l={};uc(j.tree,t,n,r,s.width,l),Tm(j.tree,s,l)}}function rE(j,A){let e={width:{2:!0,0:!0,3:!0,1:!0,4:!0,5:!0},height:{2:!0,0:!0,3:!0,1:!0,4:!0,5:!0}},t=j.getParent(A.id);if(!t||!$A(A)||Im(A)&&A.autoSize===!0||Fj(A)?(e.width[1]=!1,e.height[1]=!1,e.width[3]=!1,e.height[3]=!1,e.width[4]=!1,e.height[4]=!1):Ye(t)?Le(A,t)?(e.width[3]=!0,e.height[3]=t.gridRowHeightType!=="fit"):(e.width[3]=!1,e.height[3]=!1):JA(t)?(Le(A,t)||(e.width[3]=!1),Le(A,t)||(e.height[3]=!1)):(e.width[3]=!1,e.height[3]=!1),Vp(A)&&_j(A.textFitViewBoxSize)&&(e.height[2]=!0,e.width[2]=!1,e.height[0]=!1,e.height[1]=!1,e.height[3]=!1,e.height[4]=!1),no(A)||(e.width[5]=!1,e.height[5]=!1),W(A)){let o=A.getSupportedLayout(L);Be(o.width)||(e.width[2]=!1),Be(o.height)||(e.height[2]=!1),g6(o.width)||(e.width[0]=!1,e.width[1]=!1,e.width[3]=!1,e.width[4]=!1),g6(o.height)||(e.height[0]=!1,e.height[1]=!1,e.height[3]=!1,e.height[4]=!1)}else if(pA(A)){if(IA(A)){e.width[2]=!1,W6(A)&&(e.height[0]=!1,e.height[1]=!1,e.height[3]=!1,e.height[4]=!1);let o=j.get(A.parentid);ZA(o)&&(e.height[2]=!1)}A.children.length===0&&(e.width[2]=!1,e.height[2]=!1)}else pA(A)||Xo(A)||QA(A)||(e.width[2]=!1,wp(A)||(e.height[2]=!1));return De(A)&&sA(A.layout)&&jj(A)&&!kj(A)&&(e.width[2]=!1,e.height[2]=!1),ka(j,A)||(e.width[4]=!1,e.height[4]=!1),(IA(t)&&Fe(t)&&Jo(t.heightType)||W6(t))&&(e.height[3]=!1,e.height[1]=!1),Ze(t)&&(e.width[3]=!1,e.width[1]=!1,e.height[3]=!1,e.height[1]=!1),e}var oE=j=>{let A=[];return j.forEach((e,t)=>{for(let r=t+1;r<j.length;r++){let o=j[r];A.push([e,o])}}),A};function nE(j,A,e){let t=A.map(c=>j.convertFrameToCanvas(c));if(t.length===2){let[c,u]=t,p=LR(c,u),f=qR(c,u);if(p&&!f)return"vertical";if(f&&!p)return"horizontal"}let r=t.map(c=>q.center(c));if(r.length<=1){if(t.length===1){let[c]=t,u=e.width/Math.max(1,c.width),p=e.height/Math.max(1,c.height);return u<p?"vertical":"horizontal"}return e.width<e.height?"vertical":"horizontal"}let o=oE(r),n=[],a=[];o.forEach(([c,u])=>{n.push(Math.abs(c.x-u.x)),a.push(Math.abs(c.y-u.y))});let i=n.reduce((c,u)=>c+u,0),s=a.reduce((c,u)=>c+u,0);return i>s?"horizontal":"vertical"}function iE(j,A,e){return[...A].sort((t,r)=>{let o=j.tree.getRect(t),n=j.tree.getRect(r);return e==="horizontal"?o.x-n.x:o.y-n.y})}function OR(j){if(qA(j))return!0;switch(j){case"start":case"center":case"end":return!0;default:return!1}}function pc(j,A,e){let t=nE(j.tree,A,e),r=j.stores.persistedUserDefaults.layoutGap;return{layout:"stack",stackDirection:t,gap:r,stackDistribution:U7,stackAlignment:qi,stackWrapEnabled:!1,padding:0,paddingPerSide:!1,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0}}function wR(j,A){A.forEach((e,t)=>{j.tree.moveNodeIndex(e,t)})}function aE(j,A,e,t,r){e==="horizontal"&&A.heightType===2||e==="vertical"&&A.widthType===2||sE(j,t,e,r,{})}function sE(j,A,e,t,r){if(e==="horizontal"||qA(r.padding))return;let o={...t};if(r.paddingPerSide)r.paddingLeft&&(o.width-=r.paddingLeft),r.paddingRight&&(o.width-=r.paddingRight),r.paddingTop&&(o.height-=r.paddingTop),r.paddingBottom&&(o.height-=r.paddingBottom);else if(r.padding){let a=r.padding*2;o.width-=a,o.height-=a}o.width=Math.max(0,o.width),o.height=Math.max(0,o.height);let n=o.width;n>0&&A.forEach(a=>{if(!$A(a)||RA(a)||Ba(a)||$a(a)||a.widthType===2||a.widthType===4)return;if(j.tree.getRect(a).width/n>.96){let l=j.tree.getParent(a.id),c=j.tree.getParentSizeInfo(a);c.sizing&&a.heightType===4&&(c.sizing={...o,height:c.sizing.height});let u=j.tree.getRect(a),p=a.updateForRect({rect:u,parentSizeInfo:c,constraintsLocked:!0,shouldGuessPinToBottom:pt(j.tree,a),shouldGuessPinToRight:ee(j.tree,a,l)});p.width=1,a.width!==1&&(p.widthType=3),a.set(p)}})}function lE(j,A,e,t,r){if(!j.tree.getNode(A))return;iE(j,t,r).forEach(a=>{if(Su(a)&&wt(a)||nn(a))return;let i=j.tree.getParent(a.id),s=j.tree.getRect(a),l=q.offset(s,lA.reverse(e));j.moveNode(a.id,A);let c={...e},u=j.tree.getParentSizeInfo(a);rp(a)&&u.sizing&&(c.width=u.sizing.width),op(a)&&u.sizing&&(c.height=u.sizing.height),j.tree.current(a)?.set({...a.updateForRect({rect:l,parentSizeInfo:{sizing:c,positioning:e,viewport:u?.viewport??null,layout:Ne(i)},constraintsLocked:!1,shouldGuessPinToBottom:!0,shouldGuessPinToRight:ee(j.tree,a,i)}),top:null,left:null,bottom:null,right:null,position:void 0}),Mt(j.tree,a).forEach(({replicaRoot:f,relatedNode:E})=>{kA.resetOverridesByProperty(j.tree,f,E,["position"])})})}function LR(j,A){let e=q.maxX(j),t=q.maxX(A);return e>A.x&&t>j.x}function qR(j,A){let e=q.maxY(j),t=q.maxY(A);return e>A.y&&t>j.y}function kc(j,A,e){if(!vA(e))return;let t=A==="width"?"widthType":"heightType";e.children.forEach(r=>{if($A(r)&&(r[t]===3||r[t]===1)){let o=j.getRect(r),n={[t]:0,[A]:o[A]};ro(r)&&(n.aspectRatio=null),j.current(r)?.set(n)}})}function eN(j,A){if(!vA(A)||!$A(A))return;let e=new Set;A.children.forEach(t=>{if(!$A(t)||!oo(t))return;let r=j.getRect(t),o={};A.widthType===2&&(t.widthType===3||t.widthType===1)&&(o.minWidth=r.width,e.add(t)),A.heightType===2&&(t.heightType===3||t.heightType===1)&&(o.minHeight=r.height),Object.keys(o).length>0&&(e.add(t),j.current(t)?.set(o))}),e.size>0&&VR()}function VR(){TA({type:"add",variant:"info",key:"setting-stack-direction-causes-children-change",text:"Layers in this stack received min-sizing to prevent a collapse",icon:"thumbnail",duration:5e3,showCloseButton:"always"})}function cs(j,A,e={}){if(!De(A)||!vA(A)||Re(A))return;let t={layout:"stack",...e},r=j.tree.getRect(A),o=j.tree.getScopeNodeFor(A),n=Wk(A)||MA(A)&&w(o)||A.__unsafeIsGroundNode(j.tree)&&Ae(o),a=n?"vertical":nE(j.tree,A.children,r),i=iE(j,A.children,a);hA(A)||wR(j,i);let s=Vi(A),l=A.gap??j.stores.persistedUserDefaults.layoutGap,c=n?"start":"center";t.stackDirection=s?A.stackDirection??a:a,t.stackDistribution=s?A.stackDistribution??c:c,t.gap=s||OR(c)?l:0,t.stackAlignment=s?A.stackAlignment??qi:qi,t.stackWrapEnabled=s?A.stackWrapEnabled??!1:!1;let u=s&&jt(A)?{padding:A.padding,paddingPerSide:A.paddingPerSide,paddingLeft:A.paddingLeft,paddingRight:A.paddingRight,paddingTop:A.paddingTop,paddingBottom:A.paddingBottom}:{...pu};if(a==="horizontal"&&e.heightType===2||a==="vertical"&&e.widthType===2||sE(j,A.children,a,r,u),u.paddingPerSide){let{paddingTop:f,paddingRight:E,paddingBottom:F,paddingLeft:h}=u;f===E&&f===F&&f===h&&(u.paddingPerSide=!1,u.padding=f)}A.set({...t,...u})}var uE=900;function gN(j){return j.intrinsicWidth>=uE}function ds(j,A,e){if(xj(A))return!1;let t=e??j.getParent(A.id);return!!(t&&IA(t))}function hN(j){return j<=.5}function KR(j,A,e){if(!pA(A)||!pj(A)||!IA(A)||he(A)||!ds(j,e,A))return!1;let t=oj(e)&&Fe(e)&&e.widthType===1&&e.width===1;if(oj(e)&&e.width<uE&&!t)return!1;let r=A.children.filter(l=>l.id!==e.id);if(r.length===0)return!0;let n=j.getRect(A).width||1,a=r.map(l=>j.getRect(l));return a.some(l=>l.width/n<.5)?!1:a.every((l,c)=>a.every((u,p)=>c===p?!0:!q.intersects(l,u)))}function pE(j,A,e,t){if(!De(A)||!KR(j.tree,A,e))return;let r={};t.height>500&&(r.heightType=2),cs(j,A,r),A.set({gap:0})}function cE(j,A){for(let e of Object.values(j.variables))if(e?.type==="collectionreference"&&e.dataIdentifier===A)return e}function dE(j,A){return Object.values(j.variables).find(e=>e?.type==="multicollectionreference"&&e.dataIdentifier===A)}function JR(j,A){let e=mk(A);if(M6(e))return{targetDataIdentifier:e.dataIdentifier,targetProviderId:e.id};let t=j.stores.scopeStore.active;if(Wj(t))return{targetDataIdentifier:t.dataIdentifier,targetProviderId:t.id}}function kE(j,A,e){if(!M6(e))return;let t=JR(j,A);if(!t)return;let{targetDataIdentifier:r,targetProviderId:o}=t,n=Fn(j.tree,e.dataIdentifier),a=Fn(j.tree,r);if(!n||!a)return;let i=cE(n,r),s=dE(n,r),l=cE(a,e.dataIdentifier),c=dE(a,e.dataIdentifier),u;c?u={id:gj(),itemKey:"id",transforms:[{id:gj(),type:"valueTransform",name:"isIncludedIn",value:Zj(c.id,o)}]}:l?u={id:gj(),itemKey:"id",transforms:[{id:gj(),type:"valueTransform",name:"equals",value:Zj(l.id,o)}]}:s?u={id:gj(),itemKey:s.id,transforms:[{id:gj(),type:"valueTransform",name:"contains",value:Zj("id",o)}]}:i&&(u={id:gj(),itemKey:i.id,transforms:[{id:gj(),type:"valueTransform",name:"equals",value:Zj("id",o)}]}),u&&e.set({collectionFilters:{filters:[u]}})}function mE(j,A,e,t){if(!pA(A)||!pj(A)||!IA(A)||!Re(A)||A.stackDirection!=="vertical"||!ds(j.tree,e,A)||A.heightType===2||!rE(j.tree,A).height[2])return;let o=A.children.filter(s=>s.id!==e.id);if(o.length===0)return;let n=j.tree.getRect(A),a=o.map(s=>j.tree.getRect(s));q.merge(...a).height+t.height<=n.height||(A.set({height:n.height,heightType:2}),o.forEach((s,l)=>{let c=a[l];$(c,"Child rect must be defined"),oj(s)&&Fe(s)&&s.heightType===3&&s.set({height:c.height,heightType:0})}))}var fE=Pj(Kh());var ps=Pj(Hr()),Ec=Pj(Mi());function us(j){let A=j.name||Ce(j);return/^\s*$/u.test(A)?j instanceof ym?"Text":"Layer":A}function EE({node:j,renderTarget:A=xi.export,addNames:e=!1,isDarkMode:t,combinedVariableValueMap:r}){if(ht(j))return j.svg;let o=[],n=!0,a=null;RA(j)?(a=j,j.children.map(E=>{ej(E)&&o.push(E)})):(n=!1,o.push(j));let i=j.tree();$(i,"cannot render nodes to svg without a tree"),o=o.map(E=>Nm(E,i,t)),xm(i,r,t);let s={needsXlinks:!1},l=o.map(E=>(fc(E,s),mc(E,n,e,r))),c=null,u=a?.fillEnabled&&a.exportIncludesBackground&&!Sp(a);if(u&&a){let E=new bm(a.raw({__class:"RectangleShapeNode"}));fc(E,s),c=mc(E,!1,!1,r)}let p=(0,ps.jsx)(I7,{isStatic:!0,children:(0,ps.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:s.needsXlinks?"http://www.w3.org/1999/xlink":void 0,width:F6(j.width,3),height:F6(j.height,3),fill:"none",overflow:RA(j)?void 0:"visible",children:[u&&c,l]})});return h7({target:A},()=>fE.renderToStaticMarkup(p))}function $E(j){return j.replace(/[\f\n\r\t\v\xa0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/gu," ").replace(/(?:\/|^)(?:\.+\/)+/gmu,"/")}function mc(j,A,e,t){if(Rt(j)){let o=j.getProps(t);return(0,Ec.createElement)(lu,{...o,key:j.id,isRootVectorNode:!1,includeTransform:A},j.children.map(n=>mc(n,!0,e,t)))}let r=j.getProps(t);return(0,Ec.createElement)(su,{...r,key:j.id,isRootVectorNode:!1,includeTransform:A})}function fc(j,A){if(A.needsXlinks||((Rt(j)||Zo(j))&&j.children&&j.children.map(u=>fc(u,A)),Rt(j)))return;let{strokeEnabled:e,strokeAlignment:t,strokeWidth:r,fillEnabled:o,fillType:n,fillImage:a,boxShadows:i}=j,s=t==="inside"&&e&&e&&!!r,l=o&&n==="image"&&a!==null,c=i&&!qA(i)&&i.length>0&&i.some(u=>u!==void 0);(s||c||l)&&(A.needsXlinks=!0)}var BE=t7({canvas:()=>{let j=HR();return wl(j),Ol(j)},onPageCanvas:()=>{let j=QR();return wl(j),Ol(j)}});function HR(){let j=Qj.isDebugBuild?"canvas-sandbox.debug.html":"canvas-sandbox.html",A=pl(`./${j}`),e=JSON.stringify(Me());return A+`#services=${encodeURIComponent(e)}`}function QR(){let j=Qj.isDebugBuild?"canvas-sandbox-on-page.debug.html":"canvas-sandbox-on-page.html",A=pl(`./${j}`),e=JSON.stringify(Me());return A+`#services=${encodeURIComponent(e)}`}var Ej=class Ej{constructor(A,e,t,r){this.log=A;this.windowService=e;this.windowRef=t;this.contentWindow=r}static async serviceIfAvailable(){Ej.deprecatedServicePromise=Ej.deprecatedServicePromise??Ul.on(Jr).discover({timeout:1e3}),Ej.servicePromise=Ej.servicePromise??zl.on(Jr).discover({timeout:1e3});try{return await Promise.any([Ej.servicePromise,Ej.deprecatedServicePromise])}catch{return}}static async isAvailable(){return!!await Ej.serviceIfAvailable()}static async new(A){Ej.currentWindow&&(Ej.currentWindow.contentWindow.close(),Ej.currentWindow=void 0);let e=await Ej.serviceIfAvailable();$(e,"CustomWindow is not available");let t=gA("electron-window"),r=await e.willOpenWindow(A);t.debug("opening window...");let o=window.open(A.url,"_blank")??void 0;return $(o,"Couldn't open a new DOM window"),t.debug("opened window",o),Ej.currentWindow=new Ej(t,e,r,o),Ej.currentWindow}async openSaveDialog({count:A,pathname:e}){return this.windowService.openSaveDialog({count:A,pathname:e})}async collectMetrics(){return this.windowService.collectMetrics()}async writeToClipboard(A){return this.windowService.writeToClipboard({...A,ref:this.windowRef})}async writeToDisk(A){return this.log.debug("capture....",this.windowRef),this.windowService.writeToDisk({...A,ref:this.windowRef})}async getImageData(A){return"getImageData"in this.windowService?(await this.windowService.getImageData({...A,ref:this.windowRef})).imageData:Promise.reject(new Error("getImageData is not available"))}};I(Ej,"deprecatedServicePromise"),I(Ej,"servicePromise"),I(Ej,"currentWindow");var qn=Ej;var ks=class{constructor(){I(this,"controller");I(this,"renderer");I(this,"modules");I(this,"modulesRuntime");I(this,"assets");I(this,"controlsVisibility");I(this,"flags");OA.isOn("newRpc")&&(this.controller=new wm(te),this.renderer=this.controller.getRemote(te.channels.renderer),this.modules=this.controller.getRemote(te.channels.modules),this.modulesRuntime=this.controller.getRemote(te.channels.modulesRuntime),this.controlsVisibility=this.controller.getRemote(te.channels.controlsVisibility),this.assets=this.controller.getRemote(te.channels.assets),this.flags=this.controller.getRemote(te.channels.flags))}setLocal({componentsStore:A,loadedExternalModulesStore:e},t){this.controller&&(this.controller.setLocal(te.channels.rendererListener,t),this.controller.setLocal(te.channels.componentsStore,A),this.controller.setLocal(te.channels.loadedExternalModulesStore,e))}};var Vn=class{constructor(A){this.callbacks=A;I(this,"experimentListeners",new Map);I(this,"employeesOnlySettingsListeners",new Map);I(this,"projectFeaturesListeners",new Map)}startUpdatesStream(){Object.keys(P6).forEach(A=>{let e=t=>{this.callbacks.updateExperiments({[A]:t})};OA.addListener(A,e),this.experimentListeners.set(A,e)}),Object.keys(T6).forEach(A=>{let e=t=>{this.callbacks.updateEmployeesOnlySettings({[A]:t})};qe.addListener(A,e),this.employeesOnlySettingsListeners.set(A,e)})}getInitialExperiments(){let A={};return Object.keys(P6).forEach(e=>{A[e]=OA.get(e)}),A}getInitialEmployeesOnlySettings(){let A={};return Object.keys(T6).forEach(e=>{A[e]=qe.get(e)}),A}initProjectFeatures(){vn.updated.then(()=>{let A={};Object.keys(Ll).forEach(e=>{A[e]=vn.get(e)}),this.callbacks.updateProjectFeatures(A),this.projectFeaturesListeners.size===0&&Object.keys(Ll).forEach(e=>{let t=r=>{this.callbacks.updateProjectFeatures({[e]:r})};vn.addListener(e,t),this.projectFeaturesListeners.set(e,t)})}).catch(yA)}stopUpdatesStream(){for(let[A,e]of this.experimentListeners)OA.removeListener(A,e);for(let[A,e]of this.employeesOnlySettingsListeners)qe.removeListener(A,e);for(let[A,e]of this.projectFeaturesListeners)vn.removeListener(A,e);this.experimentListeners.clear(),this.employeesOnlySettingsListeners.clear(),this.projectFeaturesListeners.clear()}},ms=class{constructor(A){this.remoteFlags=A;let e=new Vn(this.remoteFlags);e.startUpdatesStream(),this.remoteFlags.updateExperiments(e.getInitialExperiments()),this.remoteFlags.updateEmployeesOnlySettings(e.getInitialEmployeesOnlySettings())}};var Ro=class{constructor(){I(this,"experimentsUpdatesEmitter",new ze);I(this,"employeesOnlySettingsUpdatesEmitter",new ze);I(this,"projectFeaturesUpdatesEmitter",new ze);I(this,"flagsUpdater",new Vn(this));this.flagsUpdater.startUpdatesStream(),this.experimentsUpdatesEmitter.onNewStream=A=>{if(A?.replay==="latest")return{latest:this.flagsUpdater.getInitialExperiments()}},this.employeesOnlySettingsUpdatesEmitter.onNewStream=A=>{if(A?.replay==="latest")return{latest:this.flagsUpdater.getInitialEmployeesOnlySettings()}},this.projectFeaturesUpdatesEmitter.onNewStream=A=>{this.flagsUpdater.initProjectFeatures()}}updateExperiments(A){this.experimentsUpdatesEmitter.emit(A)}updateEmployeesOnlySettings(A){this.employeesOnlySettingsUpdatesEmitter.emit(A)}updateProjectFeatures(A){this.projectFeaturesUpdatesEmitter.emit(A)}stopUpdatesStream(){this.flagsUpdater.stopUpdatesStream()}experimentsUpdatesStream(A){return this.experimentsUpdatesEmitter.newStream(A)}employeesOnlySettingsUpdatesStream(A){return this.employeesOnlySettingsUpdatesEmitter.newStream(A)}projectFeaturesUpdatesStream(A){return this.projectFeaturesUpdatesEmitter.newStream(A)}};var fs=gA("setup-rpc-connection"),$c=3e4;function hE(j,A){if(!j)return Promise.resolve();let e=performance.now(),t=vt(),r=j.connect(A);return r.then(()=>{fs.debug("Connected to controller",j.channelInterface.name),mA("connected_to_sandbox",{correlationId:t,durationMs:Math.round(performance.now()-e),userAgent:navigator.userAgent,visibility:document.visibilityState})}).catch(()=>{fs.debug("Failed to connect to controller",j.channelInterface.name),mA("connection_to_sandbox_error",{correlationId:t,userAgent:navigator.userAgent,visibility:document.visibilityState,error:"failed to connect"})}),new Bc($c,()=>{if(j.isConnected)fs.debug("Controller connected within timeout");else{mA("connection_to_sandbox_error",{correlationId:t,userAgent:navigator.userAgent,visibility:document.visibilityState,error:`not connected within ${$c}ms`});let o=new Error(`RPC connection timeout after ${$c}ms`);fs.reportCriticalError(o)}}),r}var gE=10,Bc=class{constructor(A,e){this.millis=A;this.callback=e;I(this,"round",0);I(this,"timer",0);I(this,"arm",()=>{this.round>=gE?this.callback():(this.round+=1,this.timer=window.setTimeout(this.arm,this.millis/gE))});this.arm()}cancel(){this.timer&&(clearTimeout(this.timer),this.timer=0)}};async function RE(j,A,e,t,r){if(!e)throw Error("ServiceSandbox: no trusted sandbox origin");if(j){await hE(j,{target:A,url:e}),await j.getRemote(te.channels.renderer).initialize(pn,t);return}let o=!1,n=new c7(A,e),a=await $6.on(n).discover({timeout:3e4}),i=new Ro;j||Pi.on(n).register(i);let s=pn;await a.initialize({renderTarget:t,upgradeToMessagePortChannel:o,treeVersion:s}),r.debug("ServiceSandbox: ready to initialize contentWindow. Establishing channel\u2026");let l=new MessageChannel,c=$6.service.fingerprint;return A.postMessage(c,e,[l.port2]),o&&(i.stopUpdatesStream(),r.debug("ServiceSandbox: unregistering initializer"),await $t.shared().unregister(n)),r.debug("ServiceSandbox: service channel ready"),o?new l7(l.port1):n}var IE=new WeakMap,gc=new Set;function FE(j){return IE.get(j())?Promise.resolve():new Promise((A,e)=>{let t=setTimeout(()=>{e(new Error("waitForReadyToInitialize timed out"))},1e4);gc.add({source:j,resolveReady(){clearTimeout(t),A()}})})}window.addEventListener("message",j=>{if(j.data!==Lm)return;let A=j.source;if(A){IE.set(A,!0);for(let e of gc)e.source()===A&&(gc.delete(e),e.resolveReady())}},!1);var Kn=class extends ks{constructor(e,t,r){super();I(this,"log",gA("window-sandbox"));I(this,"channelPromise");I(this,"windowPromise",tr());this.channelPromise=(async()=>{let o=await qn.new({...r,url:e.url});return this.log.debug("WindowSandbox: created custom window"),this.windowPromise.resolve(o),this.controller||(await FE(()=>o.contentWindow),this.log.debug("WindowSandbox: loaded")),RE(this.controller,o.contentWindow,e.origin,t,this.log)})()}static async isAvailable(){return qn.isAvailable()}waitForServiceChannel(){return this.channelPromise}async openSaveDialog({count:e,pathname:t}){return(await this.windowPromise).openSaveDialog({count:e,pathname:t})}async collectMetrics(){return(await this.windowPromise).collectMetrics()}async writeToClipboard(e){return(await this.windowPromise).writeToClipboard(e)}async writeToDisk(e){return(await this.windowPromise).writeToDisk(e)}async getImageData(e){return(await this.windowPromise).getImageData(e)}};var Jn=class{constructor(){I(this,"metricsMap",new Map)}static trackError(A){Yl({exportCount:0,success:!1,scope:"selection",errorReason:A})}createErrorReason({sizeKb:A,hasSavedToDisk:e}){if(!e)return"Export success, but no file was written";if(A===0)return"Export success, but the file is 0kb"}createId({nodeId:A,pixelRatio:e}){return A+"-"+e}mergeElectronMetrics(A){for(let e of A){let t=this.createId({nodeId:e.nodeId,pixelRatio:e.pixelRatio}),r=this.metricsMap.get(t);r&&this.metricsMap.set(t,{...r,sizeKb:e.kb,success:e.hasSavedToDisk})}}add(A,e){let t=this.createId({nodeId:A.nodeId,pixelRatio:A?.pixelRatio??1}),r=this.metricsMap.get(t)??{};this.metricsMap.set(t,{...r,...e})}track(){for(let[A,e]of this.metricsMap){let t=this.createErrorReason({sizeKb:e.sizeKb??0,hasSavedToDisk:e.hasSavedToDisk??!1});Yl({durationMs:e.durationMs,format:e.format,exportCount:e.exportCount,success:e.success,scope:e.scope,sizeKb:e.sizeKb,errorReason:e.errorReason??t})}this.metricsMap.clear()}};function GE(j){for(let A of j.walk())if(no(A))return!1;return ej(j)||RA(j)||ht(j)}function SE(j){return EE({...j})}var UR=3,wj=gA("PartialTreeSender"),yE=Vr();function CE(){return new Promise((j,A)=>{if(typeof MessageChannel<"u"){let e=new MessageChannel;e.port1.onmessage=()=>j(),e.port1.onmessageerror=()=>A(),e.port2.postMessage(null)}else setTimeout(j,0)})}var $s=class{constructor(A,e,t){this.timeline=A;I(this,"name");I(this,"currentScopeId","");I(this,"timelineCursor");I(this,"scopeBufferMap",new Map);I(this,"chunkQueue",[]);I(this,"chunkIndex",0);I(this,"chunkingConfig");I(this,"drainingPromise");this.name=e+"-"+String(Math.round(Math.random()*1e3)),this.chunkingConfig={maxNodesPerChunk:t?.maxNodesPerChunk??1e3}}shouldUseChunking(A,e){if(this.timelineCursor)return!1;let t=A.chunkingHints;if(!t||t.size===0)return!1;let r=Es();e&&r.add(e);for(let o of r)if(t.has(o))return wj.debug(this.name,`chunking required - large page hint: ${o}`),!0;return!1}serializeTreeChunks(A,e){let t=[],r=crypto.randomUUID(),o=new Map,n=new Map,a=0,i=Es();e&&i.add(e);let s=()=>{o.size>0&&(t.push({name:this.name,timestamp:Date.now(),treeChunks:{chunkId:r,chunkIndex:t.length,totalChunks:-1,nodes:o,childrenMap:n,rootId:t.length===0?A.root.id:void 0}}),o=new Map,n=new Map)},l=h=>{let S=Ra.valueFromNode(h);o.set(h.id,S);let v=h.children?h.children.map(P=>P.id):[];if(n.set(h.id,v),a++,S.children&&(S.children=yE),o.size>=this.chunkingConfig.maxNodesPerChunk&&s(),h.children)for(let P of h.children)l(P)},c=A.root,u,p={};for(u in c)V6[u]||(p[u]=c[u]);let f=A.getNodes(i),E={...p,__class:"RootNode",id:A.root.id,children:yE};o.set(A.root.id,E),n.set(A.root.id,f.map(h=>h.id)),a++,o.size>=this.chunkingConfig.maxNodesPerChunk&&s();for(let h of f)l(h);s();let F=t.length;for(let h of t)h.treeChunks.totalChunks=F;return wj.debug(this.name,`directly chunked tree into ${t.length} chunks with ${a} total nodes`),t}getNextChunk(){if(this.chunkQueue.length===0)return;let A=this.chunkQueue[this.chunkIndex];return this.chunkIndex++,this.chunkIndex>=this.chunkQueue.length&&(this.chunkQueue=[],this.chunkIndex=0),A}hasMoreChunks(){return $(this.chunkIndex>=0,"Chunk index should not be negative"),$(this.chunkIndex<=this.chunkQueue.length,"Chunk index should not exceed queue length"),this.chunkIndex<this.chunkQueue.length}async*drainChunks(A){if(!this.hasMoreChunks())return;let e=this.drainingPromise;this.drainingPromise=new vi,e&&(wj.debug(this.name,"drainChunks already in progress, waiting for it to finish"),await e),wj.debug(this.name,"drainChunks started");let t=0,r=performance.now();try{for(;this.hasMoreChunks();){if(A?.aborted){wj.debug(this.name,"drainChunks aborted, clearing chunk queue"),this.chunkQueue=[],this.chunkIndex=0;return}let o=this.getNextChunk();o&&(t++,wj.debug(this.name,`sending chunk ${o.treeChunks.chunkIndex+1} of ${o.treeChunks.totalChunks}`),yield o),await CE()}}finally{await CE(),this.timelineCursor=this.timeline.getChangeTrackingCursor();let o=performance.now()-r,n=o>1e3?`${(o/1e3).toFixed(2)}s`:`${Math.round(o)}ms`;wj.debug(this.name,`completed sending ${t} chunks in ${n}`),wj.debug(this.name,"drainChunks completed"),this.drainingPromise?.resolve(),this.drainingPromise=void 0}}resetScopeBuffer(A){this.scopeBufferMap.clear(),this.currentScopeId=A??"",A&&(this.timelineCursor=void 0,this.scopeBufferMap.set(A,performance.now()))}updateScopeBuffer(A){if(this.currentScopeId===A)return[void 0,void 0];if(A===un)return[void 0,void 0];if(this.currentScopeId=A,this.scopeBufferMap.has(this.currentScopeId))return this.scopeBufferMap.set(this.currentScopeId,performance.now()),[void 0,void 0];let e;if(this.scopeBufferMap.size>=UR){let t=Es(),r=1/0,o;for(let[n,a]of this.scopeBufferMap)t.has(n)||r>a&&(r=a,o=n);o&&(this.scopeBufferMap.delete(o),e=o)}return this.scopeBufferMap.set(this.currentScopeId,performance.now()),[e,A]}reset(A){let e=this.timeline.tree;if(this.resetScopeBuffer(A),this.shouldUseChunking(e,A))return this.chunkQueue=this.serializeTreeChunks(e,A),this.chunkIndex=0,wj.debug(this.name,"initiated direct chunked transfer for tree"),null;let t=vE(e,A);return this.chunkQueue=[],this.chunkIndex=0,t}update(A){if(!A)return{};if(this.hasMoreChunks())return{};let e=this.timeline.tree,t=this.timeline.fetchForwardChanges(this.timelineCursor);if(!t){if(this.timeline.invalidatedByLoadCompletedDocument(this.timelineCursor))return wj.debug(this.name,"cursor invalidated, sending empty update for load completed document"),this.timelineCursor=this.timeline.getChangeTrackingCursor(),{};if(this.resetScopeBuffer(A),this.shouldUseChunking(e,A)){this.chunkQueue=this.serializeTreeChunks(e,A),this.chunkIndex=0;let i=this.getNextChunk();if(i)return wj.debug(this.name,`starting direct chunked resend with ${this.chunkQueue.length} chunks`),i}let a=vE(e,A);return wj.debug(this.name,"cursor invalidated, sending tree with scope:",A),this.timelineCursor=this.timeline.getChangeTrackingCursor(),{name:this.name,tree:a,timestamp:Date.now()}}let[r,o]=this.updateScopeBuffer(A);r&&(wj.debug(this.name,"deleting scope by diff:",r),bE(r,t)),t.length===0&&(t=void 0);let n;if(o&&(wj.debug(this.name,"adding scope by subtree:",o),n=this.getScopeSubTree(e,o)),t){let a=this.getAffectedScopeIDsAfterCrossScopeMove(e,t);for(let i of a){if(i!==this.currentScopeId){this.scopeBufferMap.has(i)&&(wj.debug(this.name,"deleting scope due to cross-scope move:",i),bE(i,t),this.scopeBufferMap.delete(i));continue}n||(wj.debug(this.name,"resending tree with scope due to cross-scope move:",i),n=this.getScopeSubTree(e,i))}}return{changes:t,scopes:n?[n]:void 0,timestamp:Date.now()}}getScopeSubTree(A,e){let t=A.get(e);return mr(t)&&$(t.isLoaded(),"Scope must be loaded"),WR(t)}getAffectedScopeIDsAfterCrossScopeMove(A,e){let t=new Set;for(let r of e){if(!r.previousScope||!r.to.parentid)continue;let o=A.get(r.id),n=A.getScopeNodeFor(o);n&&t.add(n.id)}return t}};function bE(j,A){A.push({id:j,removed:"CanvasNode",to:{}})}function WR(j){if(j)return Ra.valueFromNode(j)}function Es(){return new Set([Lt,Da,Rm,fe,Lk,un])}function vE(j,A){let e=Es();A&&e.add(A);let t=j.getNodes(e).map(a=>Ra.valueFromNode(a)),r=j.root,o,n={};for(o in r)V6[o]||(n[o]=r[o]);return{version:pn,root:{...n,__class:"RootNode",id:j.root.id,children:t}}}function TE(j,A){let e=j.getRouteSegmentRootNode(),t=new Map(A.map(o=>[o.id,o])),r=[];for(let o of e.walk()){if(!St(o)||!o.webPageId)continue;let n=t.get(o.webPageId);n&&r.push(n)}return r}function PE(j,A,e=!1,t=!1){let r=A?.[j];if(r)return r;if(j===ip&&e)return t?"Key":"Key & Gamepad";if(t&&j==="onMouseEnter")return"Enter";let n=(j.startsWith("on")&&j.length>2?j.substring(2):j).replace("Tap","Click");return Xe(n)}function zR(){let j=null,A=null;return e=>{let t=L.componentForIdentifier(e.codeComponentIdentifier);if(t===j)return A;if(!t||!t.properties)return null;let r={},o=Object.keys(t.properties);for(let n=0,a=o.length;n<a;n++){let i=o[n],s=t.properties[i];s?.type==="eventhandler"&&s.title&&(r[i]=s.title)}return j=t,A=r,r}}var oO=zR();function XR(j){if(j.type!=="controlReference"&&j.type!=="nodePropertyControlReference")return;let{expectedType:A}=j;$(A==="enum"||A==="segmentedenum"||A==="file")}function uO({galleryImageId:j,isSmartComponent:A}){return A?Array(4).fill(null).map(()=>({id:gj(),type:"object",value:{[j]:{type:"image",value:void 0}}})):[]}function ME(j,A){return $(j.type!=="responsiveimage",`Image variables are compiled to be responsive images. To
        prevent confusion we don't allow creation of type responsive images.
        Because that would mean that two different types represent the same thing.`),XR(j),j.type!=="trackingid"&&j.type!=="vectorsetitem"&&mA("variable_create",{scopeType:A,variableType:j.type}),j.type==="image"&&(_(j.initialValue)?I6(j.initialValue)||(j.initialValue=void 0):ce(j.initialValue)&&_(j.initialValue.value)&&(I6(j.initialValue.value)||(j.initialValue=void 0))),j.type==="array"&&A==="canvas_component"&&($(j.minCount===void 0,"minCount should not be lifted to component"),$(j.maxCount===void 0,"maxCount should not be lifted to component")),{id:gj(),...j}}function YR(j,A){let e=new Set(j.variables.map(t=>t.name));return Cj(Xe(A),e)}function ZR(j){switch(j.type){case"controlReference":case"nodePropertyControlReference":switch(j.expectedType){case"enum":return"Type";case"file":return"File";default:throw Error(`getFallbackNameForCreateVariableOptions(), unsupported file reference type: ${j.expectedType}`)}default:return _u(j.type)}}function AI(j,A){if(j==="richtext")return A.length;let e=nr;return A.forEach((t,r)=>{if(!se(e)){if(t.type!=="richtext"){Y(e)&&(e=jr);return}uu(e)||(e=r)}}),Y(e)?e:A.length}function jI(j){return uj(j)?"collection":ZA(j)?"layout_template":(eA(j)||$(!0,"Should not be able to create variables on invalid scope",j.__class),"canvas_component")}function hc(j,A){let{scopeId:e,isAssigned:t=!0,useUniqueName:r=!0,...o}=A,n=j.get(e);if(!n||!nt(n))return null;let a=A.name.trim(),i=a||ZR(A),s=r?YR(n,i):i,l=ME({...o,name:s},jI(n));if(l.type==="eventhandler"&&!eA(n))return null;let c=AI(l.type,n.variables),u=_e.insert(n.variables,c,l);return n.set({variables:u}),t&&Rf({variableType:l.type,variableId:l.id}),Zj(l.id,n.id)}function yO(j){let{engine:A,showModal:e=!0,...t}=j,r=hc(A.tree,t);if(!r)return null;let o=A.tree.get(j.scopeId);return!o||!nt(o)?null:(go(A)&&e&&(A.stores.variablesStore.selectedVariableId=r.id,A.stores.modalStore.set({type:"Variables",source:"properties"})),Zj(r.id,o.id))}var eI=gA("createAndAssignActionVariableToNode");function _E(j,A,e,t,r){if(!(we(A)||W(A)))return null;let o=j.getScopeNodeFor(A);if(!o||!eA(o))return null;let n=j.getGroundNodeFor(A);if(!n||!pj(n))return null;let a=L.componentForIdentifier("framer/useTriggerEvent");if(!a)return null;let i=hc(j,{scopeId:o.id,type:"eventhandler",name:t??PE(e,null),initialValue:void 0});if(!i)return null;Pa(j,A,e,a,{id:{type:"string",value:i.id}});let s=o.getTopLevelReplicaVariants();for(let l of s){let{overrides:c}=l.replicaInfo;c[A.id]&&Fk(j,l,A.id,e,a,{id:{type:"string",value:i.id}})}return r&&r.updateComponent(o.id).catch(l=>eI.error(l)),i.id}function tI(j){let A=Ta(j);if(Object.keys(A).length!==0)for(let t in A){let r=A[t];if(r&&r.length===0)return t}}function rI(j,A,e){switch(A){case"framer/useShowOverlay":return j.create(nm,e);case"framer/useShowRelativeOverlay":return j.create(ye,e,{width:200,height:150,radius:10,boxShadows:[gu({x:0,y:10,blur:20,color:"rgba(0,0,0,0.05)",spread:0})],floatingPositionEnabled:!0,floatingPlacement:ua,floatingAlignment:pa,floatingOffsetX:up,floatingOffsetY:pp,floatingCollisionDetection:!0,floatingCollisionPadding:dp});default:iA(A)}}function oI(j,A,e,t){e&&$(A==="framer/useShowOverlay"&&Yo(e)||A==="framer/useShowRelativeOverlay"&&(pA(e)||W(e)),"Invalid overlay type: ",e.__class,"for overlay action: ",A);let r=e??rI(j,A,t.id);return Fj(r)&&r.set({zIndex:xu,styleAppearEffectEnabled:!0,styleAppearEffectTrigger:"onMount",overflow:Oe(),position:"absolute",...Ck.fadeIn()}),r}function nI(j,A,e,t,r){$(kn(e),"Parent is not a local smart component instance, events can't be created");let o=Cp(j,e);j.loadScopes([o],([n])=>{if(!n)return;let a=n.getPrimaryVariant();$(a,"SmartComponentNode should have a primary variant");let i=_E(j,a,t,t==="onMouseEnter"?"Hover":void 0,A);$(i,"Should be able to create event key for local smart component node"),r(i)})}function DE(j,A,e,t,r){let o=L.componentForIdentifier(A);$(o,"Cannot find overlay action definition"),Pa(j,r,t,o,{overlay:{type:"string",value:e.id}},!0)}function iI(j){switch(j){case"framer/useShowOverlay":return"fixed";case"framer/useShowRelativeOverlay":return"relative";default:iA(j)}}function Bs({treeStore:j,codeGenerationStore:A},e,t,r){let o=j.tree.get(t);if(!o)return;let n=hA(o)?j.tree.get(o.originalid):o;if(!n||!we(n)&&!W(n))return;let a=e==="framer/useShowRelativeOverlay"?"onMouseEnter":"onTap",i=W(n)?tI(n):a,s=kn(n);if(!i&&!s)return;let l=oI(j.tree,e,r,n);return i?DE(j.tree,e,l,i??a,n):nI(j.tree,A,n,a,c=>DE(j.tree,e,l,c,n)),mA("overlay_create",{source:r?"duplicate":"events_panel",overlayType:iI(e)}),l}var NE=gA("ScopeStore");function Hn(j){return fj(j,!0)||w(j,!0)||Ae(j,!0)}function xE(j){if(fj(j))return"CanvasPage";if(w(j))return"WebPage";if(eA(j))return"SmartComponent";if(zo(j))return"ContentManagement";if(ZA(j))return"LayoutTemplate";if(de(j))return"VectorSet";if(ru(j))return"Analytics";if(ou(j))return"LocalizationGlossary";if(Ae(j))return"DesignPage";throw Error(`Failed to return scope type, invalid scope: ${j.__class}`)}var br,vr,Tr,Pr,Io,ne,kt,qt,Fo,Go,So,OE=class extends me{constructor(e,t,r,o,n,a,i,s,l,c,u,p){super();this.scheduler=e;this.treeStore=t;this.canvasStore=r;this.selection=o;this.chromeStore=n;this.contentManagementStore=a;this.modalStore=i;this.overlayStore=s;this.codeGenerationStore=l;this.insertSidebarStore=c;this.modulesStore=u;this.aiGenerationStore=p;NA(this,br,0);I(this,"isCheckingActivePage",!0);NA(this,vr,"");NA(this,Tr,"");NA(this,Pr,"");NA(this,Io,"");NA(this,ne,[]);NA(this,kt,!1);NA(this,qt,!1);NA(this,Fo,new Map);NA(this,Go,new Map);I(this,"loadingActiveId");I(this,"_activeId");I(this,"scopeSwitchStart",0);I(this,"scopeSwitchPending",!1);I(this,"scopeIdToSelectedCollectionItem",new Map);I(this,"rootScopeType","CanvasPage");NA(this,So,[]);I(this,"canGoBack",()=>rA(this,kt));I(this,"goBack",()=>{let e=Array.from(this.isolatedCanvasNodes());e.pop();let t=e.pop();t&&this.select(t.id,{keepHistory:!1})});let f=this.getFirstPageNodeAccordingToUI();this._activeId=f.id,dn(f),fj(f)?FA(this,vr,f.id):w(f)?FA(this,Tr,f.id):Ae(f)&&FA(this,Pr,f.id);let E=this.getScopeNodes();FA(this,br,E.indexOf(f)),$(f.loaded,"Scope must be fully loaded"),c.onScopeChange({scope:f.loaded,hasCanvasPageNodes:this.hasCanvasPageNodes(),hasWebPageNodes:this.hasWebPageNodes()}),this.modulesStore.setActiveScope(this._activeId)}get activeId(){return this._activeId}get active(){let e=this.getScopeNode(this._activeId);return $(e.isLoaded(),"Scope must be fully loaded"),e}get rootNode(){return this.treeStore.tree.root}get checkingActivePage(){return this.isCheckingActivePage}documentDidLoad(){this.isCheckingActivePage=!1}get scopeType(){return xE(this.active)}getScopeNode(e){let t=this.treeStore.tree.get(e);return $(t instanceof Y6,"Node, ",e,"is not a ScopeNode"),t}getScopeNodes(){return this.rootNode.children.filter(mr)}getCanvasPageNodes(){return this.rootNode.children.filter(fj)}getDesignPageNodes(){return this.rootNode.children.filter(Ae)}getKitPageNodes(){let e=[];for(let t of this.rootNode.children)w(t)&&t.kitPage&&e.push(t);return e}getSmartComponentNodes(){return this.rootNode.children.filter(eA)}getLayoutTemplateNodes(){return this.rootNode.children.filter(ZA)}getWebPageNodes(){return this.rootNode.children.filter(w)}getWebPageNodesWithoutCollection(){return this.rootNode.children.filter(e=>w(e,!0)&&!e.dataIdentifier)}getWebPageNodesWithCollection(e=!1){let t=this.rootNode.children.filter(r=>!!(w(r)&&r.dataIdentifier));return e?TE(this.treeStore.tree,t):t}hasPages(){let e=!1,t=!1,r=!1,o=!1,n=!1;for(let a of this.rootNode.children)if(fj(a)&&(r=!0),Ae(a)&&(o=!0),w(a)&&(a.kitPage?n=!0:a.dataIdentifier?t=!0:e=!0),e&&t&&r&&o&&n)break;return{hasSitesPages:e,hasCMSPages:t,hasCanvasPages:r,hasDesignPages:o,hasKitPages:n}}hasCanvasPageNodes(){return this.rootNode.children.some(fj)}hasWebPageNodes(){return this.rootNode.children.some(w)}getRootScopeNodes(){return this.rootNode.children.filter(Hn)}getFirstPageNodeAccordingToUI(e=this.treeStore.tree){let{children:t,homePageNodeId:r}=e.root;return Vm(t,r)}getFirstWebPageNode(){try{let e=this.getFirstPageNodeAccordingToUI();if(w(e))return e}catch{}}changeActive(e,t,r){if(this._activeId){let i=e.get(this._activeId),s=w(i)&&i.abTestingParentId?i.abTestingParentId:this._activeId;rA(this,Fo).set(s,{zoom:this.canvasStore.zoom,offset:this.canvasStore.offset}),rA(this,Go).set(this._activeId,this.selection.ids),eA(i)&&mA("component_canvas_exit",{componentId:this._activeId})}if(FA(this,Io,this._activeId),FA(this,br,r),this._activeId=t.id,dn(t),this.codeGenerationStore.changeScope(),this.modulesStore.changeScope(t),Ae(t))this.rootScopeType="DesignPage",FA(this,Pr,t.id),FA(this,ne,[]),FA(this,kt,!1),FA(this,qt,!1);else if(fj(t))this.rootScopeType="CanvasPage",FA(this,vr,t.id),FA(this,ne,[]),FA(this,kt,!1),FA(this,qt,!1);else if(w(t))this.rootScopeType="WebPage",FA(this,Tr,t.id),FA(this,ne,[]),FA(this,kt,!1),FA(this,qt,Wj(t));else if(eA(t)||ZA(t)||de(t)){let i=rA(this,ne).indexOf(t.id);i===-1?rA(this,ne).push(t.id):rA(this,ne).splice(i+1),FA(this,kt,rA(this,ne).length>0),FA(this,qt,!1),$f({componentId:t.id}),eA(t)&&this.chromeStore.mainView===0&&this.modalStore.displayComponentIsolationModal({source:"automatic"})}let o=rA(this,Fo).get(w(t)&&t.abTestingParentId?t.abTestingParentId:t.id);o?this.canvasStore.updateCanvas(o.offset,o.zoom):this.canvasStore.zoomAfterScopeSwitch(e,t);let n=rA(this,Go).get(t.id);n?this.selection.set(n):this.selection.clear(),this.overlayStore.hideAll(),this.insertSidebarStore.onScopeChange({scope:t,hasWebPageNodes:this.hasWebPageNodes(),hasCanvasPageNodes:this.hasCanvasPageNodes()}),this.treeStore.setHighlight(null);let a=xE(t);this.chromeStore.onChangeScopeType(a),this.contentManagementStore.onChangeScopeType(a),this.aiGenerationStore.setCurrentSessionId(a==="DesignPage"?t.id:void 0)}select(e,{keepHistory:t,activateContentPanel:r,collectionItemId:o}){this.loadingActiveId=e,this.scopeSwitchStart=performance.now();let n=()=>{if(this.scopeSwitchPending=!1,this.loadingActiveId!==e||this._activeId===e)return;let s=this.getScopeNodes().findIndex(p=>p.id===e);$(s!==-1,"Tree must contain scope node");let c=this.treeStore.tree.latestTree().getNode(e);$(mr(c),"Tree must contain scope node",e);let u;if(c.isLoaded())u=c.loaded;else if(!this.treeStore.tree.getService("loader"))NE.reportError(new ReferenceError("Loader service is not available in the tree but scope is not loaded"),{message:"Scope must be fully loaded"},{shallowScopes:"true"}),u=c;else throw new TypeError("Scope must be fully loaded");t||FA(this,ne,[]),_(o)&&w(c)&&this.setSelectedCollectionItemForWebPage(c.id,o),r&&(this.chromeStore.contentPanelTab=r),this.changeActive(this.treeStore.tree,u,s)},a=this.treeStore.tree.getService("loader");if(a&&!a.hasLoadedScope(e)){this.scopeSwitchPending=!0,a.prioritizeLoadingScope(e,()=>this.scheduler.processWhenReady(n));return}n()}selectByNode(e){let t=this.treeStore.tree.get(e);if(t===null)return;let r=this.treeStore.tree.getScopeNodeFor(t);r!==null&&this.select(r.id,{keepHistory:!1})}selectPreviousActiveScope(){let e=this.treeStore.tree.get(rA(this,Io));this.select(e?.id??this.getFirstPageNodeAccordingToUI().id,{keepHistory:!1})}findNextActiveScope(e=this.treeStore.tree){let t=e.root,r=t.children.filter(mr);$(t.children.some(Hn),"validateActiveScope: Tree must contain at least one Canvas Page or Web Page");let o=r.findIndex(n=>n.id===this._activeId);return o===-1&&(o=this.findNextAvailablePageIndex(r,rA(this,br))),[r[o],o]}validateActiveScope(e=this.treeStore.tree,t=!1){let[r,o]=this.findNextActiveScope(e);$(r,"ScopeNode must be defined"),t||$(r.isLoaded(),"Scope must be fully parsed"),FA(this,br,o);let n=r;return r.id!==this._activeId&&(this.scopeSwitchStart=performance.now(),this.scopeSwitchPending=!1,this.changeActive(e,n,o)),n}findNextAvailablePageIndex(e,t){let r=[],o=[];for(let s=0;s<e.length;s++){let l=e[s];w(l)?o.push(s):fj(l)&&r.push(s)}let n=this.rootScopeType==="WebPage",a=n?o:r,i=n?r:o;return aI(a.length>0?a:i,t)}renameScope(e,t){this.getScopeNode(e).set({name:t})}getActiveScopeNodeForReset(e=this.treeStore.tree,t=null){if(t){let o=e.getScopeNodeFor(e.get(t));if(Km(o)&&o?.isValid())return o}let r=this.getFirstPageNodeAccordingToUI(e);if(w(r)&&r.isValid()&&r.loaded||fj(r)&&r.loaded)return r.loaded;NE.warn("getActiveScopeNodeForReset: falling back to scanning for a useful scope to make active");for(let o of e.root.children)if(fj(o)&&o.isValid()&&o.loaded||w(o)&&o.isValid()&&o.loaded)return o.loaded;for(let o of e.root.children)if(eA(o)&&o.isValid()&&o.loaded)return o.loaded;throw Error("Document does not have any scopes that can be set to active.")}resetActiveScope(e=this.treeStore.tree,t=void 0){let r=this.getActiveScopeNodeForReset(e,t);if(r.id===this._activeId)return;this._activeId="",FA(this,vr,""),FA(this,Pr,""),FA(this,Tr,""),FA(this,Io,""),rA(this,Fo).clear(),rA(this,Go).clear(),$(r.isLoaded(),"Scope must be fully parsed");let o=e.root.children.indexOf(r);this.scopeSwitchStart=performance.now(),this.scopeSwitchPending=!1,this.changeActive(e,r,o)}movePage(e,t){let r=this.getScopeNode(e),o=this.getAllPageNodesOfScope(r),n=o[t];$(n,`Trying to move a page node to an invalid index: ${t}, total: ${o.length} page nodes.`);let a=this.rootNode.children.findIndex(i=>i.id===n.id);$(r.parentid,"Scope node has no parentid"),$(a!==-1,"Cant find scope in root node"),this.treeStore.tree.moveNode(r,r.parentid,a)}getAllPageNodesOfScope(e){return Ae(e)?this.getDesignPageNodes():fj(e)?this.getCanvasPageNodes():w(e)&&e.kitPage?this.getKitPageNodes():($(!e,"Scope is not movable"),Vr())}getParentId(e,t){let r=this.rootNode.id;if(e instanceof Y6||Ur(e))return r;let o=this.active,n=o.id;return zo(o)&&$(oa(e),"ContentManagementNode only accepts content nodes"),t===r?n:t??n}insertNode(e,t,r,o){t=this.getParentId(e,t),je(e)&&Bs({codeGenerationStore:this.codeGenerationStore,treeStore:this.treeStore},Fj(e)?"framer/useShowRelativeOverlay":"framer/useShowOverlay",t,e),this.treeStore.tree.insertNode(e,t,r,o)}insertNodes(e){for(let t of e)this.insertNode(t,t.parentid)}moveNode(e,t,r,o){t=this.getParentId(e,t),this.treeStore.tree.moveNode(e,t,r,o)}removeNode(e){this.treeStore.tree.removeNode(e),e.id===this._activeId&&this.validateActiveScope(this.treeStore.tree,!0)}setSelectedCollectionItemForWebPage(e,t){if(this.scopeIdToSelectedCollectionItem.get(e)===t)return;let o=new Map(this.scopeIdToSelectedCollectionItem);o.set(e,t),this.scopeIdToSelectedCollectionItem=o}getSelectedCollectionItemForScope(e){if(w(e))return this.scopeIdToSelectedCollectionItem.get(e.id)}getMostRecentPage(){switch(this.rootScopeType){case"CanvasPage":{let e=this.treeStore.tree.get(rA(this,vr));if(fj(e))return e;break}case"DesignPage":{let e=this.treeStore.tree.get(rA(this,Pr));if(Ae(e))return e;break}case"WebPage":{let e=this.treeStore.tree.get(rA(this,Tr));if(e&&mr(e)&&w(e))return e;break}}return this.getFirstPageNodeAccordingToUI()}getComponentHistory(){if(rA(this,ne).length===0)return[];let e=this.active;if(!(eA(e)||ZA(e)||de(e)))return[];let t=[],r;for(let o of rA(this,ne)){let n=this.treeStore.tree.getNode(o);(eA(n)||ZA(n)||de(n))&&n.isLoaded()&&(t.push(n),r=n)}return r===e?t:[e]}get onIsolatedCanvas(){return rA(this,kt)}get onCollectionPage(){return rA(this,qt)}isolatedCanvasNodes(){let e=this.active,t;return Hn(e)?t=[e]:t=[this.getMostRecentPage(),...this.getComponentHistory()],or(rA(this,So),t)?rA(this,So):(FA(this,So,t),t)}getTopMostWebPageNode(){for(let e of this.isolatedCanvasNodes())if(w(e))return e}};br=new WeakMap,vr=new WeakMap,Tr=new WeakMap,Pr=new WeakMap,Io=new WeakMap,ne=new WeakMap,kt=new WeakMap,qt=new WeakMap,Fo=new WeakMap,Go=new WeakMap,So=new WeakMap;function aI(j,A){for(let e of j)if(!(e<A))return e;return Math.max(...j)}var P8=Jr,wE=Qj.isAutomation?Jr:s7;var gs=class{constructor(A,e){I(this,"sandbox");I(this,"log");I(this,"engine");I(this,"wantsEngineUpdates");I(this,"renderState");I(this,"partialTreeSender");I(this,"timelineCursor");I(this,"chunkAbortController");I(this,"chunkSessionId");I(this,"drainingPromise");I(this,"onSandboxServicesReady");I(this,"onSandboxStateChange",A=>{typeof A!="boolean"&&this.log.reportError(A)});I(this,"onSandboxRender");I(this,"fail",A=>{this.chunkAbortController?.abort(),this.readyForRenderingPromise.reject(A),this.onSandboxStateChange?.(A)});I(this,"renderServiceIfDiscovered");I(this,"readyForRenderingPromise",tr());I(this,"flagsService",new Ro);I(this,"lastSandboxTreeUpdate",0);I(this,"onRenderedUpdate",A=>{this.lastSandboxTreeUpdate&&(this.lastSandboxTreeUpdate<A.update?(this.fail(new Error(`dropped tree update: ${this.lastSandboxTreeUpdate} < ${A.update}`)),this.lastSandboxTreeUpdate=0):this.lastSandboxTreeUpdate===A.update&&(this.lastSandboxTreeUpdate=0)),this.onSandboxRender&&(this.onSandboxRender(A),this.updateGroundNodeOverflowSizes());let{scopeId:e,scopeSwitchStartTime:t,renderEndTime:r,updateEndTime:o}=A;if(t&&o&&r){let n=Math.round(o-t),a=Math.round(r-t),{scopeStore:i}=this.engine.stores,{scopeSwitchStart:s,scopeSwitchPending:l,activeId:c}=i,u=a,p=!1;c===e&&(u=performance.now()-s,p=l);let f=this.engine.tree.get(e);f&&Hn(f)&&ff({pageId:e,renderDurationMs:a,updateDurationMs:n,totalDurationMs:u,neededLoading:p})}});I(this,"onChannelReady",async A=>{if(A){let r=await d7.on(A).discover({timeout:3e4});this.log.debug("Discovered render service"),this.renderServiceIfDiscovered=r,r.renderedUpdateStream({oneway:!0}).read(this.onRenderedUpdate).catch(this.fail),Pi.on(A).register(this.flagsService)}let{modulesStore:e}=this.engine.stores;this.sandbox.modules?e.getModulesUpdatesService().moduleUpdatesStream({replay:"latest"}).read(r=>this.sandbox.modules?.updateModules(r.patches,r.dependentModules,r.prioritizedModules,r.initialized,r.revision)).catch(this.fail):($(A,"neither old or new rpc defined for modules"),u7.on(A).register(e.getModulesUpdatesService()));let t=new ze;t.emit({}),A&&E6.on(A).register({assetUpdatesStream:t.newStream}),g7(E6.on(wE).discover(),async r=>{this.sandbox.assets?r.assets&&this.sandbox.assets.oneway.updateAssets(r.assets):t.emit(r)}),this.onSandboxServicesReady&&(this.renderServiceIfDiscovered?await this.onSandboxServicesReady(A,this.renderServiceIfDiscovered):this.sandbox.renderer&&await this.onSandboxServicesReady(A,this.sandbox.renderer)),this.wantsEngineUpdates&&(this.engine.addSandbox(this),this.engine.scheduler.changes.observe("PendingBundle",()=>this.update(!0)),this.engine.loadWasCalled&&this.update(!0)),this.log.debug("Initialized render sandbox"),this.onSandboxStateChange?.(!0),this.renderServiceIfDiscovered?this.readyForRenderingPromise.resolve(this.renderServiceIfDiscovered):this.sandbox.renderer&&this.readyForRenderingPromise.resolve(this.sandbox.renderer)});I(this,"previousTransform");I(this,"previousActiveLocaleId");I(this,"previousIsReadyToRender");I(this,"previousPerformanceMode");I(this,"previousLoadedAllUserData");I(this,"previousRenderScope");I(this,"previousRenderNodes");I(this,"previousSelection");I(this,"previousNodeInTextEditor");I(this,"previousNodeInEffectPreview");I(this,"previousActiveEffect");I(this,"previousActiveEffectIds");I(this,"previousNodesInMoveToolRootFontSize");I(this,"previousActiveOverlays");I(this,"previousPlaceholder");I(this,"previousRootFontSize");I(this,"previousIsDarkMode");I(this,"previousScopeIdToSelectedCollectionItem");I(this,"previousShouldSetMinHeight");I(this,"previousActiveLinkStyle");I(this,"update",(A=!0)=>{if(this.drainingPromise)return!1;let e=this.renderState(),t=e.transform,r=!Yj(t,this.previousTransform);if(this.previousTransform=t,!A)return this.sendSandboxUpdate(void 0,r?t:void 0);let o=!1,n={},a=this.engine,{treeStore:i,loadingStore:s,chromeStore:l,persistedUserDefaults:c}=a.stores,u=i.timeline,p="renderScope"in e?e.renderScope:void 0;p!==this.previousRenderScope&&(this.previousRenderScope=p,o=!0,n.renderScope=p),this.previousRenderScope||(this.previousRenderScope=u.tree.root.children[0]?.id??"");let f=!qe.isOn("disablePartialTreeInSandbox");if(!this.partialTreeSender&&f?(this.partialTreeSender=new $s(u,"sandbox"),this.timelineCursor=void 0):this.partialTreeSender&&!f&&(this.partialTreeSender=void 0),this.partialTreeSender){u.legacyMode=!1;let T=this.partialTreeSender.update(this.previousRenderScope);n.partialTreeUpdate=T,T.tree?(o=!0,r=!0,n.loadedSomeUserData=s.isDocumentLoaded):T.changes||T.scopes?o=!0:T.treeChunks&&(o=!0,this.partialTreeSender.hasMoreChunks()?this.drainChunksAsync():(n.loadedSomeUserData=s.isDocumentLoaded,r=!0))}else{let T=u.fetchForwardChanges(this.timelineCursor);u.legacyMode=!0,T?(this.log.trace("change tracking cursor changes:",T.length),T.length>0&&(n.changes=T,o=!0)):(this.timelineCursor=u.getChangeTrackingCursor(),this.log.debug("change tracking cursor invalidated, sending full tree:",u.tree.size()),u.tree.beginAllowPartialScopeAccess(),n.tree=u.tree.toJS(),u.tree.endAllowPartialScopeAccess(),o=!0,r=!0,n.loadedSomeUserData=s.isDocumentLoaded)}let E=OA.isOn("debugEditWhileNeverLoadingRest")?s.hasMinimalEditableData:s.hasFullDocumentData;!this.previousLoadedAllUserData&&E&&(this.previousLoadedAllUserData=!0,o=!0,n.loadedAllUserData=!0);let F=l.canvasLocaleId;F!==this.previousActiveLocaleId&&(this.previousActiveLocaleId=F,o=!0,n.activeLocaleId=F);let h=s.assetMapLoaded;h!==this.previousIsReadyToRender&&(this.previousIsReadyToRender=h,o=!0,n.isReadyToRender=h);let S=c.performanceMode;S!==this.previousPerformanceMode&&(this.previousPerformanceMode=S,o=!0,n.performanceMode=S);let v="renderNodes"in e?e.renderNodes:void 0;Yj(v,this.previousRenderNodes)||(this.previousRenderNodes=v,o=!0,n.renderNodes=v);let P="isDarkMode"in e?e.isDarkMode:void 0;P!==this.previousIsDarkMode&&(this.previousIsDarkMode=P,o=!0,n.isDarkMode=P);{let T=e.editor,N=T?.selection;N!==this.previousSelection&&(this.previousSelection=N,o=!0,n.selection=N);let Q=T?.nodeInTextEditor;Q!==this.previousNodeInTextEditor&&(this.previousNodeInTextEditor=Q,o=!0,n.nodeInTextEditor=Q);let H=T?.nodesInEffectPreview;Yj(H,this.previousNodeInEffectPreview)||(this.previousNodeInEffectPreview=H,o=!0,n.nodesInEffectPreview=H);let Z=T?.nodesInMoveToolRootFontSize;Yj(Z,this.previousNodesInMoveToolRootFontSize)||(this.previousNodesInMoveToolRootFontSize=Z,o=!0,n.nodesInMoveToolBaseFontSize=Z);let J=T?.activeEffect;J!==this.previousActiveEffect&&(this.previousActiveEffect=J,o=!0,n.activeEffect=J);let AA=T?.activeEffectIds;Yj(AA,this.previousActiveEffectIds)||(this.previousActiveEffectIds=AA,o=!0,n.activeEffectIds=AA?new Set(AA):null);let jA=T?.activeOverlayNodes;jA!==this.previousActiveOverlays&&(this.previousActiveOverlays=jA,o=!0,n.activeOverlayNodes=jA);let x=T?.dragAndDropPlaceholders;x!==this.previousPlaceholder&&(this.previousPlaceholder=x,o=!0,n.placeholder=x);let z=T?.rootFontSize;z!==this.previousRootFontSize&&(this.previousRootFontSize=z,o=!0,n.rootFontSize=z);let K=T?.scopeIdToSelectedCollectionItem;K&&K!==this.previousScopeIdToSelectedCollectionItem&&(this.previousScopeIdToSelectedCollectionItem=K,o=!0,n.scopeIdToSelectedCollectionItem=K,p&&p===this.previousRenderScope&&(n.renderScope=p));let nA=T?.shouldSetMinHeight;nA!==this.previousShouldSetMinHeight&&(this.previousShouldSetMinHeight=nA,o=!0,n.shouldSetMinHeight=nA);let BA=T?.activeLinkStyle;BA!==this.previousActiveLinkStyle&&(this.previousActiveLinkStyle=BA,o=!0,n.activeLinkStyle=BA??null)}return this.sendSandboxUpdate(o?n:void 0,r?t:void 0)});I(this,"groundNodeOverflowSizes",{});this.sandbox=A,this.log=e.log,this.engine=e.engine,this.wantsEngineUpdates=e.wantsEngineUpdates,this.renderState=e.renderState,A.setLocal(e.engine.stores,{renderedUpdate:this.onRenderedUpdate,error:e.handleSandboxError??(()=>{}),heartbeat:e.heartbeat??(()=>{})}),A.waitForServiceChannel().then(this.onChannelReady).catch(this.fail),A.controller&&A.controller.waitUntilConnected().then(()=>{A.flags&&new ms(A.flags)}).catch(t=>{this.log.error("Error while waiting for flags service",t)})}sendSandboxUpdate(A,e){if(A||e){let{scheduler:t}=this.engine;A?.tree&&(this.lastSandboxTreeUpdate=t.update),A&&(A.timestamp=Date.now());let r={type:"SandboxUpdate",update:t.update,document:A,transform:e};return this.renderServiceIfDiscovered?this.renderServiceIfDiscovered.update({fixmeOpaqueJSON:r}):this.sandbox.renderer&&this.sandbox.renderer.oneway.updateSandbox(r),!0}return!1}command(A,e){this.renderServiceIfDiscovered?this.renderServiceIfDiscovered.update({fixmeOpaqueJSON:{command:A,args:e}}):this.sandbox.renderer&&this.sandbox.renderer.oneway.updateSandbox({command:A,args:e})}async drainChunksAsync(){if(this.drainingPromise)return this.drainingPromise;this.drainingPromise=this._performDraining();try{await this.drainingPromise}finally{this.drainingPromise=void 0}}async _performDraining(){this.chunkAbortController?.abort(),this.chunkAbortController=new AbortController;let A=crypto.randomUUID();this.chunkSessionId=A;let e=this.chunkAbortController.signal,t=this.previousRenderScope;try{if(!this.partialTreeSender)return;for await(let r of this.partialTreeSender.drainChunks(e)){if(e.aborted||this.chunkSessionId!==A||this.previousRenderScope!==t)break;let o={partialTreeUpdate:r,timestamp:Date.now()};this.partialTreeSender.hasMoreChunks()?this.sendSandboxUpdate(o,void 0):(o.loadedSomeUserData=this.engine.stores.loadingStore.isDocumentLoaded,this.sendSandboxUpdate(o,this.previousTransform))}this.update(!0)}catch(r){if(r instanceof Error&&r.name==="AbortError")return;throw r}finally{this.log.debug("Chunk draining completed or aborted"),this.chunkSessionId===A&&(this.chunkAbortController=void 0,this.chunkSessionId=void 0)}}updateGroundNodeOverflowSizes(){let A=this.engine.tree.get(this.previousRenderScope);dn(A);let e=A?.children;if(!e)return;let t=!1;for(let o of e){let n=o.cache,a=this.groundNodeOverflowSizes[o.id];qm(n,a)||(t=!0,this.groundNodeOverflowSizes[o.id]={minX:n.minX,maxX:n.maxX,minY:n.minY,maxY:n.maxY})}let r=Object.keys(this.groundNodeOverflowSizes);if(r.length>e.length){t=!0;let o=new Set(r);for(let n of e)o.delete(n.id);for(let n of o)delete this.groundNodeOverflowSizes[n]}t&&this.command("updateGroundNodeOverflowSizes",this.groundNodeOverflowSizes)}async renderUpdates(A){let e=await this.readyForRenderingPromise;await e.willStartUpdates(),A(),this.update(),await e.waitForCompleteRenderAfterUpdates()}get renderService(){return this.renderServiceIfDiscovered||this.sandbox.renderer||void 0}async measureNodes(A){return this.renderService?.measureNodes(A)}async getFitTextViewBoxes(A){return this.renderService?.getFitTextViewBoxes(A)}async fetchJSON(A){return this.renderService?.fetchJSON(A)}async getComponentRenderingError(A){return this.renderService?.getComponentRenderingError(A)}async preloadFonts(A){return this.renderService?.preloadFonts(A)}async waitUntilPlaceholdersSettled(){await this.renderService?.waitUntilPlaceholdersSettled()}};var hs=class{constructor(A,e){I(this,"log",gA("node-snapshots"));I(this,"engine");I(this,"renderer");I(this,"renderState",{renderNodes:{},transform:[0,0,1],isDarkMode:!1});this.engine=e,this.renderer=new gs(A,{log:this.log.extend("renderer"),engine:this.engine,wantsEngineUpdates:!1,renderState:()=>this.renderState})}renderToSVG({nodeId:A}){this.log.debug("preparing SVG");let t=this.engine.tree.getNode(A);if(!t)throw Error(`Node ${A} doesn't exist`);if(!GE(t))throw Error(`Node ${A} must be exportable as SVG`);return SE({node:t,isDarkMode:this.engine.stores.documentSettingsStore.hasDarkAppearance,combinedVariableValueMap:t.cache.getUnsafeCombinedVariableValueMap()})}async prepareNodeSnapshot({nodeId:A,zoom:e=1,pixelRatio:t=1}){this.log.debug("preparing snapshot");let r=this.engine.tree,o=r.getNode(A);if(!o)throw Error(`Node ${A} doesn't exist`);let n=r.getRect(o),a=sI(r,o),i=Jm(r,o),s={...n,x:a.x-i.x,y:a.y-i.y};t!==1&&(e*=t),this.log.debug("rendering");let l=this.engine.stores.scopeStore.active;return await this.renderer.renderUpdates(()=>{let{treeStore:c,toolStore:u,scopeStore:p,modulesStore:f,documentSettingsStore:E,propertiesPanelStore:F,overlayStore:h,selectionStore:S,effectStore:v}=this.engine.stores;this.renderState.renderScope=c.treeIndex.getScopeIdFor(o.id),this.renderState.renderNodes={[o.id]:s},this.renderState.transform=[0,0,e],this.renderState.isDarkMode=E.hasDarkAppearance,this.renderState.editor={selection:S.ids,nodeInTextEditor:u.nodeInTextEditor,nodesInEffectPreview:v.nodesInEffectPreview,nodesInMoveToolRootFontSize:this.engine.getNodesInMoveToolRootFontSize(),activeEffect:v.activeEffect,activeEffectIds:v.activeEffectIds,activeOverlayNodes:h.activeOverlays,dragAndDropPlaceholders:u.dragAndDropPlaceholders,rootFontSize:wu(l,c.tree,f)??null,scopeIdToSelectedCollectionItem:p.scopeIdToSelectedCollectionItem,shouldSetMinHeight:!1,activeLinkStyle:F.activeLinkStyle}}),q.multiply(q.atOrigin(i),e)}};function sI(j,A){if(j.isGroundNode(A))return j.getRect(A);let e=j.getGroundNodeFor(A);return j.getCanvasBoundingRectCached(e)}function LE(){TA({type:"add",variant:"warning",text:"This file format is currently unsupported",key:"image-export-unsupported",icon:"warning",duration:2e3})}function qE(){TA({type:"add",variant:"error",text:"Please update to the latest version",key:"image-export-not-available",icon:"error",duration:2e3})}async function VE(j,A){j=j.filter(i=>{for(let s of i.exportOptions)if(s.enabled)return!0;return!1});let e=j.length,t=j[0];$(t,"Node must be defined");let r=us(t),o=new Set;for(let i of j)for(let s of i.exportOptions)s.enabled&&o.add(s.type);let n=Array.from(o).join(", "),a={key:"export-nodes-progress",progress:{variant:"progress",text:e===1?`${r} is exporting as ${n}`:`${e} layers are exporting as ${n}`},success:{variant:"success",text:e===1?`${r} has been exported`:`${e} layers have been exported`},error:{variant:"error",text:e===1?`Unable to export ${r}`:"Unable to export layers"}};await Dm(a,A)}var cI=gA("export"),Ic=Wp?"\\":"/",Fc=new Set;Fc.add("html");Fc.add("webp");var yo=class yo extends hs{constructor(e){super(new Kn(BE.canvas,xi.export,{width:100,height:100,offscreen:!qe.isOn("sandboxExportDebugging")}),e);I(this,"exportMetrics",new Jn)}static async whenAvailable({toastIfNot:e}={toastIfNot:!1},t){let r=await Kn.isAvailable();if(this.isAvailable&&r)return this.shared=this.shared??new yo(t),this.shared;e&&(Jn.trackError("ServiceChannel miss-match error. Unable to establish a connection."),qE())}static async exportNodes(e,t){let r=await yo.whenAvailable({toastIfNot:!0},t);if($(r,"Expected image exporter to be available"),r.hasUnsupportedFiles(e))return LE();let a=(await r.openSaveDialog(e))?.filePath;a&&await VE(e,async()=>{await r.exportNodes(e,a)})}hasUnsupportedFiles(e){for(let t of e)for(let r of t.exportOptions)if(Fc.has(r.type)&&r.enabled)return!0;return!1}async exportNodes(e,t){let r=[],o=this.getCount(e);for(let i of e)for(let s of i.exportOptions){if(!s.enabled)continue;let l=s.type,c=this.createNamePath(i,s),u=i.id,p=s.scale,f=o===1?this.verifyNamePath(c,t):c;switch(l){case"png":r.push({nodeId:u,pixelRatio:p,type:"image/png",pathname:f,count:o,dialogFilePath:t,p3:this.engine.stores.persistedUserDefaults.p3});break;case"jpg":r.push({nodeId:u,pixelRatio:p,type:"image/jpeg",pathname:f,count:o,dialogFilePath:t,p3:this.engine.stores.persistedUserDefaults.p3});break;case"svg":r.push({nodeId:u,pixelRatio:p,type:"image/svg+xml",pathname:f,count:o,dialogFilePath:t,p3:this.engine.stores.persistedUserDefaults.p3});break;default:iA(l)}}let n;for(let i of r){let s=performance.now();cI.debug("snapshotting export",i);try{await this.writeToDisk(i),this.exportMetrics.add(i,{durationMs:Math.floor(performance.now()-s),errorReason:null,format:i.type,exportCount:o,success:!0,scope:"selection"})}catch(l){this.exportMetrics.add(i,{durationMs:Math.floor(performance.now()-s),errorReason:"Exporting snapshoting failed",format:i.type,exportCount:o,success:!1,scope:"selection"}),n=l}}let{metrics:a}=await this.renderer.sandbox.collectMetrics();if(this.exportMetrics.mergeElectronMetrics(a),this.exportMetrics.track(),n)throw n}createNamePath(e,t){let r=$E(us(e))||"export",o=t.nameExtension.lastIndexOf("/"),n=o>=0?t.nameExtension.slice(0,o+1):"",a=t.nameExtension.slice(o+1),i=t.type;return n+r+a+"."+i}getCount(e){let t=0;for(let r of e)for(let o of r.exportOptions)o.enabled&&t++;return t}async openSaveDialog(e){for(let t of e)for(let r of t.exportOptions)if(r.enabled)return this.renderer.sandbox.openSaveDialog({count:this.getCount(e),pathname:this.createNamePath(t,r)})}verifyNamePath(e,t){let r=e.split("/"),o=r[r.length-1];$(_(o),`Filename must be defined: ${r}`);let n=t.split(Ic),a=n[n.length-1];if($(_(a),`Filename must be defined: ${n}`),o.toLowerCase()!==a.toLowerCase()){let s=r.slice(0,-1).join(Ic);return s?s+Ic+a:a}return e}async writeToDisk(e){let t=await this.prepareNodeSnapshot(e);if(this.exportMetrics.add(e,{nodeWidth:t.width,nodeHeight:t.height}),e.type==="image/svg+xml"){let r=this.renderToSVG(e);return this.renderer.sandbox.writeToDisk({...e,rect:t,svgString:r})}return this.renderer.sandbox.writeToDisk({...e,rect:t})}async writeToClipboard(e){let t=await this.prepareNodeSnapshot(e);if(this.exportMetrics.add(e,{nodeWidth:t.width,nodeHeight:t.height}),e.type==="image/svg+xml"){let r=this.renderToSVG({nodeId:e.nodeId});return this.renderer.sandbox.writeToClipboard({...e,rect:t,svgString:r})}return this.renderer.sandbox.writeToClipboard({...e,rect:t})}async getImageData(e){let t=await this.prepareNodeSnapshot(e);return e.type==="image/svg+xml"?this.renderToSVG({nodeId:e.nodeId}):this.renderer.sandbox.getImageData({...e,rect:t})}};I(yo,"isAvailable",zp),I(yo,"shared");var Qn=yo;var Rs=Pj(qh());function Gc(j){let A=Kj.boundingBox(j),e=j.pathSegments.map(t=>t.merge({x:t.x-A.x,y:t.y-A.y}));return[{pathClosed:j.pathClosed,pathSegments:e},A]}function KE(j,A,e,t){let r=gA("app:importSVG"),o=j,n,a;if(t&&t.colorable){let E=An(j,"image/svg+xml").documentElement;if(!E)throw new Error(`Unsupported SVG: ${j}}`);let F=E.getAttribute("fill"),h=!(F&&F.toLowerCase()==="none");if(h){if(t.fillType==="linear-gradient"&&t.fillLinearGradient instanceof Dp)n={fillType:"linear-gradient",fillLinearGradient:t.fillLinearGradient};else if(t.fillType==="image"&&t.fillImage)n={fillType:"image",fillImage:t.fillImage,fillImageResize:t.fillImageResize,fillImagePixelWidth:t.fillImagePixelWidth,fillImagePixelHeight:t.fillImagePixelHeight};else if(t.fillType==="color"&&_(t.fillColor)){let S=(0,Rs.getPaperLazily)(),P=new S.Color(t.fillColor).toCSS(!1);h&&E.setAttribute("style",`fill: ${P}; color: ${P}`);let T=E.getAttribute("stroke");T&&T.toLowerCase()==="currentcolor"&&E.setAttribute("stroke",P)}o=E}}let i=uI(o);o=i.svgElement,a=i.svgSize;let s=!1,c=(0,Rs.getPaperLazily)().project.importSVG(o,{expandShapes:!0,insert:!1,size:e,onError:f=>{r.reportError(f),s=!0;let E=document&&document.getElementsByTagName("body");if(E&&E[0]){let F=E[0].lastElementChild;for(;F&&F.tagName==="svg";)F.remove(),F=E[0].lastElementChild}}});if(s)return null;let u;try{u=JE({item:c,fillOverrides:n,tree:A()})}catch(f){return r.reportError(f),null}let p=u[0];return p?(oj(p)&&a&&p.set({width:a.width,height:a.height}),A().insertNodes(u).getNode(p.id)):null}function JE({item:j,tree:A,nodes:e=[],parent:t=null,parentAbsolutePosition:r=lA(0,0),fillOverrides:o}){let n=(0,Rs.getPaperLazily)();return j instanceof n.Group?mI({group:j,nodes:e,parent:t,parentAbsolutePosition:r,tree:A,fillOverrides:o}):j instanceof n.PathItem?kI({item:j,nodes:e,parent:t,parentAbsolutePosition:r,fillOverrides:o}):(console.warn("Unhandled Paper item:",j),e)}function uI(j){let A=_(j)?An(j,"image/svg+xml").documentElement:j;if(!A)throw new Error(`Unsupported SVG: ${j}}`);let e,t=A.getAttribute("viewBox"),r=A.getAttribute("width"),o=A.getAttribute("height");if(t){let[n,a,i,s]=t.split(" ");i&&s&&(A.setAttribute("width",i),A.setAttribute("height",s),e={width:parseInt(i),height:parseInt(s)})}else r&&o&&(e={width:parseInt(r),height:parseInt(o)});return HE(A),{svgElement:A,svgSize:e}}function HE(j){pI(j);for(let A of j.children)HE(A)}function pI(j){let A=j.getAttribute("rx"),e=j.getAttribute("ry");!A&&!e||A&&e||(A?j.setAttribute("ry",A):e&&j.setAttribute("rx",e))}function kI({item:j,nodes:A=[],parent:e=null,parentAbsolutePosition:t=lA(0,0),fillOverrides:r}){let o=xp({item:j,parentAbsolutePosition:t}),n=Op(j),a=e?e.id:Bj;if(o.length===1){let s=o[0];$(s,"Path must be defined");let[{pathSegments:l,pathClosed:c},u]=Gc(s),p=new Cn({parentid:a,pathSegments:l,pathClosed:c,...n,...r,...u});A.push(p)}else if(o.length){let s=QE(j),l=s.x-t.x,c=s.y-t.y,u=j.fillRule==="evenodd"?3:4,p=new wa({parentid:a,pathBoolean:u,...n,...r,x:l,y:c,width:s.width,height:s.height});A.push(p),o.forEach(f=>{let[{pathSegments:E,pathClosed:F},h]=Gc(f),S=new Cn({parentid:p.id,pathSegments:E,pathClosed:F,...r,x:h.x-l,y:h.y-c,width:h.width,height:h.height});A.push(S)})}return A}function mI({group:j,tree:A,nodes:e=[],parent:t=null,parentAbsolutePosition:r=lA(0,0),fillOverrides:o}){let n=QE(j),a=t?t.id:Bj,i,s;return a?(i=new Gm({parentid:a,x:n.x-r.x,y:n.y-r.y,width:n.width,height:n.height}),s=lA(n.x,n.y)):(i=new Fr({parentid:a,left:0,top:0,width:n.x+n.width,height:n.y+n.height,fillEnabled:!1}),s=lA(0,0)),e.push(i),j.children.forEach(l=>{JE({item:l,nodes:e,parent:i,parentAbsolutePosition:s,tree:A,fillOverrides:o})}),e}function QE(j){let{x:A,y:e,width:t,height:r}=j.bounds;return{x:A,y:e,width:t,height:r}}function fI(j){return _j(j)&&"iconURL"in j}function w1(j){return _j(j.icon)?j.id==="WorkspacePluginsCategory"?!0:fI(j.icon):!1}var EI={DefaultCategory:!0,PluginsCategory:!0,ManagedCollectionPluginsCategory:!0,WorkspacePluginsCategory:!0};function L1(j){return _(j)?Object.hasOwn(EI,j):!1}var $I={FindNodesCategory:!0,PluginsCategory:!0,ManagedCollectionPluginsCategory:!0,WorkspacePluginsCategory:!0};function q1(j){return Object.hasOwn($I,j)}function V1(j){return j?.kind==="item"}function UE(j){if(j!==void 0)switch(j){case 2:return"auto";case 0:return"fixed";case 3:return"fraction";case 1:return"percentage";case 4:return"viewport";case 5:return"fit-image";default:iA(j)}}function WE(j,{widthType:A,heightType:e},t){if(!$A(j))return;let r=A!==void 0&&j.widthType!==A,o=e!==void 0&&j.heightType!==e;!r&&!o||hf({widthType:UE(A),heightType:UE(e),source:t,nodeType:j.__class,componentId:W(j)?j.codeComponentIdentifier:void 0})}function Co(j,A,e=!1){let t={};for(let r in j){let o={...j[r]};"itemsOrder"in o&&Array.isArray(o.itemsOrder)&&e&&(o.itemsOrder=Nn(o.itemsOrder,A)),t[A.get(r)??r]=o}return t}var Is=class extends Map{get(A){let e=super.get(A);for(;e;){let t=super.get(e);if(t===void 0)break;e=t}return e}};function BI(j,A){if(va(j)){if(!j.controls.target?.value)return;let e=A.get(j.controls.target.value);return e?{target:{...j.controls.target,value:e}}:void 0}if(Je(j)){if(!j.controls.variantId?.value)return;let e=A.get(j.controls.variantId.value);return e?{variantId:{...j.controls.variantId,value:e}}:void 0}if(X6(j)){if(!j.controls.overlay?.value)return;let e=A.get(j.controls.overlay.value);return e?{overlay:{...j.controls.overlay,value:e}}:void 0}}function zE(j,A,e,t){let r=W(A),o={},n=!1,a=Ta(A);for(let i in a){let s=r?VA(i):i;if(!UA(j,A,s))continue;let l=a[i];if(!ij(l))continue;let c=[],u=!1;for(let p of l){if(t&&(X6(p)||da(p))){u=!0;continue}let E=BI(p,e);if(!E){c.push(p);continue}c.push({...p,controls:{...p.controls,...E}}),u=!0}u&&(r?o[VA(i)]={type:"eventhandler",value:c}:o[i]=c,n=!0)}n&&A.set(o,j)}function gI(j,A,e){let t={};function r(a){let i=j.get(a);i&&j.linkNodeChangesTo(i,A.id)}let o=vm(A,L);for(let a of o){if(!UA(j,A,VA(a)))continue;let i=A.getRawControlProp(a);if(i){if(i.type==="slot"&&ij(i.value)){let s=!1,l=i.value.map(c=>{if(!_j(c))return c;let u="reference";if(!_(c[u]))return c;let p=e.get(c.reference);return p?(s=!0,r(p),{...c,[u]:p}):c});if(!s)continue;t[a]={type:"slot",value:l}}else if((i.type===null||i.type==="componentinstance")&&_(i.value)){let s=e.get(i.value);if(!s)continue;t[a]={type:"slot",value:[{id:"first-item",reference:s}]},r(s)}else if(ij(i.value)){let s=!1,l=[];for(let c=0;c<i.value.length;c++){let u=i.value[c];if(!Aa(u)||u.type!==null&&u.type!=="componentinstance"||!_(u.value))continue;let p=fu(u)?u.id:gj(),f=e.get(u.value);l.push({id:p,reference:f??u.value}),f&&(r(f),s=!0)}if(!s)continue;t[a]={type:"slot",value:l}}}}if(Pe(t))return;let n=Zr(t);A.set(n,j)}function hI(j,A,e){let t={},r=L.componentForIdentifier(A.codeComponentIdentifier)?.properties;for(let o in r){if(!UA(j,A,VA(o)))continue;let n=r[o];if(n?.type!=="scrollsectionref")continue;let a=A.getRawControlProp(o);if(!a)continue;let i=qu(n,a);if(!i||aA(i)||!_(i.target))continue;let s=e.get(i.target);s&&(t[o]={type:"scrollsectionref",value:{...i,target:s}})}Pe(t)||A.set(Zr(t),j)}function RI(j,A){if(Tk(j)&&ij(j.appearEffectScrollTargets)){let e=j.appearEffectScrollTargets.map(t=>{if(!t.target||aA(t.target))return t;let r=A.get(t.target);return r?{id:gj(),variant:t.variant,target:r}:t});j.set({appearEffectScrollTargets:e})}if(bk(j)&&_(j.styleAppearEffectScrollTarget)){let e=A.get(j.styleAppearEffectScrollTarget);e&&j.set({styleAppearEffectScrollTarget:e})}if(vk(j)&&ij(j.styleTransformEffectScrollTargets)){let e=j.styleTransformEffectScrollTargets.map(t=>{if(!t.target||aA(t.target))return t;let r=A.get(t.target);return r?{id:gj(),style:t.style,target:r}:t});j.set({styleTransformEffectScrollTargets:e})}if(Sk(j)&&j.dragEffectConstraintElement){let e=A.get(j.dragEffectConstraintElement);e&&j.set({dragEffectConstraintElement:e})}if(Pk(j)&&_(j.textEffectScrollTarget)){let e=A.get(j.textEffectScrollTarget);e&&j.set({textEffectScrollTarget:e})}}function be(j,A,e,t){if(A=A.draftOrCurrent(),(we(A)||ap(A))&&zE(j,A,e,t),W(A)&&(zE(j,A,e,t),gI(j,A,e),hI(j,A,e)),yn(A)&&RI(A,e),to(A)&&A.formSubmitButtonId){let o=e.get(A.formSubmitButtonId);o&&A.set({formSubmitButtonId:o})}if(Uk(A)&&A.dataSourceLoaderId){let o=e.get(A.dataSourceLoaderId);o&&A.set({dataSourceLoaderId:o})}if(Ki(A)&&A.collectionRepeatedItemId){let o=e.get(A.collectionRepeatedItemId);o&&A.set({collectionRepeatedItemId:o})}if(Wj(A)){let o=XE(A.dataIdentifier,e);o&&A.set({dataIdentifier:o})}if(uj(A)){let o=A.variables.map(n=>{if(!ia(n))return n;let a=XE(n.dataIdentifier,e);return a?{...n,dataIdentifier:a}:n});or(A.variables,o)||A.set({variables:o})}ue(A)&&II(A,e);let r=jm(j,A,o=>{if(!o.providerId)return;let n=e.get(o.providerId);if(n)return Zj(e.get(o.id)??o.id,n)});if(r&&A.set(r),A.children)for(let o of A.children)be(j,o,e,t);return A}function XE(j,A){let e=oA(j);if(!YA(e))return null;let t=A.get(e.localIdName);return t?er(e.type,t,e.exportSpecifier).value:null}function II(j,A){let e=j.getControlProps();for(let[t,r]of Object.entries(e)){if(r?.type==="collectionreference"&&_(r.value)){let o=A.get(r.value);o&&j.setControlProp(t,{...r,value:o})}if(r?.type==="multicollectionreference"&&!sA(r.value)&&!aA(r.value)){let o=r.value.map(n=>A.get(n)??n);or(r.value,o)||j.setControlProp(t,{...r,value:o})}}}function Fs(j){if(!j)return!1;let A=oA(j);return A?A.kind==="externalModuleExport"||A.kind==="localModuleExport":!1}function Gs(j,A){W(j)&&Fs(j.codeComponentIdentifier)&&A(j.codeComponentIdentifier),zr(j)&&j.dataIdentifier&&A(j.dataIdentifier),eo(j)&&Fs(j.codeOverrideIdentifier)&&A(j.codeOverrideIdentifier),Gl(j)&&j.codeOverrides?.forEach(e=>{A(e.identifier)}),ue(j)&&zm(j).forEach(A)}function Ss(j,A){let e={};if(W(j)&&Fs(j.codeComponentIdentifier)){let r=A(j.codeComponentIdentifier);r&&(e.codeComponentIdentifier=r)}if(zr(j)&&j.dataIdentifier){let r=A(j.dataIdentifier);r&&($(Rj(r)),e.dataIdentifier=r)}if(eo(j)&&Fs(j.codeOverrideIdentifier)){let r=A(j.codeOverrideIdentifier);r&&(e.codeOverrideIdentifier=r)}if(Gl(j)&&j.codeOverrides){let r=!1,o=j.codeOverrides.map(n=>{let a=A(n.identifier);return a?(r=!0,{...n,identifier:a}):n});r&&(e.codeOverrides=o)}if(ue(j)){let r=Um(j,A);r&&Object.assign(e,r)}if(Object.keys(e).length!==0)return e}function YE(j){return rs(j)||uj(j)}async function ZE(j,A,e){return(await qa.post(`/web/projects/${e}/assets/duplicate-module`,{moduleId:j,saveId:A})).assets}var j$=75,FI={mutable:!0,update:0};function Mr(j,A,e,t,r=!1){function o(n,a,i=!1){let s=new n.constructor;s.assign(n,FI,{cache:s.cache,id:s.id}),Rp(s)&&(s.itemsOrder=void 0),n.cache.insideVariant=i;let l=ur(n)?n.getChildrenInVisualOrder():n.children;l&&(s.children=l.map(p=>o(p,s.id,i)));let c={parentid:a},u=Ss(n,p=>{let f=oA(p);if(f.kind==="localModuleExport"){let E=A.get(f.localId);if(E)return`${E}:${f.exportSpecifier}`}else if(f?.kind==="externalModuleExport"){let E=e.get(f.moduleId);if(E)return Kr(f,E).value}});if(u&&Object.assign(c,u),aj(n)&&!MA(n)&&Object.assign(c,{replicaInfo:void 0,originalid:void 0,...n.replicaInfo.overrides[n.replicaInfo.master],_deleted:void 0}),r&&Object.assign(c,{duplicatedFrom:ca(n.duplicatedFrom,n.id)}),s.assign(c),t){if(t.has(n.id)){let p=t.get(n.id);p&&t.set(p,s.id)}t.set(n.id,s.id),n.originalid&&!t.has(n.originalid)&&t.set(n.originalid,s.id)}return s}return o(j,void 0,MA(j))}function GI(j){let A=new Map;for(let e of j)if(e.type==="local"){let t=e.moduleId;A.set(e.localId,le(t,e.saveId,e.file).value)}return A}async function e$(j){let A=new Map;for await(let e of j)if(e.type==="local"&&e.moduleType==="css"){let t=await r$({moduleId:e.moduleId,saveId:e.saveId}),{__treeSerializationVersion:r,...o}=t,n=r||j$,{root:a}=Z6({root:o,version:n}),i=Dl(a);It(i)&&A.set(i.id,i)}return[...A.values()]}function t$(j,A,e){let t=GI(e.imports),r=new Map,o=[];for(let n of j.walk())Gs(n,a=>{let i=oA(a);if(YA(i)){let s=t.get(i.localId);if(!s)return;let{moduleId:l,saveId:c,file:u}=oA(s);i=o7(i,l,c,u)}if(i.kind==="externalModuleExport"){let s=A.getPersistedModuleByGlobalId(i.moduleId);s?r.set(i.moduleId,s.localId):o.push(i)}});return{identifiers:o,localIdsToExternalIdentifiers:t,externalModuleIdsToLocalIds:r}}async function r$({moduleId:j,saveId:A}){try{return await(await fetch(`${Me().modulesCDN}/${j}/${A}/tree.json`)).json()}catch(e){yA(e)}}async function o$(j,A){let[e,t]=await Promise.all([r$(A),j.stores.modulesStore.getModuleDependencies(A)]);$(e,"Can't get tree.json for module identifier"),$(t,"Can't get dependencies for module identifier");let{__treeSerializationVersion:r,...o}=e,n=r||j$,{root:a}=Z6({root:o,version:n}),i=Dl(a);return $(YE(i),"Node should be un-linkable."),{node:i,dependencies:t}}async function n$(j,A,e){let t=j.remoteDocument?.projectId;if(t&&A.assets.length>0)try{let r=await ZE(e.moduleId,e.saveId,t);j.stores.assetStore.assetService?.addAssets(r)}catch{}}function yc(j){if(!vA(j)||RA(j))return 0;let A=0,e=j.children.length;return A+=e,j.children.forEach(t=>{A+=yc(t)}),A}function i$(j,A,e,t){let r=is(e,L),o=new Map(Object.entries(r)),n=new Map;n.set(t,o);let a={};for(let i of j.walk()){let s=Na(A,t,i,n);s&&(a[i.originalid??i.id]=s)}return a}function a$(j){let{left:A,top:e,right:t,bottom:r,centerAnchorX:o,centerAnchorY:n,constraintsLocked:a,width:i,widthType:s,height:l,heightType:c,aspectRatio:u,name:p,...f}=j;return f}function s$(j){let A=L.reactComponentForIdentifier(j.codeComponentIdentifier);if(!A)return;let e={},t=Object.keys(A.properties);for(let r of t){let o=A.properties[r];if(!o||o.type!=="eventhandler")continue;let n=j.getRawControlProp(r);if(!n)continue;let{value:a}=n;!Array.isArray(a)||a.length===0||(e[r]=a)}return e}function ys(j,{opacity:A,rotation:e}){if(aA(A))j.opacity=A;else if(j?.opacity||A){let t=Y(A)?A:1;j.opacity=(j.opacity??1)*t}if(aA(e))j.rotation=e;else if(j?.rotation||e){let t=Y(e)?e:0;j.rotation=(j.rotation??0)+t}}function I4(j){return j.every(A=>pA(A)||xj(A)||W(A))}function F4(j,A){return A?!1:j.every(e=>{if(!pA(e)&&!W(e)&&!QA(e)||IA(e)||pA(e)&&ao(e).length===0)return!1;if(W(e)){let t=e.getSupportedLayout(L);if(!Be(t.width)||!Be(t.height))return!1}return e.widthType!==2||e.heightType!==2})}function l$(j,A,e){for(let t of A)if(xj(t)||W(t))t.set({widthType:2,heightType:2}),xj(t)&&e&&mA("layout_fit_text",{source:e});else if(pA(t)){let r={widthType:2,heightType:2,aspectRatio:null};Re(t)||cs(j,t,r),kc(j.tree,"width",t),kc(j.tree,"height",t),Hk(t)&&(r.framePreset=null),t.set(r),e&&mA("layout_stack",{layoutType:"stack",source:e})}}function C4(j){return aj(j)&&!MA(j)}function c$(j){return hA(j)&&!kj(j)}function d$(j){return jj(j)&&!kj(j)}function Cs(j,A){return wi(A)&&(gA("app").warn("Inserting a symbol is no longer supported."),A.isMaster=!1,A.replicaInfo=null,A.originalid=null),$(!j.tree.has(A.id),"Tree should not contain node with same id as inserted template"),j.stores.scopeStore.insertNode(A),A}function k$(j){let A={width:200,height:200,codeComponentIdentifier:j.identifier,intrinsicWidth:null,intrinsicHeight:null,slotsAreChildNodes:OA.isOn("componentSlotsAreChildNodes")},{defaultProps:e,annotations:t}=j;if(e!==void 0&&(S6(e.width)&&(A.width=e.width,A.intrinsicWidth=e.width),S6(e.height)&&(A.height=e.height,A.intrinsicHeight=e.height)),t){let r=Hp(t);r.width&&(A.width=r.width),r.height&&(A.height=r.height)}return new Rr(A)}function K4(j){return j.sort(SI)}var u$=new Map;function p$(j){let A=u$.get(j);if(A)return A;let e=j.split("/").map(t=>t.trim()).join("");return u$.set(j,e),e}function SI(j,A){if(j.name===null)return-1;if(A.name===null)return 1;let e=p$(j.name),t=p$(A.name);return e.localeCompare(t,void 0,{numeric:!0})}function J4(j){if(k7(j)&&j.file==="./canvas.tsx"||j.identifier==="framer/Stack")return!1;let A=oA(j.identifier);return YA(A)&&A.type==="screen"?!1:j.type==="component"||j.type==="master"}function H4(j){let A=j.split("/"),e=A[A.length-1];return $(ce(e),"Last section is required"),e.trim()}function Q4(j,A){return j.name?j.name:A?Ce(A):"Unknown"}function U4(j){let A=[];for(let e of L.getAllLocalModules())e.type==="component"&&e.file===j&&A.push(e);return A}function bs(j,{allowVariants:A,allowLockedNodes:e}={}){return!e&&wt(j)||Uj(j)||!A&&(MA(j)||kj(j))||d$(j)||Xo(j)||RA(j)||nu(j)?!1:$A(j)}async function m$(j,A,e,t){function r(){vI(j,[A],e,t)}if(!W(e)){r();return}let o=oA(e.codeComponentIdentifier);if(!o||o.kind!=="externalModuleExport"){r();return}await j.stores.modulesStore.addExternalModulesToProject([o],{onTreeUpdate:r})}function yI(j,A,e){if(!kn(A))return;let t=bp(j.tree,A);if(!eA(t))return;$(t.isLoaded(),"smart component must be loaded"),e.set({formSubmitButtonId:A.id});let r=t.getPrimaryVariant();t.getReplicaVariants().forEach(o=>{kA.resetOverridesByProperty(j.tree,o,o,["htmlTag","link"])}),yk(r)&&r.set({htmlTag:"button",link:void 0})}function CI(j,A,e){if(!W(j)||!W(A)||!j.cache.formContainerAncestorId)return;let t=e.tree.get(j.cache.formContainerAncestorId);to(t)&&yI(e,A,t)}function bI(j,A,e){let t=fk(e.tree,j);t&&Gk(j,t)&&t.set({dataSourceLoaderId:A.id})}function vI(j,A,e,t){let r={},o=new Set;A.forEach(n=>{let a=null;if(jj(n)){if(!pe(n))return;let f=Ke(j.tree,n),E=kA.getReplicaForTemplateNode(j.tree,n);if(!f||!E||!MA(E))return;n=f,a=E}let i=Cs(j,e);CI(n,i,j),bI(n,i,j);let s=j.tree.getNodeParent(n),l=s||j.tree.getScopeNodeFor(n)||j.stores.scopeStore.active,c=l.children.indexOf(n),u=ls(j.tree,n,i,l);if(i.set(u),s&&Fj(n)&&Tt(i)){i.set(Pt(n));let f=new Is([[n.id,i.id]]);be(j.tree,s,f,je(s)||ma(s)),o.add(i.id)}if(W(i)&&PI(n,i,new Set(Object.keys(u))),aj(n)&&!MA(n)&&W(i)&&TI(j,n,i),MI(j,l,n,i),vA(n))for(let f of n.children)je(f)&&j.moveNode(f.id,i.id);j.deleteNode(n.id),j.moveNode(i.id,l.id,c);let p=_I(j.tree,n,i);$A(i)&&p&&(t?j.tree.current(i)?.set({left:p.left,right:p.right,top:p.top,bottom:p.bottom,centerAnchorX:p.centerAnchorX,centerAnchorY:p.centerAnchorY}):j.tree.current(i)?.set(p)),a?r[n.id]=ke(a.id,i.id):r[n.id]=i.id});for(let n of j.stores.selectionStore.ids)o.add(r[n]??n);j.stores.selectionStore.set(Array.from(o))}function TI(j,A,e){if(MA(A))return;let t=e.getLocalSmartComponentNodeId();if(!t)return;let r=j.tree.getNode(t);if(!(!r||!eA(r))&&r.originalSymbolId===A.replicaInfo.master){for(let o of A.walk())if(!(!Qk(o)||!o.isTarget)&&o.originalid){if(pA(o)&&o.fillType==="image"&&_(o.fillImage)){let n=e.getRawControlProp(`symbol_${o.originalid}`);n&&n.type==="image"&&(n.value=o.fillImage)}else if(Xo(o)){let n=e.getRawControlProp(`symbol_${o.originalid}`);n&&n.type==="string"&&(n.value=o.styledText.text)}}}}function PI(j,A,e){let t;A:for(let o of j.walk()){if(!we(o)&&!W(o))continue;let n=Ma(o);for(let[,a]of Object.entries(n))if(t===void 0)t=a;else if(t){t=null;break A}}if(!t)return;let r=L.componentForIdentifier(A.codeComponentIdentifier);if(r?.properties)for(let o in r.properties){if(e?.has(o)||r.properties[o]?.type!=="eventhandler")continue;let a={type:"eventhandler",value:t};A.set({[VA(o)]:a});return}}function MI(j,A,e,t){let r=A?Qo(A):null;if(!r||!pj(r))return;let o=j.tree.getSmartComponentNodeFor(r);if(o)for(let n of o.getReplicaVariants()){let a=n.replicaInfo;if(!(e.id in a.overrides))continue;let i={...a};i.overrides={...i.overrides};let s={},l=i.overrides[e.id];for(let c in l){let u=l[c];if(c==="_deleted"){if(!ij(u))continue;let p=u.filter(f=>f in t);p.length&&(s._deleted=p)}else c in t&&(s[c]=u)}delete i.overrides[e.id],i.overrides[t.id]=s,j.tree.current(n)?.set({replicaInfo:i})}}function _I(j,A,e){if(!$A(A)||!$A(e))return;let t=A.constraintValues();if(cr(A)&&cr(e)&&(tp(A)&&(t.gridItemFillCellWidth=!0),ep(A)&&(t.gridItemFillCellHeight=!0)),!W(e))return t;if(Up(A)){let r=e.getSupportedLayout(L),o=j.getRect(A);A.widthType===2&&!Be(r.width)&&(t.widthType=0,t.width=o.width),A.widthType===5&&(t.widthType=Be(r.width)?2:0),A.heightType===2&&!Be(r.height)&&(t.heightType=0,t.height=o.height),A.heightType===5&&(t.heightType=Be(r.height)?2:0)}return t}function f$(j){return p7(j)?k$(j):null}var E$=Pj(_6());function $$(j){let A={};for(let e of j.walk()){let t={};Ee(e)&&(t.strokeDashArray=e.strokeDashArray,t.strokeDashOffset=e.strokeDashOffset,qA(e.strokeWidth)||(t.strokeWidth=e.strokeWidth)),sr(e)&&(t.boxShadows=e.boxShadows),Ot(e)&&(t.radius=e.radius),ir(e)&&(t.radiusTopLeft=e.radiusTopLeft,t.radiusTopRight=e.radiusTopRight,t.radiusBottomRight=e.radiusBottomRight,t.radiusBottomLeft=e.radiusBottomLeft),jn(e)&&(t.pathSegments=e.pathSegments),Ge(e)&&e.fillType==="image"&&e.fillImageResize==="tile"&&(t.fillImageTileSize=e.fillImageTileSize??1),A[e.id]=t}return(0,E$.Map)(A)}function Cc(j,A,e){A.forEach((t,r)=>{let o=j.getNode(r);if(!o)return;let n={};Ee(o)&&(Y(t.strokeWidth)&&(n.strokeWidth=dj(t.strokeWidth*e,2)),_(t.strokeDashArray)&&(n.strokeDashArray=NI(t.strokeDashArray,e)),Y(t.strokeDashOffset)&&(n.strokeDashOffset=dj(t.strokeDashOffset*e,2))),Cu(o)&&Bu(t.boxShadows)&&(n.boxShadows=DI(t.boxShadows,e)),Ot(o)&&(Y(t.radius)&&(n.radius=dj(t.radius*e,2)),Y(t.radiusTopLeft)&&(n.radiusTopLeft=dj(t.radiusTopLeft*e,2)),Y(t.radiusTopRight)&&(n.radiusTopRight=dj(t.radiusTopRight*e,2)),Y(t.radiusBottomRight)&&(n.radiusBottomRight=dj(t.radiusBottomRight*e,2)),Y(t.radiusBottomLeft)&&(n.radiusBottomLeft=dj(t.radiusBottomLeft*e,2))),jn(o)&&t.pathSegments&&(n.pathSegments=o.pathSegments.map((a,i)=>{let l=t.pathSegments[i].radius*e;return a.merge({radius:l})})),Ge(o)&&Y(t.fillImageTileSize)&&(n.fillImageTileSize=t.fillImageTileSize*e),o.set(n)})}function DI(j,A){if(!(!j||qA(j)))return j.map(e=>ta(e,{x:dj(e.x*A,2),y:dj(e.y*A,2),blur:dj(e.blur*A,2),spread:dj(e.spread*A,2)}))}function NI(j,A){let e=[],t=j.split(",");for(let r of t){let o=parseFloat(r);if(!Y(o))continue;let n=dj(o*A,2);e.push(n)}return e.join(", ")}var qL=(j,A)=>{if(j===A)return!0;if(j.length!==A.length)return!1;let e=new Set(j);for(let t of A)if(!e.has(t))return!1;return!0},VL=(j,A,e)=>{let t=[];for(let r of j)bc(A,r,e)!==-1&&t.push(r);return t},B$=(j,A,e)=>{if(!e)return Array.from(new Set([...j,...A]));let t=[...j];for(let r of A)bc(t,r,e)===-1&&t.push(r);return t},KL=(j,A,e)=>j.filter(t=>bc(A,t,e)===-1);function bc(j,A,e){return e?j.findIndex(t=>e(t,A)):j.indexOf(A)}function xI(j,A){let e=[];for(let r of A.segmentSelection){let o=j.getNode(r.id);!o||r.index>=o.pathSegments.length||e.push(r)}let t=A.segmentHandle;if(t){let r=j.getNode(t.id);(!r||t.index>=r.pathSegments.length)&&(t=null)}return{...A,segmentSelection:e,segmentHandle:t}}var g$=class{constructor(A){this.addChanges=A;I(this,"state",{segmentSelection:[],selectionType:0,segmentHandle:null,segmentHovered:null,closestCurve:null,pointRounding:.5,snapConstraint:null})}validateSegmentSelection(A){this.state=xI(A,this.state),this.addChanges("PathSelection")}setSegmentSelection(A,e){this.state={...this.state,segmentSelection:A,selectionType:e},this.addChanges("PathSelection")}toggleSegmentSelection(A,e){this.state.selectionType!==e&&(this.state={...this.state,segmentSelection:A,selectionType:e});let t=A.filter(o=>this.state.segmentSelection.find(n=>o.id===n.id&&o.index===n.index)===void 0),r=this.state.segmentSelection.filter(o=>A.find(n=>n.id===o.id&&n.index===o.index)===void 0);this.state={...this.state,segmentSelection:B$(t,r)},this.addChanges("PathSelection")}setSegmentHandle(A){this.state={...this.state,segmentHandle:A},this.addChanges("PathSelection")}setHoveredSegment(A){this.state={...this.state,segmentHovered:A},this.addChanges("PathSelection")}setClosestCurve(A){this.state={...this.state,closestCurve:A},this.addChanges("PathSelection")}setPathPointRounding(A){this.state={...this.state,pointRounding:A},this.addChanges("PathSelection")}setPathConstraint(A){this.state={...this.state,snapConstraint:A},this.addChanges("PathSelection")}};var Un=Pj(_6());function R$(j,A){return Dn(j,"canDesign")||A.length===0?!1:A.find(e=>!(!ho(e)&&xt(e)&&!Rt(e)&&!e.originalid))===void 0}function hq(j,A,e,t){let r=A.map(o=>Tc(j,o,e,t)[0]);j.stores.selectionStore.set(r)}function Tc(j,A,e,t){let r=j.tree,o;Ml.isBasicShape(A)?o=Ml.createPath(A):o=A.calculatedPaths();let n=Pp(A,o),a=zn(r,A,o),i=r.newId(),s=Kj.boundingBox(n),l=G$(A),c=Mk(A);if(l.fillType==="linear-gradient"&&l.fillLinearGradient){l.fillType="linear-gradient";let p=Y(A.rotation)?A.rotation:0;l.fillLinearGradient=l.fillLinearGradient.updated({angle:l.fillLinearGradient.angle+p})}if(n.length===1){let p=Kj.offset(n[0],lA.reverse(s));j.createPath(A.parentid,{id:i,...p,...s,...l,...c})}else{let p=[],f=new wa({id:i,parentid:A.parentid,pathBoolean:4,...s,...l,...c});p.push(f);for(let E of n){let F=Kj.boundingBox(E),h={...F,...lA.subtract(F,s)},S=Kj.offset(E,lA.reverse(F)),v=new Cn({parentid:i,...h,...S,...l});p.push(v)}j.tree.insertNodes(p)}let u=r.getParent(A.id);if(u!==null&&vA(u)){let p=u.children.indexOf(A);j.moveNode(i,u.id,p)}return j.deleteNode(A.id),t||j.stores.selectionStore.set(i),e===!0&&j.setTool(34),[i,a]}function OI(j){let A={};return j.forEach(e=>{A[e.id]||(A[e.id]=[]),A[e.id].push(e.index)}),A}function Rq(j,A){let e=1/A;return{x:Math.round(j.x*e)/e,y:Math.round(j.y*e)/e}}function Iq(j,A){let e=j.getNode(A.id);if(!e||!e.pathSegments)return null;let t=e.pathSegments[A.index],r=A.handle===0?Ij.calculatedHandleIn(t):Ij.calculatedHandleOut(t);return j.convertPointToCanvas(e,r)}function h$(j,A){return A.handle===0?{x:j.handleOutX,y:j.handleOutY}:{x:j.handleInX,y:j.handleInY}}function Fq(j,A,e,t,r){let o=j.getNode(A.id),n=o.pathSegments[A.index];return e=j.convertPointToNode(o,e),e=lA.subtract(e,n),_e.update(o.pathSegments,A.index,a=>{let i=h$(a,A),s=a.handleMirroring==="straight",l=a.handleMirroring;t&&(i=h$(t,A),s=t.handleMirroring==="straight",l=t.handleMirroring),s&&(l="symmetric"),t&&r&&(l==="disconnected"||l==="asymmetric"?l="symmetric":l="disconnected"),l==="symmetric"&&(i=lA.reverse(e));let c=A.handle===0,u=c?e.x:i.x,p=c?e.y:i.y,f=c?i.x:e.x,E=c?i.y:e.y;return a.merge({handleOutX:f,handleOutY:E,handleInX:u,handleInY:p,handleMirroring:l})})}function Wn(j,A,e=!1,t){let r=j.tree,o=(0,Un.Map)(),n=(0,Un.Map)();if(!xt(A)&&!RA(A))return{descendantPaths:o,descendantBasicShapes:n};let a={};Pc(r,A,a);let i=Object.keys(a);for(let c=0,u=i.length;c<u;c++){let p=i[c],f=a[p];o=o.set(p,f)}let s={};Mc(r,A,s,e);let l=Object.keys(s);for(let c=0,u=l.length;c<u;c++){let p=l[c],f=s[p];n=n.set(p,f)}return n.forEach((c,u)=>{if(c!==null)return;let p=r.getNode(u);if(!p||!R$(j,[p]))return;let[f,E]=Tc(j,p,!1,!0),F=E[0];o=o.set(f,F),t&&t.includes(u)&&j.stores.selectionStore.toggle(f)}),{descendantPaths:o,descendantBasicShapes:n}}function I$(j,A){let e=j.tree,t=(0,Un.Map)(),r=(0,Un.Map)();if(!RA(A))return{shapeContainerDescendantPaths:t,shapeContainerDescendantBasicShapes:r};let o={};Pc(e,A,o,A);let n=Object.keys(o);for(let s=0,l=n.length;s<l;s++){let c=n[s],u=o[c];t=t.set(c,u)}let a={};Mc(e,A,a,!1,!1,A);let i=Object.keys(a);for(let s=0,l=i.length;s<l;s++){let c=i[s],u=a[c];r=r.set(c,u)}return r.forEach((s,l)=>{if(s!==null)return;let c=e.getNode(l);if(!c||!R$(j,[c]))return;let[u,p]=Tc(j,c,!1,!0),f=p[0],E=Vt(e,A,[f])[0];t=t.set(u,{pathSegments:E,pathClosed:!0})}),{shapeContainerDescendantPaths:t,shapeContainerDescendantBasicShapes:r}}function Pc(j,A,e,t){if(Rt(A)||Zo(A)||RA(A))for(let r of A.children)xt(r)&&Pc(j,r,e,t);else if(ho(A)){let r=zn(j,A,A)[0].pathSegments;t&&(r=Vt(j,t,[{pathSegments:r,pathClosed:A.pathClosed}])[0]),e[A.id]={pathSegments:r,pathClosed:A.pathClosed}}}function Mc(j,A,e,t=!1,r=!1,o){if(Rt(A)||Zo(A)||RA(A))for(let n of A.children){let i=Nt(n)&&Y(n.rotation)&&n.rotation%90!==0||t;xt(n)&&Mc(j,n,e,i,r,o)}else if(!ho(A)&&xt(A))if(t||r)e[A.id]=null;else{let n=q.pointsAtOrigin(j.getRect(A));e[A.id]=n.map(a=>{let i=j.convertPointToCanvas(A,a);return o?j.convertPointToNode(o,i,!0):i})}}function zn(j,A,e,t=1){let r=[];return Array.isArray(e)?r=e:r=[e],r.map(({pathSegments:o,pathClosed:n})=>({pathSegments:o.map(i=>vc(j,A,i,t,void 0)),pathClosed:n}))}function vc(j,A,e,t=1,r){let o=lA.multiply(j.convertPointToCanvas(A,e,!0,r),t),n=lA.multiply(j.convertPointToCanvas(A,Ij.calculatedHandleIn(e),!0,r),t),a=lA.multiply(j.convertPointToCanvas(A,Ij.calculatedHandleOut(e),!0,r),t),i=lA.subtract(n,o),s=lA.subtract(a,o);return e.merge({...o,handleOutX:s.x,handleOutY:s.y,handleInX:i.x,handleInY:i.y})}function Vt(j,A,e){return e.map(({pathSegments:t})=>t.map(r=>{let o=j.convertPointToNode(A,r),n=j.convertPointToNode(A,Ij.calculatedHandleIn(r)),a=j.convertPointToNode(A,Ij.calculatedHandleOut(r)),i=lA.subtract(n,o),s=lA.subtract(a,o);return r.merge({...o,handleOutX:s.x,handleOutY:s.y,handleInX:i.x,handleInY:i.y})}))}function F$(j,A,e,t){return t.map(({pathSegments:r})=>r.map(o=>{let n={x:o.x,y:o.y},a=j.convertPointFromNodeToDescendant(A,e,n),i=j.convertPointFromNodeToDescendant(A,e,Ij.calculatedHandleIn(o)),s=j.convertPointFromNodeToDescendant(A,e,Ij.calculatedHandleOut(o)),l=lA.subtract(i,a),c=lA.subtract(s,a);return o.merge({...a,handleOutX:c.x,handleOutY:c.y,handleInX:l.x,handleInY:l.y})}))}function _c(j,A){return A.map(({pathSegments:e})=>e.map(t=>{let r=Sj.convertPoint(j,t),o=Sj.convertPoint(j,Ij.calculatedHandleIn(t)),n=Sj.convertPoint(j,Ij.calculatedHandleOut(t)),a=lA.subtract(o,r),i=lA.subtract(n,r);return t.merge({...r,handleOutX:i.x,handleOutY:i.y,handleInX:a.x,handleInY:a.y})}))}function wI(j,A,e){let t=A.updateForPath(e);j.tree.current(A)?.set(t)}function Gq(j,A,e,t,r){let o=j.getParent(e.id),n=e.updateForPath(t);A.createPath(o?o.id:Bj,{...n,id:r,rotation:e.rotation,...G$(e)})}function Sq(j,A,e){if(e===0)return A;let t=[],r=OI(A),o=Object.keys(r);for(let n=0,a=o.length;n<a;n++){let i=o[n],s=[],l=j.getNode(i),c=r[i],u=l.pathSegments.length;for(let p=0,f=c.length;p<f;p++){let E=c[p];s.push(E);let F=E+1;F===u?s.push(0):s.push(F)}for(let p=0,f=s.length;p<f;p++){let E=s[p];t.push({id:l.id,index:E})}}return t}function yq(j,A,e){for(let t of j)if(t.id===A&&t.index===e)return!0;return!1}function Cq(j,A,e,t,r,o){let n=zn(j,r,r),a=Vt(j,e,n)[0],i=!Kj.isLastSegment(e.pathSegments,e.pathClosed,t.index),s=Kj.isLastSegment(r.pathSegments,r.pathClosed,o.index);(!i&&s||i&&!s)&&(a=Kj.reverse(a));let c;i?c=_e.unshift(e.pathSegments,...a):c=_e.push(e.pathSegments,...a),A.deleteNode(r.id),wI(A,e,{pathSegments:c})}function LI(j,A,e){let t=au(j,A);if(e===0){if(t)return lA.subtract(A,j);if(j.handleOutX!==0||j.handleOutY!==0){let o=Ij.calculatedHandleOut(j);return lA.subtract(o,j)}let r=Ij.calculatedHandleIn(A);return lA.subtract(r,j)}else{if(t)return lA.subtract(j,A);if(A.handleInX!==0||A.handleInY!==0){let o=Ij.calculatedHandleIn(A);return lA.subtract(o,A)}let r=Ij.calculatedHandleOut(j);return lA.subtract(r,A)}}function bq(j,A){let e=j.getNode(A.id);if(!e)return null;let t=e.pathSegments[A.segmentIndex],r=e.pathSegments[A.segmentIndex+1];if(!t||!r)return null;let o=vc(j,e,t),n=vc(j,e,r),i=A.projectedTime<.5?Ij.point(o):Ij.point(n),s=LI(o,n,0);return R7(i,lA.add(i,s))}var qI=15;function vq(j,A,e,t){let r=5/t,o=qI/t,n=A.cache.canvasRect;if(n&&(n.x-e.x>r||n.y-e.y>r||e.x-(n.x+n.width)>r||e.y-(n.y+n.height)>r))return null;let a=Kj.toBezierJS(A,A),i=j.convertPointToNode(A,e),s=-1,l=1/0,c=0;for(let F=0,h=a.length;F<h;F++){let v=a[F].project(i),P=v.d,T=v.t;P>=l||T===0||T===1||(l=P,s=F,c=T)}if(s===-1)return null;let u=a[s],p=u.get(c),f=u.get(.5),E=lA.distance(i,f)<o;return{id:A.id,segmentIndex:s,distance:l,projectedPoint:p,projectedTime:c,midPoint:f,midPointInRange:E}}function G$(j){return{strokeEnabled:j.strokeEnabled,strokeAlignment:j.strokeAlignment,strokeWidth:j.strokeWidth,strokeColor:j.strokeColor,lineJoin:j.lineJoin,lineCap:j.lineCap,strokeMiterLimit:j.strokeMiterLimit,strokeDashArray:j.strokeDashArray,strokeDashOffset:j.strokeDashOffset,fillEnabled:j.fillEnabled,fillType:j.fillType,fillColor:j.fillColor,fillLinearGradient:j.fillLinearGradient,fillRadialGradient:j.fillRadialGradient,fillImage:j.fillImage,fillImageResize:j.fillImageResize,fillImageOriginalName:j.fillImageOriginalName,fillImagePixelWidth:j.fillImagePixelWidth,fillImagePixelHeight:j.fillImagePixelHeight,fillImagePositionX:j.fillImagePositionX,fillImagePositionY:j.fillImagePositionY,fillImageTileSize:j.fillImageTileSize,boxShadows:j.boxShadows,opacity:j.opacity}}function S$(j,A){let e=j.getRect(A),t={width:e.width,height:e.height};if(!pA(A)||!he(A))return t;let r=lo(A);if(r.perSide)r.top&&(t.height-=r.top),r.bottom&&(t.height-=r.bottom),r.right&&(t.width-=r.right),r.left&&(t.width-=r.left);else if(r.top){let o=r.top*2;t.width-=o,t.height-=o}return t.width=Math.max(1,t.width),t.height=Math.max(1,t.height),t}function Yq(j,A,e,t){j.getNodesWithTrait(e,ej).forEach(o=>{let{descendantPaths:n}=Wn(A,o,!0,e),a=n.valueSeq().toArray(),i=Kj.boundingBox(a),s={...i};t==="horizontal"?(s.x=i.x+i.width,s.width=-i.width):(s.y=i.y+i.height,s.height=-i.height);let l=s.width>-1&&s.width<1?1:s.width,c=s.height>-1&&s.height<1?1:s.height,u=[i.x,i.x+i.width],p=[s.x,s.x+l],f=[i.y,i.y+i.height],E=[s.y,s.y+c],F=l/i.width,h=c/i.height;n.forEach((S,v)=>{let P=S.pathSegments.map(J=>J.merge({x:Mj(J.x,u,p,!1),y:Mj(J.y,f,E,!1),handleOutX:J.handleOutX*F,handleOutY:J.handleOutY*h,handleInX:J.handleInX*F,handleInY:J.handleInY*h}));$(A.tree===j);let T=j.get(v);if(!T)return;let N={pathSegments:P,pathClosed:T.pathClosed},H={pathSegments:Vt(j,T,[N])[0],pathClosed:T.pathClosed},Z=T.updateForPath(H);T.set(Z)})})}function Zq(j,A,e){let{tree:t}=j;A.forEach(r=>{let o=t.getRect(r),n=e(o);if(n.width&&n.width<1&&(n.width=1),n.height&&n.height<1&&(n.height=1),RA(r))VI(j,r,n);else if(xt(r))KI(j,r,n);else{let a=t.getParent(r.id),i=a?S$(t,a):null,s=r.updateForSize(n,i?{sizing:i,positioning:i,viewport:r.cache.viewportRect,layout:Ne(a)}:null);t.current(r)?.set(s)}})}function VI(j,A,e){let{tree:t}=j,r=t.getParent(A.id),o=r?t.getRect(r):null,n=A.updateForSize(e,o?{sizing:o,positioning:o,viewport:null,layout:Ne(r)}:null);n.sizeToFit=!1,t.current(A)?.set(n)}function KI(j,A,e){let{tree:t}=j,r=t.getRect(A),o=Xi.update(r,e,ro(A)?Y(A.aspectRatio):!1),n={...r,...o},a=n.width>-1&&n.width<1?1:n.width,i=n.height>-1&&n.height<1?1:n.height,s=[r.x,r.x+r.width],l=[n.x,n.x+a],c=[r.y,r.y+r.height],u=[n.y,n.y+i],p=a/r.width,f=i/r.height,{descendantPaths:E,descendantBasicShapes:F}=Wn(j,A);E.forEach((h,S)=>{let P=Vt(t,A,[h])[0].map(J=>J.merge({x:Mj(J.x+r.x,s,l,!1)-r.x,y:Mj(J.y+r.y,c,u,!1)-r.y,handleOutX:J.handleOutX*p,handleOutY:J.handleOutY*f,handleInX:J.handleInX*p,handleInY:J.handleInY*f})),T=zn(t,A,{pathSegments:P,pathClosed:!0});$(j.tree===t);let N=t.get(S);if(!N)return;let H={pathSegments:Vt(t,N,T)[0],pathClosed:N.pathClosed},Z=N.updateForPath(H);N.set(Z)}),F.forEach((h,S)=>{if(h===null)return;let T=h.map(jA=>t.convertPointToNode(A,jA)).map(jA=>({x:Mj(jA.x+r.x,s,l,!1)-r.x,y:Mj(jA.y+r.y,c,u,!1)-r.y})).map(jA=>t.convertPointToCanvas(A,jA)),N=t.get(S);if(!N)return;let Q=T.map(jA=>t.convertPointToNode(N,jA)),H=q.boundingRectFromPoints(Q),Z=q.center(H),J=ga(N,Z),AA={x:J.x-H.width/2,y:J.y-H.height/2,width:H.width,height:H.height};N.set(AA)})}function y$(j,A,e,t,r,o){let{tree:n}=j,a=n.getNode(A.id),i=o.width>-1&&o.width<1?1:o.width,s=o.height>-1&&o.height<1?1:o.height,l=i/r.width,c=s/r.height;e.forEach((u,p)=>{let f=n.getNode(p);if(!f)return;let F={pathSegments:u.pathSegments.map(P=>P.merge({x:P.x*l,y:P.y*c,handleOutX:P.handleOutX*l,handleOutY:P.handleOutY*c,handleInX:P.handleInX*l,handleInY:P.handleInY*c})),pathClosed:u.pathClosed},S={pathSegments:F$(n,a,f,[F])[0],pathClosed:f.pathClosed},v=f.updateForPath(S);f.set(v)}),t.forEach((u,p)=>{if(u===null)return;let f=u.map(S=>({x:S.x*l,y:S.y*c})),E=n.getNode(p),F=f.map(S=>n.convertPointFromNodeToDescendant(a,E,S,!1)),h=q.boundingRectFromPoints(F);j.tree.get(p)?.set(h)})}function C$(j,A,e,t,r,o=n=>n.canvasMatrix()){let n=t.width>-1&&t.width<1?1:t.width,a=t.height>-1&&t.height<1?1:t.height,i=[e.x,e.x+e.width],s=[t.x,t.x+n],l=[e.y,e.y+e.height],c=[t.y,t.y+a],u=n/e.width,p=a/e.height,f=r?{x:0,y:0}:A.rect;A.descendantPaths&&A.descendantPaths.forEach((E,F)=>{let S=(r?E.pathSegments:_c(A.canvasMatrix.inverse(),[E])[0]??[]).map(H=>H.merge({x:Mj(H.x+f.x,i,s,!1)-f.x,y:Mj(H.y+f.y,l,c,!1)-f.y,handleOutX:H.handleOutX*u,handleOutY:H.handleOutY*p,handleInX:H.handleInX*u,handleInY:H.handleInY*p})),v=r?{pathSegments:S,pathClosed:E.pathClosed}:{pathSegments:_c(A.canvasMatrix,[{pathSegments:S,pathClosed:E.pathClosed}])[0]??[],pathClosed:E.pathClosed},P=j.get(F);if(!P)return;let N={pathSegments:Vt(j,P,[v])[0],pathClosed:P.pathClosed},Q=P.updateForPath(N);P.set(Q)}),A.descendantBasicShapes&&A.descendantBasicShapes.forEach((E,F)=>{if(E===null)return;let S=(r?E:E.map(J=>Sj.convertPoint(A.canvasMatrix.inverse(),J))).map(J=>({x:Mj(J.x+f.x,i,s,!1)-f.x,y:Mj(J.y+f.y,l,c,!1)-f.y})),v=r?S:S.map(J=>Sj.convertPoint(A.canvasMatrix,J)),P=j.get(F);if(!P)return;let T=v.map(J=>Sj.convertPoint(o(P).inverse(),J)),N=q.boundingRectFromPoints(T),Q=q.center(N),H=ga(P,Q),Z={x:G6(H.x-N.width/2),y:G6(H.y-N.height/2),width:N.width,height:N.height};P.set(Z)})}function v$(j,A,e,t,r){if(e!==1)for(let[o]of t.parentsInitialState){let n=t.parentsInitialState.get(o);if(!n)continue;let a=[];for(let i of A)n.selectedNodeIds.has(i.id)&&a.push(i);P$(a,e,UI(j,o,e,t,r),!0)}}function T$(j,A){let e=new Map,t=new Map,r={},o=new Set;for(let n of j.tree.withoutDescendants(A)){let a=n.parentid;if(!a)continue;let i=j.tree.getNode(a);$(i,"Parent must exist"),JI(j,n,t,o),QI(j,n,i,e),r[a]??=[],r[a].push(n)}for(let[n,a]of e){let i=r[n];$(i,"Nodes must exist"),a.selectionBoundingFrame=j.tree.getBoundingFrameForNodes(i)}return{parentsInitialState:e,nodesInitialState:t,nonScalableNodes:o}}function JI(j,A,e,t){for(let{node:r,skipChildren:o}of A.walkWithSkipChildren()){if(e.has(r.id))continue;let n=r.id===A.id,a=j.tree.isInlineVectorNode(r),i=ej(r)&&(a||n);if(!oF(r,n)){t.add(r.id),o();continue}let s=i?Wn(j,r):void 0,l=RA(r)?I$(j,r):void 0,c=RA(r)||i?$$(r.draftOrCurrent()):void 0,u=W(r)?HI(r):void 0;e.set(r.id,{rect:q.round(j.tree.getRect(r,!1),2),matrix:j.tree.transformMatrixToNode(r),codeComponentControlProps:u,scalableShapeStylesMap:c,...s,...l}),RA(r)&&o()}}function HI(j){let A=L.reactComponentForIdentifier(j.codeComponentIdentifier);if(!(!A||!A.properties))return j.getControlProps(A.properties)}function QI(j,A,e,t){let r=t.get(e.id)??{matrix:j.tree.transformMatrixToNode(e).invertSelf(),selectedNodeIds:new Set,selectionBoundingFrame:{x:0,y:0,width:0,height:0}};r.selectedNodeIds.add(A.id),t.set(e.id,r)}function UI(j,A,e,t,r){let o=t.parentsInitialState.get(A);$(o,"Parent must be present in initial state");let n=o.selectionBoundingFrame,a={...n,width:n.width*e,height:n.height*e};return{initialRect:n,resizedRect:a,engine:j,tree:j.tree,initialState:t,anchorPoint:r??{x:.5,y:.5}}}function P$(j,A,e,t){if(j.length===0)return!1;let r=!1;for(let o of j){if(e.initialState.nonScalableNodes.has(o.id))continue;let n=nF(o)&&P$(o.children,A,e,!1),a=WI(o,e,A,n,t);r||=a||n}return r}function WI(j,A,e,t,r){let o=tF(j,e,r),n=zI(j,A,e,t,r,o);return j.set(o),(n||t)&&ZI(j,A,e,r),n}function zI(j,A,e,t,r,o){return QA(j)?XI(j,e,A,r,o):RA(j)?YI(j,e,A,r,o):ej(j)?iF(j,e,A):W(j)?aF(j,e,A,r,o):oj(j)?M$(j,e,A,t,r,o):!1}function XI(j,A,e,t,r){let o=!1;if(!j.textFitViewBoxSize){rF(j,e.tree);let n=j.draftOrCurrent().updateForScale(A);Object.assign(r,n),o=!0}return j.widthType!==2&&(o=bo("width",j,A,e,!1,t,r)||o),j.heightType!==2&&(o=bo("height",j,A,e,!1,t,r)||o),o}function YI(j,A,e,t,r){let o=e.initialState.nodesInitialState.get(j.id),n=o?.shapeContainerDescendantPaths,a=o?.shapeContainerDescendantBasicShapes,i=o?.scalableShapeStylesMap;return $(i,"Shape container styles should be available in initial state"),$(n,"Shape container paths should be available in initial state"),$(a,"Shape container shapes should be available in initial state"),y$(e.engine,j,n,a,j,{width:j.width*A,height:j.height*A}),Cc(e.tree,i,A),bo("width",j,A,e,!0,t,r),bo("height",j,A,e,!0,t,r),!0}function ZI(j,A,e,t){if(t)AF(j,e,A);else if($A(j)){let r={};j.left&&(r.left=tA(j.left,e)),j.right&&(r.right=tA(j.right,e)),j.top&&(r.top=tA(j.top,e)),j.bottom&&(r.bottom=tA(j.bottom,e)),j.set(r)}}function AF(j,A,e){if(!$A(j)&&!Ga(j))return;let t=e.initialState.nodesInitialState.get(j.id);$(t,"Node must be present in initial state");let r=j.parentid?e.initialState.parentsInitialState.get(j.parentid):void 0;$(r,"Node parent must be present in the initial state"),r.selectedNodeIds.size===1?jF(j,A,e,t):eF(j,e,t,r)}function jF(j,A,e,t){let r=t.rect,o={...r,width:r.width*A,height:r.height*A},a=ej(j)||RA(j)?j.clone({rotation:0}):j,i=Ts(r,e.anchorPoint),s=Ts(o,e.anchorPoint),l=Sj.convertPoint(a.originAdjustedMatrix(null,r),i),c=Sj.convertPoint(a.originAdjustedMatrix(null,o),s),u=lA.subtract(l,c),p=q.round(q.offset(o,u),2);if($A(j)){let{widthType:f,heightType:E,maxHeight:F,minHeight:h,maxWidth:S,minWidth:v,...P}=ul(j.constraints(),p,e.tree.getParentSizeInfo(j,e.tree.getParent(j.id)),null,!1);j.set(P)}else j.set({x:p.x,y:p.y})}function eF(j,A,e,t){let r=lA.add(Ts(A.initialRect,A.anchorPoint),A.initialRect),o=lA.add(Ts(A.resizedRect,A.anchorPoint),A.resizedRect),n=lA.subtract(r,o),a=t.matrix??null,i=b$(a,A.initialRect),s=b$(a,q.offset(A.resizedRect,n)),l=[i.x,i.x+i.width],c=[s.x,s.x+s.width],u=[i.y,i.y+i.height],p=[s.y,s.y+s.height],f=e.rect,E={x:Mj(f.x,l,c,!1),y:Mj(f.y,u,p,!1)},F={x:Mj(f.x+f.width,l,c,!1),y:Mj(f.y+f.height,u,p,!1)},h=q.round(q.fromTwoPoints(E,F));if($A(j)){let S=ul(j.constraints(),h,A.tree.getParentSizeInfo(j,A.tree.getParent(j.id)),null,!1);delete S.widthType,delete S.heightType,j.set(S)}else j.set({x:h.x,y:h.y})}function b$(j,A){if(!j)return A;let e=Sj.convertPointsWithClipping(j,q.cornerPoints(A));return q.boundingRectFromPoints(e)}function tF(j,A,e){let t={};return ct(j)&&(t.borderWidth=tA(j.borderWidth,A),t.borderBottom=tA(j.borderBottom,A),t.borderLeft=tA(j.borderLeft,A),t.borderTop=tA(j.borderTop,A),t.borderRight=tA(j.borderRight,A)),sr(j)&&(t.boxShadows=D$(j.boxShadows,A)),Ee(j)&&(t.strokeWidth=tA(j.strokeWidth,A)),jt(j)&&(t.padding=tA(j.padding,A),t.paddingBottom=tA(j.paddingBottom,A),t.paddingLeft=tA(j.paddingLeft,A),t.paddingTop=tA(j.paddingTop,A),t.paddingRight=tA(j.paddingRight,A)),ir(j)&&(t.radiusBottomLeft=tA(j.radiusBottomLeft,A),t.radiusBottomRight=tA(j.radiusBottomRight,A),t.radiusTopLeft=tA(j.radiusTopLeft,A),t.radiusTopRight=tA(j.radiusTopRight,A)),Ot(j)&&(t.radius=tA(j.radius,A)),Vi(j)&&(t.gridColumnMinWidth=tA(j.gridColumnMinWidth,A),t.gridColumnWidth=tA(j.gridColumnWidth,A),j.gridRowHeightType==="fixed"&&(t.gridRowHeight=tA(j.gridRowHeight,A))),he(j)&&(t.gap=_$(j.gap,A)),Sr(j)&&(t.formInputFontSize=N$(j.formInputFontSize,A),j.formInputFontLetterSpacingUnit==="px"&&(t.formInputFontLetterSpacing=tA(j.formInputFontLetterSpacing,A)),j.formInputFontLineHeightUnit==="px"&&(t.formInputFontLineHeight=tA(j.formInputFontLineHeight,A))),Gn(j)&&(t.blur=tA(j.blur,A,0),t.backgroundBlur=tA(j.backgroundBlur,A,0)),Ge(j)&&j.fillType==="image"&&j.fillImageResize==="tile"&&(t.fillImageTileSize=tA(j.fillImageTileSize??1,A)),oo(j)&&(t.minWidth=vs(j.minWidth,A,e),t.maxWidth=vs(j.maxWidth,A,e),t.minHeight=vs(j.minHeight,A,e),t.maxHeight=vs(j.maxHeight,A,e)),t}function M$(j,A,e,t,r,o){if(!Fe(j))return o.width=tA(j.width,A),o.height=tA(j.height,A),!0;let n=!1;return n=bo("width",j,A,e,t,r,o)||n,n=bo("height",j,A,e,t,r,o)||n,n}function rF(j,A){let e=j.getTextStylePresets(!1);for(let t of e){let r=A.getNode(t);It(r)&&j.draftOrCurrent().detachTextStylePreset(r,!1)}}function bo(j,A,e,t,r,o,n){let a=j==="width"?"widthType":"heightType",i=A[a],s=t.initialState.nodesInitialState.get(A.id)?.rect;$(s,"node should have cached rect");let l=j==="width"?"gridItemFillCellWidth":"gridItemFillCellHeight";if(cr(A)&&A[l]&&o)return n[l]=!1,n[j]=tA(s[j],e),n[a]=0,!0;switch(i){case 0:return n[j]=tA(A[j],e),!0;case 4:return n[j]=tA(A[j],e,4),!0;case 1:return o?(n[j]=tA(A[j],e,4),!0):!1;case 3:return o?(n[j]=tA(s[j],e),n[a]=0,!0):!1;case 2:if(!r){let u=t.tree.getNodeParent(A),f=(u&&De(u)?u.layout:void 0)==="grid"?s[j]:A[j];return n[j]=tA(f,e),n[a]=0,!0}return!1;case 5:return!0;default:iA(i)}}function oF(j,A){let e=W(j)?j.getSupportedLayout(L):void 0;return!(e?.width==="auto"&&e?.height==="auto"||IA(j)||je(j)&&!A)}function nF(j){return!(!j.children||RA(j)||ej(j))}function tA(j,A,e=2){return Y(j)?dj(j*A,e):j}function _$(j,A){return Y(j)?tA(j,A):_(j)?Zi(j,e=>tA(e,A)):j}function vs(j,A,e){if(sA(j))return j;let[t,r]=fp(j);return Number.isNaN(t)||r==="%"&&!e?j:yt(tA(t,A,0),r)}function D$(j,A){if(!(!j||qA(j)))return j.map(e=>e.type==="realistic"?e:ta(e,{x:tA(e.x,A),y:tA(e.y,A),spread:tA(e.spread,A)}))}function iF(j,A,e){let t=e.initialState.nodesInitialState.get(j.id);return t?(C$(e.tree,{canvasMatrix:t.matrix,rect:t.rect,descendantPaths:t.descendantPaths,descendantBasicShapes:t.descendantBasicShapes},e.initialRect,e.resizedRect,!0,r=>{let o=e.initialState.nodesInitialState.get(r.id);return $(o,"Basic shape initial state must exist"),o.matrix}),t.scalableShapeStylesMap&&Cc(e.tree,t.scalableShapeStylesMap,A),!0):!1}function Ts(j,A){return{x:j.width*A.x,y:j.height*A.y}}function aF(j,A,e,t,r){let o=oj(j)?M$(j,A,e,!1,t,r):!1,n=e.initialState.nodesInitialState.get(j.id)?.codeComponentControlProps;if(!n)return o;for(let a in n){let i=n[a];if(!(!i||qA(i.value)))switch(i.type){case"borderradius":r[VA(a)]={...i,value:lF(i.value,A)};break;case"padding":r[VA(a)]={...i,value:cF(i.value,A)};break;case"gap":r[VA(a)]={...i,value:_$(i.value,A)};break;case"boxshadow":r[VA(a)]={...i,value:D$(i.value,A)};break;case"font":r[VA(a)]={...i,value:uF(i.value,A)};break;case"border":r[VA(a)]={...i,value:pF(i.value,A)};break;case"array":case"boolean":case"collectionreference":case"color":case"slot":case"cursor":case"customcursor":case"date":case"enum":case"eventhandler":case"file":case"link":case"linkrelvalues":case"multicollectionreference":case"number":case"object":case"pagescope":case"richtext":case"scrollsectionref":case"string":case"transition":case"fusednumber":case"image":case"trackingid":case"vectorsetitem":break;default:iA(i)}}return o}function sF(j){return j.includes("%")}function lF(j,A){return qA(j)||sF(j)?j:Zi(j,e=>tA(e,A))}function cF(j,A){return qA(j)?j:Zi(j,e=>tA(e,A))}var dF={px:2,rem:3};function N$(j,A){if(sA(j))return j;let[e,t]=Y(j)?[j,"px"]:Yi(j);return yt(tA(e,A,dF[t]),t)}function uF(j,A){if(sA(j))return j;let e=N$(j.fontSize,A);return{...j,fontSize:e,lineHeight:j.lineHeight?.[1]==="px"?[tA(j.lineHeight[0],A),"px"]:j.lineHeight,letterSpacing:j.letterSpacing?.[1]==="px"?[tA(j.letterSpacing[0],A),"px"]:j.letterSpacing}}function pF(j,A){return!j||aA(j)?j:{...j,borderWidth:tA(j.borderWidth,A),borderTop:tA(j.borderTop,A),borderRight:tA(j.borderRight,A),borderBottom:tA(j.borderBottom,A),borderLeft:tA(j.borderLeft,A)}}var Oc;(Et=>{function j(d){return d.some(m=>V$(m))}Et.canCopyNodes=j;function A(d){return d.some(m=>x$(m))}Et.canDuplicateNodes=A;function e(d,m){return j(m)&&a(d,m)}Et.canCutNodes=e;function t(d,m,k=void 0,B=!0){let{documentSettingsStore:R,codeGenerationStore:G,modalStore:y,canvasStore:b,scopeStore:C,treeStore:D}=d.stores,M=D.tree,O=M.withoutDescendants(M.getNodes(m)),fA=C.active,dA=O.length===1?O[0]:void 0;if(!sA(dA)&&sa(dA)&&!IA(dA)&&pA(dA)&&eA(fA)){let cA=M.getRect(dA),lj=Mn(M,fA,dA,cA),qj=Et.createVariant(d.stores,fA,dA,lj);return qj?new Set([qj.id]):void 0}let LA=O.find(cA=>IA(cA));if(LA){let cA=D.tree.getScopeNodeFor(LA);if(cA&&w(cA)){y.set({type:"DuplicateWebPage",source:"context_menu",duplicateFromId:cA.id});return}}let EA=O.map(cA=>M.getRect(cA)),uA=new Map,GA=new Set,rj=[],PA=new Map,SA=new Map,Lj=0;if(O.forEach((cA,lj)=>{if(!x$(cA))return;let qj=M.getParent(cA.id);if(Yo(cA))if(qj&&W(qj)){if(!sp(qj,L))return}else return;for(let XA of cA.walk())pA(XA)&&Lj++;let zA=d.cloneNode(cA,!1,!0,uA);if(uA.set(cA.id,zA.id),SA.set(cA.id,zA.id),GA.add(zA.id),PA.set(cA,zA),cA.isMaster)Xl({});else if(cA.replicaInfo){let{master:XA}=cA.replicaInfo,$j=XA&&M.getNode(XA);$j&&Ho($j)||Xl({})}else P7(cA)&&(!k||k.node&&M7(k.node))&&wf(d,cA,uA);if(k){let XA=M.getParent(cA.id);if(k.node){let $j=k.node;if(hA(k.node)&&($j=Ke(M,k.node),!$j))return;if(Dt(d.tree,$j,zA,C.active.id,L)){let ve=XA&&JA(XA)&&JA($j),Hj=XA&&pA(XA)&&pA($j);if(ve||Hj)d.moveNode(zA.id,$j.id,k.insertionIndex);else if($A(zA)){d.moveNode(zA.id,$j.id,k.insertionIndex);let qr=M.getParentSizeInfo(zA,$j,!0,!1),Ar=zA.updateForSize(EA[lj]??{},qr);XA||(Ar.left=0,Ar.top=0),d.tree.current(zA)?.set(Ar)}else Et.convertNodeToNewParent(d,zA,XA,k.node,k.insertionIndex,cA);if(kj(k.node)){ac(d,zA,k.node,$j,GA,uA);let Te=kA.getReplicaForTemplateNode(M,k.node);if(Te){let qr=ke(Te.id,zA.id);SA.set(cA.id,qr)}}}}else Et.convertNodeToNewParent(d,zA,XA,k.node,k.insertionIndex,cA),JA(XA)&&EA[lj]&&d.tree.current(zA)?.set(zA.updateForSize(EA[lj],null))}}),!k){let cA=O.some(qj=>M.isGroundNode(qj)),lj=O.some(qj=>Nt(qj)&&qj.resolveValue("rotation")!==0);if(O.length){let qj=O.map(Vj=>M.convertFrameToCanvas(Vj)),zA=q.merge(...qj),XA,$j=Q(d,m),ve=H(M,O),Hj=O.some(Vj=>ej(Vj)),Te=R.lastDuplicationMap,qr=!1;if(!Hj&&$j&&!ve&&!lj&&Te){let Vj=Te.keys(),d6=d.tree.getBoundingFrameForNodes(M.getNodes(Vj));qr=!0,XA=lA.subtract(zA,d6)}let Ar=XA||{y:0,x:0},c6=O[0];if(!Hj&&cA&&!qr&&c6){let Vj=Gf(M,C.active,c6,zA,O.every(dt)?{x:d.tree.getRect(c6).width}:XA);Ar=lA.subtract(Vj,zA)}for(let Vj of O){let{x:d6,y:Dh,width:Nh,height:xh}=M.getRect(Vj),Qe=PA.get(Vj);if(!Qe)continue;let Lo=d.tree.getParent(Vj.id),qo=d.tree.getParent(Qe.id);if(qo&&Lo&&kj(Lo)){ac(d,Qe,Lo,qo,GA,uA);let A7=kA.getReplicaForTemplateNode(M,Lo);if(A7){let Lh=ke(A7.id,Qe.id);SA.set(Vj.id,Lh)}}if(qo&&JA(qo))continue;let Yd=d6+Ar.x,Zd=Dh+Ar.y,Oh=d.tree.getParentSizeInfo(Vj,Lo),wh=Qe.updateForRect({rect:{x:ej(Vj)?Yd:Math.round(Yd),y:ej(Vj)?Zd:Math.round(Zd),width:Nh,height:xh},parentSizeInfo:Oh,constraintsLocked:!1,shouldGuessPinToBottom:!0,shouldGuessPinToRight:ee(d.tree,Qe,qo)});d.tree.current(Qe)?.set(wh),cA&&M.isGroundNode(Qe)&&rj.push(Qe.rect())}}}R.lastDuplicationMap=SA;let hj=[];for(let cA of PA.values())be(M,cA,uA,!1),dt(cA)&&hj.push(cA);if(hj.length&&G.createVectorSet(hj),rj.length){let cA=q.merge(...rj);b.scrollToCenter(q.center(cA))}return B&&GA.size>0&&d.stores.selectionStore.set(GA,{sticky:!0}),Lj>0&&mA("layout_frame",{source:"duplication",count:Lj}),GA}Et.duplicateNodes=t;function r(d){if(d.length>=50)return!0;let k=d.length;return d.forEach(B=>{k+=yc(B)}),k>=50}function o(d,m,k){let B=d.tree.withoutDescendants(m);function R(){let G=[],y=[];B.forEach(b=>{if(pe(b))if(fa(d.tree,b))y.push(b);else{let C=d.tree.get(b.originalid);C&&xc(C)&&G.push(C.id)}else xc(b)&&G.push(b.id)}),y.forEach(b=>b.set({visible:!1})),d.deleteNodes(G),d.stores.selectionStore.clear(),d.stores.treeStore.setHighlight(null)}k&&r(B)?d.stores.modalStore.set({type:"Confirmation",variant:"destructive",title:"Delete Selection",description:"You are about to delete the selected layers for all project collaborators.",confirmLabel:"Delete",onConfirm:R,source:"delete_node"}):R()}Et.deleteOrHideNodes=o;function n(d,m){d.tool.deleteAction?d.tool.deleteAction():m&&o(d,m,!0)}Et.deleteAction=n;function a(d,m){return d.tool.deleteAction?!!d.tool.canDelete&&d.tool.canDelete():!!m&&m.some(k=>fF(k))}Et.canDeleteOrHideNodes=a;function i(d,m){return Ze(m)?!1:jj(m)?pe(m):!Ao(m)}Et.canRenameNode=i;function s(d,m){return m.filter(k=>i(d,k)).length===1}Et.canRename=s;function l(d,m){return d.stores.chromeStore.contentPanelTab!=="Pages"||d.stores.scopeStore.active.id===d.tree.root.homePageNodeId||m.length!==0?!1:w(d.stores.scopeStore.active)||fj(d.stores.scopeStore.active)}Et.canRenameActivePage=l;function c(d,m){if(l(d,m)){let k=d.stores.scopeStore.active.id,B=pr(d.tree,k)?.id||k;ts(B)}else m.length===1&&(d.stores.chromeStore.layersExpanded=!0,d.stores.chromeStore.contentPanelTab="Layers",d.scheduler.runBeforeNextFrame(()=>{let k=document.querySelectorAll(".layerPanelPlaceholder.active");if(k.length===1&&k[0]){let B=new MouseEvent("dblclick",{view:window,bubbles:!0,cancelable:!0}),R=k[0].parentElement;R&&R.dispatchEvent(B)}}))}Et.rename=c;async function u(d,m){if(!Qn.isAvailable)return;let k=gA("generateLayerNames");TA({type:"add",key:"generate-layer-names",text:"Snapshotting layer\u2026",variant:"progress",duration:1/0});let B=await Qn.whenAvailable({toastIfNot:!0},d);if(B){let R=await B.getImageData({nodeId:m.id,type:"image/png",pixelRatio:1});k.debug("imageData",R);let G=JSON.stringify(m.toJS()),y="Here is an image and the document structure for a webpage section. Please provide me a nice and short name for every node in this hierarchy to display in the layer panel. Make them specific to their visual content and avoid generic names like 'Frame' or 'Stack'. Also avoid numbering them, as they do not have to be unique.";TA({type:"add",key:"generate-layer-names",text:"Generating layer names\u2026",variant:"progress",duration:1/0});let b=await xf({messages:[{role:"user",content:y},{role:"user",content:R},{role:"user",content:G}],model:"google/gemini-2.0-flash-001",schema:{$schema:"http://json-schema.org/draft-07/schema#",type:"array",items:{type:"object",properties:{nodeId:{type:"string"},name:{type:"string"}},required:["nodeId","name"]}}});TA({type:"add",key:"generate-layer-names",text:"Updating layers\u2026",variant:"progress",duration:1/0}),await d.scheduler.processWhenReadyAsync(()=>{for(let C of b){let{nodeId:D,name:M}=C;if(typeof D!="string"||typeof M!="string")continue;let O=d.tree.get(D);k.debug("nodeId",O,M),O&&O.set({name:M})}}),TA({type:"remove",key:"generate-layer-names"})}}Et.generateLayerNames=u;function p(d,m){let k=d.tree,B=k.withoutDescendants(m),R=Lr(B);S(k,m,R)&&Hd(d,R,"front")}Et.sendToFront=p;function f(d,m){let k=d.tree,B=k.withoutDescendants(m),R=Lr(B);h(k,m,R)&&Hd(d,R,"back")}Et.sendToBack=f;function E(d,m){let k=d.tree,B=k.withoutDescendants(m),R=Lr(B);S(k,m,R)&&Qd(d,R,1)}Et.sendForward=E;function F(d,m){let k=d.tree,B=k.withoutDescendants(m),R=Lr(B);h(k,m,R)&&Qd(d,R,-1)}Et.sendBackward=F;function h(d,m,k){if(Jd(m))return!1;if(!k){let B=d.withoutDescendants(m);k=Lr(B)}return Ud(d,k,-1)}Et.sendBackwardEnabled=h;function S(d,m,k){if(Jd(m))return!1;if(!k){let B=d.withoutDescendants(m);k=Lr(B)}return Ud(d,k,1)}Et.sendForwardEnabled=S;function v(d,m){return nA(d,m,0)}Et.addFrame=v;function P(d,m){return nA(d,m,1)}Et.addStack=P;function T(d,m){let k=d.stores.scopeStore.active,B=d.tree.withoutDescendants(m);return B.length>1&&WA(d,B)&&(!w(k)||B.every(R=>d.tree.isGroundNode(R)))}Et.canWrapInAutoSizedFrame=T;function N(d,m,k){let B=v(d,m);$(B!==void 0,"new frame ID must be defined");let R=d.tree.getNode(B);$(R!==null,"new frame must exist");let G=d.tree.withoutDescendants([R]);return l$(d,G,k),R}Et.wrapInAutoSizedFrame=N;function Q(d,m){let{documentSettingsStore:k,selectionStore:B}=d.stores;if(!k.lastDuplicationMap||!Ln(m,B.ids))return!1;let R=[...k.lastDuplicationMap.values()];if(!Ln(B.ids,R))return!1;let G=[...k.lastDuplicationMap.keys()];return Ln(B.previousIds,G)}function H(d,m){let k=d.getCommonGroundNode(m);return!!k&&JA(k)}function Z(d,m,k){if(k!==null){let B=m.flatMap(b=>d.convertCornerPointsToCanvas(b)),R=d.transformMatrixToNode(k),G=(gl(k)?R:Sj.flatProjectionMatrix(R)).invertSelf(),y=B.map(b=>Sj.convertPoint(G,b));return q.roundToOutside(q.boundingRectFromPoints(y))}return q.roundToOutside(q.merge(...m.map(B=>d.convertFrameToCanvas(B))))}Et.getUntransformedBoundingRect=Z;function J(d,m,k,B,R,G){let y={top:k.y,left:k.x,width:k.width,height:k.height,fillEnabled:!1},b=R.length===1?R[0]:null;$(b!==void 0,"node must be defined",R),B&&Object.assign(y,AA(m,k,B,b,G));let C=B===null,D=w(d.stores.scopeStore.active);return y.overflow=C||D?Oe():"visible",y}function AA(d,m,k,B,R){let G=d.getViewportRect(k),y=d.getRect(k),b=B?d.getParentSizeInfo(B,k):{sizing:y,positioning:y,viewport:G,layout:Ne(k)},C=!!B&&$A(B),D=jA(B,R),M=Xp({rect:m,parentSizeInfo:b,currentConstraints:D,constraintsLocked:C,shouldGuessPinToBottom:pt(d,null,k),shouldGuessPinToRight:ee(d,null,k),floatingPosition:null});return R&&k?{...so(B,k),...x(B),...M,widthType:he(k)?3:1,heightType:2,width:1,left:0}:{...so(B,k),...x(B),...M}}function jA(d,m){let B=!!d&&$A(d)?d.constraints():void 0;if(!B)return;let R={...B};return m?(R.widthType===5&&(R.widthType=2),R.heightType===5&&(R.heightType=2)):(Jo(R.widthType)&&(R.widthType=0),Jo(R.heightType)&&(R.heightType=0)),R}function x(d){if(!(!d||!oj(d)))return{width:d.width,height:d.height}}function z(d,m,k,B,R,G,y,b,C){let D=G?.id??Bj;switch(m){case 0:{let M=d.createFrame(D,{id:k,...C},B);return d.moveNode(M.id,D,y),$(M&&vA(M),"Fail to create a wrapping frame: the created frame should have the `children` field"),b.forEach(O=>{let fA=wo(d.tree,O,G,M);d.moveNode(O.id,M.id),d.tree.current(O)?.set(fA)}),M}case 1:{let M=K(d,k,D,C,b,R);return d.moveNode(M.id,D,y),M}case 2:{let M=d.createShapeContainer(D,{id:k,...C});return d.moveNode(M.id,D,y),$(M&&vA(M),"Fail to create a wrapping frame: the created frame should have the `children` field"),b.forEach(O=>{let fA=wo(d.tree,O,G,M);d.moveNode(O.id,M.id),d.tree.current(O)?.set(fA)}),M}default:iA(m)}}function K(d,m,k,B,R,G,y){let b=pc(d,R,G),C=d.createNode(ye,{id:m,...B,...b},k,y);$(Re(C),"Fail to create stack: the created node should have stack layout");let{stackDirection:D}=b;return lE(d,m,G,R,D),C}function nA(d,m,k){let B=d.tree;if(!WA(d,m))return;let R=B.sortVisually(B.withoutDescendants(m)),G=R[0]?B.getParent(R[0].id):null,y=G&&kj(G),b=y?d.tree.getNode(G.originalid):G,C=!0,D=y?R.map(uA=>{if(!jj(uA))return uA;let GA=d.tree.getNode(uA.originalid);return $(GA,"Fail to create a wrapping frame: the original node must exist"),C&&(C=!GA.cache.visible),GA}):R,M=G?.children.findIndex(uA=>R.includes(uA))??-1,O=B.newId(),fA=Z(B,D,b),dA=J(d,B,fA,b,D,k===1),LA=z(d,k,O,D[0]?.id,fA,b,M,D,dA),EA=O;if(y){$(G,"Fail to create a wrapping frame: parentNode should not be null"),$(hA(G),"Fail to create a wrapping frame: parentNode should be a replica node"),C&&xn(d,LA,G,b);let uA=kA.getReplicaForTemplateNode(d.tree,G);$(uA,"Fail to create a wrapping frame: replica must exist");let GA=Z(B,R,G),rj=J(d,B,GA,G,R,k===1);bn(B,uA,LA.id,rj),kA.replicaWithChanges(d.tree,uA.draftOrCurrent());let PA=ke(uA.id,O);EA=PA;let SA=d.tree.get(PA);if($(SA&&vA(SA),"Fail to create a wrapping frame: replica wrapping node should exist and should have the `children` field"),k===0||k===2)R.forEach(Lj=>{let hj=wo(B,Lj,G,SA);d.tree.current(Lj)?.set(hj)});else if(k===1){$(pA(LA),"Fail to create a wrapping frame: the wrapping node should be a FrameNode"),$(Re(LA),"Fail to create a wrapping frame: the wrapping node should have stack layout");let Lj=pc(d,R,GA);bn(B,uA,LA.id,Lj),aE(d,LA,Lj.stackDirection,R,GA)}}return d.stores.selectionStore.set(EA),O}function BA(d){return nn(d)||MA(d)||Fj(d)||zi(d)||Ze(d)||Yo(d)?!1:jj(d)?pe(d):!0}function WA(d,m){if(m.length===0)return!1;switch(d.tool.enum){case 0:case 1:case 6:break;default:return!1}if(!m.every(y=>BA(y)))return!1;let k=d.tree,B=k.withoutDescendants(m),[R,G]=B.reduce(([y,b],C)=>{let D=k.isInlineVectorNode(C)||!ej(C)&&!Fj(C),M=B[0]?k.getParentId(B[0]):void 0,O=k.getParentId(C);return[y&&M===O,b&&D]},[!0,!0]);return R&&G}Et.wrappingEnabled=WA;function HA(d){return d.some(rt)}Et.overflowEnabled=HA;function vj(d){d.stores.chromeStore.removePanelOverrides(),d.stores.chromeStore.chromeIsVisible=!0,d.stores.chromeStore.pagesExpanded=!0,d.stores.chromeStore.contentPanelTab="Pages";let m=new Set(d.stores.scopeStore.getDesignPageNodes().map(B=>B.name??"")),k=d.createNode(Nk,{name:Cj("Design",m,{startIndex:m.size+1,omitCountIfFirst:!0})},d.tree.root.id);return d.stores.scopeStore.select(k.id,{keepHistory:!1}),d.scheduler.runAtEndOfFrame(()=>ts(k.id)),k.id}Et.createDesignPage=vj;function sj(d){d.stores.chromeStore.removePanelOverrides(),d.stores.chromeStore.chromeIsVisible=!0,d.stores.chromeStore.pagesExpanded=!0,d.stores.chromeStore.contentPanelTab="Pages";let m=new Set(d.stores.scopeStore.getCanvasPageNodes().map(G=>G.name??"")),k=d.createNode(Jp,{name:Cj("Canvas",m,{startIndex:m.size+1,omitCountIfFirst:!1})},d.tree.root.id),B=Jk("iPhone_390_844"),R=d.createFrame(k.id,{width:B.screenWidth,height:B.screenHeight,name:B.title,framePreset:B.id,isScreen:!0});d.stores.codeGenerationStore.updateComponent(R.id).catch(yA),d.stores.scopeStore.select(k.id,{keepHistory:!1}),mf({pageId:k.id}),d.scheduler.runAtEndOfFrame(()=>ts(k.id))}Et.createCanvasPage=sj,Et.toggleContentManagementScope=d=>{let{chromeStore:m,selectionStore:k,scopeStore:B,analyticsStore:R,siteSettingsStore:G,codeEditorStore:y}=d.stores,b=m.mainView;if(b===2){B.selectPreviousActiveScope();return}switch(b){case 0:d.cancelTool();break;case 5:m.setLocalizationsVisible(!1);break;case 6:R.close();break;case 4:G.close();break;case 1:y.closeEditor();break;case 3:break;default:iA(b)}let C=d.tree.getContentManagementNode()?.loaded;if(C&&C.children.length>0){let D=B.active,M=k.nodes.at(0);B.select(C.id,{keepHistory:!1});let O=EF(d,D,M);if(O){k.set(O);return}if(k.ids.length===0){let fA=C.children[0];fA&&k.set(fA.id)}}else m.toggleContentManagementSidebar()};function ie(d,m){d.stores.chromeStore.chromeIsVisible=!0,d.stores.scopeStore.select(un,{keepHistory:!1}),d.stores.selectionStore.set(m)}Et.openContentCollection=ie;function ae(d,m,k,B){d.stores.modalStore.set({type:"CreateComponent",source:m,onSuccess:R=>{if(Dj(R.name)||Dj(d.tree.getEntityRootNode()))return;let G=ns(d.tree,R.name,k??mn);Cr(d.tree,G,R.id),B?.(R)}})}Et.makeComponent=ae;function Zt(d,m){return Mh(d,m)}Et.canMakeComponent=Zt;function Ii(d,m){if(m.length!==1||lr(d.stores.scopeStore.active))return;let k=m[0];k&&wi(k)&&kA.canMakeMaster(k)&&d.tree.current(k)?.set({isMaster:!0,replicaInfo:null,originalid:null})}Et.makeMaster=Ii;function s6(d,m){for(let k of m)if(k.originalid&&hA(k)&&kA.overrideKeys(d,[k]).size>0)return!0;return!1}Et.canResetToMasterValues=s6;function Nd(d,m){for(let k of m){if(!k.originalid)continue;let R=kA.getReplicaForTemplateNode(d,k);R&&kA.resetOverrides(d,R,k)}}Et.resetToMasterValues=Nd;function xd(d,m,k){for(let B of m){if(!hA(B))continue;let R=kA.getReplicaForTemplateNode(d,B);R&&kA.resetOverridesByProperty(d,R,B,k)}}Et.resetPropertiesToMasterValues=xd;function Od(d,m){if(m.length===0)return!1;for(let k of m){if(pj(k))return!1;if(sa(k)){let B=d.tree.getScopeNodeFor(k);if(!B)return!1;if(eA(B)){let{hover:R,pressed:G}=B.getGesturesForTopLevelVariant(k);return!(R||G)}return w(B)&&!IA(k)}if(aj(k))return!0}return!1}Et.canDetachFromMaster=Od;function l6(d,m){let k=new Map;m.filter(aj).forEach(R=>{if(!bs(R,{allowVariants:!0}))return;let G=R.clone({parentid:null});G.replicaInfo=null,Nu(G)&&(G.isVariant=void 0);for(let C of G.walk())C.originalid=null;$(R.id!==G.id),d.tree.insertNode(G);let y=d.tree.getParent(R.id)||d.stores.scopeStore.active,b=y.children.indexOf(R);d.tree.removeNode(R),d.moveNode(G.id,y.id,b),d.tree.current(G)?.set(G.constraintValues()),k.set(R.id,G.id)}),be(d.tree,d.tree.root,k,!1);let B=d.stores.selectionStore.ids.map(R=>k.get(R)??R);return d.stores.selectionStore.set(B),k}Et.detachFromMaster=l6;function Fi(d,m){if(!Gi(m))return;let k=Oo(m);m.filter(Eo).forEach(R=>R.set({visible:!k})),d.stores.treeStore.setHighlight(Bj)}Et.visibility=Fi;function Gi(d){return d.some(Eo)}Et.visibilityEnabled=Gi;let Oo=d=>d.every(m=>m.isVisible());function Si(d){return Oo(d)?"Hide":"Show"}Et.visibilityTitle=Si;function zy(d,m){let k=d.withoutDescendants(m);if(!Bh(k))return;let B=!wd(k),R=new Set;for(let G of k){if(!gr(G))continue;let y=G.cache.lockedByParent,b=B===y?void 0:B;G.set({locked:b});for(let C of G.descendants())R.add(C)}for(let G of R)gr(G)&&G.locked!==void 0&&G.set({locked:void 0})}Et.toggleLock=zy;function Bh(d){return d.some(gr)}Et.toggleLockEnabled=Bh;function wd(d){return d.some(m=>gr(m)&&wt(m))}function Xy(d){return wd(d)?"Unlock":"Lock"}Et.toggleLockTitle=Xy;function Yy(d){return d.every(dt)}Et.copyURLEnabled=Yy;function Zy(d){return d.length>0&&d.every(R=>Ld(R))?`Remove ${d.length>1?"Viewboxes":"Viewbox"}`:`Remove ${d.length>0&&d.find(R=>!JA(R))===void 0?"Stack":"Frame"}${d.length>1?"s":""}`}Et.removeFrameTitle=Zy;function AC(d,m){gh(d,m)&&Gh(d,m)}Et.removeFrame=AC;function gh(d,m){if(m.length===0)return!1;let k=d.stores.scopeStore.active.id;return m.every(B=>{if(!pA(B)&&!JA(B)&&!Ld(B)||!B.children||B.children.length===0||Uj(B)||aj(B)||jj(B)&&!pe(B))return!1;let R=d.tree.getParent(B.id);if(!R)return!0;for(let G of B.children)if(!Dt(d.tree,R,G,k,L))return!1;return!0})}Et.removeFrameEnabled=gh;function Ld(d){return RA(d)&&!dt(d)}function jC(d,m){m.forEach(k=>{let B=d.getParentSizeInfo(k);if(k.intrinsicWidth!==null&&k.intrinsicHeight!==null){let R={width:k.intrinsicWidth,height:k.intrinsicHeight},G=R.width/R.height;if(nn(k))k.set(Pm(k,R,{aspectRatio:G}),d);else if(ro(k)&&k.aspectRatio){k=k.set({aspectRatio:null},d);let y=k.updateForSize(R,B);y.aspectRatio=G,k.set(y,d)}else k.set(k.updateForSize(R,B),d)}})}Et.resetToIntrinsicSize=jC;function wo(d,m,k,B){let R=d.getRect(m),G=d.getOriginPoint(m),y=d.convertPointToCanvas(m,{x:R.width*G.x,y:R.height*G.y});if(B){let M=d.transformMatrixToNode(B),O=gl(B)?M:Sj.flatProjectionMatrix(M);y=Sj.convertPoint(O.inverse(),y)}let b={...R,x:y.x-R.width*G.x,y:y.y-R.height*G.y},C=m.updateForRect({rect:b,parentSizeInfo:d.getParentSizeInfo(m,B),constraintsLocked:!1,shouldGuessPinToBottom:B?pt(d,m,B):!0,shouldGuessPinToRight:ee(d,m,B)});if(JA(B)||(C.widthType===3&&(C.widthType=0,C.width=R.width),C.heightType===3&&(C.heightType=0,C.height=R.height)),Nt(m)){let M=m.resolveValue("rotation")-Fh(d,k,B);M!==0&&(C.rotation=M)}return B&&he(B)&&!$a(m)&&!Ba(m)&&(C.top=null,C.left=null,C.bottom=null,C.right=null),Object.assign(C,so(m,B)),C}Et.convertNodeToNewParentUpdate=wo;function eC(d,m,k,B,R=-1,G){let{tree:y}=d,b=m;if(jj(m)&&(b=Ke(y,m),!b))return null;let C=B;if(B&&hA(B)&&(C=Ke(y,B),!C))return null;let D=k;if(k&&hA(k)&&(D=Ke(y,k),!D))return null;let M=wo(y,G??b,jj(m)?D:k,jj(m)?C:B);if(d.tree.current(b)?.set(M),d.moveNode(b.id,C?C.id:d.stores.scopeStore.active.id,R),b.id!==m.id){$(k,"Current parent must exist when editing variants");let fA=kA.getReplicaForTemplateNode(y,k);$(fA,"The current parent should located in a variant node");let dA=B?kA.getReplicaForTemplateNode(y,B):null;if(fA.id===dA?.id){let LA=wo(y,m,k,B);y.current(m)?.set(LA)}}return{originalNode:b,originalCurrentParent:D,originalNewParent:C}}Et.convertNodeToNewParent=eC;function qd(d,m){if(!Ur(d)&&!wt(d)&&(m.push(d.id),!!d.children))for(let k of d.children)qd(k,m)}function Vd(d,m){let k=new Set;return m.forEach(B=>{let R=d.getParent(B.id);R&&k.add(R.id)}),k}function tC(d,m){let k=d.withoutDescendants(d.getNodes(m));return Vd(d,k).size>0}Et.canSelectAncestor=tC;function rC(d,m){Kd(d,m,"parent")}Et.selectParent=rC;function oC(d,m){Kd(d,m,"groundNode")}Et.selectGroundNode=oC;function Kd(d,m,k){let{tree:B}=d,R=B.withoutDescendants(B.getNodes(m)),G=null;if(k==="groundNode"){let M=new Set(R.map(O=>B.getGroundNodeFor(O).id));M.size>0&&(G=Array.from(M))}else{let M=Vd(B,R);M.size>0&&(G=Array.from(M))}if(!G)return!1;let{selectionStore:y,overlayStore:b,treeStore:C}=d.stores;y.set(G,{sticky:!0,switchToLayers:!0});let D=R.length===1?R[0]:null;return D&&b.activeOverlays.has(D.id)&&b.exitEditMode(y,!1),C.setHighlight(null),!0}Et.selectAncestor=Kd;function nC(d,m){let k=d.tree,B=[];if(d.tool.selectAll){d.tool.selectAll();return}else{let R=m.map(G=>{let y=k.get(G);if(ej(y)){let C=Fm(k,y);return C&&k.isGroundNode(C)?C.id:Bj}let b=k.getGroundFrameAncestor(G,!0);return b!==null?b.id:Bj});if(new Set(R).size===1&&R[0]!==null){let G=R[0];B=k.getSubtreeNodes(G).filter(y=>wt(y)?!1:y.id!==G).map(y=>y.id)}if(B.length===0)for(let G of d.stores.scopeStore.active.children)qd(G,B)}d.stores.selectionStore.set(B)}Et.selectAll=nC;function iC(d,m){let k=new Set;for(let B of m){let R=d.tree.get(B);if(!R)continue;let G=d.tree.getSiblingsIncludingSelf(R);for(let y of G)k.add(y.id)}d.stores.selectionStore.set(k)}Et.selectAllSiblings=iC;function aC(d,m){return d.tree.getNodes(m).some(k=>vA(k)&&k.children.length>0)}Et.canSelectChildren=aC;function sC(d,m){let k=new Set;for(let B of m){let R=d.tree.get(B);if(!R)continue;let G=ao(R);for(let y of G)k.add(y.id)}k.size>0&&d.stores.selectionStore.set(k)}Et.selectAllChildren=sC;function lC(d,m){let k=m.length>0?d.tree.getNodes(m):d.stores.scopeStore.active.getGroundNodes(),B=[];k.map(b=>{xj(b)?B.push(...d.tree.getSiblingsIncludingSelf(b)):B.push(b)});let R=new Set,G=new Set,y=b=>{if(!R.has(b.id)){if(xj(b)&&G.add(b.id),b.children)for(let C of b.children)y(C);R.add(b.id)}};for(let b of B)y(b);d.stores.selectionStore.set(G)}Et.selectAllTextNodes=lC;function cC(d,m){let[k]=d.tree.getNodes(m);if(!k||!xj(k))return;let B=[],R=QA(k)?tt(k.getTextStylePresets(!1)):void 0,G=tt(k.getFonts(!1)),y=tt(k.getFontSizes(!1).map(C=>en(C)?yt(...C):Y(C)?yt(C,"px"):C)),b=tt(k.getTextColors(!1));if(!(Ct(R)||se(R))&&!(Ct(G)||se(G))&&!(Ct(y)||se(y))&&!(Ct(b)||se(b))){for(let C of d.stores.scopeStore.active.walk())kj(C)||!xj(C)||(QA(C)?tt(C.getTextStylePresets(!1)):void 0)!==R||tt(C.getFonts(!1))!==G||tt(C.getFontSizes(!1).map(dA=>en(dA)?yt(...dA):Y(dA)?yt(dA,"px"):dA))!==y||tt(C.getTextColors(!1))!==b||B.push(C);d.stores.selectionStore.set(B)}}Et.selectAllTextNodesWithSameFontStyles=cC;function dC(d,m){let k=d.tree.getNodes(m);$(m.length===1,"Cannot have multiple layers selected");let[B]=k;if(!B||!pA(B))return;let R=[],y=Ou(d.tree,B.id)??d.stores.scopeStore.active;for(let b of y.walk())pA(b)&&hh(B,b,d.tree)&&R.push(b);d.stores.selectionStore.set(R)}Et.selectAllLayersWithSameFill=dC;function hh(d,m,k){if(_t(d)&&!d.fillEnabled||_t(m)&&!m.fillEnabled)return!1;let{fillType:B}=d;if(B!==m.fillType||B===void 0)return!1;switch(B){case"color":return!_(d.fillColor)||!_(m.fillColor)?!1:Oi.equals(sc(d.fillColor,k,void 0),sc(m.fillColor,k,void 0));case"linear-gradient":return d.fillLinearGradient&&m.fillLinearGradient?d.fillLinearGradient.equals(m.fillLinearGradient):!1;case"radial-gradient":return d.fillRadialGradient&&m.fillRadialGradient?d.fillRadialGradient.equals(m.fillRadialGradient):!1;case"conic-gradient":return d.fillConicGradient&&m.fillConicGradient?d.fillConicGradient.equals(m.fillConicGradient):!1;case"image":return d.fillImage===m.fillImage;default:iA(B)}}function Jd(d){return d.some(m=>ha(m)?jj(m)?!pe(m):!1:!0)}function Lr(d){let m={};return d.forEach(k=>{let B=k.parentid?k.parentid:rn,R=m[B];R||(R=[],m[B]=R),R.push(k)}),m}function Hd(d,m,k){let B=d.tree;for(let R in m){let G=R===rn?B.root:B.get(R);if(!G||!m[R])continue;let y=B.sortVisually(m[R]);k==="back"&&y.reverse();let b=k==="front"?-1:0,C=kj(G)&&Ie(G);y.forEach(D=>{let M=D.originalid?B.get(D.originalid):D;$(M,"Cannot send",D.id,"backward/forward: original node must exist."),C&&ha(M)?al(M.id,G,b):d.tree.moveNodeIndex(M,b)})}}function Rh(d,m,k){let B=d.tree.getParent(k.id);if(!B)return null;let R=B.children.indexOf(k),G=m==="backward"?R-1:R+1,y=B.children[G];if(!y||!Le(y))return null;let b=d.tree.convertFrameToCanvas(k),C=d.tree.convertFrameToCanvas(y);if(m==="backward")return{...b,y:C.y};let D=C.height-b.height;return{...b,y:C.y+D}}function Ih(d,m,k){let B=Rh(d,m,k),{canvasStore:R}=d.stores;!B||q.containsRect(R.getCanvasVisibleRectTakingOverlaysIntoAccount(),B)||R.zoomToCenter(B,{zoom:R.zoom,maxZoom:.5,animated:!0})}function Qd(d,m,k){let B=d.tree,R=Object.keys(m).length===1;for(let G in m){let y=G===rn?B.root:B.get(G);if(!y||!vA(y))continue;let b=kj(y)&&Ie(y),C=m[G],D=R&&C?.length===1,M=ur(y)?y.getChildrenInVisualOrder():y.children,O=!1;for(let fA=0,dA=M.length;fA<dA;fA++){let LA=k===1?dA-fA-1:fA,EA=M[LA];if(!C?.includes(EA))O=!0;else if(O)if(b&&ha(EA))$(EA.originalid,"Cannot send nodes: nodes in a replica variant parent must have originalid."),al(EA.originalid,y,LA+k);else{D&&ds(B,EA)&&Ih(d,k===-1?"backward":"forward",EA);let GA=EA.originalid?B.get(EA.originalid):EA,rj=y.originalid?B.get(y.originalid):y;$(GA,"Cannot send node",EA.id,": original child node does not exist."),$(rj,"Cannot send node",y.id,": original parent node does not exist."),d.moveNode(GA.id,rj.id,LA+k)}}}}function Ud(d,m,k){for(let B in m){let R=B===rn?d.root:d.get(B);if(!R||!vA(R))continue;let G=m[B],y=ur(R)?R.getChildrenInVisualOrder():R.children,b=!1;for(let C=0,D=y.length;C<D;C++){let M=k===1?D-C-1:C,O=y[M];if(!G?.includes(O))b=!0;else if(b)return!0}}return!1}function Fh(d,m,k){let B=0,R=0;return m&&(B=d.totalAncestorRotation(m)),k&&(R=d.totalAncestorRotation(k)),Math.round(R-B)}function uC(d){if(d.length!==1)return!1;let m=d[0];return m&&ho(m)&&!m.originalid}Et.reversePathDirectionEnabled=uC;function pC(d,m){let k=d.current(m);k&&k.set({pathSegments:Kj.reverse(k.pathSegments)})}Et.reversePathDirection=pC;function kC(d,m){let k=wn(m,d);return k.length===0?!1:k.every(B=>ej(B)&&!B.originalid&&ao(B).length>0)}Et.canUngroup=kC;function Gh(d,m){if(m.length===0)return;let k=d.tree,B=k.sortVisually(wn(m,k)),R=k.withoutDescendants(B),G=[];return R.forEach(y=>{if(!vA(y))return;let b=y,C=null;if(jj(y)){if(b=Ke(k,y),!b)return;C=kA.getReplicaForTemplateNode(k,y)}let D=k.getParent(y.id);if(y.children.length>0){let M=k.getIndex(y),O=b?.id??y.id;[...ao(y)].forEach((dA,LA)=>{let EA=dA;if(jj(dA)&&(EA=Ke(k,dA),!EA))return;if(je(EA)){k.removeNode(EA);return}let uA=D,GA=uA;if(uA&&hA(uA)&&(GA=Ke(k,uA),!GA))return;let rj=Et.convertNodeToNewParentUpdate(k,EA,b,GA);if(d.moveNode(EA.id,GA?.id??null,M+LA,O),d.tree.current(EA)?.set(rj),O=EA.id,C){let PA=Et.convertNodeToNewParentUpdate(k,dA,y,uA);d.tree.current(dA)?.set(PA)}G.push(dA.id)}),d.deleteNode(b.id)}}),d.stores.selectionStore.set(G),G}Et.ungroup=Gh;function mC(d){return!d.hasPreferredSize(L)}Et.canSetDefaultSize=mC;function fC(d,m){if(m.hasPreferredSize(L))return;let k=m.getPreferredSize(L),B={aspectRatio:null};k.width==="auto"?(B.width=1,B.widthType=2):Y(k.width)&&(B.width=k.width,B.widthType=0),k.height==="auto"?(B.height=1,B.heightType=2):Y(k.height)&&(B.height=k.height,B.heightType=0),$A(m)&&Y(m.top)&&Y(m.bottom)&&(B.bottom=null),$A(m)&&Y(m.left)&&Y(m.right)&&(B.right=null),WE(m,B,"context_menu_default_size_item"),m.set(B,d.tree)}Et.setDefaultSize=fC;function Sh(d,m){if(!d.stores.toolStore.isDefaultToolActive)return!1;let k=wn(m,d.tree);return k.length===0?!1:k.every(B=>ej(B)&&!B.originalid)}Et.canJoinInGroup=Sh;function EC(d,m){let k=d.tree;if($(m.length>0,"No nodes"),!Sh(d,m))return;let B=wn(m,k),R=k.sortVisually(k.withoutDescendants(B)),G=R[0],y=G?k.getParent(G.id):void 0,b=y?y.id:Bj,C=G?k.getIndex(G):void 0,D=k.newId();d.createShapeGroup(b,{id:D},C),R.forEach(M=>{let O=Et.convertNodeToNewParentUpdate(k,M,k.getParent(M.id),y);d.moveNode(M.id,D),d.tree.current(M)?.set(O)}),d.stores.selectionStore.set(D)}Et.joinInGroup=EC;function $C(d,m){if(m.originalid)return null;let k={width:m.width,height:m.height},B=KE(m.svg,La.createEmpty,k,m);if(B){B.name=m.name||m.originalFilename,B.parentid=m.parentid;let R=d.cloneNode(B),G=m.parentid===null,y=G?"rgb(255,255,255)":"transparent",{aspectRatio:b,...C}=m.constraintValues();d.tree.current(R)?.set({...C,width:B.width,height:B.height,fillEnabled:G,fillColor:y});let D=d.tree.getParent(m.id);if(D!==null&&vA(D)){let M=D.children.indexOf(m);d.moveNode(R.id,D.id,M)}return Wd(d,R.id,k),d.deleteNode(m.id),R.id}return null}Et.convertSVGToShape=$C;function Wd(d,m,k){let B=d.tree.get(m);if(!RA(B))return;let R=B.width>=B.height?"width":"height",G=R==="width"?"height":"width",y=k[R]/B[R];if(y===1)return;v$(d,[B],y,T$(d,[B]),yh(B));let b=d.tree.current(B);$(b,"Node must exist after scaling");let C=k[G]-b[G];if(C===0)return;b.set({[G]:k[G]});let D=G==="width"?"x":"y";for(let M of b.children){let O=d.tree.current(M);!O||!Ga(O)||O.set({[D]:O[D]+C/2})}}Et.scaleVector=Wd;function yh(d){let m=d.constraints(),k=0,B=0;return m.top===!1&&m.bottom===!1?B=.5:m.top===!1&&(B=1),m.left===!1&&m.right===!1?k=.5:m.left===!1&&(k=1),{x:k,y:B}}function BC(d,m){if(m.length>1)return!1;let k=kA.getReplicaForTemplateNode(d,m[0]);if(!k)return!1;let B=kA.getMaster(d,k);if(Ur(B))return!1;for(let R=0,G=m.length;R<G;R++){let y=m[R];if(kA.overrideKeys(d,[y]).size>0)return!0}return!1}Et.canUpdateMasterFromInstance=BC;function gC({tree:d},m){function k(C,D){for(let M of["id","update","cache","children","mutable","parentid","originalid","isMaster","isVariant","isBreakpoint","replicaInfo","duplicatedFrom","gesture"])delete C[M];if(D)for(let M of kA.positionKeysToIgnore)delete C[M];return C}function B(C,D){let M;if(D)for(let O of kA.positionKeysToIgnore)C[O]!==void 0&&(M=M||{},M[O]=C[O]);return C.gesture&&(M||(M={}),M.gesture=C.gesture),M}let R=kA.getReplicaForTemplateNode(d,m[0]);if(!R)return;let G=kA.getMaster(d,R);if(Ur(G))return;let y={...R.replicaInfo.overrides},b={...R.replicaInfo,overrides:y};for(let C=0,D=m.length;C<D;C++){let M=m[C];if(!M?.originalid)continue;let O=d.get(M.originalid),fA=k(M.raw(),aj(M));O?.set(fA);let dA=B(y[M.originalid]??{},aj(M));dA?y[M.originalid]=dA:delete y[M.originalid]}R.asDraft().replicaInfo=b}Et.updateMasterFromInstance=gC;function hC(d,m){let k=zd(d,m);return!k||Ho(k)?0:T7(k)?2:1}Et.canGoToMaster=hC;let zd=(d,m)=>{let k=null;for(let R=0,G=m.length;R<G;R++){let y=m[R],b=kA.getReplicaForTemplateNode(d,y);if(b){if(!k)k=b.originalid;else if(k!==b.originalid)return null}}if(!k)return null;let B=d.getNode(k);return!B||!Uj(B)?null:B};function RC(d,m){if(m.length===1){let B=d.tree.getNode(m[0]?.originalid);if(!B)return;Xd(d,B);return}let k=zd(d.tree,m);k&&(kA.showMaster(d.tree,k),Xd(d,k))}Et.goToMaster=RC;function Xd(d,m){let k=d.tree.getScopeNodeFor(m),B=d.stores.scopeStore.active;Uj(m)&&kA.showMaster(d.tree,m),k===null&&(d.moveNode(m.id,B.id),k=B),d.stores.scopeStore.select(k.id,{keepHistory:!1}),d.stores.selectionStore.set(m);let R=d.tree.convertFrameToCanvas(m);d.stores.canvasStore.scrollToCenter(q.center(R))}Et.showNodeOnCanvas=Xd;function IC(d,m){d.exitMode(),d.stores.modalStore.set({type:"CodeFileCreation",source:"main_menu",creationType:"Component",parentId:m})}Et.createCodeComponent=IC;function FC(d){d.exitMode(),d.stores.modalStore.set({type:"CodeFileCreation",source:"main_menu",creationType:"Override"})}Et.createCodeOverride=FC;function GC(d,m,k,B,{gesture:R,overrides:G,overrideSize:y,variantName:b,viewportHeight:C,selectAndCenter:D=!0}={}){R&&$(sa(k),"gesture variant should inherit from top level variant");let{treeStore:M,scopeStore:O,selectionStore:fA,canvasStore:dA}=d,LA=m.getPrimaryVariant(),EA=null;if(!R){let rj=new Set(m.getTopLevelVariants().map(PA=>PA.name??""));b?EA=Cj(b,rj):EA=Cj(IA(k)?"Breakpoint":"Variant",rj,{startIndex:rj.size+1,omitCountIfFirst:!1})}if(G||(G=R?void 0:k.replicaInfo?.overrides),EA&&IA(k)){let rj=zf(M,EA,k);rj&&(G?G=dr(rj,G):G=rj);let PA={};k.children.forEach(SA=>{if(!Ie(SA)||$A(SA)&&SA.widthType===2||!(SA.originalid?M.tree.getNode(SA.originalid):SA))return;let hj=M.tree.getRect(SA);uc(M.tree,SA,hj,k,B.width,PA)}),G||(G={}),G=dr(G,PA)}let uA=kA.create(M.tree,LA,{overrides:G,inheritsFrom:R?k.id:void 0,duplicatedFrom:cn(k)});if(O.insertNode(uA,m.id,-1),!uA)return;let GA={top:B.y,left:B.x,gesture:R,isBreakpoint:jo(m)?!0:void 0,name:EA};if(C&&(GA.viewportHeight=C),y&&(GA.width=B.width,GA.widthType=0,IA(uA)||(GA.height=B.height,GA.heightType=0)),uA.set(GA),eA(m)){let rj=Va(R)?"variant":R??"variant";Bf({variantId:uA.id,variantType:rj,componentId:m.id})}else IA(uA)&&mA("breakpoint_create",{scopeId:m.id,breakpointId:uA.id,width:uA.width});return D&&(fA.set(uA.id),dA.scrollToCenter(q.center(B))),uA}Et.createVariant=GC;function Ch(d,m){return d.filter(k=>va(k)?Rk(k)!==m:Je(k)?Lf(k)!==m:!0)}function SC(d,m,k){for(let B of m.walk()){let R=Ma(B);for(let[G,y]of Object.entries(R)){let b=Ch(y,k);if(b.length!==y.length){if(we(B))d.tree.current(B)?.set({[G]:b});else if(W(B)){let C={type:"eventhandler",value:b};d.tree.current(B)?.set({[G]:C})}}}}}Et.removeActionsWithTarget=SC;function yC(d,m){let k=d.tree.getParent(m.id)||d.stores.scopeStore.active;if(hA(k))return!1;let B=d.stores.treeStore.getPartialIndexes();return m.codeComponentIdentifier in B.localSmartComponentNameByIdentifier}Et.canDetachVariantInstance=yC;function CC(d,m,k,B){if(!k)return null;let R={...is(m,L),...s$(m)},G=new Map;k.getTopLevelVariants().forEach(PA=>G.set(PA.id,PA));let y=_(R.variant)&&G.get(R.variant)||k.getPrimaryVariant();$(pA(y),"Variant must be a frame node");let b=d.tree.getParent(m.id)||d.tree.getScopeNodeFor(m)||d.stores.scopeStore.active;if(hA(b))return null;let C=new Map,D=Mr(y,new Map,new Map,C);C.set(m.id,D.id);let M=d.tree.getScopeNodeFor(b);if(w(M)||eA(M)){let PA=M.getTopLevelReplicaVariants();for(let SA of PA){let Lj=ke(SA.id,m.id),hj=d.tree.getNode(Lj);if(!hj||!W(hj))continue;let cA=hj.getResolvedControlPropValues(L).variant;if(!_(cA))continue;if(B){let Hj=B.get(cA);Hj&&(cA=Hj)}let lj=_(cA)?G.get(cA):void 0;if(!lj||!pA(lj)||!MA(lj))continue;let qj=Co(i$(lj,d.tree,hj,k.id),C),zA={},XA=C.get(y.id)??y.id;if(an(lj)){let Hj=Co(lj.replicaInfo.overrides,C,!0);Object.assign(zA,{...Hj,[XA]:a$(Hj[XA]??{})})}let $j=dr(qj,zA);if(an(lj)){let{opacity:Hj,rotation:Te}=SA.replicaInfo.overrides?.[m.id]||{};ys($j[XA]??{},{opacity:Hj,rotation:Te})}else if(SA.replicaInfo.overrides?.[m.id]){let{opacity:Hj,rotation:Te}=lj;ys(SA.replicaInfo.overrides[m.id]??{},{opacity:Hj,rotation:Te})}let ve={};hj.heightType===2&&(ve.heightType=lj.heightType,ve.height=lj.height),hj.widthType===2&&(ve.widthType=lj.widthType,ve.width=lj.width),d.tree.current(SA)?.set({replicaInfo:{...SA.replicaInfo,overrides:dr({...SA.replicaInfo.overrides,[m.id]:{}},{...$j,[XA]:{...SA.replicaInfo.overrides[m.id],...$j[XA],...ve}})}})}}let O=ls(d.tree,m,D,b);ys(O,{opacity:aA(y.opacity)?R[y.opacity.id]:y.opacity,rotation:aA(y.rotation)?R[y.rotation.id]:y.rotation});let fA=m.constraintValues(),dA=y.constraintValues();fA.widthType===2&&dA.widthType!==2&&(fA.widthType=dA.widthType),fA.heightType===2&&dA.heightType!==2&&(fA.heightType=dA.heightType),D.set({...fA,...O,...b?Pt(m):void 0,isVariant:!1,isMaster:!1,gesture:void 0,replicaInfo:null,originalid:null,name:m.name??Ce(m)});let LA=em(k),EA=new Map([...LA??[],...Object.entries(R)]),uA=new Map;uA.set(k.id,EA);let GA={};for(let PA of D.walk()){if(PA.originalid=null,Ik(PA))for(let[SA,Lj]of Object.entries(PA.getActions(L)))Lj&&PA.set({[SA]:Lj.filter(hj=>da(hj)||ea(hj))});if(EA.size>0){let SA=Na(d.tree,k.id,PA,uA,GA);SA&&PA.set(SA)}}$(D.id!==y.id);let rj=b.children.indexOf(m);d.tree.insertNode(D,b.id,rj);for(let PA of m.children)je(PA)&&d.tree.moveNode(PA,GA[PA.id]??D.id);return be(d.tree,b,C,je(b)||ma(b)),d.deleteNode(m.id),Fj(D)&&d.scheduler.runBeforeNextFrame(()=>{d.stores.overlayStore.showOverlay(d.stores.selectionStore,D,D.parentid)}),D}Et.detachSmartComponentOrWebPageInstance=CC;function bC(d){bh(d,{openLibrary:!0})}Et.toggleTeamLibrary=bC;function bh(d,{openLibrary:m}={}){let{modalStore:k,popoverStore:B}=d.stores;k.active.type==="QuickActions"?k.dismiss():(d.cancelTool(),B.active=0,k.set({type:"QuickActions",source:"main_menu",initialCategory:m?{type:"TeamLibraryCategory"}:void 0}),m?mA("ui_interaction",{page:"main-menu",id:"team-library"}):mA("ui_interaction",{page:"main-menu",id:"quick-actions"}))}Et.toggleQuickActions=bh;function vC(d){return!!IA(d)}Et.canCreateBreakpoint=vC;function TC(d,m,k,B,R){let{modalStore:G}=d.stores;G.active.type!=="CustomBreakpoint"&&(d.cancelTool(),G.set({type:"CustomBreakpoint",actionType:m,baseNodeId:k,name:B,width:R,source:"undefined"}))}Et.showCustomBreakpointModal=TC;function PC(d,m,k,B,R,G,y,b){let C={...B,width:R},D=Et.createVariant(d.stores,k,m,C,{overrideSize:!0,variantName:G,viewportHeight:y,selectAndCenter:b});return $(IA(D),"Created node is not a breakpoint variant"),D}Et.createBreakpoint=PC;function vh(d){return d.some(m=>m!==d&&Uj(m))}Et.containsMaster=vh;function Th(d){return pA(d)||ht(d)||RA(d)||xj(d)||Hi(d)||X7(d)||Qi(d)}Et.nodeTypeCanBePrimaryVariantSource=Th;function Ph(d,m){return!(!Th(m)||Hf(d,m)||MA(m)||aj(m)||Uj(m)||vh(m))}Et.canConvertNodeToSmartComponentPrimaryVariant=Ph;function Mh(d,m){let k=m.length;if(k===0)return!0;let B=m[0];return $(B,"node must be defined",m),k===1&&Ph(d.tree,B)}Et.canMakeSmartComponent=Mh;function _h(d,m){if(m.length!==1)return!1;let B=m[0];if($(B,"node must be defined",m),!pA(B)||hA(B))return!1;let R=d.tree.get(B.parentid);return Ae(R)}Et.canMakeWebPagePrimaryBreakpoint=_h;async function MC(d,m){if(!_h(d,m))return;let k=m[0];return $(k,"node must be defined",m),d.createWebPage({primaryBreakpointTemplateId:k.id,shouldRemovePanelOverrides:!1,startEditingPageTitle:!1,preferredPath:k.name?Hm(k.name):void 0})}Et.convertNodeToWebPagePrimaryBreakpoint=MC;function _C(d,m,k="Template",B,R){let G=new ye({...Kt,...kF(B),isMaster:!0,isVariant:!0,isBreakpoint:!0,widthType:0,heightType:0,width:B?.width??1200,name:B?.name??"Desktop"}),y=new Sm;G.addChild(y);let b=Cj(k,mF(d)),C=new rm({baseVariantId:G.id,name:b});$(C.isLoaded(),"A newly created LayoutTemplateNode must be loaded."),C.addChild(G),d.latestTree().insertNode(C);let D=ns(d,b,R??fn);return Cr(d,D,C.id),mA("layout_template_create",{source:m}),C}Et.createLayoutTemplate=_C;function DC(d,m,k=!0,B=null,R=gj(),G="context_menu",y=0){let b=new vl({name:m,id:R});if($(b.isLoaded(),"A newly created VectorSetNode must be loaded"),d.tree.latestTree().insertNode(b),Cr(d.tree,B??io,b.id),k)for(let D of gF())d.tree.latestTree().insertNode(D,b.id);let C=d.tree.current(b);return $(C,"A newly created VectorSetNode must exist"),d.stores.codeGenerationStore.createVectorSet(C.getVectorSetItems()),mA("vector_set_create",{source:G,items:k?3:y}),b}Et.createVectorSet=DC;async function NC(d,m,k){let B=d.tree.get(k);if(!de(B))return;let R=B.isLoaded()?B:await B.load();if(!R)return;let G=R.children.find(dt);if(!dt(G))return;let y=d.tree.getRect(G);d.scheduler.process(()=>{let b=w$(d,m),C=[],D=_t(G)?{fillEnabled:G.fillEnabled,fillType:G.fillType,fillColor:G.fillColor}:void 0;for(let M of b){let O=d.tree.get(M);if(!O)continue;let fA=d.tree.getIndex(O),dA=Mn(d.tree,R,O,y,y.width),LA=O$(O,dA,D);if(dt(LA)){if(d.tree.insertNode(LA,R.id),C.push(LA),Wd(d,LA.id,y),mA("vector_set_item_create",{source:"context_menu"}),k!==d.stores.scopeStore.active.id){let EA=new Rr({...L$(O),codeComponentIdentifier:er("vector",LA.id,"default").value,width:O.width,height:O.height,widthType:0,heightType:0,slotsAreChildNodes:OA.isOn("componentSlotsAreChildNodes"),name:O.name});d.tree.insertNode(EA,O.parentid,fA)}d.tree.removeNode(O)}}C.length!==0&&(d.stores.scopeStore.select(B.id,{keepHistory:!1}),d.stores.selectionStore.set(C),d.stores.chromeStore.layersExpanded=!0,d.stores.chromeStore.contentPanelTab="Layers",d.stores.codeGenerationStore.createVectorSet(C))})}Et.addToVectorSet=NC;function xC(d,m,k="Icon Set",B="context_menu"){let R=new vl({name:k});$(R.isLoaded(),"A newly created VectorSetNode must be loaded");let G=w$(d,m),y=0,b=[];for(let C of G){let D=d.tree.get(C);if(!D)continue;let M=d.tree.getRect(D),O=O$(D,{x:y,y:0});if(!dt(O))continue;let fA=d.tree.getIndex(D);b.push(O),R.addChild(O),y+=M.width*2;let dA=new Rr({...L$(D),codeComponentIdentifier:er("vector",O.id,"default").value,width:D.width,height:D.height,widthType:0,heightType:0,slotsAreChildNodes:OA.isOn("componentSlotsAreChildNodes"),name:D.name});d.tree.insertNode(dA,D.parentid,fA),d.tree.removeNode(D)}d.tree.latestTree().insertNode(R),Cr(d.tree,io,R.id),d.stores.codeGenerationStore.createVectorSet(b),d.stores.scopeStore.select(R.id,{keepHistory:!1}),d.stores.selectionStore.set(b),d.stores.chromeStore.layersExpanded=!0,d.stores.chromeStore.contentPanelTab="Layers",mA("vector_set_create",{source:B,items:G.size})}Et.createVectorSetFromNodes=xC;function OC(d,m,k,B,R){let G=k.clone({children:[],name:"Vector"}),{scopeStore:y,codeGenerationStore:b,selectionStore:C,canvasStore:D}=d;y.insertNode(G,m.id),$($A(G),"Vector must be pinnable."),G.set({top:B.y,left:B.x}),b.createVectorSet([G]),C.set(G.id),D.scrollToCenter(q.center(B)),mA("vector_set_item_create",{source:R})}Et.createVectorSetItem=OC})(Oc||={});var Kt={height:tm,left:0,top:0,layout:"stack",stackDirection:"vertical",stackAlignment:"center",stackDistribution:"start",stackWrapEnabled:!1,gap:0,padding:0,paddingPerSide:!1,paddingLeft:0,paddingBottom:0,paddingTop:0,paddingRight:0,overflow:Oe()};function kF(j){if(!j||!De(j)||!jt(j)||!_t(j))return;let A=lo(j);return{gap:j.resolveValue("gap")??Kt.gap,padding:A.perSide?Kt.padding:A.top,paddingPerSide:A.perSide??Kt.paddingPerSide,paddingLeft:A.left??Kt.paddingLeft,paddingBottom:A.bottom??Kt.paddingBottom,paddingTop:A.top??Kt.paddingTop,paddingRight:A.right??Kt.paddingRight,fillEnabled:j.resolveValue("fillEnabled"),fillType:j.resolveValue("fillType"),fillColor:j.resolveValue("fillColor"),fillLinearGradient:j.resolveValue("fillLinearGradient"),fillRadialGradient:j.resolveValue("fillRadialGradient"),fillConicGradient:j.resolveValue("fillConicGradient"),fillImage:qA(j.fillImage)?void 0:j.fillImage,fillImageOriginalName:j.resolveValue("fillImageOriginalName"),fillImageResize:j.resolveValue("fillImageResize"),fillImagePixelWidth:j.resolveValue("fillImagePixelWidth"),fillImagePixelHeight:j.resolveValue("fillImagePixelHeight"),fillImagePositionX:j.resolveValue("fillImagePositionX"),fillImagePositionY:j.resolveValue("fillImagePositionY"),fillImageTileSize:j.resolveValue("fillImageTileSize")}}function mF(j){let A=new Set;return j.root.children.forEach(e=>{!ZA(e)||!e.name||A.add(e.name)}),A}function V$(j){return!(Ao(j)||zi(j)||Ze(j))}function xc(j){return!(pj(j)||zi(j)||Ze(j)||jj(j))}function fF(j){return pe(j)&&j.isVisible()?!0:xc(j)}function x$(j){return V$(j)?jj(j)?pe(j):!0:!1}function Xn(j,A){if(Wj(A)){let e=Fn(j.tree,A.dataIdentifier);if(e)return e.id}return null}function EF(j,A,e){if(e){let r=Xn(j,e);if(r)return r;for(let o of e.ancestors()){let n=Xn(j,o);if(n)return n}}let t=Xn(j,A);if(t)return t;if(e)for(let r of e.walk()){let o=Xn(j,r);if(o)return o}for(let{node:r,skipChildren:o}of A.walkWithSkipChildren())if(e&&r.id===e.id)o();else{let n=Xn(j,r);if(n)return n}return null}function O$(j,{x:A,y:e},t){if(ej(j)){let r=new Fr({...t,isVectorSetItem:!0,width:j.width,height:j.height,left:A,top:e,name:j.name}),o=j.clone({x:0,y:0});return r.addChild(o),r}return j.clone({...t,isVectorSetItem:!0,left:A,top:e})}function w$(j,A){return new Set(A.map(e=>{if(!e)return null;if(RA(e))return e.originalid??e.id;let t=j.tree.getAncestorThatMatches(e,o=>$F(j,o),!0,!0);if(!t)return null;let r=j.tree.getNodeParent(t);return r&&RA(r)?r.originalid??r.id:t.originalid??t.id}))}function $F(j,A){return ej(A)&&j.tree.isRootVectorNode(A)}function L$(j){return $A(j)?{top:j.top,bottom:j.bottom,left:j.left,right:j.right,centerAnchorX:j.centerAnchorX,centerAnchorY:j.centerAnchorY,constraintsLocked:j.constraintsLocked}:{top:j.y,left:j.x}}var BF="rgb(0, 153, 255)",Dc={fillType:"color",fillColor:BF,fillEnabled:!0},Nc={isVectorSetItem:!0,top:0,width:40,height:40,autoSize:!1},gF=()=>{let j=new _l({...Dc,x:-3,y:-3,width:46,height:46,polygonSides:3,centered:!0,radius:1}),A=new _l({...Dc,x:0,y:0,width:40,height:40,polygonSides:4,centered:!0,radius:1}),e=new Cm({...Dc,x:2,y:2,width:36,height:36}),t=new Fr({...Nc,name:"Triangle"});t.addChild(j);let r=new Fr({...Nc,left:80,name:"Diamond"});r.addChild(A);let o=new Fr({...Nc,left:160,name:"Oval"});return o.addChild(e),[t,r,o]};function Ps(j){let A={},e=j.getPresetsListNode();if(!e)return A;for(let t of e.children)if(!aj(t)){if(It(t)){let r=am(t.tag);A[r]??=t.id;continue}if(Ft(t)){A.stylePresetLink??=t.id;continue}if(Gt(t)){A.stylePresetInlineCode??=t.id;continue}if(Wi(t)){A.stylePresetImage??=t.id;continue}if(Z7(t)){A.stylePresetBlockquote??=t.id;continue}if(Ui(t)){A.stylePresetTable??=t.id;continue}if(Xr(t)){let r=ln(t.componentIdentifier);A[r]??=t.id;continue}iA(t)}return A}function pJ(j,A){let e=Ps(j),t={};for(let r in e){let o=A[r];j.get(o)||(t[r]=e[r])}Object.keys(t).length>0&&A.set(t)}function kJ(j,A,e="",t={}){let r=document.createElement(A);r.innerText=e;let o=Oa(j,A);if(o)jp(r,o.id);else{let n=qp[A],a=n.fontSize,i;cu(a)?i=Yi(a):Y(a)&&(i=[a,"px"]),Zu(r.style,Yu.transforms,{...n,fontSize:i})}return new Bm({html:r.outerHTML,...Ps(j),...t})}function K$(j,A,e,t){let r=`${t}/${e.segment}`;j.add(r);for(let o of e.children)K$(j,A,o,r)}function J$(j){let A=new Set,e=j.getRouteSegmentRootNode();for(let t of e.children)K$(A,j,t,"");return A}function H$(j){j=[...j].sort((e,t)=>e[0]-t[0]||e[1]-t[1]);let A=[];for(let e of j){if(e[0]===e[1])continue;let t=A[A.length-1];if(!t){A.push(e);continue}if(e[0]<=t[1]){t[1]<e[1]&&(t[1]=e[1]);continue}A.push(e)}return A}function Q$(j,A){let e=[],t=0;for(let[r,o]of j){if(r<=t){t=o;continue}e.push([t,r]),t=o}return A!==void 0&&t<A&&e.push([t,A]),e}var hF=/\/+/gu,RF=/\/{2,}/gu,IF=new RegExp(`-?${_7}-?`,"g"),FF=/\s+/gu,GF=/[?#[\]@!$&'()*+,;="<>%{}|\\^`]/gu;function SF(j){return j.startsWith("/")?j:"/"+j}function yF(j){return j.replace(RF,"/")}function CF(j){return j.toLowerCase().replaceAll(GF,"").replaceAll(FF,"-")}function Ms(j){let A=bF(j,hF,IF),e=Q$(A,j.length);return j.startsWith("/")?j=U$(j,e,CF):j=U$(j,e,iu),j=SF(j),j=yF(j),j}function bF(j,...A){let e=[];for(let t of A)for(let r of j.matchAll(t))$(r.index!==void 0),e.push([r.index,r.index+r[0].length]);return H$(e)}function U$(j,A,e){let t="",r=0;for(let[o,n]of A)o>r&&(t+=j.substring(r,o)),t+=e(j.substring(o,n)),r=n;return r<j.length&&(t+=j.substring(r)),t}var W$=":missing-slug";function wc(j,A){if(!A)return"/unknown";let e=L.dataForIdentifier(j);if(!e)return A;let t=e.properties;if(!t)return A;let r=new Set(Object.keys(t)),o=0,n=A.replace(D7,(i,s)=>{if(o++,r.has(s))return i;for(let[c,u]of Object.entries(t))if(s.toLowerCase()===(u?.title??c).toLowerCase())return`:${c}`;let l=e.annotations?.framerSlug;return l?`:${l}`:W$});if(o>0)return n;n.endsWith("/")||(n+="/");let a=e.annotations?.framerSlug;return a?n+`:${a}`:n+W$}function vF(j){let A=j.split("/"),e=A[A.length-1];return e?Ca(e):!1}var Lc=(j,A,e,t=!1)=>{j=Ms(j);let r=J$(A.tree),o=A.tree.root.homePageNodeId,n=!!e&&e.id===o;j==="/"&&!n&&(j="/page"),e?.dataIdentifier&&(j=wc(e.dataIdentifier,j));let a=j.endsWith("/")&&!n,i=j;a&&(i=j.slice(0,-1));let s=mo(A.tree,e);return r.has(j)&&(t||j!==s)&&(r.add(i),vF(i)&&(i+="/copy"),i=Cj(i,r,{withDash:!0})),{path:a?`${i}/`:i,suggestedName:Ka(j)}};var mt=Pj(Hr()),z$="dismissedInstantNPMToast",X$="showedInstantNPMToast",Y$="instant-npm-toast",DJ=()=>window.localStorage.getItem(X$)==="true",Z$=()=>window.localStorage.getItem(z$)==="true";function TF(){return(0,mt.jsxs)(mt.Fragment,{children:[(0,mt.jsx)(Nl,{children:"You installed an external NPM library."}),(0,mt.jsxs)("a",{href:"https://www.framer.com/developers/#faq",target:"_blank",children:[" ",(0,mt.jsx)(Nl,{children:"Learn More"})]})]})}function AB(){window.localStorage.setItem(X$,"true"),TA({type:"add",variant:"info",text:(0,mt.jsx)(TF,{}),key:Y$,duration:1/0,action:{title:"Dismiss",onClick:()=>window.localStorage.setItem(z$,"true")}})}function NJ(){TA({type:"remove",key:Y$})}function PF(j){if(j.length>=255)throw new TypeError("Alphabet too long");let A=new Uint8Array(256);for(let s=0;s<A.length;s++)A[s]=255;for(let s=0;s<j.length;s++){let l=j.charAt(s),c=l.charCodeAt(0);if(A[c]!==255)throw new TypeError(l+" is ambiguous");A[c]=s}let e=j.length,t=j.charAt(0),r=Math.log(e)/Math.log(256),o=Math.log(256)/Math.log(e);function n(s){if(s instanceof Uint8Array||(ArrayBuffer.isView(s)?s=new Uint8Array(s.buffer,s.byteOffset,s.byteLength):Array.isArray(s)&&(s=Uint8Array.from(s))),!(s instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(s.length===0)return"";let l=0,c=0,u=0,p=s.length;for(;u!==p&&s[u]===0;)u++,l++;let f=(p-u)*o+1>>>0,E=new Uint8Array(f);for(;u!==p;){let S=s[u],v=0;for(let P=f-1;(S!==0||v<c)&&P!==-1;P--,v++)S+=256*E[P]>>>0,E[P]=S%e>>>0,S=S/e>>>0;if(S!==0)throw new Error("Non-zero carry");c=v,u++}let F=f-c;for(;F!==f&&E[F]===0;)F++;let h=t.repeat(l);for(;F<f;++F)h+=j.charAt(E[F]);return h}function a(s){if(typeof s!="string")throw new TypeError("Expected String");if(s.length===0)return new Uint8Array;let l=0,c=0,u=0;for(;s[l]===t;)c++,l++;let p=(s.length-l)*r+1>>>0,f=new Uint8Array(p);for(;l<s.length;){let S=s.charCodeAt(l);if(S>255)return;let v=A[S];if(v===255)return;let P=0;for(let T=p-1;(v!==0||P<u)&&T!==-1;T--,P++)v+=e*f[T]>>>0,f[T]=v%256>>>0,v=v/256>>>0;if(v!==0)throw new Error("Non-zero carry");u=P,l++}let E=p-u;for(;E!==p&&f[E]===0;)E++;let F=new Uint8Array(c+(p-E)),h=c;for(;E!==p;)F[h++]=f[E++];return F}function i(s){let l=a(s);if(l)return l;throw new Error("Non-base"+e+" character")}return{encode:n,decodeUnsafe:a,decode:i}}var jB=PF;var qc="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",MF=jB(qc),_F=8/Math.log2(62),LJ=j=>MF.encode(j).padStart(Math.ceil(j.length*_F),"0"),Yn=(j=20)=>Array(j).fill(0).map(()=>qc[Math.floor(Math.random()*qc.length)]).join("");var eB="https://app.framerstatic.com/framer_compiler_bg-UTRYLQ4Z.wasm";var ft=gA("compiler");async function eH(){await Ai()}function tB(j){return{code:`const err = new Error(${JSON.stringify(String(j))}); err.name = "CompilationError"; throw err;`,sourceMap:void 0,annotations:{},exportedNames:[],reExportedModules:[],imports:{absolute:[],relative:[],bare:[]}}}function rB(j,A,e){let t={...A.exports};e&&(t.__FramerMetadata__={type:"variable"},j=j.concat(`
export const __FramerMetadata__ = `,JSON.stringify({exports:t})));let r=Object.entries(t).filter(([,n])=>n.type!=="tsType").map(([n])=>n),o={};for(let[n,a]of Object.entries(A.exports))a.annotations&&(o[n]=a.annotations);return{moduleCode:j,annotations:o,exportedNames:r}}async function oB({localId:j,name:A,source:e,includeSourceMap:t=!0}){let r=await Ai();try{let{code:o,metadata:n,map:a}=await r.transformSync(e,{fileName:re(A).source,framerContractVersion:1,mediaType:"tsx",minify:!1,compress:!1,mangle:!1,sourceMap:t,useReactRefresh:!0}),i=`
if (!window.$RefreshReg$) throw new Error("React refresh preamble was not loaded. Something is wrong.");
const prevRefreshReg = window.$RefreshReg$;
const prevRefreshSig = window.$RefreshSig$;
window.$RefreshReg$ = window.reactRefreshRuntime.getRefreshReg("${j}");
window.$RefreshSig$ = window.reactRefreshRuntime.createSignatureFunctionForTransform;

${o}

window.$RefreshReg$ = prevRefreshReg;
window.$RefreshSig$ = prevRefreshSig;`,{moduleCode:s,annotations:l,exportedNames:c}=rB(i,n,!0);return{code:s,sourceMap:a??void 0,imports:n.requestedModules,annotations:l,exportedNames:c,reExportedModules:n.reExportedModules}}catch(o){let n=`Failed to compile development module ${A}: ${o}`;return ft.debug(n,"(enable trace logging to see full source)"),ft.trace(e),j.startsWith("codeFile/")||(ft.reportCriticalError(new Error(n),{moduleName:A,moduleSource:e}),mA("application_error",{message:n,area:"compiler"})),tB(o)}}async function tH(j,A){await(await Ai()).transformSync(A,{fileName:re(j).source,framerContractVersion:1,mediaType:"tsx",minify:!0,compress:!1,mangle:!1,sourceMap:!1,useReactRefresh:!1})}async function nB({name:j,source:A,type:e,includeSourceMap:t=!0,addFramerMetadata:r=!0,telemetrySession:o}){let n=Yn(10),a=`compile-${j}-${n}`,i=`\u{1F4DD} Compile ${j}`;ft.debug("Compiling module",j,"; with source map:",t),Tn(a);let s=await Ai(),l=o?.start("transform"),c=e==="collection";try{let{code:u,map:p,metadata:f}=await s.transformSync(A,{fileName:re(j).source,framerContractVersion:1,mediaType:"tsx",minify:!0,compress:c,mangle:c,sourceMap:t,useReactRefresh:!1}),{moduleCode:E,annotations:F,exportedNames:h}=rB(u,f,r);return{code:E,sourceMap:p??void 0,imports:f.requestedModules,annotations:F,exportedNames:h,reExportedModules:f.reExportedModules}}catch(u){let p=`Failed to compile module ${j}: ${u}`;return ft.debug(p,"(enable trace logging to see full source)"),ft.trace(A),j.startsWith("codeFile/")||(ft.reportCriticalError(new Error(p),{moduleName:j,moduleSource:A}),mA("application_error",{message:p,area:"compiler"})),tB(u)}finally{l?.end(),aB(i,a)}}async function iB(j){let e=`analyze-imports-${Yn(10)}`,t="\u{1F575}\u{1F3FB} Analyze Imports";Tn(e);try{return{ok:!0,value:await(await Ai()).analyzeImports(j)}}catch(r){return ft.warn("Failed to analyze imports:",r),r instanceof Error?{ok:!1,error:r}:{ok:!1,error:new Error(`${r}`)}}finally{aB(t,e)}}var Ds;async function Ai(){if(!Ds){let j=new Worker(Ak("./modulesCompilerWorker.js")),A=Yp(j);Ds=A.initWithPathToWasm(eB).then(()=>({transformSync:A.transformSync,analyzeImports:A.analyzeImports})),Ds.catch(()=>{if(Om()||!e7.isProduction)throw new Error(`\u274C Your dev setup is struggling to run the compiler\u2019s WASM binary.
To fix it, run "make clean" followed by "make dev".`)})}return Ds}function aB(j,A){Ja(j,A),performance.getEntriesByName(j,"measure").forEach(({name:e,duration:t})=>{ft.debug(e,"took",t.toFixed(2),"ms"),Xm(e)}),Ha(A)}function sB(j,A){if(!W(j))return;let e=j.getSupportedLayout(L),t=j.getCurrentVariantSize(L);B6(e.width)&&t?.widthType!==0&&(A.widthType=2,A.left!==null&&A.right!==null&&(A.right=null)),B6(e.height)&&t?.heightType!==0&&(A.heightType=2,A.top!==null&&A.bottom!==null&&(A.bottom=null))}function lB(j,A,e=!0){j.scheduler.processWhenReady(()=>{let{overlayStore:t,selectionStore:r,scopeStore:o,canvasStore:n,persistedUserDefaults:a}=j.stores;o.selectByNode(A.id),r.set(A.id);let i=j.tree.get(A.cache.overlayAncestorId);if(je(i)?t.showOverlay(r,i,i.parentid):t.hideAll(),e){let s=j.tree.getBoundingFrameForNodes([A]);n.zoomToCenter(s,{animated:a.animateOnZoom,maxZoom:1})}})}var _r=class extends Error{constructor(e,t,r,o=!1){super(e);this.missing=t;this.error=r;this.wasTimeout=o}};function dH(j){return j instanceof _r}var Vc=gA("ensureComponentsInLoader"),NF=500,xF=30*1e3;async function Ns(j,A,e,t){let r=cB(A,j).length;if(r===0)return;let o=t??xF+r*2e3;Vc.debug("modules:",A.length,", new:",r,", timeout:",o),await OF(j,e,o);let n=cB(A,j);if(n.length===0)return;let a=wF(A,j);throw Vc.debug("components loaded, but some are missing",{missing:n,errors:a}),new _r("ensureComponentsInLoader: Some modules are missing.",n,a)}async function OF(j,A,e){let t=performance.now(),r=await LF(async()=>(await p6(e),"timeout"),async()=>{await A.whenIdle();let o=A.revision;return $(o>=0,"moduleStore.revision cannot be negative"),await A.loadAllLocalModules(),o});if(r==="timeout")throw new _r("ensureComponentsInLoader: Modules store not ready in time.",[],[],!0);for(let o=0;o<1e3;o++){let n=j.modulesRevision;if(r<=n)break;if(performance.now()-t>e)throw Vc.debug("component loader not updated in time: want:",r,"got:",n),new _r("ensureComponentsInLoader: Component loader not updated in time.",[],[],!0);await p6(NF)}}function cB(j,A){let e=new Set;for(let t of j)A.componentForIdentifier(t)||e.add(t);return Array.from(e)}function wF(j,A){let e=new Set;for(let t of j)Dj(A.errorForIdentifier(t))||e.add(t);return Array.from(e)}async function LF(...j){return Promise.race(j.map(async A=>A()))}async function dB(j,A){let e=[];j.forEach(t=>{let r=oA(t);r&&r.kind==="externalModuleExport"&&e.push(r)}),e.length&&await A.preloadExternalModules(e),await Ns(L,j,A)}function xs(j,A,e,t,r){if(aA(e.htmlContent))return;let o=j.getScopeNodeFor(A);$(o&&jo(o),"Can't find scope with breakpoints");let a=o.getTopLevelVariants().map(i=>{let s=pj(i)?e.id:ke(i.id,e.id),l=j.get(s);return $(l&&QA(l),"Can't find rich text node in breakpoint"),[i,l]});for(let[i,s]of a){$(oj(i),"Can't read width attribute of node");let l=xa(t,c=>(c.breakpointWidth??0)>i.width)??r;s.detachTextStylePreset(l,!0)}}var Kc=["formButtonSuccessVariant","formButtonPendingVariant","formButtonErrorVariant","formButtonIncompleteVariant","whileOpenEffectVariant","appearEffectVisibleVariantId","appearEffectObscuredVariantId","dataLoaderLoadingVariant","dataLoaderDisabledVariant"];function uB(j,A,e){let t=A.tokenOverrides;!t||Pe(t)||(pB(j,e,t),A.set({tokenOverrides:void 0}))}function pB(j,A,e){qF(j,A.id,e);let t=[];for(let r of A.variables){if(!mB(r)){t.push(r);continue}switch(r.type){case"border":t.push(ar(r.initialValue)?{...r,initialValue:{...r.initialValue,borderColor:Dr(r.initialValue.borderColor,e)}}:r);break;case"color":t.push({...r,initialValue:Dr(r.initialValue,e)});break;default:iA(r,"Unsupported variable type.")}}A.set({variables:t})}function qF(j,A,e){let t=j.tree.get(A);if(t)for(let{node:r,skipChildren:o}of t.walkWithSkipChildren()){if(hA(r)){o();continue}if(kB(r,e),VF(j,r,e),!W(r)||r.isVectorInstance)continue;let n=r.getLocalSmartComponentNodeId();if(!n){r.set({tokenOverrides:e});continue}let a=j.tree.get(n);eA(a)&&a.isLoaded()&&(pB(j,a,e),j.stores.codeGenerationStore.updateComponent(a.id))}}function VF(j,A,e){let t=Mt(j.tree,A);for(let r of t){let{relatedNode:o,replicaRoot:n}=r;n.replicaInfo.overrides[A.id]&&kB(o,e)}}function kB(j,A){if(Ge(j)){let e=Dr(j.fillColor,A);e&&j.set({fillColor:e})}if(ct(j)){let e=Dr(j.borderColor,A);e&&j.set({borderColor:e})}if(Ee(j)){let e=Dr(j.strokeColor,A);e&&j.set({strokeColor:e})}if(QA(j)){let e=new Map;for(let t in A){if(!z6(t))continue;let r=A[t],o=vu(t);o&&e.set(o,`var(${t}, ${r})`)}j.replaceColorTokenVariables(e)}else if(W(j)){let e=L.componentForIdentifier(j.codeComponentIdentifier);if(!e)return;let t=j.getControlProps(e.properties);if(!t)return;for(let r in t){let o=t[r];if(!(!o||!mB(o)))switch(o.type){case"border":if(!ar(o.value))break;j.setControlProp(r,{...o,value:{...o.value,borderColor:Dr(o.value.borderColor,A)}});break;case"color":j.setControlProp(r,{...o,value:Dr(o.value,A)});break;default:iA(o,"Unsupported control type.")}}}}function Dr(j,A){if(Dj(j)||!ot(j))return j;let e=bu(j);if(!z6(e))return j;let t=A[e];return t?`var(${e}, ${t})`:j}function mB(j){switch(j.type){case"color":case"border":return!0;case"array":case"boolean":case"number":case"string":case"richtext":case"eventhandler":case"image":case"file":case"scrollsectionref":case"customcursor":case"cursor":case"transition":case"boxshadow":case"gap":case"padding":case"borderradius":case"collectionreference":case"multicollectionreference":case"trackingid":case"vectorsetitem":case"date":case"enum":case"link":case"linkrelvalues":case"fusednumber":case"object":case"font":case"pagescope":case"slot":case"slug":case"controlReference":case"nodePropertyControlReference":return!1;default:iA(j,"Check if we support this variable type.")}}function fB(j){if(!w(j))return!1;for(let A of j.children)if(!IA(A)||vA(A)&&A.children.length>0)return!1;return!0}function EB(j,A,e){if(Wj(e))return;let t;j.stores.scopeStore.removeNode(A);let r=pr(j.tree,e.id);r&&j.tree.removeNode(r);let o=j.tree.root.homePageNodeId,n=pr(j.tree,A.id);n&&(A.id===o?j.tree.removeNode(n):n.set({webPageId:e.id})),j.tree.current(e)?.set({name:A.name,pagePath:A.pagePath}),j.tree.has(o)||(t??={},t.homePageNodeId=e.id),t&&j.tree.root.set(t)}function ji(j,A){return j.filter(e=>e.originalid===A.id).sort((e,t)=>(t.breakpointWidth??0)-(e.breakpointWidth??0))}function e5(j,A){let e=j.getPresetsListNode();$(e,"Can't find PresetsListNode");let t=e.children.filter(It);return ji(t,A)}function S5(j,A,e){if(!QA(e))return;let t=e.getStylePresetsForCodeGeneration(j);for(let r of t){let o=j.getNodes(r.cache.replicaInstances??[]);for(let n of o)A[n.id]??=n.toJS();A[r.id]??=r.toJS()}}function Jc(j,A,e){for(let t of A){let r=j[t];if(!r)continue;let o=e(r);o&&o.id!==r&&j.set({[t]:o.id})}}function BB({engine:j,node:A,pastedPresetMap:e,stylePresetNodes:t,fromSameProject:r,breakpointVariantIds:o,shouldCreateNewPresets:n}){if(!t)return;let a={pastedPresetMap:e,stylePresetNodes:t,shouldCreateNewPresets:n},i=c=>KF(j,c,a);if(Jc(A,im,i),A.remapTextStylePresets(i),r)return;let s=Qo(A),l=j.tree.getGroundNodeFor(A);for(let c of A.getStylePresetIdsForCodeGeneration()){let u=t.find(f=>f.id===c);if(!u||!Yr(u))continue;let p=ji(t,u);if(s){xs(j.tree,s,A,p,u);continue}if(o?.has(l.id)&&oj(l)){let f=xa(p,E=>(E.breakpointWidth??0)>l.width)??u;A.detachTextStylePreset(f,!1);continue}A.detachTextStylePreset(u,!1)}}function KF(j,A,{pastedPresetMap:e,stylePresetNodes:t,shouldCreateNewPresets:r}){if(!t)return;let o=t.find(u=>u.id===A);if(!o)return;let n=j.tree.get(A);if(n&&Yr(n)&&n.equals(o))return e.set(A,n),n;if(!r)return;let i=Ir(j.tree),s=i.getTextStylePresets().find(u=>u.equals(o));if(s&&Yr(s))return e.set(A,s),s;let l=n?o.clone():o.cloneWithIds();j.tree.insertNode(l,i.id),e.set(A,l);let c=t.filter(u=>u.originalid===A);for(let u of c){let p=j.tree.get(A);if(p&&Y7(p)&&p.equals(u)){e.set(A,p);continue}let E=p?u.clone():u.cloneWithIds();j.tree.insertNode(E,i.id),e.set(A,E)}return l}function gB({engine:j,node:A,pastedPresetMap:e,stylePresetNodes:t}){if(!t)return;let r={pastedPresetMap:e,stylePresetNodes:t},o=n=>JF(j,n,r);Jc(A,sm,o),A.remapLinkStylePresets(o)}function JF(j,A,{pastedPresetMap:e,stylePresetNodes:t}){if(!t)return;let r=t.find(l=>l.id===A);if(!r||!Ft(r))return;let o=j.tree.get(A);if(o&&Ft(o)&&o.equals(r))return e.set(A,o),o;let a=Ir(j.tree),i=a.getLinkStylePresets().find(l=>l.equals(r));if(i&&Ft(i))return e.set(A,i),i;let s=o?r.clone():r.cloneWithIds();return j.tree.insertNode(s,a.id),e.set(A,s),s}function hB({engine:j,node:A,pastedPresetMap:e,stylePresetNodes:t}){if(!t)return;let r={pastedPresetMap:e,stylePresetNodes:t},o=n=>HF(j,n,r);Jc(A,lm,o),A.remapInlineCodeStylePresets(o)}function HF(j,A,{pastedPresetMap:e,stylePresetNodes:t}){if(!t)return;let r=t.find(l=>l.id===A);if(!r||!Gt(r))return;let o=j.tree.get(A);if(o&&Gt(o)&&o.equals(r))return e.set(A,o),o;let a=Ir(j.tree),i=a.getInlineCodeStylePresets().find(l=>l.equals(r));if(i&&Gt(i))return e.set(A,i),i;let s=o?r.clone():r.cloneWithIds();return j.tree.insertNode(s,a.id),e.set(A,s),s}function y5(j){if(w(j))return{id:j.id,pagePath:j.pagePath,webMetadata:j.webMetadata,customHTML:j.customHTML,dataIdentifier:j.dataIdentifier}}function C5(j,A,e,t){let r={},o=new Set;function n(a){Gs(a,i=>{if(t.has(i))return;let s=QF(j,i);s&&(r[i]=s);let l=hk(i,j.tree,j.stores.modulesStore,o);l&&Object.assign(r,l)})}for(let a of A.walk())n(a);return w(e)&&n(e),{moduleData:r}}function QF(j,A){let e=oA(A);if(e&&e.kind==="localModuleExport"){let t=j.stores.modulesStore.getPersistedModuleByLocalId(e.localId);return t?($(t.files.module,"expected module typed file in persisted module"),le(t.id,t.saveId,t.files.module,e.exportSpecifier)):void 0}if(e&&e.kind==="externalModuleExport")return e}function UF(j,A,e){let t=oA(A);if(YA(t))return $(j.stores.modulesStore.initialized,"Cannot paste modules before modulesStore has been initialized."),j.stores.modulesStore.getPersistedModuleByLocalId(t.localId)?.id===e.moduleId?null:e.value;if($e(t)&&t.kind==="externalModuleExport"){let r=j.stores.modulesStore.getPersistedModuleByGlobalId(t.moduleId)?.localId;return r?Kr(t,r).value:null}return null}function WF(j,A,e,t,r){let o=t.cloneWithIds();o.set(r),j.removeNode(t),j.insertNode(o,A,e)}function b5(j,A,e){if(!e)return A;for(let t of A.root.walk())vA(t)&&t.children.forEach((r,o)=>{if(e){let n=Ss(r,i=>{let s=e[i];if(!s)return;let l=UF(j,i,s);return l||void 0});if(!n)return;let a=A.current(r);if(!a)return;WF(A,t.id,o,a,n)}});return A.commit()}function zF(j){return aj(j)&&oj(j)}function v5(j,A,e){let t=j.get(e.id);if(!t)return;let r=Qo(t);if(!r||!IA(r))return;let o=j.getNodes(r.cache.replicaInstances??[]).filter(zF);for(let{width:n,replicaInfo:a}of o){let i=A.get(n)??{},s=a.overrides[e.id];s&&(i[e.id]=s),A.set(n,i)}oj(r)&&!A.get(r.width)&&A.set(r.width,{})}function vo(j,A,e,t){if(ot(A)){let r=na(A),o=j.get(r);if(o&&!(o.id in e)){let n=o.cloneWithIds();e[n.id]=n.toJS(),t&&(t[o.id]=vt())}}else if($u(A))vo(j,A.color,e,t);else if(_p(A)||Mp(A)||Np(A))for(let r of A.stops)vo(j,r.value,e,t);else if(ij(A))for(let r of A)vo(j,r,e,t);else ar(A)&&vo(j,A.borderColor,e,t)}function T5(j,A,e,t){if(QA(A)){let r=A.getInlineStyleTokenVariables();vo(j,r,e,t)}for(let r in A)vo(j,A[r],e,t)}function P5(j,A,e){let t=e-A;return Math.ceil(j/100*t+A)}function $B({collectedCollections:j,node:A,tree:e}){if(Wj(A)){let t=oA(A.dataIdentifier);if(!YA(t))return;let r=e.getNodeWithTrait(t.localIdName,uj);r&&(j.set(A.dataIdentifier,r),$B({collectedCollections:j,node:r,tree:e}))}if(uj(A))for(let t of A.variables){if(!ia(t))continue;let r=oA(t.dataIdentifier);if(!YA(r))continue;let o=e.getNodeWithTrait(r.localIdName,uj);o&&(j.has(t.dataIdentifier)||(j.set(t.dataIdentifier,o),$B({collectedCollections:j,node:o,tree:e})))}}function w5(j){return fj(j)?j.getGroundNodes().length===0:!1}function L5(j){if(!w(j))return!1;let A=j.getGroundNodes();return A.length>1?!1:A.length===0?!0:A[0]?.children?.length===0}function q5(j){return j?!j.children||j.children.length===0:!1}function Hc(j,A=!0){let e=j.trim().split("/").filter(Boolean).map(t=>{let r="/"+t,o=Ms(r);return o.startsWith("/")?o.slice(1):o});return j.endsWith("/")&&A&&e.push(""),e}function V5(j){return`/${Hc(j).join("/")}`}function XF(j){return j===""}function K5(j){return!!(j.webPageId&&XF(j.segment))}function YF(j,A){let e=A.get(j);if(!St(e))return;let t=A.get(e.webPageId);if(w(t)||e.children.length>0)return;let r=e.parentid;A.removeNode(e),r&&YF(r,A)}function J5(j,A){if(!j)return;let e=L.dataForIdentifier(j);if(e)return rf(void 0,e,A??ku)}function RB(j,A,e,t,r){let o=Hc(t,w(A,!0));$(o.length>0,"Path must have at least one segment");let n=j.tree.getRouteSegmentRootNode();return o.forEach((a,i)=>{let s=i===o.length-1,l=s?r?.positionInParent:void 0,c=Ca(a)?e:void 0;c&&(a=wc(c,a));let u=n.children.find(f=>f.segment===a),p=u&&s&&A;if(!u||p&&u.webPageId){let f=new hm({segment:a,webPageId:s?A?.id:void 0,dataIdentifier:c});j.tree.insertNode(f,n.id,l),n=f}else p&&u.set({webPageId:A.id,dataIdentifier:c}),n=u}),$(St(n),"Current parent should be the created RouteSegmentNode"),n}function IB(j,A){let e=pr(j,A);return j.get(e?.parentid)?.children.findIndex(r=>r.id===e?.id)}function ZF(j,A,e){let t=new Set(j.stores.scopeStore.getSmartComponentNodes().map(r=>r.name).filter(_));return e||A===null?Cj(e??"Component",t):Cj(A,t)}function Qc(j,A,e,t,{insertionIndex:r,preferredName:o,enterIsolation:n=!0,localIdsToExternalIdentifiers:a=new Map,externalModuleIdsToLocalIds:i=new Map,instance:s,renamedIds:l=new Map,isAutoDetach:c=!1,intrinsicSize:u,textStylePresets:p,linkStylePresets:f,inlineCodeStylePresets:E,pastedPresetMap:F=new Map,fromInsertSidebar:h=!1,abTesting:S=!1}={}){let v=c?La.createEmpty():j.tree,P={children:[]};if(w(A)){let x=A.id===j.tree.root.homePageNodeId?"Home":mo(j.tree,A),{suggestedName:z,path:K}=Lc(o??x??"Page",j,A,!0);P.pagePath=K,P.name=z}else P.name=ZF(j,A.name,o);let T=A.clone(P);l.set(A.id,T.id),eA(A)&&Ef({componentId:T.id,source:t});let N=T.instanceIdentifier,Q=IA(e),H=Mr(e,a,i,l,Q),Z=[H];T.baseVariantId=H.id,T.addChild(H);for(let x of A.children)if(!(x.id===e.id||Ao(x)))if(aj(x)&&MA(x)){let z=Co(x.replicaInfo.overrides,l,!0);if($A(x)){z[H.id]??={};let nA=z[H.id];nA.top=x.top,nA.left=x.left,nA.right=x.right,nA.bottom=x.bottom,nA.centerAnchorX=x.centerAnchorX,nA.centerAnchorY=x.centerAnchorY}let K=kA.create(j.tree,H,{overrides:z,duplicatedFrom:cn(x)});l.set(x.id,K.id),Z.push(K),T.addChild(K)}else{let z=Mr(x,a,i,void 0,Q);Z.push(z),l.set(x.id,z.id),T.addChild(z)}v.insertNode(T,void 0,r);for(let x=0;x<A.children.length;x++){let z=A.children[x];if(!Ao(z))continue;let K=kA.create(v,H,{overrides:Co(z.replicaInfo.overrides,l,!0),inheritsFrom:l.get(z.replicaInfo.inheritsFrom),duplicatedFrom:cn(z)});l.set(z.id,K.id),Z.push(K),v.insertNode(K,T.id,x)}let J=Ps(v);for(let x of Z){if(be(v,x,l,!1),!p&&!f&&!E)continue;let z=[];for(let K of x.walk())QA(K)&&z.push(K);for(let K of z){let nA=K.getStylePresetIdsForCodeGeneration();if(f&&gB({engine:j,node:K,pastedPresetMap:F,stylePresetNodes:f}),E&&hB({engine:j,node:K,pastedPresetMap:F,stylePresetNodes:E}),p){if(h)BB({engine:j,node:K,pastedPresetMap:F,stylePresetNodes:p,fromSameProject:!0,shouldCreateNewPresets:h});else for(let BA of p)if(nA.has(BA.id))if(w(A)&&IA(x)){if(Uj(x)){let WA=ji(p,BA);xs(v,H,K,WA,BA)}}else(Uj(x)||UA(v,K,"html"))&&K.detachTextStylePreset(BA,!1)}}for(let K of z){UA(v,K,"html")&&(K.remapTextStylePresets((nA,BA)=>{let WA=Lp(BA)?BA:"p",HA=K.getNodeTextStylePreset(v,WA)??Oa(v,WA)??Kp.createDefault(WA);return $m(j,HA),HA}),K.remapLinkStylePresets(()=>{let nA=K.getNodeLinkStylePreset(v)??fm(v)??om.createDefault();return Em(j,nA),nA}),K.remapInlineCodeStylePresets(()=>{let nA=K.getNodeInlineCodeStylePreset(v)??km(v)??new zk;return mm(j,nA),nA}));for(let nA in J)UA(v,K,nA)&&K.set({[nA]:J[nA]})}}let{codeGenerationStore:AA}=j.stores;for(let x of F.values())hA(x)||AA.createModuleFromComponentSource(x).catch(yA);if(c)return v.commit(),T.draftOrCurrent();{let x=v.get(T.baseVariantId);if(x&&pj(x))for(let z of T.children)an(z)&&z.replicaInfo.master===x.id&&kA.registerInInheritedNode(x,z)}j.scheduler.process(()=>{if(!s)return;let x=j.tree.current(s);if(!x)return;let z={},K={},nA=s.getRawControlProps();if(nA.variant?.value&&_(nA.variant.value)){let BA=l.get(nA.variant.value)??H.id,WA={type:"enum",value:BA};z.variant=WA}for(let BA of Kc){let WA=s[BA];_(WA)&&(K[BA]=l.get(WA)??void 0)}Mt(j.tree,x).forEach(({relatedNode:BA,replicaRoot:WA})=>{let HA=WA.replicaInfo.overrides[BA.originalid];if(!HA)return;let vj={};for(let ae of Kc){if(!(ae in HA))continue;let Zt=HA[ae];_(Zt)&&(K[ae]=l.get(Zt)??void 0)}if(BA.set(vj),!(VA("variant")in HA))return;let sj=BA.getRawControlProp("variant");if(!sj||!_(sj.value))return;let Tj=l.get(sj.value);if(!Tj)return;let ie={type:"enum",value:Tj};BA.set(Zr({variant:ie}))}),x.set({codeComponentIdentifier:N,...K,...Zr(z)})});let jA=AA.createModuleFromComponentSource(T,u);if(s&&jA.then(j.scheduler.wrapHandler(()=>{if(s=j.tree.get(s?.id),!s)return;let x=j.stores.treeStore.tree.getScopeNodeFor(s)?.loaded;if(!x||!lr(x))return;let z=j.stores.treeStore.tree.get(x.baseVariantId);z&&pj(z)&&AA.updateComponent(x.id).catch(yA)})).catch(yA),n&&(j.stores.chromeStore.contentPanelTab="Layers",j.stores.scopeStore.select(T.id,{keepHistory:!0})),w(T)&&!S){$(_(P.pagePath),"pagePath should be a string");let x=IB(j.tree,A.id),z=Y(x)?x+1:void 0;RB(j,T,T.dataIdentifier,P.pagePath,{positionInParent:z})}return T.draftOrCurrent()}async function FB(j,{identifier:A,enterIsolation:e,instance:t,isAutoDetach:r,renamedIds:o=new Map,info:n}){let{node:a,dependencies:i}=await o$(j,A);$(rs(a),"Should be a generated node.");let s=j.tree.get(t?.originalid??t?.id);$(!s||W(s),"instance should be a code component.");let l=a.children.find(h=>h.id===a.baseVariantId);$(l&&pj(l),"Unlink: Can't unlink a tree which doesn't have a Primary Variant node");let{identifiers:c,localIdsToExternalIdentifiers:u,externalModuleIdsToLocalIds:p}=t$(a,j.stores.modulesStore,i);if(await dB(c.map(h=>h.value),j.stores.modulesStore),c.some(h=>{let S=L.dataForIdentifier(h.value);return S?yp(S):!1})){TA({type:"add",variant:"info",text:"Remove collection references before unlinking"});return}let E=await e$(i.imports);return await n$(j,i,A),await j.stores.modulesStore.addExternalModulesToProject(c,{onTreeUpdate:()=>{let h=j.tree.current(s),S=at(n.module.metadata.intrinsicWidth)??200,v=at(n.module.metadata.intrinsicHeight)??200,P=Qc(j,a,l,"unlink",{enterIsolation:e,localIdsToExternalIdentifiers:u,externalModuleIdsToLocalIds:p,instance:h,renamedIds:o,isAutoDetach:r,intrinsicSize:{width:S,height:v},textStylePresets:E});return h&&eA(P)&&uB(j,h,P),P}})}async function GB(j,A){let e=await FB(j,A);if(!e)return;$(eA(e),"node should be a smart component");let{isAutoDetach:t}=A;return t||await j.stores.codeGenerationStore.untilCompiled(e.id),e.draftOrCurrent()}async function SB(j,A){let[e]=await j.stores.modulesStore.preloadExternalModules([A]);if(!e)return;let t=await FB(j,{identifier:A,enterIsolation:!1,info:e});$(w(t),"node should be a web page");let{path:r,suggestedName:o}=Lc(t.name??"Page",j,t,!0);return j.scheduler.processWhenReady(()=>{j.tree.current(t)?.set({name:o,pagePath:r});let n=j.stores.scopeStore.active;fB(n)&&EB(j,n,t),j.stores.scopeStore.select(t.id,{keepHistory:!1})}),t}function yB(j,A,e,t){let r=Qc(j,A,e,"duplicate",{enterIsolation:!1,preferredName:t,insertionIndex:j.tree.root.children.findIndex(o=>o.id===A.id)+1});j.stores.persistedUserDefaults.newContentAsDraft&&r.set({isDraft:!0,duplicatedFrom:ca(r.duplicatedFrom,A.id)}),j.stores.scopeStore.select(r.id,{keepHistory:!1})}async function eQ(j,A){let e=new Map,t=new Set(j.stores.scopeStore.getDesignPageNodes().map(i=>i.name).filter(_)),r=Cj(A.name??"Design",t),o=A.isLoaded()?A:await A.load();if(!o)return;let n=o.clone({name:r,children:[]});e.set(o.id,n.id);let a=[];for(let i of o.children){let s=Mr(i,new Map,new Map,e,!1);a.push(s),e.set(i.id,s.id),n.addChild(s)}j.tree.insertNode(n,void 0,j.tree.root.children.findIndex(i=>i.id===A.id)+1);for(let i of a)be(j.tree,i,e,!1);return mA("design_page_create",{pageId:n.id,source:"duplicate"}),n}function CB(j,A){let[e,...t]=A.stores.selectionStore.ids;if(!e||t.length)return null;let r=A.tree,o=r.getNode(e),n=!1;for(;!n&&o&&(n=Dt(r,o,j,A.stores.scopeStore.active.id,L),!n);)o=r.getParent(o.id);return o}function Uc(j){let A={};for(let[e,t]of j)TB(A,e,t);return A}function Po(j,A,e){return tj(j,t=>{TB(t,A,e)})}function ws(j,A){return j[A]?tj(j,e=>{let t=e[A];if(t){for(let r of t.dependents){let o=e[r];o&&(o.dependencies.delete(A),Os(o)&&delete e[r])}for(let r of t.dependencies){let o=e[r];o&&(o.dependents.delete(A),Os(o)&&delete e[r])}delete e[A]}}):j}function Nr(j,A,e,t,r){let o=new Set,n=[A];for(t=t||new Set,r=r||new Set;n.length>0;){let a=n.pop();if(!a||o.has(a))continue;o.add(a);let i=j[a];if(i){if(t.has(a))r.add(a);else if(!t.size)e.add(a);else{let s=!1;for(let l of i.dependents)if(t.has(l)||r.has(l)){s=!0;break}s?r.add(a):e.add(a)}for(let s of i.dependents)o.has(s)||n.push(s)}}}function vB(j,A){let e=new Set,t=[A];for(;jG(t);){let r=t.shift(),o=j[r];if(o){for(let n of o.dependents)e.has(n)||(e.add(n),t.push(n));if(e.has(A))return!0}}return!1}function AG(j,A){let e=Se(j,A);if(e)return e.startsWith("collection")&&!A.startsWith("collection")&&!A.startsWith("draftCollection")?e.replace("collection","draftCollection"):e}function TB(j,A,e){let t=j[A];if(!t){if(e.length===0)return;t=bB(j,A)}let r=new Set(t.dependencies);for(let o of e){let n=AG(o,A);if(!n)continue;t.dependencies.add(n);let a=j[n];a||(a=bB(j,n)),a.dependents.add(A),t.dependencies.add(n),r.delete(n)}for(let o of r){let n=j[o];n&&(n.dependents.delete(A),Os(n)&&delete j[o])}Os(t)&&delete j[A]}function Os(j){return j.dependents.size===0&&j.dependencies.size===0}function bB(j,A){let e={dependents:new Set,dependencies:new Set};return j[A]=e,e}function jG(j){return j.length>0}var Jt=".tsx";var eG=["arguments","await","break","case","catch","class","const","continue","debugger","default","delete","do","else","enum","eval","export","extends","false","finally","for","function","if","implements","import","in","instanceof","interface","let","new","null","package","private","protected","public","return","static","super","switch","this","throw","true","try","typeof","var","void","while","with","yield","Infinity","NaN","document","undefined","window"],tG=["toolbar"],rG=/^[$A-Z_a-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEF\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7C6\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB67\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC\u{10000}-\u{1000B}\u{1000D}-\u{10026}\u{10028}-\u{1003A}\u{1003C}\u{1003D}\u{1003F}-\u{1004D}\u{10050}-\u{1005D}\u{10080}-\u{100FA}\u{10140}-\u{10174}\u{10280}-\u{1029C}\u{102A0}-\u{102D0}\u{10300}-\u{1031F}\u{1032D}-\u{1034A}\u{10350}-\u{10375}\u{10380}-\u{1039D}\u{103A0}-\u{103C3}\u{103C8}-\u{103CF}\u{103D1}-\u{103D5}\u{10400}-\u{1049D}\u{104B0}-\u{104D3}\u{104D8}-\u{104FB}\u{10500}-\u{10527}\u{10530}-\u{10563}\u{10600}-\u{10736}\u{10740}-\u{10755}\u{10760}-\u{10767}\u{10800}-\u{10805}\u{10808}\u{1080A}-\u{10835}\u{10837}\u{10838}\u{1083C}\u{1083F}-\u{10855}\u{10860}-\u{10876}\u{10880}-\u{1089E}\u{108E0}-\u{108F2}\u{108F4}\u{108F5}\u{10900}-\u{10915}\u{10920}-\u{10939}\u{10980}-\u{109B7}\u{109BE}\u{109BF}\u{10A00}\u{10A10}-\u{10A13}\u{10A15}-\u{10A17}\u{10A19}-\u{10A35}\u{10A60}-\u{10A7C}\u{10A80}-\u{10A9C}\u{10AC0}-\u{10AC7}\u{10AC9}-\u{10AE4}\u{10B00}-\u{10B35}\u{10B40}-\u{10B55}\u{10B60}-\u{10B72}\u{10B80}-\u{10B91}\u{10C00}-\u{10C48}\u{10C80}-\u{10CB2}\u{10CC0}-\u{10CF2}\u{10D00}-\u{10D23}\u{10F00}-\u{10F1C}\u{10F27}\u{10F30}-\u{10F45}\u{10FE0}-\u{10FF6}\u{11003}-\u{11037}\u{11083}-\u{110AF}\u{110D0}-\u{110E8}\u{11103}-\u{11126}\u{11144}\u{11150}-\u{11172}\u{11176}\u{11183}-\u{111B2}\u{111C1}-\u{111C4}\u{111DA}\u{111DC}\u{11200}-\u{11211}\u{11213}-\u{1122B}\u{11280}-\u{11286}\u{11288}\u{1128A}-\u{1128D}\u{1128F}-\u{1129D}\u{1129F}-\u{112A8}\u{112B0}-\u{112DE}\u{11305}-\u{1130C}\u{1130F}\u{11310}\u{11313}-\u{11328}\u{1132A}-\u{11330}\u{11332}\u{11333}\u{11335}-\u{11339}\u{1133D}\u{11350}\u{1135D}-\u{11361}\u{11400}-\u{11434}\u{11447}-\u{1144A}\u{1145F}\u{11480}-\u{114AF}\u{114C4}\u{114C5}\u{114C7}\u{11580}-\u{115AE}\u{115D8}-\u{115DB}\u{11600}-\u{1162F}\u{11644}\u{11680}-\u{116AA}\u{116B8}\u{11700}-\u{1171A}\u{11800}-\u{1182B}\u{118A0}-\u{118DF}\u{118FF}\u{119A0}-\u{119A7}\u{119AA}-\u{119D0}\u{119E1}\u{119E3}\u{11A00}\u{11A0B}-\u{11A32}\u{11A3A}\u{11A50}\u{11A5C}-\u{11A89}\u{11A9D}\u{11AC0}-\u{11AF8}\u{11C00}-\u{11C08}\u{11C0A}-\u{11C2E}\u{11C40}\u{11C72}-\u{11C8F}\u{11D00}-\u{11D06}\u{11D08}\u{11D09}\u{11D0B}-\u{11D30}\u{11D46}\u{11D60}-\u{11D65}\u{11D67}\u{11D68}\u{11D6A}-\u{11D89}\u{11D98}\u{11EE0}-\u{11EF2}\u{12000}-\u{12399}\u{12400}-\u{1246E}\u{12480}-\u{12543}\u{13000}-\u{1342E}\u{14400}-\u{14646}\u{16800}-\u{16A38}\u{16A40}-\u{16A5E}\u{16AD0}-\u{16AED}\u{16B00}-\u{16B2F}\u{16B40}-\u{16B43}\u{16B63}-\u{16B77}\u{16B7D}-\u{16B8F}\u{16E40}-\u{16E7F}\u{16F00}-\u{16F4A}\u{16F50}\u{16F93}-\u{16F9F}\u{16FE0}\u{16FE1}\u{16FE3}\u{17000}-\u{187F7}\u{18800}-\u{18AF2}\u{1B000}-\u{1B11E}\u{1B150}-\u{1B152}\u{1B164}-\u{1B167}\u{1B170}-\u{1B2FB}\u{1BC00}-\u{1BC6A}\u{1BC70}-\u{1BC7C}\u{1BC80}-\u{1BC88}\u{1BC90}-\u{1BC99}\u{1D400}-\u{1D454}\u{1D456}-\u{1D49C}\u{1D49E}\u{1D49F}\u{1D4A2}\u{1D4A5}\u{1D4A6}\u{1D4A9}-\u{1D4AC}\u{1D4AE}-\u{1D4B9}\u{1D4BB}\u{1D4BD}-\u{1D4C3}\u{1D4C5}-\u{1D505}\u{1D507}-\u{1D50A}\u{1D50D}-\u{1D514}\u{1D516}-\u{1D51C}\u{1D51E}-\u{1D539}\u{1D53B}-\u{1D53E}\u{1D540}-\u{1D544}\u{1D546}\u{1D54A}-\u{1D550}\u{1D552}-\u{1D6A5}\u{1D6A8}-\u{1D6C0}\u{1D6C2}-\u{1D6DA}\u{1D6DC}-\u{1D6FA}\u{1D6FC}-\u{1D714}\u{1D716}-\u{1D734}\u{1D736}-\u{1D74E}\u{1D750}-\u{1D76E}\u{1D770}-\u{1D788}\u{1D78A}-\u{1D7A8}\u{1D7AA}-\u{1D7C2}\u{1D7C4}-\u{1D7CB}\u{1E100}-\u{1E12C}\u{1E137}-\u{1E13D}\u{1E14E}\u{1E2C0}-\u{1E2EB}\u{1E800}-\u{1E8C4}\u{1E900}-\u{1E943}\u{1E94B}\u{1EE00}-\u{1EE03}\u{1EE05}-\u{1EE1F}\u{1EE21}\u{1EE22}\u{1EE24}\u{1EE27}\u{1EE29}-\u{1EE32}\u{1EE34}-\u{1EE37}\u{1EE39}\u{1EE3B}\u{1EE42}\u{1EE47}\u{1EE49}\u{1EE4B}\u{1EE4D}-\u{1EE4F}\u{1EE51}\u{1EE52}\u{1EE54}\u{1EE57}\u{1EE59}\u{1EE5B}\u{1EE5D}\u{1EE5F}\u{1EE61}\u{1EE62}\u{1EE64}\u{1EE67}-\u{1EE6A}\u{1EE6C}-\u{1EE72}\u{1EE74}-\u{1EE77}\u{1EE79}-\u{1EE7C}\u{1EE7E}\u{1EE80}-\u{1EE89}\u{1EE8B}-\u{1EE9B}\u{1EEA1}-\u{1EEA3}\u{1EEA5}-\u{1EEA9}\u{1EEAB}-\u{1EEBB}\u{20000}-\u{2A6D6}\u{2A700}-\u{2B734}\u{2B740}-\u{2B81D}\u{2B820}-\u{2CEA1}\u{2CEB0}-\u{2EBE0}\u{2F800}-\u{2FA1D}]+/u,oG=/[\0-#%-/:-@[-^`{-\xA9\xAB-\xB4\xB6-\xB9\xBB-\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0378\u0379\u037E\u0380-\u0385\u0387\u038B\u038D\u03A2\u03F6\u0482\u0488\u0489\u0530\u0557\u0558\u055A-\u055F\u0589-\u0590\u05BE\u05C0\u05C3\u05C6\u05C8-\u05CF\u05EB-\u05EE\u05F3-\u060F\u061B-\u061F\u066A-\u066D\u06D4\u06DD\u06DE\u06E9\u06FD\u06FE\u0700-\u070F\u074B\u074C\u07B2-\u07BF\u07F6-\u07F9\u07FB\u07FC\u07FE\u07FF\u082E-\u083F\u085C-\u085F\u086B-\u089F\u08B5\u08BE-\u08D2\u08E2\u0964\u0965\u0970\u0984\u098D\u098E\u0991\u0992\u09A9\u09B1\u09B3-\u09B5\u09BA\u09BB\u09C5\u09C6\u09C9\u09CA\u09CF-\u09D6\u09D8-\u09DB\u09DE\u09E4\u09E5\u09F2-\u09FB\u09FD\u09FF\u0A00\u0A04\u0A0B-\u0A0E\u0A11\u0A12\u0A29\u0A31\u0A34\u0A37\u0A3A\u0A3B\u0A3D\u0A43-\u0A46\u0A49\u0A4A\u0A4E-\u0A50\u0A52-\u0A58\u0A5D\u0A5F-\u0A65\u0A76-\u0A80\u0A84\u0A8E\u0A92\u0AA9\u0AB1\u0AB4\u0ABA\u0ABB\u0AC6\u0ACA\u0ACE\u0ACF\u0AD1-\u0ADF\u0AE4\u0AE5\u0AF0-\u0AF8\u0B00\u0B04\u0B0D\u0B0E\u0B11\u0B12\u0B29\u0B31\u0B34\u0B3A\u0B3B\u0B45\u0B46\u0B49\u0B4A\u0B4E-\u0B55\u0B58-\u0B5B\u0B5E\u0B64\u0B65\u0B70\u0B72-\u0B81\u0B84\u0B8B-\u0B8D\u0B91\u0B96-\u0B98\u0B9B\u0B9D\u0BA0-\u0BA2\u0BA5-\u0BA7\u0BAB-\u0BAD\u0BBA-\u0BBD\u0BC3-\u0BC5\u0BC9\u0BCE\u0BCF\u0BD1-\u0BD6\u0BD8-\u0BE5\u0BF0-\u0BFF\u0C0D\u0C11\u0C29\u0C3A-\u0C3C\u0C45\u0C49\u0C4E-\u0C54\u0C57\u0C5B-\u0C5F\u0C64\u0C65\u0C70-\u0C7F\u0C84\u0C8D\u0C91\u0CA9\u0CB4\u0CBA\u0CBB\u0CC5\u0CC9\u0CCE-\u0CD4\u0CD7-\u0CDD\u0CDF\u0CE4\u0CE5\u0CF0\u0CF3-\u0CFF\u0D04\u0D0D\u0D11\u0D45\u0D49\u0D4F-\u0D53\u0D58-\u0D5E\u0D64\u0D65\u0D70-\u0D79\u0D80\u0D81\u0D84\u0D97-\u0D99\u0DB2\u0DBC\u0DBE\u0DBF\u0DC7-\u0DC9\u0DCB-\u0DCE\u0DD5\u0DD7\u0DE0-\u0DE5\u0DF0\u0DF1\u0DF4-\u0E00\u0E3B-\u0E3F\u0E4F\u0E5A-\u0E80\u0E83\u0E85\u0E8B\u0EA4\u0EA6\u0EBE\u0EBF\u0EC5\u0EC7\u0ECE\u0ECF\u0EDA\u0EDB\u0EE0-\u0EFF\u0F01-\u0F17\u0F1A-\u0F1F\u0F2A-\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F48\u0F6D-\u0F70\u0F85\u0F98\u0FBD-\u0FC5\u0FC7-\u0FFF\u104A-\u104F\u109E\u109F\u10C6\u10C8-\u10CC\u10CE\u10CF\u10FB\u1249\u124E\u124F\u1257\u1259\u125E\u125F\u1289\u128E\u128F\u12B1\u12B6\u12B7\u12BF\u12C1\u12C6\u12C7\u12D7\u1311\u1316\u1317\u135B\u135C\u1360-\u137F\u1390-\u139F\u13F6\u13F7\u13FE-\u1400\u166D\u166E\u1680\u169B-\u169F\u16EB-\u16ED\u16F9-\u16FF\u170D\u1715-\u171F\u1735-\u173F\u1754-\u175F\u176D\u1771\u1774-\u177F\u17D4-\u17D6\u17D8-\u17DB\u17DE\u17DF\u17EA-\u180A\u180E\u180F\u181A-\u181F\u1879-\u187F\u18AB-\u18AF\u18F6-\u18FF\u191F\u192C-\u192F\u193C-\u1945\u196E\u196F\u1975-\u197F\u19AC-\u19AF\u19CA-\u19CF\u19DA-\u19FF\u1A1C-\u1A1F\u1A5F\u1A7D\u1A7E\u1A8A-\u1A8F\u1A9A-\u1AA6\u1AA8-\u1AAF\u1ABE-\u1AFF\u1B4C-\u1B4F\u1B5A-\u1B6A\u1B74-\u1B7F\u1BF4-\u1BFF\u1C38-\u1C3F\u1C4A-\u1C4C\u1C7E\u1C7F\u1C89-\u1C8F\u1CBB\u1CBC\u1CC0-\u1CCF\u1CD3\u1CFB-\u1CFF\u1DFA\u1F16\u1F17\u1F1E\u1F1F\u1F46\u1F47\u1F4E\u1F4F\u1F58\u1F5A\u1F5C\u1F5E\u1F7E\u1F7F\u1FB5\u1FBD\u1FBF-\u1FC1\u1FC5\u1FCD-\u1FCF\u1FD4\u1FD5\u1FDC-\u1FDF\u1FED-\u1FF1\u1FF5\u1FFD-\u200C\u200E-\u203E\u2041-\u2053\u2055-\u2070\u2072-\u207E\u2080-\u208F\u209D-\u20CF\u20DD-\u20E0\u20E2-\u20E4\u20F1-\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F-\u215F\u2189-\u220B\u220D-\u2BFF\u2C2F\u2C5F\u2CE5-\u2CEA\u2CF4-\u2CFF\u2D26\u2D28-\u2D2C\u2D2E\u2D2F\u2D68-\u2D6E\u2D70-\u2D7E\u2D97-\u2D9F\u2DA7\u2DAF\u2DB7\u2DBF\u2DC7\u2DCF\u2DD7\u2DDF\u2E00-\u2E2E\u2E30-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u3040\u3097\u3098\u309B\u309C\u30A0\u30FB\u3100-\u3104\u3130\u318F-\u319F\u31BB-\u31EF\u3200-\u33FF\u4DB6-\u4DFF\u9FF0-\u9FFF\uA48D-\uA4CF\uA4FE\uA4FF\uA60D-\uA60F\uA62C-\uA63F\uA670-\uA673\uA67E\uA6F2-\uA716\uA720\uA721\uA789\uA78A\uA7C0\uA7C1\uA7C7-\uA7F6\uA828-\uA83F\uA874-\uA87F\uA8C6-\uA8CF\uA8DA-\uA8DF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA954-\uA95F\uA97D-\uA97F\uA9C1-\uA9CE\uA9DA-\uA9DF\uA9FF\uAA37-\uAA3F\uAA4E\uAA4F\uAA5A-\uAA5F\uAA77-\uAA79\uAAC3-\uAADA\uAADE\uAADF\uAAF0\uAAF1\uAAF7-\uAB00\uAB07\uAB08\uAB0F\uAB10\uAB17-\uAB1F\uAB27\uAB2F\uAB5B\uAB68-\uAB6F\uABEB\uABEE\uABEF\uABFA-\uABFF\uD7A4-\uD7AF\uD7C7-\uD7CA\uD7FC-\uF8FF\uFA6E\uFA6F\uFADA-\uFAFF\uFB07-\uFB12\uFB18-\uFB1C\uFB29\uFB37\uFB3D\uFB3F\uFB42\uFB45\uFBB2-\uFBD2\uFD3E-\uFD4F\uFD90\uFD91\uFDC8-\uFDEF\uFDFC-\uFDFF\uFE10-\uFE1F\uFE30-\uFE32\uFE35-\uFE4C\uFE50-\uFE6F\uFE75\uFEFD-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF3E\uFF40\uFF5B-\uFF65\uFFBF-\uFFC1\uFFC8\uFFC9\uFFD0\uFFD1\uFFD8\uFFD9\uFFDD-\uFFFF\u{1000C}\u{10027}\u{1003B}\u{1003E}\u{1004E}\u{1004F}\u{1005E}-\u{1007F}\u{100FB}-\u{1013F}\u{10175}-\u{101FC}\u{101FE}-\u{1027F}\u{1029D}-\u{1029F}\u{102D1}-\u{102DF}\u{102E1}-\u{102FF}\u{10320}-\u{1032C}\u{1034B}-\u{1034F}\u{1037B}-\u{1037F}\u{1039E}\u{1039F}\u{103C4}-\u{103C7}\u{103D0}\u{103D6}-\u{103FF}\u{1049E}\u{1049F}\u{104AA}-\u{104AF}\u{104D4}-\u{104D7}\u{104FC}-\u{104FF}\u{10528}-\u{1052F}\u{10564}-\u{105FF}\u{10737}-\u{1073F}\u{10756}-\u{1075F}\u{10768}-\u{107FF}\u{10806}\u{10807}\u{10809}\u{10836}\u{10839}-\u{1083B}\u{1083D}\u{1083E}\u{10856}-\u{1085F}\u{10877}-\u{1087F}\u{1089F}-\u{108DF}\u{108F3}\u{108F6}-\u{108FF}\u{10916}-\u{1091F}\u{1093A}-\u{1097F}\u{109B8}-\u{109BD}\u{109C0}-\u{109FF}\u{10A04}\u{10A07}-\u{10A0B}\u{10A14}\u{10A18}\u{10A36}\u{10A37}\u{10A3B}-\u{10A3E}\u{10A40}-\u{10A5F}\u{10A7D}-\u{10A7F}\u{10A9D}-\u{10ABF}\u{10AC8}\u{10AE7}-\u{10AFF}\u{10B36}-\u{10B3F}\u{10B56}-\u{10B5F}\u{10B73}-\u{10B7F}\u{10B92}-\u{10BFF}\u{10C49}-\u{10C7F}\u{10CB3}-\u{10CBF}\u{10CF3}-\u{10CFF}\u{10D28}-\u{10D2F}\u{10D3A}-\u{10EFF}\u{10F1D}-\u{10F26}\u{10F28}-\u{10F2F}\u{10F51}-\u{10FDF}\u{10FF7}-\u{10FFF}\u{11047}-\u{11065}\u{11070}-\u{1107E}\u{110BB}-\u{110CF}\u{110E9}-\u{110EF}\u{110FA}-\u{110FF}\u{11135}\u{11140}-\u{11143}\u{11147}-\u{1114F}\u{11174}\u{11175}\u{11177}-\u{1117F}\u{111C5}-\u{111C8}\u{111CD}-\u{111CF}\u{111DB}\u{111DD}-\u{111FF}\u{11212}\u{11238}-\u{1123D}\u{1123F}-\u{1127F}\u{11287}\u{11289}\u{1128E}\u{1129E}\u{112A9}-\u{112AF}\u{112EB}-\u{112EF}\u{112FA}-\u{112FF}\u{11304}\u{1130D}\u{1130E}\u{11311}\u{11312}\u{11329}\u{11331}\u{11334}\u{1133A}\u{11345}\u{11346}\u{11349}\u{1134A}\u{1134E}\u{1134F}\u{11351}-\u{11356}\u{11358}-\u{1135C}\u{11364}\u{11365}\u{1136D}-\u{1136F}\u{11375}-\u{113FF}\u{1144B}-\u{1144F}\u{1145A}-\u{1145D}\u{11460}-\u{1147F}\u{114C6}\u{114C8}-\u{114CF}\u{114DA}-\u{1157F}\u{115B6}\u{115B7}\u{115C1}-\u{115D7}\u{115DE}-\u{115FF}\u{11641}-\u{11643}\u{11645}-\u{1164F}\u{1165A}-\u{1167F}\u{116B9}-\u{116BF}\u{116CA}-\u{116FF}\u{1171B}\u{1171C}\u{1172C}-\u{1172F}\u{1173A}-\u{117FF}\u{1183B}-\u{1189F}\u{118EA}-\u{118FE}\u{11900}-\u{1199F}\u{119A8}\u{119A9}\u{119D8}\u{119D9}\u{119E2}\u{119E5}-\u{119FF}\u{11A3F}-\u{11A46}\u{11A48}-\u{11A4F}\u{11A9A}-\u{11A9C}\u{11A9E}-\u{11ABF}\u{11AF9}-\u{11BFF}\u{11C09}\u{11C37}\u{11C41}-\u{11C4F}\u{11C5A}-\u{11C71}\u{11C90}\u{11C91}\u{11CA8}\u{11CB7}-\u{11CFF}\u{11D07}\u{11D0A}\u{11D37}-\u{11D39}\u{11D3B}\u{11D3E}\u{11D48}-\u{11D4F}\u{11D5A}-\u{11D5F}\u{11D66}\u{11D69}\u{11D8F}\u{11D92}\u{11D99}-\u{11D9F}\u{11DAA}-\u{11EDF}\u{11EF7}-\u{11FFF}\u{1239A}-\u{123FF}\u{1246F}-\u{1247F}\u{12544}-\u{12FFF}\u{1342F}-\u{143FF}\u{14647}-\u{167FF}\u{16A39}-\u{16A3F}\u{16A5F}\u{16A6A}-\u{16ACF}\u{16AEE}\u{16AEF}\u{16AF5}-\u{16AFF}\u{16B37}-\u{16B3F}\u{16B44}-\u{16B4F}\u{16B5A}-\u{16B62}\u{16B78}-\u{16B7C}\u{16B90}-\u{16E3F}\u{16E80}-\u{16EFF}\u{16F4B}-\u{16F4E}\u{16F88}-\u{16F8E}\u{16FA0}-\u{16FDF}\u{16FE2}\u{16FE4}-\u{16FFF}\u{187F8}-\u{187FF}\u{18AF3}-\u{1AFFF}\u{1B11F}-\u{1B14F}\u{1B153}-\u{1B163}\u{1B168}-\u{1B16F}\u{1B2FC}-\u{1BBFF}\u{1BC6B}-\u{1BC6F}\u{1BC7D}-\u{1BC7F}\u{1BC89}-\u{1BC8F}\u{1BC9A}-\u{1BC9C}\u{1BC9F}-\u{1D164}\u{1D16A}-\u{1D16C}\u{1D173}-\u{1D17A}\u{1D183}\u{1D184}\u{1D18C}-\u{1D1A9}\u{1D1AE}-\u{1D241}\u{1D245}-\u{1D3FF}\u{1D455}\u{1D49D}\u{1D4A0}\u{1D4A1}\u{1D4A3}\u{1D4A4}\u{1D4A7}\u{1D4A8}\u{1D4AD}\u{1D4BA}\u{1D4BC}\u{1D4C4}\u{1D506}\u{1D50B}\u{1D50C}\u{1D515}\u{1D51D}\u{1D53A}\u{1D53F}\u{1D545}\u{1D547}-\u{1D549}\u{1D551}\u{1D6A6}\u{1D6A7}\u{1D6C1}\u{1D6DB}\u{1D6FB}\u{1D715}\u{1D735}\u{1D74F}\u{1D76F}\u{1D789}\u{1D7A9}\u{1D7C3}\u{1D7CC}\u{1D7CD}\u{1D800}-\u{1D9FF}\u{1DA37}-\u{1DA3A}\u{1DA6D}-\u{1DA74}\u{1DA76}-\u{1DA83}\u{1DA85}-\u{1DA9A}\u{1DAA0}\u{1DAB0}-\u{1DFFF}\u{1E007}\u{1E019}\u{1E01A}\u{1E022}\u{1E025}\u{1E02B}-\u{1E0FF}\u{1E12D}-\u{1E12F}\u{1E13E}\u{1E13F}\u{1E14A}-\u{1E14D}\u{1E14F}-\u{1E2BF}\u{1E2FA}-\u{1E7FF}\u{1E8C5}-\u{1E8CF}\u{1E8D7}-\u{1E8FF}\u{1E94C}-\u{1E94F}\u{1E95A}-\u{1EDFF}\u{1EE04}\u{1EE20}\u{1EE23}\u{1EE25}\u{1EE26}\u{1EE28}\u{1EE33}\u{1EE38}\u{1EE3A}\u{1EE3C}-\u{1EE41}\u{1EE43}-\u{1EE46}\u{1EE48}\u{1EE4A}\u{1EE4C}\u{1EE50}\u{1EE53}\u{1EE55}\u{1EE56}\u{1EE58}\u{1EE5A}\u{1EE5C}\u{1EE5E}\u{1EE60}\u{1EE63}\u{1EE65}\u{1EE66}\u{1EE6B}\u{1EE73}\u{1EE78}\u{1EE7D}\u{1EE7F}\u{1EE8A}\u{1EE9C}-\u{1EEA0}\u{1EEA4}\u{1EEAA}\u{1EEBC}-\u{1FFFF}\u{2A6D7}-\u{2A6FF}\u{2B735}-\u{2B73F}\u{2B81E}\u{2B81F}\u{2CEA2}-\u{2CEAF}\u{2EBE1}-\u{2F7FF}\u{2FA1E}-\u{E00FF}\u{E01F0}-\u{10FFFF}]+/gu,nG=/^\.+$/u,dQ=(j,A)=>{if(j===null||j.trim().length===0)return null;let e=1,t=j.replace(/_\d+$/u,""),r=j;for(;A.includes(r)||iG(r);)r=`${t}_${e}`,e++;return r},iG=j=>eG.includes(j)||window.hasOwnProperty(j)&&!tG.includes(j);function Wc(j,A){if(!A)return null;let e=A.trim();if(e.length===0)return null;let t=j==="selector"?"_":"$";if(j==="directory"){if(nG.test(e))return null}else rG.test(e)||(e=t+e);return e=e.replace(oG,"_"),e=e.replace(/_+/gu,"_"),e=e.replace(/^\$_/u,t),e}function Mo(j){return Wc("variable",j)}function uQ(j){let A=Wc("selector",j);return A&&(A=A.replace(/^\$/gu,"_")),A}function PB(j){return Wc("directory",j)}function MB(j){let e=Mo(j)||"MyComponent",t=e+Jt,r=aG(e);return{name:t,content:r}}function aG(j){return`// Get Started: https://www.framer.com/developers

import { addPropertyControls, ControlType } from "framer"
import { motion } from "framer-motion"

/**
 * @framerSupportedLayoutWidth auto
 * @framerSupportedLayoutHeight auto
 */
export default function ${j}(props) {
    const { tint } = props

    return (
        <motion.div
            style={{
                margin: 50,
                width: 100,
                height: 100,
                borderRadius: 25,
                backgroundColor: tint,
            }}
            animate={{ scale: 1.5 }}
            whileHover={{ rotate: 90 }}
        />
    )
}

addPropertyControls(${j}, {
    tint: {
        title: "Tint",
        type: ControlType.Color,
        defaultValue: "#09F",
    },
})
`}function sG(j){return`import { forwardRef, type ComponentType } from "react"
import { createStore } from "https://framer.com/m/framer/store.js@^1.0.0"
import { randomColor } from "https://framer.com/m/framer/utils.js@^0.9.0"

// Learn more: https://www.framer.com/developers/overrides/

const useStore = createStore({
    background: "#0099FF",
})

export function withRotate(Component): ComponentType {
    return forwardRef((props, ref) => {
        return (
            <Component
                ref={ref}
                {...props}
                animate={{ rotate: 90 }}
                transition={{ duration: 2 }}
            />
        )
    })
}

export function withHover(Component): ComponentType {
    return forwardRef((props, ref) => {
        return <Component ref={ref} {...props} whileHover={{ scale: 1.05 }} />
    })
}

export function withRandomColor(Component): ComponentType {
    return forwardRef((props, ref) => {
        const [store, setStore] = useStore()

        return (
            <Component
                ref={ref}
                {...props}
                animate={{
                    background: store.background,
                }}
                onClick={() => {
                    setStore({ background: randomColor() })
                }}
            />
        )
    })
}
`}function _B(j){let e=Mo(j)||"MyOverrides",t=e+Jt,r=sG(e);return{name:t,content:r}}function ei(j){return j.endsWith(".json")?!0:/\.[tj]sx?$/u.test(j)}var lG=/^(?:[\w-]+\/)*[\w-]+(?:\.[\w-]+)*$/u;function SQ(j){let{path:A}=DB(j);return lG.test(A)}function cG(j,A){if(ei(j))return j;let[e,t]=Ni(A);return t&&(t=`.${t}`),(!t||!ei(t))&&(t=Jt),j+t}function yQ(j){return ei(j)||(j+=".tsx"),j}function dG(j){let A=j.lastIndexOf("/");return A<0?"":j.slice(0,A)}function uG(j){let A=j.lastIndexOf("/")+1;return j.slice(A)}function zc(...j){let A="";return j.forEach(e=>{for(;e.startsWith("/");)e=e.slice(1);for(;e.endsWith("/");)e=e.slice(0,-1);e!==""&&(A!==""&&(A+="/"),A+=e)}),A}function DB(j,A=!0){j=j.trim();let[e,t]=Ni(uG(j));t&&(t=`.${t}`);let r=dG(j).split("/").map(a=>PB(a)).filter(a=>!!a).join("/"),o=Mo(e)||"MyComponent";return(!ei(t)||t===Jt)&&A&&(o=w7(o)),{path:zc(r,o+t),dirName:r,name:o,extension:t}}function CQ(j,A="component",e=!0){j=j.trim();let{dirName:t,name:r,extension:o}=DB(j,e);if(ei(o)&&o!==Jt){let i=r+o;return{path:zc(t,i),content:""}}let n=A==="component"?MB(r):_B(r),a=cG(r+o,n.name);return{path:zc(t,a),content:n.content}}function NB(j,A){if(!j.has(A))return A;let e=1,t,[r,o]=Ni(A);o&&(o=`.${o}`);do t=r+"_"+String(e++)+o;while(j.has(t));return t}function bQ(j){return j==="typescript"||j==="javascript"}var pG=1;function kG(j){return j==="screen"||j==="canvasComponent"}function Xc(j){let A=j.metadata.compatibleCmsVersion;return Y(A)?A:0}function mG(j){let A=CA(j);return j.imports.relative.some(e=>{let t=Se(e,A);return _(t)&&t.startsWith("collection")})}function Yc(j){return kG(j.type)&&mG(j)}function DQ(j){return Yc(j)&&Xc(j)<pG}var _o,ti,Do=class{constructor(A){this.limit=A;NA(this,_o,0);NA(this,ti,[])}async run(A,e){if(rA(this,_o)===this.limit){let t=new Promise(r=>{rA(this,ti).push(r)});e&&(t=Promise.race([t,fG(e)])),await t}OB(e),u6(this,_o)._++;try{return await A()}finally{u6(this,_o)._--,rA(this,ti).shift()?.()}}};_o=new WeakMap,ti=new WeakMap;var xB=new WeakMap;function fG(j){let A=xB.get(j);return A||(OB(j),A=new Promise((e,t)=>{j.addEventListener("abort",()=>{t(j.reason)},{once:!0})}),xB.set(j,A)),A}function OB(j){if(j?.aborted)throw j.reason}function ri(j){let A=new Set;if(!j)return A;if(w(j)&&la(j)){let e=wB(j.layoutTemplateIdentifier);e&&A.add(e)}for(let{node:e,skipChildren:t}of j.walkWithSkipChildren()){if(!W(e))continue;if(hA(e)){t();continue}let r=wB(e.codeComponentIdentifier);r&&A.add(r)}return A}function wB(j){let A=oA(j);if(!(!A||!YA(A)))return CA({type:A.type,name:A.localIdName})}var LB;(function(j){j[j.Static=1]="Static",j[j.Dynamic=2]="Dynamic",j[j.ImportMeta=3]="ImportMeta",j[j.StaticSourcePhase=4]="StaticSourcePhase",j[j.DynamicSourcePhase=5]="DynamicSourcePhase"})(LB||(LB={}));var EG=new Uint8Array(new Uint16Array([1]).buffer)[0]===1;function Ad(j,A="@"){if(!DA)return jd.then(()=>Ad(j));let e=j.length+1,t=(DA.__heap_base.value||DA.__heap_base)+4*e-DA.memory.buffer.byteLength;t>0&&DA.memory.grow(Math.ceil(t/65536));let r=DA.sa(e-1);if((EG?BG:$G)(j,new Uint16Array(DA.memory.buffer,r,e)),!DA.parse())throw Object.assign(new Error(`Parse error ${A}:${j.slice(0,DA.e()).split(`
`).length}:${DA.e()-j.lastIndexOf(`
`,DA.e()-1)}`),{idx:DA.e()});let o=[],n=[];for(;DA.ri();){let i=DA.is(),s=DA.ie(),l=DA.it(),c=DA.ai(),u=DA.id(),p=DA.ss(),f=DA.se(),E;DA.ip()&&(E=a(j.slice(u===-1?i-1:i,u===-1?s+1:s))),o.push({n:E,t:l,s:i,e:s,ss:p,se:f,d:u,a:c})}for(;DA.re();){let i=DA.es(),s=DA.ee(),l=DA.els(),c=DA.ele(),u=j.slice(i,s),p=u[0],f=l<0?void 0:j.slice(l,c),E=f?f[0]:"";n.push({s:i,e:s,ls:l,le:c,n:p==='"'||p==="'"?a(u):u,ln:E==='"'||E==="'"?a(f):f})}function a(i){try{return(0,eval)(i)}catch{}}return[o,n,!!DA.f(),!!DA.ms()]}function $G(j,A){let e=j.length,t=0;for(;t<e;){let r=j.charCodeAt(t);A[t++]=(255&r)<<8|r>>>8}}function BG(j,A){let e=j.length,t=0;for(;t<e;)A[t]=j.charCodeAt(t++)}var DA,jd=WebAssembly.compile((Zc="AGFzbQEAAAABKwhgAX8Bf2AEf39/fwBgAAF/YAAAYAF/AGADf39/AX9gAn9/AX9gA39/fwADMTAAAQECAgICAgICAgICAgICAgICAgIAAwMDBAQAAAUAAAAAAAMDAwAGAAAABwAGAgUEBQFwAQEBBQMBAAEGDwJ/AUHA8gALfwBBwPIACwd6FQZtZW1vcnkCAAJzYQAAAWUAAwJpcwAEAmllAAUCc3MABgJzZQAHAml0AAgCYWkACQJpZAAKAmlwAAsCZXMADAJlZQANA2VscwAOA2VsZQAPAnJpABACcmUAEQFmABICbXMAEwVwYXJzZQAUC19faGVhcF9iYXNlAwEKm0EwaAEBf0EAIAA2AoAKQQAoAtwJIgEgAEEBdGoiAEEAOwEAQQAgAEECaiIANgKECkEAIAA2AogKQQBBADYC4AlBAEEANgLwCUEAQQA2AugJQQBBADYC5AlBAEEANgL4CUEAQQA2AuwJIAEL0wEBA39BACgC8AkhBEEAQQAoAogKIgU2AvAJQQAgBDYC9AlBACAFQSRqNgKICiAEQSBqQeAJIAQbIAU2AgBBACgC1AkhBEEAKALQCSEGIAUgATYCACAFIAA2AgggBSACIAJBAmpBACAGIANGIgAbIAQgA0YiBBs2AgwgBSADNgIUIAVBADYCECAFIAI2AgQgBUEANgIgIAVBA0EBQQIgABsgBBs2AhwgBUEAKALQCSADRiICOgAYAkACQCACDQBBACgC1AkgA0cNAQtBAEEBOgCMCgsLXgEBf0EAKAL4CSIEQRBqQeQJIAQbQQAoAogKIgQ2AgBBACAENgL4CUEAIARBFGo2AogKQQBBAToAjAogBEEANgIQIAQgAzYCDCAEIAI2AgggBCABNgIEIAQgADYCAAsIAEEAKAKQCgsVAEEAKALoCSgCAEEAKALcCWtBAXULHgEBf0EAKALoCSgCBCIAQQAoAtwJa0EBdUF/IAAbCxUAQQAoAugJKAIIQQAoAtwJa0EBdQseAQF/QQAoAugJKAIMIgBBACgC3AlrQQF1QX8gABsLCwBBACgC6AkoAhwLHgEBf0EAKALoCSgCECIAQQAoAtwJa0EBdUF/IAAbCzsBAX8CQEEAKALoCSgCFCIAQQAoAtAJRw0AQX8PCwJAIABBACgC1AlHDQBBfg8LIABBACgC3AlrQQF1CwsAQQAoAugJLQAYCxUAQQAoAuwJKAIAQQAoAtwJa0EBdQsVAEEAKALsCSgCBEEAKALcCWtBAXULHgEBf0EAKALsCSgCCCIAQQAoAtwJa0EBdUF/IAAbCx4BAX9BACgC7AkoAgwiAEEAKALcCWtBAXVBfyAAGwslAQF/QQBBACgC6AkiAEEgakHgCSAAGygCACIANgLoCSAAQQBHCyUBAX9BAEEAKALsCSIAQRBqQeQJIAAbKAIAIgA2AuwJIABBAEcLCABBAC0AlAoLCABBAC0AjAoL3Q0BBX8jAEGA0ABrIgAkAEEAQQE6AJQKQQBBACgC2Ak2ApwKQQBBACgC3AlBfmoiATYCsApBACABQQAoAoAKQQF0aiICNgK0CkEAQQA6AIwKQQBBADsBlgpBAEEAOwGYCkEAQQA6AKAKQQBBADYCkApBAEEAOgD8CUEAIABBgBBqNgKkCkEAIAA2AqgKQQBBADoArAoCQAJAAkACQANAQQAgAUECaiIDNgKwCiABIAJPDQECQCADLwEAIgJBd2pBBUkNAAJAAkACQAJAAkAgAkGbf2oOBQEICAgCAAsgAkEgRg0EIAJBL0YNAyACQTtGDQIMBwtBAC8BmAoNASADEBVFDQEgAUEEakGCCEEKEC8NARAWQQAtAJQKDQFBAEEAKAKwCiIBNgKcCgwHCyADEBVFDQAgAUEEakGMCEEKEC8NABAXC0EAQQAoArAKNgKcCgwBCwJAIAEvAQQiA0EqRg0AIANBL0cNBBAYDAELQQEQGQtBACgCtAohAkEAKAKwCiEBDAALC0EAIQIgAyEBQQAtAPwJDQIMAQtBACABNgKwCkEAQQA6AJQKCwNAQQAgAUECaiIDNgKwCgJAAkACQAJAAkACQAJAIAFBACgCtApPDQAgAy8BACICQXdqQQVJDQYCQAJAAkACQAJAAkACQAJAAkACQCACQWBqDgoQDwYPDw8PBQECAAsCQAJAAkACQCACQaB/ag4KCxISAxIBEhISAgALIAJBhX9qDgMFEQYJC0EALwGYCg0QIAMQFUUNECABQQRqQYIIQQoQLw0QEBYMEAsgAxAVRQ0PIAFBBGpBjAhBChAvDQ8QFwwPCyADEBVFDQ4gASkABELsgISDsI7AOVINDiABLwEMIgNBd2oiAUEXSw0MQQEgAXRBn4CABHFFDQwMDQtBAEEALwGYCiIBQQFqOwGYCkEAKAKkCiABQQN0aiIBQQE2AgAgAUEAKAKcCjYCBAwNC0EALwGYCiIDRQ0JQQAgA0F/aiIDOwGYCkEALwGWCiICRQ0MQQAoAqQKIANB//8DcUEDdGooAgBBBUcNDAJAIAJBAnRBACgCqApqQXxqKAIAIgMoAgQNACADQQAoApwKQQJqNgIEC0EAIAJBf2o7AZYKIAMgAUEEajYCDAwMCwJAQQAoApwKIgEvAQBBKUcNAEEAKALwCSIDRQ0AIAMoAgQgAUcNAEEAQQAoAvQJIgM2AvAJAkAgA0UNACADQQA2AiAMAQtBAEEANgLgCQtBAEEALwGYCiIDQQFqOwGYCkEAKAKkCiADQQN0aiIDQQZBAkEALQCsChs2AgAgAyABNgIEQQBBADoArAoMCwtBAC8BmAoiAUUNB0EAIAFBf2oiATsBmApBACgCpAogAUH//wNxQQN0aigCAEEERg0EDAoLQScQGgwJC0EiEBoMCAsgAkEvRw0HAkACQCABLwEEIgFBKkYNACABQS9HDQEQGAwKC0EBEBkMCQsCQAJAAkACQEEAKAKcCiIBLwEAIgMQG0UNAAJAAkAgA0FVag4EAAkBAwkLIAFBfmovAQBBK0YNAwwICyABQX5qLwEAQS1GDQIMBwsgA0EpRw0BQQAoAqQKQQAvAZgKIgJBA3RqKAIEEBxFDQIMBgsgAUF+ai8BAEFQakH//wNxQQpPDQULQQAvAZgKIQILAkACQCACQf//A3EiAkUNACADQeYARw0AQQAoAqQKIAJBf2pBA3RqIgQoAgBBAUcNACABQX5qLwEAQe8ARw0BIAQoAgRBlghBAxAdRQ0BDAULIANB/QBHDQBBACgCpAogAkEDdGoiAigCBBAeDQQgAigCAEEGRg0ECyABEB8NAyADRQ0DIANBL0ZBAC0AoApBAEdxDQMCQEEAKAL4CSICRQ0AIAEgAigCAEkNACABIAIoAgRNDQQLIAFBfmohAUEAKALcCSECAkADQCABQQJqIgQgAk0NAUEAIAE2ApwKIAEvAQAhAyABQX5qIgQhASADECBFDQALIARBAmohBAsCQCADQf//A3EQIUUNACAEQX5qIQECQANAIAFBAmoiAyACTQ0BQQAgATYCnAogAS8BACEDIAFBfmoiBCEBIAMQIQ0ACyAEQQJqIQMLIAMQIg0EC0EAQQE6AKAKDAcLQQAoAqQKQQAvAZgKIgFBA3QiA2pBACgCnAo2AgRBACABQQFqOwGYCkEAKAKkCiADakEDNgIACxAjDAULQQAtAPwJQQAvAZYKQQAvAZgKcnJFIQIMBwsQJEEAQQA6AKAKDAMLECVBACECDAULIANBoAFHDQELQQBBAToArAoLQQBBACgCsAo2ApwKC0EAKAKwCiEBDAALCyAAQYDQAGokACACCxoAAkBBACgC3AkgAEcNAEEBDwsgAEF+ahAmC/4KAQZ/QQBBACgCsAoiAEEMaiIBNgKwCkEAKAL4CSECQQEQKSEDAkACQAJAAkACQAJAAkACQAJAQQAoArAKIgQgAUcNACADEChFDQELAkACQAJAAkACQAJAAkAgA0EqRg0AIANB+wBHDQFBACAEQQJqNgKwCkEBECkhA0EAKAKwCiEEA0ACQAJAIANB//8DcSIDQSJGDQAgA0EnRg0AIAMQLBpBACgCsAohAwwBCyADEBpBAEEAKAKwCkECaiIDNgKwCgtBARApGgJAIAQgAxAtIgNBLEcNAEEAQQAoArAKQQJqNgKwCkEBECkhAwsgA0H9AEYNA0EAKAKwCiIFIARGDQ8gBSEEIAVBACgCtApNDQAMDwsLQQAgBEECajYCsApBARApGkEAKAKwCiIDIAMQLRoMAgtBAEEAOgCUCgJAAkACQAJAAkACQCADQZ9/ag4MAgsEAQsDCwsLCwsFAAsgA0H2AEYNBAwKC0EAIARBDmoiAzYCsAoCQAJAAkBBARApQZ9/ag4GABICEhIBEgtBACgCsAoiBSkAAkLzgOSD4I3AMVINESAFLwEKECFFDRFBACAFQQpqNgKwCkEAECkaC0EAKAKwCiIFQQJqQbIIQQ4QLw0QIAUvARAiAkF3aiIBQRdLDQ1BASABdEGfgIAEcUUNDQwOC0EAKAKwCiIFKQACQuyAhIOwjsA5Ug0PIAUvAQoiAkF3aiIBQRdNDQYMCgtBACAEQQpqNgKwCkEAECkaQQAoArAKIQQLQQAgBEEQajYCsAoCQEEBECkiBEEqRw0AQQBBACgCsApBAmo2ArAKQQEQKSEEC0EAKAKwCiEDIAQQLBogA0EAKAKwCiIEIAMgBBACQQBBACgCsApBfmo2ArAKDwsCQCAEKQACQuyAhIOwjsA5Ug0AIAQvAQoQIEUNAEEAIARBCmo2ArAKQQEQKSEEQQAoArAKIQMgBBAsGiADQQAoArAKIgQgAyAEEAJBAEEAKAKwCkF+ajYCsAoPC0EAIARBBGoiBDYCsAoLQQAgBEEGajYCsApBAEEAOgCUCkEBECkhBEEAKAKwCiEDIAQQLCEEQQAoArAKIQIgBEHf/wNxIgFB2wBHDQNBACACQQJqNgKwCkEBECkhBUEAKAKwCiEDQQAhBAwEC0EAQQE6AIwKQQBBACgCsApBAmo2ArAKC0EBECkhBEEAKAKwCiEDAkAgBEHmAEcNACADQQJqQawIQQYQLw0AQQAgA0EIajYCsAogAEEBEClBABArIAJBEGpB5AkgAhshAwNAIAMoAgAiA0UNBSADQgA3AgggA0EQaiEDDAALC0EAIANBfmo2ArAKDAMLQQEgAXRBn4CABHFFDQMMBAtBASEECwNAAkACQCAEDgIAAQELIAVB//8DcRAsGkEBIQQMAQsCQAJAQQAoArAKIgQgA0YNACADIAQgAyAEEAJBARApIQQCQCABQdsARw0AIARBIHJB/QBGDQQLQQAoArAKIQMCQCAEQSxHDQBBACADQQJqNgKwCkEBECkhBUEAKAKwCiEDIAVBIHJB+wBHDQILQQAgA0F+ajYCsAoLIAFB2wBHDQJBACACQX5qNgKwCg8LQQAhBAwACwsPCyACQaABRg0AIAJB+wBHDQQLQQAgBUEKajYCsApBARApIgVB+wBGDQMMAgsCQCACQVhqDgMBAwEACyACQaABRw0CC0EAIAVBEGo2ArAKAkBBARApIgVBKkcNAEEAQQAoArAKQQJqNgKwCkEBECkhBQsgBUEoRg0BC0EAKAKwCiEBIAUQLBpBACgCsAoiBSABTQ0AIAQgAyABIAUQAkEAQQAoArAKQX5qNgKwCg8LIAQgA0EAQQAQAkEAIARBDGo2ArAKDwsQJQvcCAEGf0EAIQBBAEEAKAKwCiIBQQxqIgI2ArAKQQEQKSEDQQAoArAKIQQCQAJAAkACQAJAAkACQAJAIANBLkcNAEEAIARBAmo2ArAKAkBBARApIgNB8wBGDQAgA0HtAEcNB0EAKAKwCiIDQQJqQZwIQQYQLw0HAkBBACgCnAoiBBAqDQAgBC8BAEEuRg0ICyABIAEgA0EIakEAKALUCRABDwtBACgCsAoiA0ECakGiCEEKEC8NBgJAQQAoApwKIgQQKg0AIAQvAQBBLkYNBwsgA0EMaiEDDAELIANB8wBHDQEgBCACTQ0BQQYhAEEAIQIgBEECakGiCEEKEC8NAiAEQQxqIQMCQCAELwEMIgVBd2oiBEEXSw0AQQEgBHRBn4CABHENAQsgBUGgAUcNAgtBACADNgKwCkEBIQBBARApIQMLAkACQAJAAkAgA0H7AEYNACADQShHDQFBACgCpApBAC8BmAoiA0EDdGoiBEEAKAKwCjYCBEEAIANBAWo7AZgKIARBBTYCAEEAKAKcCi8BAEEuRg0HQQBBACgCsAoiBEECajYCsApBARApIQMgAUEAKAKwCkEAIAQQAQJAAkAgAA0AQQAoAvAJIQQMAQtBACgC8AkiBEEFNgIcC0EAQQAvAZYKIgBBAWo7AZYKQQAoAqgKIABBAnRqIAQ2AgACQCADQSJGDQAgA0EnRg0AQQBBACgCsApBfmo2ArAKDwsgAxAaQQBBACgCsApBAmoiAzYCsAoCQAJAAkBBARApQVdqDgQBAgIAAgtBAEEAKAKwCkECajYCsApBARApGkEAKALwCSIEIAM2AgQgBEEBOgAYIARBACgCsAoiAzYCEEEAIANBfmo2ArAKDwtBACgC8AkiBCADNgIEIARBAToAGEEAQQAvAZgKQX9qOwGYCiAEQQAoArAKQQJqNgIMQQBBAC8BlgpBf2o7AZYKDwtBAEEAKAKwCkF+ajYCsAoPCyAADQJBACgCsAohA0EALwGYCg0BA0ACQAJAAkAgA0EAKAK0Ck8NAEEBECkiA0EiRg0BIANBJ0YNASADQf0ARw0CQQBBACgCsApBAmo2ArAKC0EBECkhBEEAKAKwCiEDAkAgBEHmAEcNACADQQJqQawIQQYQLw0JC0EAIANBCGo2ArAKAkBBARApIgNBIkYNACADQSdHDQkLIAEgA0EAECsPCyADEBoLQQBBACgCsApBAmoiAzYCsAoMAAsLIAANAUEGIQBBACECAkAgA0FZag4EBAMDBAALIANBIkYNAwwCC0EAIANBfmo2ArAKDwtBDCEAQQEhAgtBACgCsAoiAyABIABBAXRqRw0AQQAgA0F+ajYCsAoPC0EALwGYCg0CQQAoArAKIQNBACgCtAohAANAIAMgAE8NAQJAAkAgAy8BACIEQSdGDQAgBEEiRw0BCyABIAQgAhArDwtBACADQQJqIgM2ArAKDAALCxAlCw8LQQBBACgCsApBfmo2ArAKC0cBA39BACgCsApBAmohAEEAKAK0CiEBAkADQCAAIgJBfmogAU8NASACQQJqIQAgAi8BAEF2ag4EAQAAAQALC0EAIAI2ArAKC5gBAQN/QQBBACgCsAoiAUECajYCsAogAUEGaiEBQQAoArQKIQIDQAJAAkACQCABQXxqIAJPDQAgAUF+ai8BACEDAkACQCAADQAgA0EqRg0BIANBdmoOBAIEBAIECyADQSpHDQMLIAEvAQBBL0cNAkEAIAFBfmo2ArAKDAELIAFBfmohAQtBACABNgKwCg8LIAFBAmohAQwACwuIAQEEf0EAKAKwCiEBQQAoArQKIQICQAJAA0AgASIDQQJqIQEgAyACTw0BIAEvAQAiBCAARg0CAkAgBEHcAEYNACAEQXZqDgQCAQECAQsgA0EEaiEBIAMvAQRBDUcNACADQQZqIAEgAy8BBkEKRhshAQwACwtBACABNgKwChAlDwtBACABNgKwCgtsAQF/AkACQCAAQV9qIgFBBUsNAEEBIAF0QTFxDQELIABBRmpB//8DcUEGSQ0AIABBKUcgAEFYakH//wNxQQdJcQ0AAkAgAEGlf2oOBAEAAAEACyAAQf0ARyAAQYV/akH//wNxQQRJcQ8LQQELLgEBf0EBIQECQCAAQaYJQQUQHQ0AIABBlghBAxAdDQAgAEGwCUECEB0hAQsgAQtGAQN/QQAhAwJAIAAgAkEBdCICayIEQQJqIgBBACgC3AkiBUkNACAAIAEgAhAvDQACQCAAIAVHDQBBAQ8LIAQQJiEDCyADC4MBAQJ/QQEhAQJAAkACQAJAAkACQCAALwEAIgJBRWoOBAUEBAEACwJAIAJBm39qDgQDBAQCAAsgAkEpRg0EIAJB+QBHDQMgAEF+akG8CUEGEB0PCyAAQX5qLwEAQT1GDwsgAEF+akG0CUEEEB0PCyAAQX5qQcgJQQMQHQ8LQQAhAQsgAQu0AwECf0EAIQECQAJAAkACQAJAAkACQAJAAkACQCAALwEAQZx/ag4UAAECCQkJCQMJCQQFCQkGCQcJCQgJCwJAAkAgAEF+ai8BAEGXf2oOBAAKCgEKCyAAQXxqQcoIQQIQHQ8LIABBfGpBzghBAxAdDwsCQAJAAkAgAEF+ai8BAEGNf2oOAwABAgoLAkAgAEF8ai8BACICQeEARg0AIAJB7ABHDQogAEF6akHlABAnDwsgAEF6akHjABAnDwsgAEF8akHUCEEEEB0PCyAAQXxqQdwIQQYQHQ8LIABBfmovAQBB7wBHDQYgAEF8ai8BAEHlAEcNBgJAIABBemovAQAiAkHwAEYNACACQeMARw0HIABBeGpB6AhBBhAdDwsgAEF4akH0CEECEB0PCyAAQX5qQfgIQQQQHQ8LQQEhASAAQX5qIgBB6QAQJw0EIABBgAlBBRAdDwsgAEF+akHkABAnDwsgAEF+akGKCUEHEB0PCyAAQX5qQZgJQQQQHQ8LAkAgAEF+ai8BACICQe8ARg0AIAJB5QBHDQEgAEF8akHuABAnDwsgAEF8akGgCUEDEB0hAQsgAQs0AQF/QQEhAQJAIABBd2pB//8DcUEFSQ0AIABBgAFyQaABRg0AIABBLkcgABAocSEBCyABCzABAX8CQAJAIABBd2oiAUEXSw0AQQEgAXRBjYCABHENAQsgAEGgAUYNAEEADwtBAQtOAQJ/QQAhAQJAAkAgAC8BACICQeUARg0AIAJB6wBHDQEgAEF+akH4CEEEEB0PCyAAQX5qLwEAQfUARw0AIABBfGpB3AhBBhAdIQELIAEL3gEBBH9BACgCsAohAEEAKAK0CiEBAkACQAJAA0AgACICQQJqIQAgAiABTw0BAkACQAJAIAAvAQAiA0Gkf2oOBQIDAwMBAAsgA0EkRw0CIAIvAQRB+wBHDQJBACACQQRqIgA2ArAKQQBBAC8BmAoiAkEBajsBmApBACgCpAogAkEDdGoiAkEENgIAIAIgADYCBA8LQQAgADYCsApBAEEALwGYCkF/aiIAOwGYCkEAKAKkCiAAQf//A3FBA3RqKAIAQQNHDQMMBAsgAkEEaiEADAALC0EAIAA2ArAKCxAlCwtwAQJ/AkACQANAQQBBACgCsAoiAEECaiIBNgKwCiAAQQAoArQKTw0BAkACQAJAIAEvAQAiAUGlf2oOAgECAAsCQCABQXZqDgQEAwMEAAsgAUEvRw0CDAQLEC4aDAELQQAgAEEEajYCsAoMAAsLECULCzUBAX9BAEEBOgD8CUEAKAKwCiEAQQBBACgCtApBAmo2ArAKQQAgAEEAKALcCWtBAXU2ApAKC0MBAn9BASEBAkAgAC8BACICQXdqQf//A3FBBUkNACACQYABckGgAUYNAEEAIQEgAhAoRQ0AIAJBLkcgABAqcg8LIAELPQECf0EAIQICQEEAKALcCSIDIABLDQAgAC8BACABRw0AAkAgAyAARw0AQQEPCyAAQX5qLwEAECAhAgsgAgtoAQJ/QQEhAQJAAkAgAEFfaiICQQVLDQBBASACdEExcQ0BCyAAQfj/A3FBKEYNACAAQUZqQf//A3FBBkkNAAJAIABBpX9qIgJBA0sNACACQQFHDQELIABBhX9qQf//A3FBBEkhAQsgAQucAQEDf0EAKAKwCiEBAkADQAJAAkAgAS8BACICQS9HDQACQCABLwECIgFBKkYNACABQS9HDQQQGAwCCyAAEBkMAQsCQAJAIABFDQAgAkF3aiIBQRdLDQFBASABdEGfgIAEcUUNAQwCCyACECFFDQMMAQsgAkGgAUcNAgtBAEEAKAKwCiIDQQJqIgE2ArAKIANBACgCtApJDQALCyACCzEBAX9BACEBAkAgAC8BAEEuRw0AIABBfmovAQBBLkcNACAAQXxqLwEAQS5GIQELIAELnAQBAX8CQCABQSJGDQAgAUEnRg0AECUPC0EAKAKwCiEDIAEQGiAAIANBAmpBACgCsApBACgC0AkQAQJAIAJFDQBBACgC8AlBBDYCHAtBAEEAKAKwCkECajYCsAoCQAJAAkACQEEAECkiAUHhAEYNACABQfcARg0BQQAoArAKIQEMAgtBACgCsAoiAUECakHACEEKEC8NAUEGIQAMAgtBACgCsAoiAS8BAkHpAEcNACABLwEEQfQARw0AQQQhACABLwEGQegARg0BC0EAIAFBfmo2ArAKDwtBACABIABBAXRqNgKwCgJAQQEQKUH7AEYNAEEAIAE2ArAKDwtBACgCsAoiAiEAA0BBACAAQQJqNgKwCgJAAkACQEEBECkiAEEiRg0AIABBJ0cNAUEnEBpBAEEAKAKwCkECajYCsApBARApIQAMAgtBIhAaQQBBACgCsApBAmo2ArAKQQEQKSEADAELIAAQLCEACwJAIABBOkYNAEEAIAE2ArAKDwtBAEEAKAKwCkECajYCsAoCQEEBECkiAEEiRg0AIABBJ0YNAEEAIAE2ArAKDwsgABAaQQBBACgCsApBAmo2ArAKAkACQEEBECkiAEEsRg0AIABB/QBGDQFBACABNgKwCg8LQQBBACgCsApBAmo2ArAKQQEQKUH9AEYNAEEAKAKwCiEADAELC0EAKALwCSIBIAI2AhAgAUEAKAKwCkECajYCDAttAQJ/AkACQANAAkAgAEH//wNxIgFBd2oiAkEXSw0AQQEgAnRBn4CABHENAgsgAUGgAUYNASAAIQIgARAoDQJBACECQQBBACgCsAoiAEECajYCsAogAC8BAiIADQAMAgsLIAAhAgsgAkH//wNxC6sBAQR/AkACQEEAKAKwCiICLwEAIgNB4QBGDQAgASEEIAAhBQwBC0EAIAJBBGo2ArAKQQEQKSECQQAoArAKIQUCQAJAIAJBIkYNACACQSdGDQAgAhAsGkEAKAKwCiEEDAELIAIQGkEAQQAoArAKQQJqIgQ2ArAKC0EBECkhA0EAKAKwCiECCwJAIAIgBUYNACAFIARBACAAIAAgAUYiAhtBACABIAIbEAILIAMLcgEEf0EAKAKwCiEAQQAoArQKIQECQAJAA0AgAEECaiECIAAgAU8NAQJAAkAgAi8BACIDQaR/ag4CAQQACyACIQAgA0F2ag4EAgEBAgELIABBBGohAAwACwtBACACNgKwChAlQQAPC0EAIAI2ArAKQd0AC0kBA39BACEDAkAgAkUNAAJAA0AgAC0AACIEIAEtAAAiBUcNASABQQFqIQEgAEEBaiEAIAJBf2oiAg0ADAILCyAEIAVrIQMLIAMLC+wBAgBBgAgLzgEAAHgAcABvAHIAdABtAHAAbwByAHQAZgBvAHIAZQB0AGEAbwB1AHIAYwBlAHIAbwBtAHUAbgBjAHQAaQBvAG4AcwBzAGUAcgB0AHYAbwB5AGkAZQBkAGUAbABlAGMAbwBuAHQAaQBuAGkAbgBzAHQAYQBuAHQAeQBiAHIAZQBhAHIAZQB0AHUAcgBkAGUAYgB1AGcAZwBlAGEAdwBhAGkAdABoAHIAdwBoAGkAbABlAGkAZgBjAGEAdABjAGYAaQBuAGEAbABsAGUAbABzAABB0AkLEAEAAAACAAAAAAQAAEA5AAA=",typeof Buffer<"u"?Buffer.from(Zc,"base64"):Uint8Array.from(atob(Zc),j=>j.charCodeAt(0)))).then(WebAssembly.instantiate).then(({exports:j})=>{DA=j}),Zc;function ed(j){return j!==void 0?{ok:!0,value:j}:{ok:!0}}function td(j){return{ok:!1,error:j}}function qB(j){return j.then(A=>ed(A),A=>td(A))}var gG=/^\s*(['"](\..*)['"])\s*$/mu,oi=class extends Error{constructor(e){super();this.persistedMissingRelativeImports=e;this.name="RewriteRelativeImportsError"}};function Ls(j){return j instanceof oi}async function qs(j,A){await jd;let[e]=Ad(j),t=j,r=new Set,o=[...e].reverse();for(let{s:n,e:a,d:i}of o){if(i===-2)continue;if(i===-1){let F=j.substring(n,a);if(!F.startsWith("."))continue;let h=A[F];h===void 0&&(r.add(F),h=KB(F)),t=VB(t,h,n,a);continue}let s=j.substring(n,a),c=s.replace(/\/\*[\s\S]*?\*\/|([^\\:]|^)\/\/.*$/gm,"$1").trim().match(gG);if(!c)continue;let u=c[1],p=c[2];if(u===void 0||p===void 0)continue;let f=A[p];f===void 0&&(r.add(p),f=KB(p));let E=s.replace(new RegExp(rd(u),"g"),JSON.stringify(f));t=VB(t,E,n,a)}return r.size>0?td({partiallyProcessedCode:t,unresolvedRelativeImports:r,parsedImports:e}):ed(t)}function VB(j,A,e,t){return j.slice(0,e)+A+j.slice(t)}function rd(j){return j.replace(/[.*+\-?^${}()|[\]\\]/gu,"\\$&")}function KB(j){return`!missing/${j}`}var X=gA("modules-storage"),HB=Object.freeze({}),QB=Object.freeze({});function PU(j){return j&&j.type==="codeFile"?($(_(j.sourceContent),"code module entry is missing source content"),!0):!1}function od(j){return j.name===m6&&j.type===n7}function hG(j){return j.id===We}function UB(j,A){return!!j&&j.saveId===A.saveId&&j.id===A.moduleId}var Vs=class extends Error{constructor(){super("A circular dependency was detected."),this.name="CircularDependencyError"}},ni="update-modules-storage",RG=0;async function Aj(j){let A=performance.now(),e=`acquire-modules-storage-lock-${RG++}`;return Tn(e),Vl.request(ni,()=>{let t=performance.now()-A;return Ja(`\u{1F513} Acquire ${ni} lock`,e),Ha(e),X.debug("\u{1F513} Acquired the",ni,"lock in",t.toFixed(2),"ms"),t>1e3&&X.warn("\u2757 Long wait: it took",t.toFixed(0),"ms to acquire the",ni,"lock."),j()})}var Ks=class{constructor(A,e,t,r){this.storage=A;this.localId=e;this.type=t;this.debugModuleStoreAndComponentLoaderRevisionsMatch=r}get id(){let A=this.storage.getPersistedModuleByLocalId(this.localId);if(A)return A.id;let e=this.storage.getModuleTreeData(this.localId);return $(e,"Module must exist"),e.moduleId}get saveId(){let A=this.storage.getTransientSaveByLocalId(this.localId);if(A)return A.saveId;let e=this.storage.getPersistedModuleByLocalId(this.localId);return $(e,"Module must exist"),e.saveId}get transientSVGIcon(){let A=this.storage.getTransientSaveByLocalId(this.localId);if(A)return A.svgIcon}externalModuleIdentifier(A="default"){let e=this.storage.getTransientSaveByLocalId(this.localId);if(e){let r=re(e.name);return le(this.id,e.saveId,r.module,A)}let t=this.storage.getPersistedModuleByLocalId(this.localId);return $(t?.files.module,"ModulesStorage: Expected module typed file in persisted module."),le(this.id,t.saveId,t.files.module,A)}delete(){return this.storage.delete(this.localId)}publish(A,e,t){return this.storage.publish(this.localId,{namespace:A,name:e,version:t})}sourceRevision(){let A=this.storage.getTransientSaveByLocalId(this.localId);if(A)return A.sourceRevision;let e=this.storage.getPersistedModuleByLocalId(this.localId);if(e)return sd(e)}annotations(A,e){let t=this.storage.getTransientSaveByLocalId(this.localId),r=t?.annotations?ko(t.annotations):this.storage.getModuleTreeData(this.localId)?.annotations;return A&&this.debugModuleStoreAndComponentLoaderRevisionsMatch()&&IG(r,A),e?r?.[e]:r}},id=class extends Ks{constructor(e,t,r,o,n){super(e,t,r,o);this.name=n}currentSourceEquals(e,t){let r=this.storage.getPersistedModuleByLocalId(this.localId);return!r||r.submodules.length||t.submodules?.size?!1:r.sourceContent===e}updateSource(e,t={}){return this.storage.updateSources([{localId:this.localId,source:e,options:{...t,stableName:!0}}])}persist(e){return this.storage.upsert(this.localId,{...e,type:this.type,name:this.name})}getKitSectionsStructure(){let e=this.storage.getTransientSaveByLocalId(this.localId);return e?e.kitSectionsStructure:this.storage.getKitSectionsStructure(this.name)}};function IG(j,A){if(!j)return;let e=oA(A.identifier);$(YA(e)&&Rj(e),"Entity must have an identifier."),A.annotations&&e.exportSpecifier in j&&!Qr(j[e.exportSpecifier],ko({default:A.annotations}).default,!0)&&X.reportError("Static annotations are not synchronized with runtime annotations.",{identifier:A.identifier})}function sd(j){let A=j?.metadata.sourceRevision;return Y(A)?A:void 0}var ad=class extends Ks{updateSource(A,e){return this.storage.updateSources([{localId:this.localId,source:A,options:e??{}}])}persist(A){return this.storage.update(this.localId,A)}rename(A){return this.storage.rename(this.localId,A)}},Js=class{constructor(A,e,t=()=>!0){this.storage=A;this.type=e;this.moduleStoreAndComponentLoaderRevisionsMatch=t}async create(A){return this.storage.create({...A,type:this.type})}getByStableName(A){return new id(this.storage,Ue(this.type,A),this.type,this.moduleStoreAndComponentLoaderRevisionsMatch,A)}getByLocalId(A){return new ad(this.storage,A,this.type,this.moduleStoreAndComponentLoaderRevisionsMatch)}getUniqueName(A){return this.storage.getUniqueNameForType(this.type,A)}},Hs=class{constructor(A,e,t,r,o,n,a,i){this.getModulesService=A;this.compile=e;this.process=t;this.processWhenReady=r;this.runWhenIdle=o;this.treeStore=n;this.getActiveScope=a;this.makeDocumentReadOnly=i;I(this,"useTreeAsLocalModuleList",!1);I(this,"writeLocalModulesToTree",!1);I(this,"dependenciesModule");I(this,"persistedModules",new Map);I(this,"persistedLocalIdsByTypeSlashNameCache",new WeakMap);I(this,"transientSaves",new Map);I(this,"lastSnapshot",{dependenciesModule:void 0,modules:new Map,depsGraph:{},initialized:!1});I(this,"modulesService");I(this,"lazyServerModulesForTransientSaves",new Map);I(this,"backgroundJob",null);I(this,"backgroundAbortController",null);I(this,"initialized",!1);I(this,"initializationStarted",!1);I(this,"readOnlyTree",!1);I(this,"resolveInitialization",()=>{throw new Error("initializationPromise has not executed yet")});I(this,"rejectInitialization",()=>{throw new Error("initializationPromise has not executed yet")});I(this,"initializationPromise",new Promise((A,e)=>{this.resolveInitialization=A,this.rejectInitialization=e}));I(this,"didSetupModuleEventStream",!1);I(this,"transientInfo",null);I(this,"previousLocalModuleNodes",[]);I(this,"treeNodesToUpdate",new Map);I(this,"treeNodesToDelete",[]);I(this,"goingToStartUsingLocalModulesInTree",!1);I(this,"listeners",new Set);I(this,"transientSaveRetries",new Map);I(this,"transientSaveRelativeImportRetries",new Set);I(this,"downloadQueue",new Do(1200))}hasPendingServerModules(){return this.lazyServerModulesForTransientSaves.size>0}processOnePendingServerModule(){return this.lazyServerModulesForTransientSaves.size===0?Promise.resolve(!1):Aj(async()=>{for(let[,A]of this.lazyServerModulesForTransientSaves)for(let e of A){let t=this.persistedModules.get(e)?.localId;if(!t)continue;let r=this.persistedModules.get(t);if(r?.kind!=="server")continue;X.debug("\u{1F343} Process one server \u2192 local module",e);let o=await this.createLocalModuleFromModule(r),n=tj(this.persistedModules,a=>{a.set(r.localId,o)});return this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:n,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!1,transientSaves:this.transientSaves}),!0}return!1})}async changeScope(A){if(!this.hasPendingServerModules())return;let e=ri(A);!e||e.size===0||(await Aj(async()=>{let t=new Set,r=this.lastSnapshot.depsGraph;for(let[i,s]of this.lazyServerModulesForTransientSaves)Nr(r,i,s,e,t);let o=[];for(let i of t){let s=this.getModuleWithTypeSlashName(i);s?.kind==="server"&&o.push(this.createLocalModuleFromModule(s))}if(X.debug("\u{1F343} Prioritizing making visible modules local after changing scope:",A.id,"/ Visible:",e,"/ Visible Dependencies:",t,"/ Server modules:",o.length),o.length===0)return;let n=await Promise.all(o),a=tj(this.persistedModules,i=>{for(let s of n)i.set(s.localId,s)});this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:a,depsGraph:r,didRemoteChange:!1,transientSaves:this.transientSaves})}),this.makeLazyServerModulesLocalWhenIdle().catch(yA))}async makeVisibleDependentServerModulesLocal(A){if(!OA.isOn("prioritizedModuleEvaluation"))return;let e=this.getActiveScope(),t=new Set,r=ri(e),o=new Set;for(let i of A){let s=this.typeAndNameFromLocalId(i.localId,i.options.stableName),l=CA(s),c=this.lastSnapshot.depsGraph;Nr(c,l,o,r,t),this.lazyServerModulesForTransientSaves.set(l,o),t.delete(l)}let n=[];for(let i of t){let s=this.getModuleWithTypeSlashName(i);s?.kind==="server"&&n.push(this.createLocalModuleFromModule(s))}X.debug("\u{1F343} Prioritizing dependent server modules after updating:",A.map(i=>i.localId),"/ Visible:",t,"/ Lazy:",o,"/ Server modules:",n.length);let a=this.persistedModules;if(n.length>0){let i=await Promise.all(n);a=tj(a,s=>{for(let l of i)s.set(l.localId,l)})}this.persistedModules=a}async makeLazyServerModulesLocalWhenIdle(){this.cancelBackgroundJob(),this.backgroundAbortController=new AbortController;let{signal:A}=this.backgroundAbortController;return this.backgroundJob=(async()=>{try{for(;this.hasPendingServerModules()&&!A.aborted;){let e=new vi;if(this.runWhenIdle(()=>{if(A.aborted){e.resolve(!1);return}this.processOnePendingServerModule().then(e.resolve,e.reject)}),!await e)break}}finally{this.backgroundJob=null,this.backgroundAbortController=null}})(),this.backgroundJob}cancelBackgroundJob(){this.backgroundAbortController&&this.backgroundAbortController.abort()}getTransientSave(A){return this.transientSaves.get(A)}resetModuleStateAndPermissions(A){this.readOnlyTree=A==="readonly",this.useTreeAsLocalModuleList=this.readOnlyTree,!this.readOnlyTree&&this.modulesService&&this.setupModuleEventStreamIfNeeded(),this.treeNodesToUpdate.clear(),this.treeNodesToDelete=[],this.transientSaves.size>0&&(X.reportErrorOncePerMinute(new Error("Discarding transient saves"),{count:this.transientSaves.size}),this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:this.persistedModules,transientSaves:new Map,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!0}))}async waitForModulesToSave(){let A=Array.from(this.transientSaves.keys());for(let t of A)this.transientSaves.has(t)&&await this.update(t,{});let e=this.transientSaves.size;e>0&&X.warn("waitForModulesToSave: transientSaves seems to be growing, ignoring rest:",e)}async initialize(){return this.initializationStarted?this.initializationPromise:(this.initializationStarted=!0,this.initializeInternal().then(this.resolveInitialization,A=>{X.reportError(A,{context:"Failed to initialize ModulesStorage: "}),this.rejectInitialization(A)}),this.initializationPromise)}setupModuleEventStreamIfNeeded(){this.didSetupModuleEventStream||(this.didSetupModuleEventStream=!0,$(this.modulesService,"ModulesStorage.useModuleEventStream: expected modules service to be initialized"),this.modulesService.moduleEventsStream().read(async({events:A})=>{let e=A.filter(SG);this.handleRemoteModuleSaveEvents(e).catch(X.reportError);let t=A.filter(yG);this.handleRemoteModuleDeleteEvents(t).catch(X.reportError)}).catch(A=>{X.reportError(A,{context:"Failed to read ModulesAPI event stream: "})}))}async initializeInternal(){if(this.modulesService=await this.getModulesService(),!this.modulesService)return;let A=this.treeStore.tree.getLocalModuleNodes();this.writeLocalModulesToTree=!!A,this.useTreeAsLocalModuleList||this.setupModuleEventStreamIfNeeded();let e,t=performance.now();if(Qa("modulesStorageStart"),this.useTreeAsLocalModuleList&&A){X.info("init from tree data"),this.previousLocalModuleNodes=A;let i=A.map(s=>({moduleId:s.save.moduleId,saveId:s.save.saveId}));e=await this.modulesService.lookUpModules({queries:i})}else X.info("init from module list"),e=await this.modulesService.list({});Qa("modulesStorageInit"),X.debug("listing modules took:",performance.now()-t,"millis");let r=e.data.find(od);r&&await this.updateDependenciesModule(r);let o=new Map,n=new Set;await Promise.all(e.data.map(async i=>{if(CA(i)===We)return;let s=await this.createServerModuleFromData(i);X.trace("init - create module",s.localId,s.id,s.saveId,s.savedAt),o.set(s.localId,s),n.add(s.localId)}));let a=this.createDependencyGraph(o);this.initialized=!0,this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:o,transientSaves:this.transientSaves,depsGraph:a,didRemoteChange:!0}),Qa("modulesStorageFirstPublish"),this.processTreeUpdates()}createDependencyGraph(A){let e=[];for(let t of A.values()){let r=CA(t),o=t.imports.relative;e.push([r,o])}return Uc(e)}processTreeUpdates(){if(this.initialized){if(this.readOnlyTree)if(this.useTreeAsLocalModuleList){if(!this.treeStore.tree.has(fe)){X.info("detected removal of local modules list node, stopping to use tree as local module list"),this.useTreeAsLocalModuleList=!1,this.setupModuleEventStreamIfNeeded();return}}else{if(!this.treeStore.tree.has(fe))return;X.info("detected insertion of a local modules list node, starting to use tree as local module list"),this.useTreeAsLocalModuleList=!0}this.syncLocalModules(),this.tryWriteTreeData()}}async syncLocalModules(){if(!this.useTreeAsLocalModuleList)return;let A=this.treeStore.tree.getLocalModulesListNode()?.children;if(!A||this.previousLocalModuleNodes===A)return;let e=[],t=j7(this.previousLocalModuleNodes,r=>[r.id,r]);this.previousLocalModuleNodes=A;for(let r of A){let o=t.get(r.id);if(t.delete(r.id),o===r)continue;let n=r.save,a=this.persistedModules.get(r.id);UB(a,n)||hG(r)&&UB(this.dependenciesModule,n)||(e.push({moduleId:n.moduleId,saveId:n.saveId}),X.debug("syncLocalModules to update:",r.id))}if(t.size>0&&(X.debug("syncLocalModules removing:",t.keys()),this.handleRemoteModuleDeletes(Array.from(t.values()).map(r=>r.save.moduleId))),e.length>0){X.debug("syncLocalModules updating:",e),$(this.modulesService,"ModulesStorage.refresh: expected modules service to be initialized");let r=performance.now(),o=await this.modulesService.lookUpModules({queries:e});X.debug("lookupModules took:",performance.now()-r,"millis"),await this.handleRemoteModuleSaves(o.data)}}canWriteTree(){return!this.treeStore.tree.isViewOnly}tryWriteTreeData(){this.canWriteTree()&&(this.treeNodesToUpdate.size===0&&this.treeNodesToDelete.length===0||this.processWhenReady(()=>{if(!this.canWriteTree())return;let A=this.treeStore.tree;A.lineage.setEditReason("localmodules"),this.createLocalModulesListNodeIfNeeded(A);for(let e of this.treeNodesToDelete)this.persistedModules.get(e)||(X.debug("tryWriteTreeData, remove:",e),A.remove(e));this.treeNodesToDelete=[];for(let[e,{treeVersion:t,errors:r,persistedModule:o}]of this.treeNodesToUpdate.entries())this.persistedModules.get(e)?.saveId===o.saveId&&(X.debug("tryWriteTreeData, write:",e,t,o.id,o.saveId,r),this.updateNode(A,e,t,o,r));this.treeNodesToUpdate.clear()},"nonUserEvent"))}updateTreeNodeWithOwnTreeVersion(A,e){!this.writeLocalModulesToTree&&!this.maybeUpgradeDocument()||this.process(()=>{this.treeStore.tree.lineage.setEditReason("localmodules"),this.createLocalModulesListNodeIfNeeded(this.treeStore.tree);let r=this.treeStore.tree.get(A)?.save.treeVersion??this.treeStore.remoteTreeVersion;X.debug("updateTreeNodeWithCurrentTreeVersion:",A,r,e.id,e.saveId),this.updateNode(this.treeStore.tree,A,r,e)},"nonUserEvent")}updateTreeNode(A,e,t,r,o){return!this.writeLocalModulesToTree&&!this.maybeUpgradeDocument()?!0:this.canWriteTree()?(this.process(()=>{this.treeStore.tree.lineage.setEditReason("localmodules"),this.createLocalModulesListNodeIfNeeded(this.treeStore.tree),X.debug("updateTreeNode:",A,e,t.id,t.saveId),this.updateNode(this.treeStore.tree,A,e,t,r,o)},"nonUserEvent"),!0):(X.debug("updateTreeNode - readonly, buffering change"),this.treeNodesToUpdate.set(A,{treeVersion:e,persistedModule:t,errors:r,kitSectionsStructure:o}),!0)}removeTreeNode(A){this.writeLocalModulesToTree&&(this.canWriteTree()?this.process(()=>{X.debug("removeTreeNode:",A),this.treeStore.tree.remove(A)}):this.treeNodesToDelete.push(A))}updateNode(A,e,t,r,o,n){$(this.writeLocalModulesToTree,"not using tree for local modules");let a=A.get(e)?.asDraft()??new El({id:e});$(a instanceof El);let i=r.metadata.pluginId,s={treeVersion:t,moduleId:r.id,saveId:r.saveId,imports:r.imports?.relative,title:r.title,name:r.name,type:r.type,sourceRevision:r.sourceRevision,annotations:r.annotations?ko(r.annotations):a.save.annotations,pluginId:_(i)?i:a.save.pluginId};a.set({save:s}),a.tree()||A.insertNode(a,fe);let l=r.name;if(!A.has(l))return;if(ij(n)){let p=A.get(l);w(p)&&p.set({kitSectionsStructure:n})}if(!o)return;let c=A.get(Ok);if(X.debug("Writing serialization errors from artifacts to tree for",l),c?.children?.forEach(p=>{let f=p.sourceNodeId??p.scopeId,E=sA(p.sourceNodeModuleType)||r.type===p.sourceNodeModuleType;!f||f!==l||!E||!wk(p.type)||A.remove(p.id)}),o.length===0)return;let u=A.ensureErrorListNode();o.forEach(p=>A.insertNode(p,u.id))}getModuleTreeData(A){return this.treeStore.tree.getNodeWithTrait(A,Br)?.save}getKitSectionsStructure(A){return this.treeStore.tree.getNodeWithTrait(A,w)?.kitSectionsStructure}createLocalModulesListNodeIfNeeded(A){if($(this.writeLocalModulesToTree,"not using tree for local modules"),A.has(fe)||!this.canWriteTree())return;X.debug("ensureAllModulesExistInTree:",this.persistedModules.size),A.insertNode(new gk);let e=this.treeStore.remoteTreeVersion;this.persistedModules.forEach(t=>{this.updateNode(A,t.localId,e,t)}),this.dependenciesModule&&this.updateNode(A,We,e,this.dependenciesModule)}usingLocalModulesInTree(){return this.treeStore.tree.has(fe)||this.goingToStartUsingLocalModulesInTree}async startUsingLocalModulesInTree(){if(!this.canWriteTree())throw Error("Project is read only.");this.goingToStartUsingLocalModulesInTree=!0,this.process(()=>{if(this.startUsingLocalModulesInTree){if(!this.canWriteTree())throw Error("Project is read only.");this.treeStore.tree.lineage.setEditReason("startUsingLocalModulesInTree"),this.goingToStartUsingLocalModulesInTree=!1,this.writeLocalModulesToTree=!0,this.createLocalModulesListNodeIfNeeded(this.treeStore.tree)}})}stopUsingLocalModulesInTree(){this.goingToStartUsingLocalModulesInTree=!1,this.process(()=>{if(!this.canWriteTree())throw Error("Project is read only.");this.treeStore.tree.lineage.setEditReason("stopUsingLocalModulesInTree"),this.treeStore.tree.remove(fe),this.writeLocalModulesToTree=!1,this.setupModuleEventStreamIfNeeded()})}maybeUpgradeDocument(){return this.process(()=>{if(!this.canWriteTree()){X.warn("cannot upgrade document if we cannot write, but should not be saving modules either");return}X.info("upgrading document to use local modules list node"),this.treeStore.tree.lineage.setEditReason("maybeUpgradeDocument"),this.writeLocalModulesToTree=!0,this.createLocalModulesListNodeIfNeeded(this.treeStore.tree)},"nonUserEvent"),this.writeLocalModulesToTree}getModuleWithTypeSlashName(A){let e=this.findPersistedModuleLocalIdByTypeSlashName(this.persistedModules,A);if(e)return this.persistedModules.get(e)}async updateDependenciesModule(A){$(od(A),"updateDependenciesModule called with non dependencies module data");let e=await this.getDependenciesFiles(A),t=e?.dependenciesMapContent;if(!t){let r=JSON.parse(e.importMapContent),o=po(r);t=JSON.stringify(o),this.readOnlyTree?X.reportError(new Error("modules storage is read only"),{context:"modules storage is read only while calling updateDependenciesModule"}):(await this.updateDependenciesLocked(r,o),X.info("The missing dependencies file has now been created."))}this.dependenciesModule={kind:"dependencies",...A,id:A.id,localId:A.localId,type:"config",name:A.name,importMapContent:e.importMapContent,dependenciesMapContent:t}}async createServerModuleFromData(A){let e={kind:"server",...A,id:A.id,localId:A.localId,moduleURL:A.baseURL+(A.type==="kit"?A.files.source:A.files.module),update:performance.now()};if((e.type==="codeFile"||e.type==="webPageMetadata")&&(e.sourceContent=await this.fetchSourceContentFromData(A)),Yc(e)&&Xc(e)===0){e.sourceContent=await this.fetchSourceContentFromData(A);let t=e.sourceContent.includes("useQueryData")?1:0;e.metadata={...e.metadata,compatibleCmsVersion:t}}return e}async fetchSourceContentFromData(A){let e=A.baseURL+A.files.source;return(await fetch(e)).text()}async refresh(){if(this.initialized&&!this.useTreeAsLocalModuleList)return X.debug("refresh: acquiring lock"),Aj(()=>this.refreshLocked())}async refreshLocked(){X.debug("refresh: start"),$(this.modulesService,"ModulesStorage.refresh: expected modules service to be initialized");let{data:A}=await this.modulesService.list({});X.debug("refresh: there's",A.length,"modules to process");let e=new Map,t=new Set;await Promise.all(A.map(async o=>{let n=o.localId;if(od(o)){this.dependenciesModule?.saveId!==o.saveId&&await this.updateDependenciesModule(o);return}let a=this.persistedModules.get(n);if(a?.saveId===o.saveId)e.set(n,a);else{let i=await this.createServerModuleFromData(o);X.debug("refresh - updating module",i.localId,i.id,i.saveId,i.savedAt),e.set(n,i)}t.add(n)}));let r=this.createDependencyGraph(e);this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:e,transientSaves:this.transientSaves,depsGraph:r,didRemoteChange:!0}),X.debug("refresh: finish")}whenInitialized(){return this.initializationPromise}async whenIdle(){await Promise.all([this.whenInitialized(),Aj(()=>{})])}isProcessing(){return!!(!this.initialized||this.transientSaves.size>0||Vl.isLocked(ni))}hasLocalChanges(){return this.transientSaves.size>0}hasLocalCodeFileChanges(){if(this.transientSaves.size===0)return!1;for(let A of this.transientSaves.values())if(A.type==="codeFile"||A.type==="config")return!0;return!1}addListener(A){this.listeners.add(A)}removeListener(A){this.listeners.delete(A)}notifyListeners(A){this.listeners.forEach(e=>{try{e(A)}catch(t){X.reportError(t)}})}subscribe(A){return this.addListener(A),A(WB(this.dependenciesModule,void 0,this.persistedModules,this.transientSaves,this.lastSnapshot.depsGraph,new Map,this.initialized,!1,!1)),()=>this.removeListener(A)}getDependentsOfModule(A){return this.lastSnapshot.depsGraph[A]?.dependents}getUniqueNameForType(A,e){let t=new Set;for(let r of this.persistedModules.values())r.type===A&&t.add(r.name);return NB(t,e)}async updateSources(A){return Aj(async()=>{let e=!1;for(let{localId:t,source:r,options:o}of A){let n=Date.now();try{await this.updateSourceLocked(t,{...o,source:r}),e=!0}catch(a){a instanceof Vs&&TA({type:"add",variant:"error",text:"Instances of your component won't update if they are nested within themselves.",key:"component-circular-dependency",icon:"error",duration:Number.POSITIVE_INFINITY}),X.reportError(a)}finally{let a=Date.now()-n;X.debug("\u23F1 update source",t,"in",a,"ms")}}return await this.makeVisibleDependentServerModulesLocal(A),this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:this.persistedModules,transientSaves:this.transientSaves,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!1}),this.makeLazyServerModulesLocalWhenIdle().catch(yA),e})}async updateDependenciesSource(A,e){return Aj(async()=>{$(this.dependenciesModule,"Dependency files must already exist to be updated.");let t=A===i7?e:this.dependenciesModule.importMapContent,r=A===a7?e:this.dependenciesModule.dependenciesMapContent;return this.updateDependenciesLocked(JSON.parse(t),JSON.parse(r))})}async compileSubmodules(A,e){let t={};return await Promise.all([...e].map(async([r,o])=>{let n=await this.compile({name:r,source:o,type:A,includeSourceMap:!1,addFramerMetadata:!1});for(let i of n.imports.relative){let s=jf(i);if(!(s&&e.has(s)))throw new Error("Submodules only support relative imports of other submodules")}let a=Ua(r);t[a]=n.code})),t}typeAndNameFromLocalId(A,e=!1){if(e)return Ci(A);for(let t of this.lastSnapshot.modules.values())if(t?.localId===A)return t;throw new Error(`Module entry for local id ${A} missing in internal snapshot`)}async updateSourceLocked(A,{source:e,submodules:t,binaryAssets:r=QB,stableName:o=!1,assets:n,preventCircularImports:a,telemetrySession:i,treeVersion:s,sourceRevision:l,svgIcon:c,kitSectionsStructure:u}){await this.whenInitialized();let p=this.typeAndNameFromLocalId(A,o),f=CA(p),E=await this.compile({localId:A,name:f,source:e,type:p.type,includeSourceMap:nd(p.type),telemetrySession:i}),F=HB;t&&(F=await this.compileSubmodules(p.type,t));let h=Po(this.lastSnapshot.depsGraph,f,E.imports.relative);if(a&&vB(h,f))throw new Vs;let S=CG(p.type,E.annotations),v=tj(this.transientSaves,P=>{let T=P.get(A),N,Q=S?.framerIntrinsicWidth;Q&&(N={...N,intrinsicWidth:Number.parseInt(Q,10)});let H=S?.framerIntrinsicHeight;if(H&&(N={...N,intrinsicHeight:Number.parseInt(H,10)}),N={...N,compilerContractVersion:1,treeAnnotations:!0,localModuleImportMapEntries:this.moduleUsesLocalImportMapSpecifiers(f)},T)T.saveId=xr(),T.moduleContent=E.code,T.sourceContent=e,T.sourceMapContent=E.sourceMap,T.submoduleContents=F,T.binaryAssetContents=r,T.imports=E.imports,T.exports=E.exportedNames,T.reExportedModules=E.reExportedModules,T.treeVersion=s??this.treeStore.remoteTreeVersion,T.sourceRevision=l??T.sourceRevision,T.annotations=E.annotations,T.svgIcon=c??T.svgIcon,T.kitSectionsStructure=u??T.kitSectionsStructure,T.update=performance.now(),n&&(T.assets=Array.from(n)),N&&(T.metadata={...T.metadata,...N});else{let Z={localId:A,type:p.type,name:p.name,saveId:xr(),moduleContent:E.code,sourceContent:e,sourceMapContent:E.sourceMap,submoduleContents:F,binaryAssetContents:r,imports:E.imports,exports:E.exportedNames,reExportedModules:E.reExportedModules,treeVersion:s,sourceRevision:l,svgIcon:c,kitSectionsStructure:u,annotations:E.annotations,update:performance.now()};n&&(Z.assets=Array.from(n)),N&&(Z.metadata=N),P.set(A,Z)}});this.transientInfo||=new Set,this.transientInfo.add(A),this.transientSaves=v,this.lastSnapshot={...this.lastSnapshot,depsGraph:h}}async create(A){return Aj(()=>this.createLocked(A))}async createLocked(A){await this.whenInitialized();let{type:e,name:t,source:r,...o}=A,n=CA({type:e,name:t}),a=await this.compile({name:n,source:r,type:e,includeSourceMap:nd(e)}),i={localId:void 0,type:e,name:t,saveId:xr(),moduleContent:a.code,sourceContent:r,sourceMapContent:a.sourceMap,submoduleContents:HB,binaryAssetContents:QB,imports:a.imports,exports:a.exportedNames,reExportedModules:a.reExportedModules,treeVersion:A.treeVersion||this.treeStore.remoteTreeVersion,sourceRevision:A.sourceRevision,svgIcon:A.svgIcon,kitSectionsStructure:A.kitSectionsStructure,annotations:a.annotations,update:performance.now()},s=await this.createBatchSaveForUpdatedModule("$new",i,this.persistedModules,new Map,new Map,{type:e,name:t,...o});$(!this.readOnlyTree,"modules storage is read only"),$(this.modulesService);let{data:l}=await this.modulesService.saveBatch({batch:[s]}),{updatedModuleLocalId:c,nextPersistedModules:u}=this.processTransientSaveData({nextPersistedModules:this.persistedModules,transientSave:i,data:l}),p=Po(this.lastSnapshot.depsGraph,n,a.imports.relative);return this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:u,transientSaves:this.transientSaves,depsGraph:p,didRemoteChange:!0}),c}async update(A,e){let t=this.persistedModules.get(A);return $(t,"Trying to update an unknown module with localId:",A),Aj(async()=>{let r=Date.now();try{return await this.whenInitialized(),await this.upsertBatchLocked({[A]:{...e,name:t.name,type:t.type}})}finally{let o=Date.now()-r;X.debug("\u23F1 update",A,"in",o,"ms")}})}async rename(A,e){return Aj(()=>this.renameLocked(A,e))}async renameLocked(A,e){await this.whenInitialized();let t=this.persistedModules,r=this.lastSnapshot.depsGraph,o=t.get(A);$(o,"Trying to rename an unknown module with localId:",A);let n=this.treeStore.remoteTreeVersion,a=CA(o);$(!this.readOnlyTree,"modules storage is read only"),$(this.modulesService);let i=await this.modulesService.update({moduleId:o.id,name:e});$(i,"invalid update reply");let s=r[a]?.dependents,l=[],c={},u=CA(i);if(a!==u&&(r=ws(r,a),r=Po(r,u,o.imports.relative)),s){let p=[],f=[];for(let h of t.values()){let S=CA(h);s.has(S)&&(h.kind==="local"?p.push(h):f.push(h))}if(f.length>0){let h=await Promise.all(f.map(S=>this.createLocalModuleFromModule(S)));t=tj(t,S=>{for(let v of h)S.set(v.localId,v),p.push(v)})}let E=[];for(let h of p){let S=CA(h),v=ml(S,`${o.type}/${e}`);$(v,"Failed to create relative path to",o.type,"/",e);let P=ml(S,a);$(P);let T=h.imports.relative.indexOf(P);if(T===-1){X.warn(h.localId,"doesn't import",P);continue}let N=[...h.imports.relative];N[T]=v;let Q={absolute:h.imports.absolute,bare:h.imports.bare,relative:N},H=YB(h.sourceContent,P,v),Z=YB(h.moduleContent,P,v);c[h.localId]={sourceContent:H,moduleContent:Z,imports:Q},$(h.files.source);let J={type:h.type,moduleId:h.id,name:h.name,saveId:xr(),patchSaveId:h.saveId,files:[{name:h.files.source,type:"source",content:H}],imports:Q};E.push(J)}$(!this.readOnlyTree,"modules storage is read only");let{data:F}=await this.modulesService.saveBatch({batch:E});l=F}t=tj(t,p=>{if(this.updateTreeNode(A,n,i)){o.kind==="server"?p.set(A,{...i,kind:"server",localId:i.localId,id:i.id,moduleURL:i.baseURL+i.files.module,sourceContent:o.sourceContent,update:performance.now()}):p.set(A,{...i,kind:"local",localId:i.localId,id:i.id,moduleURL:i.baseURL+i.files.module,sourceContent:o.sourceContent,moduleContent:o.moduleContent,sourceMapContent:o.sourceMapContent,submoduleContents:o.submoduleContents,binaryAssetContents:o.binaryAssetContents,update:performance.now()});for(let E of l){let F=E.localId,h=p.get(F);$(h?.kind==="local","dependent module must be local:",F);let S=c[F];$(S,"dependent module update must exist:",F),this.updateTreeNode(F,n,E)&&(p.set(F,{...E,kind:"local",localId:F,id:E.id,moduleURL:E.baseURL+E.files.module,moduleContent:S.moduleContent,sourceContent:S.sourceContent,sourceMapContent:h.sourceMapContent,submoduleContents:h.submoduleContents,binaryAssetContents:h.binaryAssetContents,imports:S.imports,exports:E.exports,reExportedModules:E.reExportedModules,submodules:E.submodules,binaryAssets:E.binaryAssets,sourceRevision:h.sourceRevision,update:h.update}),r=Po(r,CA(E),S.imports.relative))}}}),this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:t,transientSaves:this.transientSaves,depsGraph:r,didRemoteChange:!0})}async upsert(A,e){return Aj(async()=>{let t=Date.now();try{return await this.whenInitialized(),await this.upsertBatchLocked({[A]:e})}finally{let r=Date.now()-t;X.debug("\u23F1 upsert",A,"in",r,"ms")}})}async upsertBatch(A){return Aj(async()=>{let e=Date.now();try{return await this.whenInitialized(),await this.upsertBatchLocked(A)}finally{let t=Date.now()-e;X.debug("\u23F1 upsert batch in",t,"ms")}})}async delete(A){return Aj(()=>this.deleteLocked(A))}async deleteLocked(A){let e=Array.isArray(A)?A:[A];if(!e.length)return;await this.whenInitialized();let t=e.map(c=>{let u=this.persistedModules.get(c);return $(u,"Trying to delete an unknown module",c,"It was never persisted."),u}),{modulesService:r}=this;$(r);let o=await Promise.allSettled(t.map(c=>r.delete({moduleId:c.id}))),n=new Set,a=new Set;for(let c of o){if(c.status==="rejected"){X.warn(String(c.reason));continue}n.add(c.value.localId),a.add(c.value.id)}e=e.filter(c=>n.has(c)),t=t.filter(c=>a.has(c.id)),$(e.length>0,"Failed to delete module(s)");let i=this.lastSnapshot.depsGraph;for(let c of t){let u=CA(c);i=ws(i,u)}let s=tj(this.persistedModules,c=>{for(let u of e)c.delete(u),this.removeTreeNode(u)}),l=tj(this.transientSaves,c=>{for(let u of e)c.delete(u)});this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:s,transientSaves:l,depsGraph:i,didRemoteChange:!0})}async publish(A,e){return Aj(()=>this.publishLocked(A,e))}async publishLocked(A,{namespace:e,name:t,version:r}){await this.whenInitialized();let o=this.persistedModules.get(A);$(o,"Trying to publish an unknown module",A,"It was never persisted."),$(!this.readOnlyTree,"modules storage is read only"),$(this.modulesService);let n=await this.modulesService.publish({moduleId:o.id,saveId:o.saveId,namespace:e,name:t,version:r}),a=tj(this.persistedModules,i=>{let s=i.get(A);s&&i.set(A,{...s,lastPublish:{namespaceId:n.namespaceId,name:n.name,version:n.version,importURL:n.importURL}})});return this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:a,transientSaves:this.transientSaves,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!0}),n}async addNpmDependencies(A){return Aj(async()=>{await this.whenInitialized();let e;this.dependenciesModule?.importMapContent?e=JSON.parse(this.dependenciesModule?.importMapContent):e={imports:{}};let t;this.dependenciesModule?.dependenciesMapContent?t=JSON.parse(this.dependenciesModule?.dependenciesMapContent):t={dependencies:{}};let r=Array.isArray(A)?A:[A];if(r=r.filter(i=>{if(gn.has(i.target)||In(i.target))return!1;let s=Rn(i);return!e.imports[s]}),r.length===0)return{dependenciesMap:t};r=r.map(i=>{if(t.dependencies[i.target]){let l=e.imports[i.target]??Object.entries(e?.imports).find(([u])=>u.startsWith(i.target))?.[1];$(l,"The import map should contain a import that is in the dependencies map");let c=ik(l)?.version;return c?{...i,target:`${i.target}@${c}`}:i}let s=hn[i.target];return s?{...i,target:`${i.target}@${s}`}:i});let{importMap:o,resolvedDependencies:n}=await jk(e,r,gn,hn),a=await this.extendCurrentDependenciesMap(n);return n.forEach(({name:i,version:s})=>mA("npm_dependency_add",{name:i,semver:s})),X.debug({newImportMap:o,newDependenciesMap:a}),await this.updateDependenciesLocked(o,a),{dependenciesMap:a}})}async reinstallNpmDependencies(){return Aj(async()=>{let{currentImportMap:A,currentDependenciesMap:e}=this.getCurrentDependencies();delete A.scopes;let{importMap:t}=await ek(A,gn,hn);return await this.updateDependenciesLocked(t,e),t})}async uninstallBlockedNpmDependencies(){return Aj(async()=>{let{currentImportMap:A,currentDependenciesMap:e}=this.getCurrentDependencies(),t=kl(e),r=await rk(A);return await this.updateDependenciesLocked(r,t),r})}async clearNpmDependencies(){return Aj(async()=>this.updateDependenciesLocked({imports:{}},{dependencies:{}}))}async removeBlockedNpmDependencies(){return Aj(async()=>{let{currentImportMap:A,currentDependenciesMap:e}=this.getCurrentDependencies(),t=kl(e);return await this.updateDependenciesLocked(A,e),t})}async rebuildImportMapFromDependencies(){return Aj(async()=>{let A=this.dependenciesModule?.dependenciesMapContent,e=A?JSON.parse(A):{dependencies:{}},t=await nk(e,gn,hn);return await this.updateDependenciesLocked(t,e),t})}async unsafeUpgradeDependency(A,e,t){return Aj(async()=>{let{currentImportMap:r,currentDependenciesMap:o}=this.getCurrentDependencies(),n=await ok(r,A,e,t),a=po(n),i=uo(a,o);return await this.updateDependenciesLocked(n,i),n})}async extendCurrentImportMap(A,e){return Aj(async()=>{let{currentImportMap:t,currentDependenciesMap:r}=this.getCurrentDependencies(),o=co(t,A),n=uo(r,e);return this.updateDependenciesLocked(o,n)})}async extendCurrentDependenciesMap(A){let e={};for(let r of A)e[r.name]=r.version;let t=this.dependenciesModule?.dependenciesMapContent?JSON.parse(this.dependenciesModule?.dependenciesMapContent):{dependencies:{}};return t.dependencies=Object.assign(e,t.dependencies),t}getCurrentDependencies(){let A=this.dependenciesModule?.importMapContent?JSON.parse(this.dependenciesModule?.importMapContent):{imports:{}},e=this.dependenciesModule?.dependenciesMapContent?JSON.parse(this.dependenciesModule?.dependenciesMapContent):{dependencies:{}};return{currentImportMap:A,currentDependenciesMap:e}}async updateDependenciesLocked(A,e){let t=JSON.stringify(A,null,4),r=JSON.stringify(e,null,4);if(t===this.dependenciesModule?.importMapContent&&r===this.dependenciesModule?.dependenciesMapContent)return;let o={moduleId:"$upsertName",name:m6,saveId:xr(),type:"config",files:[{name:"importMap.json",type:"importMap",content:t},{name:"dependencies.json",type:"dependencies",content:r}],imports:{absolute:[],relative:[],bare:[]}};$(!this.readOnlyTree,"modules storage is read only"),$(this.modulesService);let{data:[n]}=await this.modulesService.saveBatch({batch:[o]});$(n,"Modules API must return an updated import map after savebatch"),this.updateTreeNodeWithOwnTreeVersion(We,n);let a={kind:"dependencies",importMapContent:t,dependenciesMapContent:r,...n,id:n.id,localId:n.localId,type:n.type,name:n.name};this.setNextInternalState({dependenciesModule:a,persistedModules:this.persistedModules,transientSaves:this.transientSaves,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!0})}getPersistedDependenciesModule(){return this.dependenciesModule}getPersistedModuleByGlobalId(A){for(let e of this.persistedModules.values())if(e.id===A)return e}getPersistedModuleByLocalId(A){return this.persistedModules.get(A)}getTransientSaveByLocalId(A){return this.transientSaves.get(A)}async handleRemoteModuleDeleteEvents(A){if(!this.useTreeAsLocalModuleList)return this.handleRemoteModuleDeletes(A.map(e=>e.id))}async handleRemoteModuleDeletes(A){await Aj(async()=>{let e=[],t=[];for(let a of A){let i=this.getPersistedModuleByGlobalId(a);i&&(t.push(CA(i)),e.push(i.localId))}let r=tj(this.persistedModules,a=>{for(let i of e)a.delete(i)}),o=tj(this.transientSaves,a=>{for(let i of e)a.delete(i)}),n=this.lastSnapshot.depsGraph;for(let a of t)n=ws(n,a);this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:r,transientSaves:o,depsGraph:n,didRemoteChange:!0})})}async handleRemoteModuleSaveEvents(A){if(!this.useTreeAsLocalModuleList)return this.handleRemoteModuleSaves(A.map(e=>e.module))}async handleRemoteModuleSaves(A){let e=[],t=[];for(let n of A)CA(n)===We?e.push(n):t.push(n);let r,o=e.length>0?e[e.length-1]:void 0;if(o){let{importMapContent:n,dependenciesMapContent:a}=await this.getDependenciesFiles(o);$(a,"No dependencies file exists for the remote update!"),r={kind:"dependencies",...o,id:o.id,localId:o.localId,type:"config",name:o.name,importMapContent:n,dependenciesMapContent:a}}await Aj(async()=>{r&&(this.dependenciesModule=r);let n=this.persistedModules,a=this.lastSnapshot.depsGraph,i=await Promise.all(t.map(s=>this.createServerModuleFromData(s)));for(let s of i){let l=CA(s),c=s.localId;n=tj(n,u=>{u.set(c,s)}),this.transientSaves.has(c)||(a=Po(this.lastSnapshot.depsGraph,l,s.imports.relative))}this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:n,transientSaves:this.transientSaves,depsGraph:a,didRemoteChange:!0,multiplayerChange:!0})})}getPatchTransientSave(A,e,t){return{saveId:t,type:e.type,name:e.name,localId:A,moduleContent:e.moduleContent,sourceContent:e.sourceContent,sourceMapContent:e.sourceMapContent,submoduleContents:e.submoduleContents,binaryAssetContents:e.binaryAssetContents,imports:e.imports,exports:e.exports,reExportedModules:e.reExportedModules,sourceRevision:e.sourceRevision,update:e.update}}async upsertBatchLocked(A){if(this.readOnlyTree)return;let e=this.persistedModules,t=new Map,r=[],o=new Map;for(let c of e.values()){let u=CA(c);o.set(u,c.localId),r.push([u,c.imports.relative])}let n=new Map;for(let c in A){let u=c,p=A[u];$(p,"No persist params found for",u);let f=this.transientSaves.get(u),E=f??e.get(u);$(E,"No module found for",u);let F=CA(E);n.set(F,f?.saveId??xr()),t.set(F,re(p.name)),o.set(F,u),f&&r.push([F,f.imports.relative])}let a=Uc(r),i=new Map,s=tj(this.transientSaves,c=>{for(let u in A)c.delete(u)}),l;try{let{batch:c,nextPersistedModules:u}=await this.createBatch(A,i,e,a,o,n,t);$(!this.readOnlyTree,"modules storage is read only"),$(this.modulesService);let{data:p}=await this.modulesService.saveBatch({batch:c});e=tj(u,f=>{for(let E of p.values()){let F=E.localId,h=i.get(F);if(!h){let Q=f.get(F);$(Q,F,"is not in persistedModules"),this.updateTreeNodeWithOwnTreeVersion(F,E),Q.saveId=E.saveId,Q.moduleURL=E.baseURL+E.files.module;continue}let S={kind:"local",...E,id:E.id,localId:E.localId,imports:h.imports,moduleURL:E.baseURL+E.files.module,sourceContent:h.sourceContent,sourceMapContent:h.sourceMapContent,moduleContent:h.moduleContent,submoduleContents:h.submoduleContents,binaryAssetContents:h.binaryAssetContents,sourceRevision:h.sourceRevision,annotations:h.annotations,update:h.update},v=A[F]?.errors,P=h.kitSectionsStructure,T=h.treeVersion??this.treeStore.remoteTreeVersion;if(!this.updateTreeNode(E.localId,T,S,v,P))return;f.set(F,S)}})}catch(c){e=this.persistedModules;let u=Array.from(i.values()).map(F=>F.saveId).join("-"),p=this.transientSaveRetries.get(u)??0,{error:f,dropTransient:E}=this.handlePersistenceError(c,p,()=>{this.transientSaveRetries.set(u,p+1),setTimeout(async()=>{let F=Object.entries(i).every(([h,S])=>{let v=h,P=this.transientSaves.get(v);return P&&P.saveId===S.saveId});Ls(f)&&(this.transientSaveRelativeImportRetries.add(u),await this.refresh()),F&&(X.debug("retrying saving batchId with id:",u),this.upsertBatchLocked(A))},1e3+p*1e3)});if(!E)return;l=f}if(this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:e,transientSaves:s,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!0}),l)throw l}async createBatch(A,e,t,r,o,n,a){let i=[];for(let u in A){let p=u,f=A[p];$(f,"No persist params found for",p);let E=this.transientSaves.get(p);if(!E){let h=t.get(p);$(h,`Trying to persist ${p} but it doesn't have neither a corresponding transient save nor an existing persisted module.`),h.kind==="server"&&(h=await this.createLocalModuleFromModule(h),t=tj(t,v=>{h&&v.set(h.localId,h)}));let S=n.get(p);$(S,"No save id found for",p),E=this.getPatchTransientSave(p,h,S)}e.set(p,E);let F=await this.createBatchSaveForUpdatedModule(this.persistedModules.get(p)?.id??"$upsertName",E,t,n,a,f);i.push(F)}let s=new Map;for(let u in A){let p=u,f=A[p];$(f,"No persist params found for",p);let E=CA(f),F=new Set;Nr(r,E,F),s.set(p,F)}let l=[];for(let u of s.values())for(let p of u){let f=o.get(p);$(f,"Cannot find localId for",p);let E=t.get(f);E?.kind==="server"&&l.push(this.createLocalModuleFromModule(E))}if(l.length>0){let u=await Promise.all(l);t=tj(t,p=>{for(let f of u)p.set(f.localId,f)})}for(let u of s.values())for(let p of u)n.has(p)||n.set(p,xr());let c=new Set;for(let[u,p]of s){let[f]=ya(u);for(let E of p){let F=o.get(E);if($(F,"Cannot find localId for",E),e.has(F)||c.has(E)||t.get(F)?.metadata.localModuleImportMapEntries===!0&&this.moduleUsesLocalImportMapSpecifiers(E)&&(f!=="codeFile"||!r[E]?.dependencies.has(u)))continue;c.add(E);let v=await this.createBatchSaveForDependentModule(F,t,n,a);i.push(v)}}return{batch:i,nextPersistedModules:t}}handlePersistenceError(A,e,t){let r=A instanceof Error?A.message:"",o=A instanceof f6?A.code:0,n=A instanceof f6?A.status:0,a=o===1002,i=o===-1e3,s=n>=300&&n!==400&&n!==403,l=i||s||Ls(A),c=20,u=2;if(Ls(A)&&OA.isOn("retryRelativeImportRewriting"))return!l||e>=u?(X.reportError("Relative imports error, exceeded max retries, making document read only:",{missing:A.persistedMissingRelativeImports}),this.makeDocumentReadOnly(),TA({type:"add",variant:"warning",text:"Framer can\u2019t save your latest changes. Please reload the page to continue working.",key:"client-outdated",duration:Number.POSITIVE_INFINITY,icon:"warning",showCloseButton:"never",action:{title:"Reload",onClick:()=>{X.reportError("ModulesStorage: Reloaded due to relative imports error.",{missing:A.persistedMissingRelativeImports}),window.top.location.reload()}}}),{error:A,dropTransient:!0}):(X.debug("Relative imports error, will retry:",{missing:A.persistedMissingRelativeImports}),t(),{error:A,dropTransient:!1});if(a&&e>0)X.debug("Ignoring duplicated save id.");else{if(a)return X.debug("Duplicate save id error, will drop transient save:",A),{error:A,dropTransient:!0};if(l&&e<c)return X.info("Connection error, will retry:",{message:r,code:o,status:n,retryCount:e}),t(),{dropTransient:!1};if(l)X.error("Error saving: too many retries, will drop transient save:",{message:r,code:o,status:n,retryCount:e});else return X.debug("Error saving, will drop transient save:",A),{error:A,dropTransient:!0}}return{dropTransient:!1}}moduleUsesLocalImportMapSpecifiers(A){let[e,t]=ya(A);if(e==="layoutTemplate")return!0;if(e==="collection")return OA.isOn("collectionLocalModuleImportMapEntries");if(e==="screen"){let r=this.treeStore.tree.get(t);if(Dj(r)||w(r))return!0}return!1}processTransientSaveData({nextPersistedModules:A,transientSave:e,data:t},r,o){let n=e.treeVersion??this.treeStore.remoteTreeVersion,a;return A=tj(A,i=>{let s=t.values(),l=s.next().value;a=l.localId;let c={kind:"local",...l,id:l.id,localId:a,imports:e.imports,moduleURL:l.baseURL+l.files.module,sourceContent:e.sourceContent,sourceMapContent:e.sourceMapContent,moduleContent:e.moduleContent,submoduleContents:e.submoduleContents,binaryAssetContents:e.binaryAssetContents,sourceRevision:e.sourceRevision,annotations:e.annotations,update:e.update};if(this.updateTreeNode(l.localId,n,c,r,o)){i.set(a,c);for(let p of s){let f=i.get(p.localId);$(f,p.localId,"is not in persistedModules"),this.updateTreeNodeWithOwnTreeVersion(p.localId,p),f.saveId=p.saveId,f.moduleURL=p.baseURL+p.files.module}}}),$(a,"Updated module",e,"is not found in the response"),{nextPersistedModules:A,updatedModuleLocalId:a}}setNextInternalState({dependenciesModule:A,persistedModules:e,transientSaves:t,depsGraph:r,didRemoteChange:o,multiplayerChange:n=!1}){this.dependenciesModule=A,this.persistedModules=e,this.transientSaves=t;let a=WB(A,this.lastSnapshot.dependenciesModule,e,t,r,this.lastSnapshot.modules,this.initialized,o,n),i=this.lastSnapshot.initialized;this.lastSnapshot={dependenciesModule:a.dependenciesModule,modules:a.modules,depsGraph:a.depsGraph,initialized:a.initialized},!(a.metadata.patches.length===0&&a.initialized===i)&&this.notifyListeners(a)}async createLocalModuleFromModule(A){X.debug("compiling server module:",A.localId);let e=A.sourceContent;e||(e=await this.fetchSourceContentFromData(A));let t={},r={},o=this.downloadQueue,n=new Array;for(let s of A.submodules)n.push(o.run(async()=>{let l=await fetch(A.baseURL+s);t[s]=await l.text()}));for(let s of A.binaryAssets)n.push(o.run(async()=>{let c=await(await fetch(A.baseURL+s)).arrayBuffer();r[s]=new Uint8Array(c)}));await Promise.all(n);let a=CA(A),i=await this.compile({localId:A.localId,name:a,source:e,type:A.type,includeSourceMap:nd(A.type)});for(let[s,l]of this.lazyServerModulesForTransientSaves)l.delete(a),l.size===0&&this.lazyServerModulesForTransientSaves.delete(s);return{...A,kind:"local",id:A.id,localId:A.localId,sourceContent:e,moduleContent:i.code,sourceMapContent:i.sourceMap,submoduleContents:t,binaryAssetContents:r,imports:i.imports,sourceRevision:sd(A),annotations:i.annotations}}async createBatchSaveForUpdatedModule(A,e,t,r,o,n){let a=CA(e),{localId:i,moduleContent:s,sourceContent:l,sourceMapContent:c,submoduleContents:u={},binaryAssetContents:p={},metadata:f,sourceRevision:E,imports:F,type:h,name:S,annotations:v,update:P,...T}=e;switch(A){case"$new":$(i===void 0,`Attempted to create ${a} but it already has localId: ${i}`);break;case"$upsertName":default:$(i!==void 0,`The transient save for the provided moduleId: ${A} doesn't have localId`)}let{type:N,name:Q,metadata:H,files:Z,...J}=n;$(N===h&&Q===S,`Mismatched type/name between save and parameters: ${N}/${Q} !== ${h}/${S}`);let AA=re(Q),jA=s;F.relative.length>0&&(jA=await this.replaceRelativeImportsWithAbsolute(a,s,F.relative,t,r,Uo(u),o)),c&&(jA+=`
//# sourceMappingURL=./${AA.sourceMap}`);let x=(Z??[]).concat([{name:AA.module,type:"module",content:jA},{name:AA.source,type:"source",content:l}]);c&&x.push({name:AA.sourceMap,type:"sourceMap",content:c});for(let[K,nA]of Object.entries(u))x.push({name:K,type:"submodule",content:nA});for(let[K,nA]of Object.entries(p))x.push({name:K,type:"binaryAsset",bytes:nA});let z={};if(f||H)if(i){let K=t.get(i);$(K||A==="$upsertName",`Cannot safely update metadata for ${A} (${i})`),z.metadata={...K?.metadata,...f,...H,sourceRevision:E}}else z.metadata={...f,...H,sourceRevision:E};return{...T,moduleId:A,type:N,name:Q,files:x,imports:F,...J,...z}}async createBatchSaveForDependentModule(A,e,t,r){let o=e.get(A);$(o,A,"is not found in persistedModules"),$(o.kind==="local","persisted module is not a local module");let n=CA(o),a=re(o.name),i=o.imports,s=o.moduleContent;i.relative.length>0&&(s=await this.replaceRelativeImportsWithAbsolute(n,o.moduleContent,i.relative,e,t,Uo(o.submoduleContents),r));let l=t.get(n);$(l,"newSaveIds don't contain saveId for",n);let c={},u=this.moduleUsesLocalImportMapSpecifiers(n);return o.metadata.localModuleImportMapEntries!==u&&(c.metadata={...o.metadata,localModuleImportMapEntries:u}),{type:o.type,moduleId:o.id,name:o.name,saveId:l,patchSaveId:o.saveId,files:[{name:a.module,type:"module",content:s}],imports:i,...c}}findPersistedModuleLocalIdByTypeSlashName(A,e){return this.ensurePersistedLocalIdsByTypeSlashNameCacheFor(A).get(e)}ensurePersistedLocalIdsByTypeSlashNameCacheFor(A){let e=this.persistedLocalIdsByTypeSlashNameCache.get(A);if(!e){e=new Map;for(let[t,r]of A.entries())e.set(CA(r),t);this.persistedLocalIdsByTypeSlashNameCache.set(A,e)}return e}async replaceRelativeImportsWithAbsolute(A,e,t,r,o,n,a){let{modulesCDN:i}=Me(),s={};for(let E of n){let F=Wa(E);s[F]=F}let l=this.moduleUsesLocalImportMapSpecifiers(A),c=new Set;for(let E of t){if(E in s)continue;let F=Se(E,A);if(!F)continue;let h=this.findPersistedModuleLocalIdByTypeSlashName(r,F);if(!h){c.add(F),X.error("Cannot resolve",E,"from",A);continue}let S=r.get(h);$(S);let{id:v,files:P}=S,T=o.get(F)??S.saveId,N=a?.get(F)?.module??P.module;$(_(N),"Must have a module file name to build a local module import map specifier."),s[E]=l?bi(h,N):`${i}/${v}/${T}/${N}`}let u=await qs(e,s);if(u.ok)return u.value;if(A.startsWith("codeFile"))return u.error.partiallyProcessedCode;let p=new Set,f=this.treeStore.tree;for(let E of u.error.unresolvedRelativeImports){let F=Se(E,A);if(!F)continue;let[h]=ya(F);if(!(h==="codeFile"||!f.getNodeWithTrait(F,Br))){p.add(F);break}}if(p.size===0)return X.reportError("Failed to rewrite relative imports due to unpersisted relative dependencies",{relativeImports:t,unresolved:Array.from(u.error.unresolvedRelativeImports)}),u.error.partiallyProcessedCode;if(X.reportError("Failed to rewrite relative imports",{typeSlashName:A,missing:Array.from(p)}),!OA.isOn("retryRelativeImportRewriting"))return u.error.partiallyProcessedCode;throw new oi(p)}async getDependenciesFiles({baseURL:A,files:e}){let[t,r]=await Promise.allSettled([fetch(A+e.importMap).then(a=>{if(a.ok!==!0)throw new Error("failed to load importMap file");return a.text()}),fetch(A+e.dependencies).then(a=>{if(a.ok!==!0)throw new Error("failed to load dependencies file");return a.text()})]);$(t.status==="fulfilled","The importMap has to exist on the module");let o=t.value,n;return r.status==="fulfilled"?n=r.value:X.warn("No dependencies file was found!"),{importMapContent:o,dependenciesMapContent:n}}async upsertKit(A,e,t){return Aj(async()=>{let r=JSON.stringify(A),o=[{name:"kit.json",type:"source",content:r},...e.map(l=>({name:`${l.id}.json`,type:"kitSection",content:JSON.stringify(l.content)}))],n=performance.now(),a="kit/kit",i={type:"kit",files:o,saveId:t,name:"kit",moduleId:this.persistedModules.get(a)?.id??"$upsertName",metadata:{title:A.title},imports:{absolute:[],relative:[],bare:[]}};$(this.modulesService);let{data:s}=await this.modulesService.saveBatch({batch:[i]});this.setNextInternalState({dependenciesModule:this.dependenciesModule,transientSaves:this.transientSaves,persistedModules:tj(this.persistedModules,l=>{for(let c of s.values()){if(c.localId!==a)continue;let u={kind:"local",...c,id:c.id,localId:c.localId,imports:c.imports,moduleURL:c.baseURL+c.files.source,sourceContent:r,sourceMapContent:void 0,moduleContent:r,submoduleContents:{},binaryAssetContents:{},sourceRevision:void 0,annotations:void 0,update:n};l.set(a,u)}}),depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!0})})}};function FG(j,A){return`${Me().modulesCDN}/${A.id}/${j.saveId}/${A.files.module}`}function WB(j,A,e,t,r,o,n,a,i){let s=new Set(o.keys()),l=new Set(t.keys()),c=[],[u,p]=Xa(o,F=>{for(let h of e.values()){let S=h.localId,v=CA(h),P=t.get(S),T=P?.type??h.type;if(!lk(T))continue;let N;if(P)N={kind:"local",localId:S,type:P.type,name:P.name,moduleURL:FG(P,h),moduleContent:P.moduleContent,sourceContent:P.sourceContent,sourceMapContent:P.sourceMapContent,submoduleContents:P.submoduleContents,binaryAssetContents:P.binaryAssetContents,relativeImports:P.imports.relative,files:h.files,sourceRevision:P.sourceRevision,kitSectionsStructure:P.kitSectionsStructure,svgIcon:P.svgIcon,update:P.update};else{let Q=sd(h);N=h.kind==="local"?{kind:"local",localId:S,type:h.type,name:h.name,moduleURL:h.moduleURL,moduleContent:h.moduleContent,sourceContent:h.sourceContent,sourceMapContent:h.sourceMapContent,submoduleContents:h.submoduleContents,binaryAssetContents:h.binaryAssetContents,relativeImports:h.imports.relative,files:h.files,sourceRevision:Q,svgIcon:void 0,kitSectionsStructure:void 0,update:h.update}:{kind:"server",localId:S,type:h.type,name:h.name,moduleURL:h.moduleURL,sourceContent:h.sourceContent,relativeImports:h.imports.relative,files:h.files,sourceRevision:Q,update:h.update}}zB(F,v,N),l.delete(S),s.delete(v)}for(let h of l){let S=t.get(h);if($(S),!S.localId)continue;let v=re(S.name),P={kind:"local",localId:S.localId,type:S.type,name:S.name,moduleURL:`./transient/${S.saveId}/${v.module}`,moduleContent:S.moduleContent,sourceContent:S.sourceContent,sourceMapContent:S.sourceMapContent,submoduleContents:S.submoduleContents,binaryAssetContents:S.binaryAssetContents,relativeImports:S.imports.relative,files:v,sourceRevision:S.sourceRevision,svgIcon:S.svgIcon,kitSectionsStructure:S.kitSectionsStructure,update:S.update};zB(F,h,P),s.delete(CA(P))}for(let h of s)F.delete(h),c.push(h)}),f={};for(let F of c){let h=o.get(F);h&&(f[F]=h.localId)}let E=tj(A,F=>{if(j){if(!F)return{kind:"dependencies",localId:We,type:j.type,name:j.name,importMapContent:j.importMapContent,dependenciesMapContent:j.dependenciesMapContent};F.importMapContent=j.importMapContent,F.dependenciesMapContent=j.dependenciesMapContent}});return E&&E!==A&&p.push({op:A?"replace":"add",path:[CA(E)],value:E}),{dependenciesModule:E,modules:u,deletedLocalIdsByTypeSlashNames:f,depsGraph:r,initialized:n,metadata:{patches:p,hasLocalChanges:t.size>0,didRemoteChange:a,multiplayerChange:i}}}function zB(j,A,e){let t=j.get(A);if(!t){j.set(A,e);return}if(t.kind!==e.kind){j.set(A,e);return}if(t.kind==="server"){$(e.kind==="server"),XB(t,e);return}$(e.kind==="local"),GG(t.relativeImports,e.relativeImports)||(t.relativeImports=e.relativeImports),O7(t.files,e.files)||(t.files=e.files);let{relativeImports:r,files:o,...n}=e;XB(t,n)}function XB(j,A){Object.assign(j,A)}function GG(j,A){if(!j&&!A)return!0;if(j&&A){let e=j.length;if(e!==A.length)return!1;for(let t=0;t<e;t++)if(j[t]!==A[t])return!1;return!0}else return!1}function SG(j){return j.type==="save"}function yG(j){return j.type==="delete"}function xr(){return Yn()}function nd(j){return j==="codeFile"||j==="canvasComponent"}function YB(j,A,e){return j.replace(new RegExp(`\\b(from\\s*)(["'])${rd(A)}\\2`,"g"),`$1${JSON.stringify(e)}`)}function CG(j,A){switch(j){case"canvasComponent":case"layoutTemplate":case"screen":case"prototype":case"collection":case"draftCollection":case"webPageMetadata":case"siteMetadata":case"vector":case"vectorSet":case"kit":return A.default;case"codeFile":case"css":case"componentPresets":case"config":case"localization":case"design":return Object.values(A)[0];default:iA(j)}}function ZB(j,A){if(!j||j.length===0)return A?.placeholder??"";if(j.length===1)return j[0]&&j[0]!==""?j[0]:A?.placeholder??"";let e=[...j],t="";if(A?.max&&A.max<j.length){let r=j.length-A.max;e=e.slice(0,A.max),t=`${r} ${r>1?"others":"other"}`}else t=e.pop()??"";return e.length>1?`${e.join(", ")}, and ${t}`:`${e.join(", ")} and ${t}`}var HU=Ue("componentPresets","componentPresets");function A0(j,A){let e=j.getPresetsListNode();return e?e.getComponentPresets().find(t=>t.componentIdentifier===A)??null:null}function j0(j,A){let{treeStore:e}=j.stores;if(e.tree.has(A.id))return;let t=A0(e.tree,A.componentIdentifier),r=Ir(e.tree),o=pm(r.children,a=>Xr(a)&&a.componentIdentifier!==A.componentIdentifier);o!==-1&&(o+=1),e.tree.insertNode(A,r.id,o),go(j)&&j.stores.codeGenerationStore.createModuleFromComponentSource(r).catch(yA),$e(A.componentIdentifier)&&j.stores.modulesStore.addExternalModulesToProject([A.componentIdentifier],{onTreeUpdate(){}});let n=ln(A.componentIdentifier);t||j.scheduler.runWithFullyLoadedTree(()=>{let a=e.getLoadedIndexes();for(let i of a.richTextNodes)i.htmlContent&&UA(e.tree,i,n)&&i.setComponentPreset(A.componentIdentifier,A.id)},{runInBackground:!0,name:"insertComponentPreset"})}function bG(j,A){if(A0(j.tree,A.componentIdentifier))return;let t=Fl.createDefault(A);j0(j,t)}function QU(j,A,e){j.scheduler.processWhenReady(()=>{let r=Ir(j.tree).getComponentPresets(),o=new Set;for(let a of r)a.name&&o.add(a.name);let n=Fl.createDefault(A,{name:Cj(A.name,o)});j0(j,n);try{e&&e(n)}catch{}})}function UU(j,A){return j.getPresetsListNode()?.getComponentPresets().filter(t=>t.componentIdentifier===A)??[]}function e0(j,A,e){let t=oA(A);function r(n){let a=oA(n);return a.kind==="externalModuleExport"&&t.kind==="externalModuleExport"&&a.moduleId===t.moduleId&&a.exportSpecifier===t.exportSpecifier}let o=j.getPresetsListNode();if(o){let n=o.getComponentPresets();for(let a of n)r(a.componentIdentifier)&&a.set({componentIdentifier:e})}$(!j.getService("loader"),"Tree should be fully loaded");for(let n of j.root.walk()){if(!QA(n))continue;let a=n.getComponentPresets();for(let[i,s]of a){let l=ln(i);r(i)&&UA(j,n,l)&&(n.setComponentPreset(e,s),n.setComponentPreset(i,void 0))}}}function WU(j,A,e){let t=A.find(r=>r.componentIdentifier===e);t&&bG(j,t)}function ii(j){let A=oA(j);if(!(!A||!Rj(A)||!$e(A)))return`${A.moduleId}:${A.exportSpecifier}`}function t0(j){let A=new Map;for(let e of j){let t=ii(e);t&&A.set(t,e)}return A}function r0(j,A){let e=j.getRawControlProps();for(let t in e){let r=e[t]?.type,o=e[t]?.value;if(r!=="vectorsetitem"||!_(o)||!Rj(o))continue;let n=ii(o);if(!n||!A.has(n))continue;let a=A.get(n);a&&j.setControlProp(t,{type:"vectorsetitem",value:a})}}function o0(j,A){for(let e of A){r0(e,j);let t=ii(e.codeComponentIdentifier);if(!t||!j.has(t))continue;let r=j.get(t);r&&e.set({codeComponentIdentifier:r})}}function n0(j,A){let e=A.getContentManagementNode();if(e){$(e.isLoaded(),"CMS Should always be loaded.");for(let{node:t,skipChildren:r}of e.walkWithSkipChildren()){if(uj(t)){if(!t.variables.some(a=>a.type==="vectorsetitem")){r();continue}i0(t,j)}if(!ue(t))continue;let o=t.getControlProps();for(let n in o){let a=o[n]?.value;if(o[n]?.type!=="vectorsetitem"||!_(a)||!Rj(a))continue;let s=ii(a);if(!s||!j.has(s))continue;let l=j.get(s);l&&t.setControlProp(n,{...o[n],value:l})}}}}function i0(j,A){let e=!1,t=j.variables.map(r=>{if(r.type!=="vectorsetitem")return r;let{initialValue:o}=r,n=o.identifier;if(!n)return r;let a=ii(n);if(!a||!A.has(a))return r;let i=A.get(a);return i?(e=!0,{...r,initialValue:{...o,identifier:i}}):r});e&&j.set({variables:t})}function a0(j,A){for(let e of A.root.children){if(w(e)){r0(e,j);continue}(eA(e)||ZA(e))&&i0(e,j)}}var bj=gA("modules-store"),s0=new Set(["codeFile","canvasComponent","screen","layoutTemplate","vector"]),vG=500;function ld(j){let{module:A,exportSpecifier:e}=j,{id:t,saveId:r,files:o}=A;return $(o.module,"module file must exist for a saved module"),le(t,r,o.module,e)}var No,ai,si,Ht,l0=class extends me{constructor(e,t,r,o,n,a,i,s){super();this.scheduler=e;this.treeStore=t;this.loadedExternalModulesStore=r;this.chromeStore=o;this.modulesAPIServicePromise=n;this.makeDocumentReadOnly=a;this.insertTemporaryImportMap=i;this.loadAllLocalModules=s;I(this,"dependenciesModule");I(this,"localModules",new Map);I(this,"fastRefreshModules",new Map);I(this,"externalModulesDynamicInfo",new Map);I(this,"revision",0);NA(this,No,new Map);I(this,"moduleDepsGraph",{});I(this,"modulesStorage");I(this,"moduleUpdatesEmitter",new ze);I(this,"fastRefreshModulesEmitter",new ze);NA(this,ai);NA(this,si,new Map);NA(this,Ht,new Map);I(this,"debugModuleStoreAndComponentLoaderRevisionsMatch",()=>this.revision===L.modulesRevision);I(this,"checkForExternalModuleUpdates",async()=>{if(this.treeStore.tree.isViewOnly)return;let e=this.treeStore.tree.getExternalModulesListNode();if(!e||!e.children?.length)return;let t=[],r=new Map;e.children.forEach(i=>{let s=oA(i.codeComponentIdentifier);if($(s?.kind==="externalModuleExport","expected ExternalModuleNode identifier to be of kind externalModuleExport"),i.type==="vector"){let l=i.annotation("framerVector");if(!Fa(l))return;let c=l.set.moduleId,u=r.get(c)??[];u.push(s),r.set(c,u)}else t.push(s)});for(let[i,s]of r){let l=this.treeStore.tree.get(i);if(!At(l))continue;let c=l.annotation("framerVectorSet");cl(c)&&(Qp(c)||t.push(...s))}let o=t.map(({moduleId:i,saveId:s})=>({moduleId:i,saveId:s}));if(!o.length)return;let n=[],a=[];for(let i=0;i<o.length;i++){let s=o[i];if($(s,"query is expected to be defined."),n.push(s),n.length<vG&&i<o.length-1)continue;let{modules:l}=await this.lookUpModules(n,{includeStatus:!0});a.push(...l),n=[]}this.treeStore.tree.isViewOnly||this.updateExternalModuleNodes(a.map((i,s)=>{let l=t[s];return $(l,"External module missing a matching identifier"),{module:i,exportSpecifier:l.exportSpecifier}}),{onTreeUpdate(){}}).catch(yA)});I(this,"updatesPollId");I(this,"compileFastRefreshModule",async({localId:e,name:t,source:r,includeSourceMap:o=!0})=>{let{type:n,name:a}=Ci(e);if(!s0.has(n))return;let i=n==="codeFile"?re(t).source:a,{code:s,imports:l,sourceMap:c}=await oB({localId:e,source:r,name:i,includeSourceMap:o}),u={kind:"fast-refresh",localId:e,type:n,name:i,sourceContent:r,moduleContent:s,relativeImports:l.relative,sourceMapContent:c,binaryAssetContents:void 0,submoduleContents:{},update:0},[p,f]=Xa(this.fastRefreshModules,E=>{E.set(t,u)});this.fastRefreshModules=p,this.fastRefreshModulesEmitter.emit({patches:f,dependentModules:[],prioritizedModules:[],revision:++this.revision,initialized:!0})});I(this,"compile",({localId:e,name:t,source:r,includeSourceMap:o=!0,type:n,telemetrySession:a})=>{let i=nB({name:t,source:r,includeSourceMap:o,type:n,telemetrySession:a});return this.fastRefreshEnabled&&e&&this.compileFastRefreshModule({localId:e,name:t,source:r,includeSourceMap:o}).catch(yA),i});this.modulesStorage=new Hs(()=>this.modulesAPIServicePromise.catch(l=>{throw bj.error(l,{context:"Failed to discover ModulesAPI service:"}),l}),this.compile,this.scheduler.process.bind(this.scheduler),this.scheduler.processWhenReady.bind(this.scheduler),this.scheduler.runWhenIdle.bind(this.scheduler),t,()=>this.getActiveScope(),()=>this.makeDocumentReadOnly()),this.fastRefreshModulesEmitter.onNewStream=l=>(bj.debug("onNewStream - fast refresh",l),{latest:this.getAllModulesAsUpdateEvent(!0)}),this.moduleUpdatesEmitter.onNewStream=l=>(bj.debug("onNewStream - module updates",l),{latest:this.getAllModulesAsUpdateEvent(!1)}),this.modulesStorage.subscribe(l=>{let c=l.dependenciesModule?.importMapContent,u=this.dependenciesModule?.importMapContent,p=!1,f=!1,E=!1,F=!1;if(c&&u&&c!==u){let Z=JSON.parse(c),J=u?JSON.parse(u):void 0;for(let[AA,jA]of Object.entries(Z.imports??{})){rA(this,No).set(AA,"success");let x=J?.imports?.[AA];if(!x){p=!0;continue}x!==jA&&(f=!0)}E=!f&&!p,F=l.metadata.multiplayerChange||f||E}F&&l.metadata.multiplayerChange,this.dependenciesModule=l.dependenciesModule,this.localModules=l.modules;let h=this.moduleDepsGraph;this.moduleDepsGraph=l.depsGraph;let S=l.metadata.patches,v=new Set,P=[],T=[],N;for(let Z of S){let J=Z.path[0];if($(typeof J=="string"),J===We){N=Z;for(let AA of l.modules.keys())v.add(AA);break}Z.op==="remove"&&Z.path.length===1?T.push(J):P.push(J)}let Q=new Set;if(!N){let Z=this.getActiveScope(),J=ri(Z);bj.debug("Calculated visible code component module typeSlashNames",J);for(let AA of P)Nr(l.depsGraph,AA,v,J,Q);for(let AA of T)Nr(h,AA,v,J,Q);P.forEach(AA=>{v.delete(AA)}),T.forEach(AA=>{v.delete(AA),Q.delete(AA)})}bj.debug("prioritized evaluation sending to sandbox",{dependentModules:v,visibleDependentModules:Q},"highprio size",Q.size,"dep size",v.size);let H={patches:S,dependentModules:Array.from(v),prioritizedModules:Array.from(Q),revision:++this.revision,initialized:l.initialized};this.moduleUpdatesEmitter.emit(H),this.fastRefreshEnabled&&N&&this.fastRefreshModulesEmitter.emit({patches:[N],dependentModules:[],prioritizedModules:[],revision:H.revision,initialized:l.initialized})})}getActiveScope(){if(this.chromeStore.mainView===5)return;let e=this.treeStore.tree.getNode(rA(this,ai));if(e)return $(e?.loaded,"Active scope node should be loaded"),e.loaded}setActiveScope(e){FA(this,ai,e)}getLatestDependencyGraph(){return this.moduleDepsGraph}initialize(){return this.initialized?this.modulesStorage.refresh():(this.setupPollingExternalModulesUpdates(),this.modulesStorage.initialize())}get initialized(){return this.modulesStorage.initialized}whenInitialized(){return this.modulesStorage.whenInitialized()}whenIdle(){return this.modulesStorage.whenIdle()}refresh(){return this.modulesStorage.refresh()}deleteModules(e){return this.modulesStorage.delete(e)}upsertBatch(e){return this.modulesStorage.upsertBatch(e)}forType(e){return new Js(this.modulesStorage,e,this.debugModuleStoreAndComponentLoaderRevisionsMatch)}getNpmDependencyInstallStatus(e){return rA(this,No).get(Rn(e))??"unknown"}async addNpmDependencies(e){let r=typeof this.dependenciesModule>"u"&&!Z$(),o=await qB(this.modulesStorage.addNpmDependencies(e)),n=Array.isArray(e)?e:[e],a=n.filter(({target:l})=>!In(l));for(let l of a)rA(this,No).set(Rn(l),o.ok?"success":"failure");if(!o.ok)throw o.error;r&&AB();let i=Object.keys(o.value.dependenciesMap.dependencies),s=n.map(({target:l})=>l).filter(l=>!i.includes(l)&&In(l));if(s.length>0){let l=ZB(s,{max:5,placeholder:"package"});TA({type:"add",variant:"warning",text:`${l} ${s.length===1?"is":"are"} incompatible with Framer`,duration:5e3})}return o.value}changeScope(e){this.setActiveScope(e.id),this.modulesStorage.changeScope(e)}async reinstallNpmDependencies(){return{importMap:await this.modulesStorage.reinstallNpmDependencies()}}async uninstallBlockedNpmDependencies(){return{importMap:await this.modulesStorage.uninstallBlockedNpmDependencies()}}async unsafeUpgradeDependency(e,t,r){return{importMap:await this.modulesStorage.unsafeUpgradeDependency(e,t,r)}}async clearNpmDependencies(){return this.modulesStorage.clearNpmDependencies()}async removeBlockedNpmDependencies(){return{dependenciesMap:await this.modulesStorage.removeBlockedNpmDependencies()}}async rebuildImportMapFromDependencies(){return{importMap:await this.modulesStorage.rebuildImportMapFromDependencies()}}async updateSources(e){return this.modulesStorage.updateSources(e)}async updateKit(...e){return this.modulesStorage.upsertKit(...e)}async updateDependenciesSource(e,t){await this.modulesStorage.updateDependenciesSource(e,t)}getDependentsOfModule(e){return this.modulesStorage.getDependentsOfModule(e)}subscribeToModulesStorage(e){return this.modulesStorage.subscribe(e)}async getModuleDependencies(e){let t=await this.modulesAPIServicePromise;return $(t,"Modules API service not initialized correctly"),await t.getModuleDependencies(e)}getModuleEntryByLocalId(e){for(let t of this.localModules.values())if(t.localId===e)return t}getModuleEntryByUniqueName(e){for(let t of this.localModules.values())if(t.name===e)return t}getPersistedDependenciesModule(){return this.modulesStorage.getPersistedDependenciesModule()}getPersistedModuleByGlobalId(e){return this.modulesStorage.getPersistedModuleByGlobalId(e)}getPersistedModuleByLocalId(e){return this.modulesStorage.getPersistedModuleByLocalId(e)}getPersistedModuleByLocalIdentifier(e){let t=oA(e);if(YA(t))return this.getPersistedModuleByLocalId(t.localId)}tryConvertExternalCodeComponentIdentifierToLocal(e){let t=oA(e);if(t?.kind!=="externalModuleExport")return;let r=this.getPersistedModuleByGlobalId(t.moduleId);if(r)return yi(r.localId,t.exportSpecifier).value}async listNamespaces(){let e=await this.modulesAPIServicePromise;return $(e,"Modules API service not initialized correctly"),await e.listNamespaces()}async lookUpModule(e,t){let{modules:r,dependencies:o}=await this.lookUpModules([e],t),n=r[0];$(n,"Module does not exist, looking up:",e);let a={module:n};return o&&(a.dependencies=o[n.ownerType]?.[n.ownerId]),a}async lookUpModules(e,t){let r=await this.modulesAPIServicePromise;if(!r)return bj.error("Modules API service not initialized correctly"),{modules:[],dependencies:{}};let{data:o,dependencies:n}=await r.lookUpModules({queries:e,...t}),a=new Map(this.externalModulesDynamicInfo);for(let s of o){let l=s.id,{localId:c,title:u,description:p,lastPublish:f,status:E}=s;a.set(l,{localId:c,title:u,description:p,lastPublish:f,status:E??a.get(l)?.status})}this.externalModulesDynamicInfo=a;let i={modules:o};return n&&(i.dependencies=n),i}trackExternalComponentInsert(e,t){let r=vt();for(let o of e)gf({insertId:r,insertType:t,codeComponentId:o})}async installExternalModulesDependencies(e){let t=[],r=[];for(let o of e){let n=rA(this,si).get(o);n?r.push(n):t.push(o)}if(t.length>0){let o=this.installDependenciesForModuleURLs(t);for(let n of t)rA(this,si).set(n,o);r.push(o)}return Promise.allSettled(r).then(o=>{for(let n of o)n.status!=="fulfilled"&&bj.error("Failed to install external module",n.reason)})}isProcessingModules(){return this.modulesStorage.isProcessing()}hasLocalCodeFileChanges(){return this.modulesStorage.hasLocalCodeFileChanges()}resetModuleStateAndPermissions(e){this.modulesStorage.resetModuleStateAndPermissions(e)}getTransientSave(e){return this.modulesStorage.getTransientSave(e)}startUsingLocalModulesInTree(){return this.modulesStorage.startUsingLocalModulesInTree()}stopUsingLocalModulesInTree(){return this.modulesStorage.stopUsingLocalModulesInTree()}usingLocalModulesInTree(){return this.modulesStorage.usingLocalModulesInTree()}createFastRefreshModuleFromModule(e){if(s0.has(e.type)){if(e.kind==="server"){let t=this.getPersistedModuleByLocalId(e.localId);$(t?.kind==="server","Only server modules should have no sourceContent"),this.modulesStorage.createLocalModuleFromModule(t).catch(yA);return}this.compileFastRefreshModule({name:CA(e),localId:e.localId,source:e.sourceContent}).catch(yA)}}getModuleWithTypeSlashName(e){return this.modulesStorage.getModuleWithTypeSlashName(e)}waitForModulesToSave(){return this.modulesStorage.waitForModulesToSave()}installDependenciesForModuleURLs(e){return bj.info(`\u{1F986} Installing external modules:
	`,e.join(`
	`)),this.lookUpModules(e.map(t=>({url:t})),{includeDependencies:!0}).then(async({dependencies:t={}})=>{let r=Object.values(t).flatMap(a=>Object.values(a)),o,n;for(let{dependencies:a,importMap:i}of r)if(i){o=co(o??{imports:{}},i);let s=a??po(i);n=uo(n??{dependencies:{}},s)}o&&n&&await this.modulesStorage.extendCurrentImportMap(o,n)})}async addOrUpdateExternalVectors(e){await this.modulesStorage.whenInitialized();let{modules:t}=await this.lookUpModules(e.filter(n=>{let a=this.treeStore.tree.getNodeWithTrait(n.moduleId,At);return a?oA(a.codeComponentIdentifier).saveId!==n.saveId:!0}),{includeDependencies:!1,includeStatus:!0}),r=new Map,o="default";for(let n of t){let a=ld({module:n,exportSpecifier:o}),i=this.treeStore.tree.getNodeWithTrait(n.id,At);Rj(i?.codeComponentIdentifier)&&oA(i.codeComponentIdentifier).saveId===n.saveId||r.set(a.value,{module:n,exportSpecifier:o})}await Promise.all(Array.from(r.keys(),n=>{let a=oA(n);return $(a,"Identifier must be a valid module identifier"),this.loadedExternalModulesStore.ensureModuleEvaluatedInSandbox(a).catch(i=>{bj.error(`Failed to evaluate external module "${n}"`,i)})})),await new Promise((n,a)=>{this.scheduler.runWithFullyLoadedTree(()=>{this.updateExternalModuleNodes(Array.from(r.values()),{onTreeUpdate:()=>{let i=t0(r.keys());o0(i,this.treeStore.getLoadedIndexes().codeComponents),n0(i,this.treeStore.tree),a0(i,this.treeStore.tree)},updateSave:!0}).then(n).catch(a)},{name:"update_external_module_version",runInBackground:!0})})}async addOrUpdateVectorSetAndVectors(e){await this.addOrUpdateExternalVectors([e]);let r=this.treeStore.tree.getNodeWithTrait(e.moduleId,At)?.annotation("framerVectorSet");cl(r)&&await this.addOrUpdateExternalVectors(r.items.map(o=>({moduleId:o.moduleId,saveId:o.saveId??""})))}async addExternalModulesToProject(e,t){let r=e.map(n=>typeof n=="string"?oA(n):n),o=await this.preloadExternalModules(r);return this.updateExternalModuleNodes(o,t)}async preloadExternalModules(e){await this.modulesStorage.whenInitialized();let t=new Map;for(let s of e)t.set(s.bareValue,s);let r=[],o=[],n=[];for(let[s,l]of t){let{moduleId:c,saveId:u}=l;if(!!this.modulesStorage.getPersistedModuleByGlobalId(c)){bj.reportError("Attempted to treat local module as external module",{identifier:l});continue}let f=this.treeStore.tree.getNode(c);if(f&&oA(f.codeComponentIdentifier).saveId===u&&!this.loadedExternalModulesStore.hasModuleForIdentifier(l)){o.push(l);continue}let E=rA(this,Ht).get(s);if(E){n.push({identifier:l,preloadPromise:E});continue}rA(this,Ht).set(s,tr()),r.push(l)}let a=new Map;for(let{identifier:s,preloadPromise:l}of n)try{let c=await l;a.set(s.value,c)}catch{rA(this,Ht).set(s.bareValue,tr()),r.push(s)}if(r.length)try{let s=Array.from(r.values(),({moduleId:p,saveId:f})=>({moduleId:p,saveId:f})),{modules:l,dependencies:c}=await this.lookUpModules(s,{includeDependencies:!0,includeStatus:!0}),u=0;for(let p of r){let f=l[u++];$(f,"Module must be defined"),a.set(p.value,{module:f,dependencies:c?.[f.ownerType]?.[f.ownerId],exportSpecifier:p.exportSpecifier}),o.push(p)}}catch(s){bj.reportError(s);for(let l of r)rA(this,Ht).get(l.bareValue)?.reject(s);throw Error(`Failed to preload modules: ${s}`)}let i;for(let s of o){let l=a.get(s.value);if(!l)continue;let{dependencies:c}=l;c?.importMap&&(i=co(i??{imports:{}},c.importMap))}i&&await this.insertTemporaryImportMap(i),await Promise.all(Array.from(o.values(),s=>this.loadedExternalModulesStore.ensureModuleEvaluatedInSandbox(s).catch(l=>{bj.error(`Failed to evaluate external module "${s.value}"`,l)})));for(let s of r){let l=a.get(s.value);$(l,"Expected to have module information for:",s.value);let c=rA(this,Ht).get(s.bareValue);$(c,"Expected to find a preload promise for:",s.bareValue),c.resolve(l)}return[...a.values()]}async updateExternalModuleNodes(e,{onTreeUpdate:t,updateSave:r=!1}){let o,n;for(let{dependencies:a}of e)if(a?.importMap){o=co(o??{imports:{}},a.importMap);let i=a.dependencies??po(a?.importMap);n=uo(n??{dependencies:{}},i)}return o&&!tk(o)&&n&&await this.modulesStorage.extendCurrentImportMap(o,n),await Promise.all(e.map(a=>this.loadedExternalModulesStore.ensureModuleEvaluatedInSandbox(ld(a)))),this.scheduler.processWhenReadyAsync(()=>{if(this.treeStore.tree.isViewOnly)throw Error("unable to edit");for(let a of e){let{id:i,type:s,metadata:l,ownerId:c,ownerType:u}=a.module,p=ld(a),{title:f,status:E}=this.externalModulesDynamicInfo.get(p.moduleId)??a.module,F=this.treeStore.tree.getExternalModulesListNode();F||(F=new qk,this.treeStore.tree.insertNode(F,this.treeStore.tree.root.id)),$(tu(F));let h=l.pluginId,S={codeComponentIdentifier:p.value,type:s,scopeNodeId:sk(a.module),intrinsicWidth:at(l.intrinsicWidth)??200,intrinsicHeight:at(l.intrinsicHeight)??200,ownerId:c,ownerType:u,group:E?.group,updateSaveId:E?.updateSaveId,namespaceId:a.module.lastPublish?.namespaceId,pluginId:_(h)?h:void 0},v=L.componentForIdentifier(p.value);$(v,"Component not found in the component loader",p.value);let P=v.annotations??void 0;S.annotations=Vk(s)?ko({default:P}).default:P;let T=v.name??f;S.title=T;let N=this.treeStore.tree.getNode(i);if(N)if(r)N.set(S);else{let{group:Q,updateSaveId:H}=S;N.set({group:Q,updateSaveId:H})}else N=new Kk({id:i,...S}),this.treeStore.tree.insertNode(N,F.id)}return t()})}setupPollingExternalModulesUpdates(){let e=of(()=>{this.checkForExternalModuleUpdates().catch(bj.reportError)},1e4),t=()=>{e(),this.updatesPollId===void 0&&(this.updatesPollId=window.setInterval(this.checkForExternalModuleUpdates,6e4))},r=()=>{window.clearInterval(this.updatesPollId),this.updatesPollId=void 0};function o(){return!document.hidden&&navigator.onLine}o()&&t();function n(){setTimeout(()=>{o()?t():r()},500)}document.addEventListener("visibilitychange",n),window.addEventListener("offline",n),window.addEventListener("online",n)}getCodeComponentNodesForExternalModuleExport(e){return this.treeStore.getLoadedIndexes().codeComponents.filter(t=>{if(!W(t)||hA(t)&&!t.isVectorInstance)return!1;let r=oA(t.codeComponentIdentifier);return r?.kind!=="externalModuleExport"?!1:r.moduleId===e.moduleId&&r.exportSpecifier===e.exportSpecifier})}get fastRefreshEnabled(){return this.chromeStore.codeEditorPreviewVisible}async updateExternalModuleComponentInstances(e){let t=oA(e);$(t?.kind==="externalModuleExport","parsed 'ExternalModuleNodes.id' should be of kind externalModuleExport");let{moduleId:r,exportSpecifier:o}=t,n=this.externalModulesDynamicInfo.get(r)?.status?.updateSaveId;if(!n){bj.warn("Could not update module",r,"latest status missing");return}let{module:a,dependencies:i}=await this.lookUpModule({moduleId:r,saveId:n},{includeDependencies:!0,includeStatus:!0});$(a.files.module,"Module file must be defined");let s=le(r,n,a.files.module,o);try{await this.loadedExternalModulesStore.ensureModuleEvaluatedInSandbox(s).catch(bj.reportError),await new Promise((l,c)=>{this.scheduler.runWithFullyLoadedTree(()=>{this.updateExternalModuleNodes([{module:a,dependencies:i,exportSpecifier:o}],{onTreeUpdate:()=>{this.getCodeComponentNodesForExternalModuleExport(t).forEach(p=>p.set({codeComponentIdentifier:s.value})),Wm(this.treeStore.tree,t.value,s.value),e0(this.treeStore.tree,t.value,s.value)},updateSave:!0}).then(l).catch(c)},{name:"update_external_module_version",modalTitle:"Updating the module version"})}),this.trackExternalComponentInsert([s.value],"update")}catch(l){bj.reportError(l)}}async replaceRelativeImportsWithImportMapSpecifiers(e,t,r){let o={};for(let a of r){let i=Se(a,e);if(!i)continue;let s;if(s=this.fastRefreshModules.get(i),s||(s=this.modulesStorage.getModuleWithTypeSlashName(i)),!s){bj.error("Cannot resolve",a,"from",e);continue}let l,{name:c,localId:u}=s;if(s.kind==="fast-refresh")l=re(c).module;else{let{files:p}=s;$(_(p.module),"Must have a module file name to build a local module import map specifier."),l=p.module}o[a]=bi(u,l)}let n=await qs(t,o);return $(n.ok),n.value}getModules(e=!1){let t={};for(let[r,o]of this.localModules)t[r]=o;if(e)for(let[r,o]of this.fastRefreshModules)t[r]=o;return{dependenciesModule:this.dependenciesModule,modules:t,revision:this.revision,initialized:this.modulesStorage.initialized}}getAllModulesAsUpdateEvent(e=!1){let{dependenciesModule:t,modules:r,initialized:o,revision:n}=this.getModules(e),a=[];t&&a.push({op:"add",path:[`${t.type}/${t.name}`],value:t});for(let i of Object.values(r))a.push({op:"add",path:[`${i.type}/${i.name}`],value:i});return{patches:a,dependentModules:[],prioritizedModules:[],initialized:o,revision:n}}getModulesUpdatesService(e=!1){return{moduleUpdatesStream:()=>e?this.fastRefreshModulesEmitter.newStream({replay:"latest"}):this.moduleUpdatesEmitter.newStream({replay:"latest"})}}hasScreenModuleLoaded(e){let t=er("screen",e,"default").value;return L.componentForIdentifier(t)!==null}postProcess(){this.modulesStorage.processTreeUpdates()}};No=new WeakMap,ai=new WeakMap,si=new WeakMap,Ht=new WeakMap;var PG={defaultComponent:{insert:"insert-default",drag:"insert-default-drag"},libraryModule:{insert:"insert-library",drag:"insert-library-drag"},externalModuleComponent:{insert:"insert",drag:"insert-drag"}},cd="default_component_",Qs="external_",dd="local_",c0="legacy_design_component",d0="legacy_code_component",u0=`${dd}${d0}`,MG=`${Qs}${d0}`,p0=`${dd}${c0}`,k0=`${Qs}${c0}`;var _G=new Set(["form","frame","image-frame","stack","repeater"]),DG=j=>j.startsWith(cd),m0=j=>j===p0||j===k0,NG=j=>_G.has(j);function f0({canvasNode:j,source:A,isDrag:e,engine:t}){let r=xG(j,t);switch(mA("component_instance",{componentType:r.type,source:A}),A){case"insert_menu":{let o=OG(r);mA("insert_menu_add",{type_added:o});break}}if(r.type==="local_module_canvasComponent_component"&&mA("component_canvas_instance",{componentId:j.id}),m0(r.type)&&mA("component_design_instance",{}),W(j)&&$e(j.codeComponentIdentifier)){let o=r.type.startsWith(cd)?"defaultComponent":A==="team_library"?"libraryModule":"externalModuleComponent",n=PG[o][e?"drag":"insert"];t.stores.modulesStore.trackExternalComponentInsert([j.codeComponentIdentifier],n)}}function xG(j,A){if(W(j)){let r=j.codeComponentIdentifier,o=oA(r);if(!o)return{type:j.codeComponentIdentifier.startsWith(".")?u0:MG,codeComponentIdentifier:r};if(YA(o))return{type:`${dd}module_${o.type}_component`,codeComponentIdentifier:r};if($e(o)){let n=A.tree.getNode(o.moduleId);return za(A,r)?{type:`${cd}${n?.title}`,codeComponentIdentifier:r}:{type:`${Qs}module_${n?.type??"unknown"}_component`,codeComponentIdentifier:r}}}let t=j.replicaInfo?.master&&A.tree.getNode(j.replicaInfo.master)||j;return Uj(t)?Ho(t)?{type:k0}:{type:p0}:Ki(j)?{type:"repeater"}:to(j)?{type:"form"}:JA(j)?{type:"stack"}:pA(j)?j.fillType==="image"?{type:"image-frame"}:{type:"frame"}:{type:"unknown"}}function OG({type:j}){return j.startsWith("local_module_")||j===u0?"code_component":m0(j)?"design_component":j.startsWith(Qs)?"package":DG(j)||NG(j)?j:"unknown"}function ud(j,A){let e=j.children;return he(j)?!e||e.length===0?[]:A.getChildrenRects(j.id)??[]:null}function UW(j,A,e){if(!j||!vA(j))return;let t=[];for(let r=0,o=j.children.length+1;r<o;r++){let n=j.children[r];if(!Le(n,j))continue;let a=ud(j,e);if(!a||a.length===0)return;let i=a.splice(r,A.length),s=q.merge(...i);t.push(s)}return t}function E0(j,A,e){if(j>=A&&j<=e||j<=A&&j>=e)return 0;let t=Math.abs(A-j),r=Math.abs(e-j);return Math.min(t,r)}function wG(j,A,e){let t=j?"y":"x",r=j?"height":"width",o=A[t],n=0,a=1/0;return e.forEach((i,s)=>{if(a===0)return;let l=i[t],c=l+i[r],u=E0(o,l,c);u<a&&(n=s,a=u)}),n}function LG(j,A,e,t){let r=Math.max(j,e),o=Math.min(A,t);return r<o}function qG(j,A,e){let t=j?"y":"x",r=j?"height":"width",o=e[A];$(o,"Out of bound access to childRects:",A,e);let n=o[t],a=n+o[r],i=new Set([A]);return e.forEach((s,l)=>{if(l===A)return;let c=s[t],u=c+s[r];LG(n,a,c,u)&&i.add(l)}),{startIndex:Math.min(...i),endIndex:Math.max(...i)}}function VG(j,A,e,t,r,o){if(r)return t.startIndex;if(o)return t.endIndex;let n=A?"x":"y",a=A?"width":"height",i=j[n],s=1/0,l=t.startIndex;for(let c=t.startIndex;c<=t.endIndex;c++){let u=e[c];$(u,"Ouf of bound access to childRects:",c,t,e);let p=u[n],f=p+u[a],E=E0(i,p,f);E<s&&(s=E,l=c)}return l}function KG(j,A){let e=[];for(let t=A.startIndex;t<=A.endIndex;t++){let r=j[t];$(r,"Ouf of bound access to childRects:",t,A,j),e.push(r)}return q.merge(...e)}function JG(j,A,e,t){let r=Ye(j)||j.resolveValue("stackDirection")==="horizontal",o=q.merge(...A),n=r?"x":"y",a=r?"y":"x",i=r?"width":"height",s=r?"height":"width",l=e[n],c=e[a],u=o[a],p=u+o[s],f=c<u,E=!f&&c>p,F=wG(r,e,A),h=qG(r,F,A),S=VG(e,r,A,h,f,E),v=A[S];$(v,"Closest rect is not defined:",S);let P=v[n]+v[i]/2,T=f||E?f:l<P,N=T?S:S+1;f&&(N=0),E&&(N=A.length);let Q=v[n],H=Q+v[i],Z=T?Q:H,J=null,AA=T?S-1:S+1;if(AA>=h.startIndex&&AA<=h.endIndex){let sj=A[AA];if(sj){let Tj=sj[n],ie=Tj+sj[i];J=T?ie:Tj}}let jA=Z;Y(J)&&(jA=Math.round((jA+J)/2));let x=KG(A,h),z=Math.round(x[a]+x[s]/2),K={[n]:jA,[a]:z},nA={...K},BA={...K},WA=t[s],HA=Math.round(WA/2);return r?(nA.y-=HA,BA.y+=HA):(nA.x-=HA,BA.x+=HA),{index:N,line:{a:nA,b:BA}}}function $0(j,A,e,t,r){if($(A.length,"childInsertion only works correctly if there are more than 0 child rects"),Ye(j)||j.stackWrapEnabled)return JG(j,A,t,r);let o=1/0,n=null,a=j.stackDirection==="vertical";A.forEach((c,u)=>{let p=Math.abs(a?t.y-c.y:t.x-c.x);p>o||(o=p,n=u)});let i=0;if(n!==null){let c=A[n];$(c,"Closest child rect is not defined:",n);let u=q.center(c);(a?t.y>u.y:t.x>u.x)&&n++,i=Math.min(Math.max(0,n),A.length)}let s=QG(j),l=UG(j.resolveValue("stackDirection"),j.resolveValue("stackAlignment"),s,e,A,i,r);return{index:HG(j,i),line:l}}function HG(j,A){$(vA(j),"A node must support children to consider an insertion index.");let e=A;for(let t=0;t<j.children.length&&t!==A;t++){let r=j.children[t];r&&(Le(r)||e++)}return e}function QG(j){let A=j.resolveValue("stackDirection"),e=j.resolveValue("stackAlignment");if(e==="center")return 0;let t=lo(j);if(!t.perSide)return t.top;let r=e==="start";return A==="vertical"?r?t.left:t.right:r?t.top:t.bottom}function UG(j,A,e,t,r,o,n){let a=r[o-1],i=r[o],s=j==="vertical",l={x:t.width/2,y:t.height/2};if(!(!a&&!i)){if(r.length===1){let c=a||i;$(c,"Child rect must be defined"),o===0?s?l.y=c.y-10:l.x=c.x-10:s?l.y=c.y+c.height+10:l.x=c.x+c.width+10}else if(a&&i){let c=Math.abs(s?a.y+a.height-i.y:a.x+a.width-i.x);s?l.y=i.y-c/2:l.x=i.x-c/2}else if(a){let c=r[o-2];$(c,"Child rect must be defined");let u=Math.abs(s?c.y+c.height-a.y:c.x+c.width-a.x);s?l.y=a.y+a.height+u/2:l.x=a.x+a.width+u/2}else if(i){let c=r[o+1];$(c,"Child rect must be defined");let u=Math.abs(s?i.y+i.height-c.y:i.x+i.width-c.x);s?l.y=i.y-u/2:l.x=i.x-u/2}}return l.x=Math.min(Math.max(4,l.x),t.width-4),l.y=Math.min(Math.max(4,l.y),t.height-4),WG(j,A,e,l,t,n)}function WG(j,A,e,t,r,o){let n=j==="vertical",a,i,s=e??0;switch(A){case"center":a={x:n?t.x-o.width/2:t.x,y:n?t.y:t.y-o.height/2},i={x:n?t.x+o.width/2:t.x,y:n?t.y:t.y+o.height/2};break;case"start":a={x:n?s:t.x,y:n?t.y:s},i={x:n?o.width+s:t.x,y:n?t.y:o.height+s};break;case"end":default:a={x:n?r.width-o.width-s:t.x,y:n?t.y:r.height-o.height-s},i={x:n?r.width-s:t.x,y:n?t.y:r.height-s};break}return{a,b:i}}var B0=6;function zG(j,A){for(let e of j)if(A.includes(e))return!0;return!1}function XG(j,A,e,t,r){if(r.length===0||j.stackWrapEnabled||MA(j)||hA(j))return null;let{tree:o,zoom:n}=A,a=o.getParent(j.id);if(a&&JA(a)&&(a.stackDirection!==j.stackDirection||a.stackWrapEnabled))return null;let i=o.convertPointToNode(j,e),s=o.getRect(j),l=j.stackDirection==="vertical",c=l?"x":"y",u=l?"y":"x",p=l?"width":"height",f=l?"height":"width",E=s[p],F=s[f],h=E*n,S=E*n;if(h<40||S<40)return null;let v=i[c],P=10/n,T=q.merge(...r),N=T[c],Q=N+T[p],H=Math.max(P,N/2),Z=Math.max(P,(E-Q)/2),J=v<=H,AA=v>=E-Z;if(!J&&!AA)return null;let jA=J?0:1,x=t[f],z=4/n,K=J?z:E-z,nA=F/2,BA=x/2,WA=F/3,HA=i[u],vj="end";x>F?vj="center":HA<WA?vj="start":HA<2*WA&&(vj="center");let sj,Tj;switch(vj){case"start":{sj=0,Tj=x;break}case"end":{Tj=F,sj=Tj-x;break}case"center":default:{sj=nA-BA,Tj=nA+BA;break}}let ie={[c]:K,[u]:sj},ae={[c]:K,[u]:Tj},Zt=o.convertPointToCanvas(j,ie),Ii=o.convertPointToCanvas(j,ae);return{insertionIndex:jA,insertionLine:{a:Zt,b:Ii},wrap:{wrapAlignment:vj}}}function pd(j,A,e,t,{allowWrapping:r=!0}={}){if(!vA(j))return{insertionIndex:null,insertionLine:null};let o=ud(j,A.stores.layoutCache);if(!o)return{insertionIndex:null,insertionLine:null};if(JA(j)&&r){let u=XG(j,A,e,t,o);if(u)return u}let n=A.tree,a=n.getRect(j),i=n.convertPointToNode(j,e);if(o.length===0)return{insertionIndex:0,insertionLine:null};let{index:s,line:l}=$0(j,o,a,i,t),c={a:n.convertPointToCanvas(j,l.a),b:n.convertPointToCanvas(j,l.b)};return{insertionIndex:s,insertionLine:c}}var YG={width:10,height:10};function g0(j,A,e,t,r,o=!1){$(e.length,"getStackOrGridInRange(): expects at least a single selected node");let n=j.stores.scopeStore.active;if(e.some(Fj))return null;let i=j.tree.getNodesAtPoint(n,A).filter(c=>!(gr(c)&&c.locked||!vA(c)||c$(c)||$p(j.tree,j.stores.overlayStore.activeOverlays,c))).reverse();if(t){let c=t.id,u=i.find(p=>p.id===c);if(u)return u}let s=null,l=e.map(c=>c.id);for(let c of i){if(!Gu(c)||o&&!IA(c))continue;let u=j.tree.getAncestors(c.id);if(u.push(c.id),zG(u,l)||(s||(s=c),!Ie(c)))continue;let{insertionLine:f}=pd(c,j,A,YG);if(!f)continue;if(f.a.x===f.b.x){if(Math.abs(A.x-f.a.x)*j.zoom>B0)continue}else if(f.a.y===f.b.y){if(Math.abs(A.y-f.a.y)*j.zoom>B0)continue}else continue;if(e.every(F=>Dt(j.tree,c,F,n.id,r)))return c}if(Ie(s)){let c=s;if(e.every(p=>Dt(j.tree,c,p,n.id,r)))return s}return null}function h0(j,A,{wrapAlignment:e}){let t=Oc.addStack(j,[A]);if(!t)return null;let r=j.tree.getNode(t);return!r||!JA(r)?null:(r.set({stackDirection:A.stackDirection==="horizontal"?"vertical":"horizontal",stackAlignment:e}),r)}function kd(j,A){let{width:e,height:t}=j.tree.getRect(A);return $A(A)&&oj(A)&&(A.widthType===2&&A.width>0&&(e=A.width),A.heightType===2&&A.height>0&&(t=A.height)),{width:e,height:t}}function ZG(j,A,e){let t=kd(j,A);return{...t,x:e.x-t.width/2,y:e.y-t.height/2}}function AS(j,A){let e=kd(j,A),t=j.stores.scopeStore.active,r=j.tree.getCommonGroundNode(j.stores.selectionStore.nodes),o,n;if(r){let i=j.tree.convertFrameToCanvas(r);o=q.center(i).x-e.width/2,n=i.y}else if(w(t)||eA(t)){let i=t.getPrimaryVariant(),s=j.tree.convertFrameToCanvas(i);o=q.center(s).x-e.width/2,n=s.y}else{let i=j.stores.canvasStore.getCanvasCenter();o=i.x-e.width/2,n=i.y-e.height/2}let a={x:o,y:n};for(;;){let i={...e,...a},s=j.tree.getNodesInRect(t,i,!0);if(s.length===0)return i;let l=j.tree.getBoundingFrameForNodes(s);a.x=l.x-e.width-100}}function jS(j,A,e,t=!1){let{tree:r}=j,o=r.getPotentialParents(j.stores.scopeStore.active,j.stores.overlayStore.activeOverlays,q.cornerPoints({...e,width:1,height:1}),e,L,A);return t&&(o=o.filter(IA)),o=r.sortVisually(o).reverse(),o.length>0&&o[0]?o[0]:null}var R0={width:1,widthType:1,heightType:2,left:0,right:null};function I0({engine:j,component:A,canvasPoint:e,source:t,type:r,shouldBecomeFullWidthForVariants:o=new Set,isLayoutSection:n=!1,notDraggedOntoCanvas:a=!1,insertAsGroundNode:i=!1,insertAsOverlayType:s,imageToUpload:l}){f0({canvasNode:A,source:r==="libraryModule"?"team_library":t,isDrag:!0,engine:j});let{selectionStore:c,canvasStore:u,scopeStore:p}=j.stores,f=i?AS(j,A):ZG(j,A,e);s===1&&Tt(A)&&A.set({floatingPositionEnabled:!0,floatingPlacement:ua,floatingAlignment:pa,floatingOffsetX:0,floatingOffsetY:10});let E=Cs(j,A),F=g0(j,e,[E],null,L,n);if(a&&n&&!F){let jA=u.getCanvasVisibleRectTakingOverlaysIntoAccount(),x=c.ids.length===1&&c.ids[0]?j.tree.getNode(c.ids[0]):null,z=x?j.tree.getGroundNodeFor(x):null;Ie(z)&&q.intersects(j.tree.convertFrameToCanvas(z),jA)&&(F=z)}let h=F??jS(j,A,e,n),S=c.ids.length===0,v=p.active,P=jo(v)?v.getPrimaryVariant():null;if(a&&n&&P&&S&&(h=P),s===1&&h&&Tt(E)&&!IA(h)){$(h,"Parent should exist");let jA=h.originalid??h.id,x=Bs(j.stores,"framer/useShowRelativeOverlay",jA,E.draftOrCurrent());if(!x)return;j.tree.move(x.id,jA);return}else Tt(E)&&E.set(kp);if(i&&(h=null,F=null,!q.containsRect(u.getCanvasVisibleRectTakingOverlaysIntoAccount(),f))){let jA=q.center(f),x=u.zoom,z=Math.min(x,1);u.scrollToCenter(jA,{animate:!0,zoom:z})}let T=-1,N=null;if(h){pE(j,h,A,f),kE(j,h,A);let jA=h.draftOrCurrent();JA(jA)&&(F=jA)}if(F){let jA=kd(j,A),{insertionIndex:x,wrap:z}=pd(F,j,e,jA);if(z&&(N=z),Y(x)&&(T=x),a&&n){if(T=F.children.length,c.ids.length===1){let l6=c.ids[0],Fi=l6&&j.tree.getNode(l6);if(Fi){let Gi=new Set([Fi.id]);for(let Si of Fi.ancestors())Gi.add(Si.id);let Oo=F.children.findIndex(Si=>Gi.has(Si.id));Oo>=0&&(T=Oo+1)}}let K,nA=F.children[T-1];nA?(K=j.tree.convertFrameToCanvas(nA),K.y+=K.height):K=j.tree.convertFrameToCanvas(F),K.height=jA.height;let BA=j.tree.convertFrameToCanvas(F),WA=Math.min(K.x,BA.x),HA=Math.max(q.maxX(K),q.maxX(BA));K.x=WA,K.width=HA-WA;let{zoom:vj}=u,sj=u.getCanvasVisibleRectTakingOverlaysIntoAccount(),Tj=sj.width*vj,ie=sj.height*vj,ae=40,Zt=Math.max(Tj-ae*2,100),Ii=Math.max(ie-ae*2,100),s6=Zt/(K.width||1),Nd=Ii/(K.height||1),xd=Math.min(s6,Nd,.5),Od=q.center(K);u.scrollToCenter(Od,{animate:!0,zoom:xd})}mE(j,F,A,f)}let Q;if(h){let{width:jA,height:x}=f;Q={...j.tree.convertCanvasFrameToNode(h,f),width:jA,height:x}}else Q=f;let H=E.updateForRect({rect:Q,parentSizeInfo:null,constraintsLocked:!1,shouldGuessPinToBottom:h?pt(j.tree,E,h):!0,shouldGuessPinToRight:h?ee(j.tree,E,h):!0});h&&JA(h)&&oj(E)&&$A(E)&&(H=tS(E,H)),sB(E,H),E.set(H,j.tree);let Z=E.id,J=!1,AA=null;if(h){if(AA=h,kj(h)&&(AA=j.tree.getNode(h.originalid),J=!0,$(AA,"Fail to insert node into variants: the original parent should exist")),N&&!hA(AA)&&JA(AA)){let z=h0(j,AA,N);if(!z)return;AA=z}j.moveNode(E.id,AA.id,T),J&&($(hA(h),"Fail to insert node into variants: the new parent should be a replica node"),Z=xn(j,E,h,AA));let jA=j.tree.getGroundNodeFor(AA),x=!!(jA.name&&o.has(jA.name.toLowerCase()));if(pA(E)&&x&&E.set({left:0,width:1,widthType:1},j.tree),W(E)&&pj(jA)&&IA(jA)){let K={width:E.width,widthType:E.widthType,left:E.left,right:E.right};x&&E.set(R0);let nA=cc(E);if(nA){let BA=j.tree.getScopeNodeFor(jA);w(BA)&&BA.getTopLevelReplicaVariants().forEach(HA=>{if(!HA.name)return;let vj=dc(HA.name,nA);if(!vj||vj===nA.defaultVariant)return;let sj={...HA.replicaInfo.overrides},Tj={...HA.replicaInfo,overrides:sj},ie={...sj[E.id]},ae=eS(x,o,HA.name,K);ae&&Object.assign(ie,ae),ie[VA(nA.key)]={type:"enum",value:vj},sj[E.id]=ie,HA.set({replicaInfo:Tj})})}}Ye(h)&&cr(E)&&(x||E.set({gridItemFillCellWidth:!0}),E.set({gridItemFillCellHeight:!0}))}l&&pA(A)&&Zm(l,A,j).catch(yA),c.set(Z,{switchToLayers:!0})}function eS(j,A,e,t){let r=A.has(e.toLowerCase());if(j!==r)return r?R0:t}function tS(j,A){let e={...A};return(j.widthType===3||j.widthType===1)&&Y(A.width)&&A.widthType!==j.widthType&&(delete e.width,delete e.widthType),(j.heightType===3||j.heightType===1)&&Y(A.height)&&A.heightType!==j.heightType&&(delete e.height,delete e.heightType),e}function Us({engine:j,module:A,identifier:e,position:t,centerInParent:r,insertAsGroundNode:o,update:n}){let a={width:at(A.metadata.intrinsicWidth)??200,height:at(A.metadata.intrinsicHeight)??200},i=new Rr({codeComponentIdentifier:e,slotsAreChildNodes:OA.isOn("componentSlotsAreChildNodes"),...a});n&&n(i);let s=t;if(r&&!o){let l=CB(i,j),c=l?q.center(j.tree.convertFrameToCanvas(l)):null,u=j.stores.canvasStore.getCanvasVisibleRectTakingOverlaysIntoAccount();c&&q.containsPoint(u,c)&&(s=c)}return I0({engine:j,component:i,canvasPoint:s,source:"context_menu",insertAsGroundNode:o}),i}var li=gA("unlinking");async function rS(j,A,e){let{codeEditorStore:t,selectionStore:r,treeStore:o}=j.stores;t.closeEditor();let[n]=r.nodes;if(r.nodes.length===1&&W(n)&&n.codeComponentIdentifier===A)return!0;let a=await j.runWithFullyLoadedTreeAsync(()=>{for(let i of o.treeIndex.codeComponentNodeIds){let s=j.tree.getNodeWithTrait(i,W);if(s?.codeComponentIdentifier===A)return s}},{runInBackground:!0,name:`findCodeComponentInstance: ${A}`});return a?(lB(j,a),!0):(TA({type:"add",variant:"info",key:"add-component-instance-to-edit-in-plugin",text:`Add this Component to Canvas to edit in ${e.name}`}),!1)}async function F0(j,A,e){return await rS(j,A,e)?(j.stores.pluginStore.openPlugin(e,j,{mode:"canvas"}),!0):!1}function G0(j,A){let e=j.componentForIdentifier(A);if(e)return e;let t=oA(A);return!YA(t)||!Rj(t)?null:j.componentForIdentifier(r7(t))}function oS(j,A,e){let t=YA(e)?e.localId:e?.moduleId,r=j.get(t);if(At(r))return r.pluginId;if(!Br(r))return;if(!sA(r.save.pluginId))return r.save.pluginId;let o=A.getPersistedModuleByLocalId(r.id);if(!o)return;let n=o.metadata.pluginId;if(_(n))return n}function S0(j,A){let e=oS(j.tree,j.stores.modulesStore,A);if(!sA(e))return j.stores.pluginStore.manifestById.get(e)}function fz(j){return`Edit in ${j.name}`}var nS=0;async function Ws(j,A,e=nS){if(e===0){let r=oA(A),o=S0(j,r);if(o&&await F0(j,A,o))return}let t=G0(L,A);t&&j.stores.codeEditorStore.editFile(t.file)}async function y0(j,{identifier:A,info:e,instance:t,enterIsolation:r,codeComponentIsolationMode:o}){let n=e.module.baseURL+e.module.files.source,i=await(await fetch(n)).text(),[s,l]=await Promise.all([iB(i),j.stores.modulesStore.getModuleDependencies(A)]);if(s.ok){let E=new Map;for(let h of s.value.relative){let S=Se(h.specifier,`${e.module.type}/`);if(!S){li.warn("Failed to normalize relative import",h.specifier);continue}let v=E.get(S)??[];v.push(h),E.set(S,v)}let F;for(let h of l.imports){if(h.type!=="local")continue;let S=`${h.moduleType}/${h.moduleName}`,v=E.get(S);if(!v){li.warn("Unable to get source location of import",S,"when unlinking");continue}for(let P of v){F||(F=i.split(`
`));let T=P.specifierLine;F[T]=F[T].replace(JSON.stringify(P.specifier),JSON.stringify(h.importURL))}}F&&(i=F.join(`
`))}let c=j.stores.modulesStore.forType("codeFile"),u=c.getUniqueName(e.module.name),p=await c.create({name:u,source:i,metadata:{pluginId:e.module.metadata.pluginId}}),f=Kr(A,p).value;return t&&j.scheduler.processWhenReady(()=>{let E=j.tree.get(t.originalid??t.id);E&&E.set({codeComponentIdentifier:f})}),r&&(j.stores.chromeStore.contentPanelTab="Assets",Ws(j,f,o)),f}var C0={canvasComponent:GB,codeFile:y0};function iS(j){return _(j)?j in C0:!1}async function fd(j,{identifier:A,moduleType:e,instance:t,enterIsolation:r=!0,codeComponentIsolationMode:o,renamedIds:n=new Map,isAutoDetach:a=!1}){if(!iS(e))throw Error(`Cannot import external module of type ${e}`);let[i]=await j.stores.modulesStore.preloadExternalModules([A]);$(i,"external module must exist on preload");let s={identifier:A,info:i,instance:t,enterIsolation:r,codeComponentIsolationMode:o,renamedIds:n,isAutoDetach:a},l=C0[e],c=await l(j,s);if(!sA(c))return!_(c)&&eA(c)?{...i,codeComponentIdentifier:c.instanceIdentifier,node:c}:{...i,codeComponentIdentifier:c,node:void 0}}var md=new Set;async function aS(j,A){let{instance:e,withUnlinkModal:t,...r}=A,o=za(j,A.identifier),n=j.stores.insertSidebarStore.getEditBehavior(A.identifier.moduleId);if(t&&n!=="autoUnlink"&&(!o||qe.isOn("openPrimaryForBuiltInModules"))){j.stores.modalStore.set({type:"UnlinkComponent",source:"edit_action",...r,nodeId:e?.id});return}if(!md.has(A.identifier)){md.add(A.identifier),j.scheduler.process(()=>{j.beginUndoGroup()});try{return(await fd(j,{instance:e,enterIsolation:n!=="autoDetach",...r}))?.codeComponentIdentifier}catch(a){li.reportError(a),TA({type:"add",variant:"error",text:"Failed to unlink component",key:"external-component-unlink-error",icon:"error"})}finally{j.scheduler.processWhenReady(()=>{j.endUndoGroup()}),md.delete(A.identifier)}}}async function Yz(j,A){let{instance:e,moduleType:t,enterIsolation:r,codeComponentIsolationMode:o}=A;if(!W(e))return;let n=await aS(j,{...A,enterIsolation:!1});if(!n)return;await Ns(L,[n],j.stores.modulesStore);let a=L.componentForIdentifier(n);if(!a)return;let i=f$(a);i&&j.scheduler.processWhenReady(()=>{if(j.tree.getNodes(Array.from(j.stores.treeStore.treeIndex.codeComponentNodeIds)).forEach(l=>{if(!i||i.id===l.id||!W(l)||l.codeComponentIdentifier!==e.codeComponentIdentifier||hA(l)||!bs(l,{allowLockedNodes:!0}))return;let c=j.cloneNode(i,!1,!1);m$(j,l,c).catch(yA)}),!!r)if(t==="canvasComponent"){let l=Ea(n);l&&j.stores.scopeStore.select(l,{keepHistory:!1})}else t==="codeFile"&&Ws(j,n,o)})}var sS=gA("clipboard:modules");async function dX(j,A,e){if(!A||!ak(A))return!1;let t="insert-external-component";try{await cS({engine:j,moduleURL:A,position:e,centerInParent:!0,toastKey:t}),TA({type:"remove",key:t})}catch(r){console.error("Failed to insert external component",r),TA({type:"add",variant:"error",key:t,text:"Failed to insert external component",icon:"error"})}return!0}async function lS(j,A){let e=new URL(A),t=e.hash.substring(1).split(","),r=t[0]||"default",o=t.some((c,u)=>u>0&&c==="unlink"),{module:n}=await j.stores.modulesStore.lookUpModule({url:e.href}),a=n.id,i=j.stores.modulesStore.getPersistedModuleByGlobalId(a);$(n.files.module,"Module file must be defined");let s=le(a,n.saveId,n.files.module,r),l=i?yi(i.localId,r):s;return{module:n,moduleIdentifier:l,externalIdentifier:s,insertUnlinked:o}}async function cS({engine:j,moduleURL:A,position:e,centerInParent:t,insertAsGroundNode:r,toastKey:o,update:n}){let{module:a,moduleIdentifier:i,externalIdentifier:s,insertUnlinked:l}=await lS(j,A);if(a.type==="screen")if(YA(i)){let c=Ea(i.value);if(!c)return;let u=j.tree.getNode(c);if(!w(u))return;await j.loadScopesThenProcess([u],([p])=>{p&&yB(j,p,p.getPrimaryVariant())})}else o&&TA({type:"add",variant:"progress",key:o,text:"Inserting Web Page",icon:"reconnecting",duration:1/0,showCloseButton:"never"}),await SB(j,s);else if(l){o&&TA({type:"add",variant:"progress",key:o,text:"Inserting external component",icon:"reconnecting",duration:1/0,showCloseButton:"never"});let c=await fd(j,{identifier:s,moduleType:a.type,enterIsolation:!1});await j.scheduler.processWhenReadyAsync(()=>{c&&Us({engine:j,module:a,identifier:c.codeComponentIdentifier,position:e,centerInParent:t,insertAsGroundNode:r,update:n})})}else{if(o&&TA({type:"add",variant:"progress",key:o,text:"Inserting external component",icon:"reconnecting",duration:1/0,showCloseButton:"never"}),!$e(i)){await j.scheduler.processWhenReadyAsync(()=>{Us({engine:j,module:a,identifier:i.value,position:e,centerInParent:t,insertAsGroundNode:r,update:n})});return}await j.stores.modulesStore.addExternalModulesToProject([i],{onTreeUpdate:()=>{if(Us({engine:j,module:a,identifier:i.value,position:e,centerInParent:t,insertAsGroundNode:r,update:n}),a.type!=="vector")return;let c=j.tree.getNodeWithTrait(a.id,At)?.annotation("framerVector");Fa(c)&&j.stores.modulesStore.addOrUpdateVectorSetAndVectors({moduleId:c.set.moduleId,saveId:""}).catch(yA)}}).catch(sS.reportError),j.stores.modulesStore.trackExternalComponentInsert([i.value],"paste-url")}return a}function b0(j,A){if(j.stores.projectStore.projectLicenseType===_m())return j.stores.modalStore.set({type:"UpsellEnterprise",source:"upsell",description:"Sign up for an Enterprise plan to increase your file upload limit to 150MB and unlock other powerful features that help scale your site.",upsell:"file-limit-enterprise-upsell",upsellFeatures:["Advanced Permissions","Custom Limits","Custom Hosting","Custom Proxy Support","Enterprise Security","Dedicated Support"]});let e=j.stores.projectStore.resourceLimits?.fileUploadLimitInMB;$(typeof e=="number","fileUploadLimitInMB is not a number");let t=e.toLocaleString()+"MB",r=(A/nf).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:1})+"MB";return j.stores.modalStore.set({source:"upsell",type:"UpsellFeature",upsellFeature:"fileUploadLimitInMB",title:"File Upload Limit",description:`Your current plan limits file uploads to ${t}, and you\u2019re trying to upload a file that\u2019s ${r}. Upgrade your site to increase the limit and upload your file.`})}var v0=class{constructor(A,{concurrency:e=5,silent:t=!1}={}){this.engine=A;I(this,"uploads",new Map);I(this,"completed",0);I(this,"failed",0);I(this,"generating",!1);I(this,"resolveStatusUpdate");I(this,"limiter");I(this,"silent");this.limiter=new Do(e),this.silent=t}add(A){return this.createTask(A,e=>e)()}createTask(A,e){let t=this.uploads.get(A);t||(t={task:async()=>{try{return typeof A=="string"?A.startsWith("data:")?await this.uploadFile(await Ym(A,"imported")):await Pn.uploadAssetByURL(A,{silent:this.silent,refreshAssetService:!1}):await this.uploadFile(A)}catch(n){throw this.failed++,n}finally{this.completed++,this.resolveStatusUpdate?.()}}},this.uploads.set(A,t));let r=t;return async()=>{r.resultPromise||(r.resultPromise=this.limiter.run(r.task),this.resolveStatusUpdate?.());let o=await r.resultPromise;return this.engine.stores.assetStore.assetService?.addAssets([o.asset]),e(o)}}async uploadFile(A){let e=this.engine.stores.projectStore.resourceLimits?.fileUploadLimitInMB??void 0,t={silent:this.silent,maxFileSize:e,onExceedsCustomMaxSize:o=>b0(this.engine,o),refreshAssetService:!1},r;if(A.type.startsWith("image/")?r=await Pn.uploadImage(A,t):A.type.startsWith("video/")?r=await Pn.uploadVideo(A,t):r=await Pn.uploadFile(A,t),!r)throw Error("Failed to upload file");return r}get active(){return[...this.uploads.values()].map(({resultPromise:A})=>A).filter(ce)}get status(){let{active:A,completed:e,failed:t}=this;return{started:A.length,completed:e,failed:t}}async*statusUpdates(){if(this.generating)throw Error("`statusUpdates` is in use by another call");for(this.generating=!0,yield this.status;this.completed<this.active.length;)await new Promise(A=>{this.resolveStatusUpdate=()=>{A(),this.resolveStatusUpdate=void 0}}),yield this.status;await this.engine.stores.assetStore.assetService?.refresh().catch(yA),this.generating=!1}async results(){let A=await Promise.allSettled(this.active).then(e=>e.filter(y7).map(t=>t.value));return await this.engine.stores.assetStore.assetService?.refresh().catch(yA),A}};function Qt(j,A){return`${j??""}.${A}`}function ci(j,A){return`${j??""}[${A}]`}function PX(j){let A=[],e=j.split(".");for(let t of e){let[r,o]=t.split("[");if(r.length!==0&&A.push({type:"object",key:r}),o){let n=o.slice(0,-1);$(n.length>0),A.push({type:"array",id:n})}}return A}function T0(j){return eA(j)||w(j)||ZA(j)}var dS=512,Ut,Ed,$d,di=class{constructor(A){this.assetMap=A;NA(this,Ut);I(this,"keys",new Set)}addAsset(A){this.keys.add(A)}resolve(A){if(!Vo(this,Ut,Ed).call(this,A))return;let e=Vo(this,Ut,$d).call(this,A);if(e!==null)return e&&(A=e.identifier),{src:f7(A)}}resolveResponsiveImage(A,e,t){if(!Vo(this,Ut,Ed).call(this,A))return;let r=Vo(this,Ut,$d).call(this,A);if(r===null)return;let o;r&&(A=r.identifier,o=r.preferredSize);let n=this.assetMap.assetForKey(A),a=n?.properties?.image,i=r?.intrinsicSize??a,s=$7(a?.width,a?.height),c={src:n?B7(n,o,e,s).url:m7(A,void 0,void 0,i),positionX:void 0,positionY:void 0,srcSet:this.generateSrcSet(n,s,o),pixelWidth:i?.width,pixelHeight:i?.height};return t&&_(t.positionX)&&_(t.positionY)&&(c.positionX=t.positionX,c.positionY=t.positionY),c}generateSrcSet(A,e,t){if(!A)return;let r;if((!t||t==="auto"||t==="lossless")&&e?.length&&A.properties?.image){r="";for(let{maxSideSize:n,width:a}of e)a<dS||(r+=`${R6(A,n,t)} ${a}w,`);r+=`${R6(A,void 0,t)} ${A.properties.image.width}w`}return r}};Ut=new WeakSet,Ed=function(A){return!(ge(A)||A.startsWith("https:"))},$d=function(A){let e=E7(A);return e&&(A=e.identifier),A===""?null:(this.addAsset(A),e)};function Bd(j,A){let e=[],t=x7(j,o=>{let n=A.create(o);return e.push(o),"${"+n+"}"});return{templatedUrl:new V("`"+t+"`"),usedVariables:e}}function zs(j,A,e,t=void 0){if(qA(j.value))return rr(!Wr(j.value),"Computed values should not be possible in fetch fallback"),A.create(j.value);switch(j.type){case"color":return j.value?g`${j.value}`:g`undefined`;case"string":return g`${j.value}`;case"boolean":return new V(j.value);case"number":return new V(j.value);case"image":{if(j.value===void 0)return g`undefined`;let r=e.resolveResponsiveImage(j.value,void 0,void 0);return r?g`${r.src}`:g`undefined`}case"link":{if(!j.value||!t)return g`undefined`;let r=t.create(j.value);return r?new V(wA(r)):g`undefined`}default:_i(j)}}function Xs(j,A,e,t=void 0){let{templatedUrl:r}=Bd(j,A),o=Li(j);return new Nj({url:r,resultKeyPath:j.resultKeyPath,fallbackValue:zs(o.controlProp,A,e,t),errorFallbackValue:o.errorControlProp?zs(o.errorControlProp,A,e,t):void 0,resultOutputType:o.controlProp.type,cacheDuration:j.cacheDuration,credentials:j.credentials})}var ui=class{constructor(A,e,t,r,o){this.bindings=A;this.variables=e;this.preload=t;this.assets=r;this.links=o;I(this,"fetchesByNode",new Map);I(this,"resultBindingsByNode",new Map)}createFetchBinding(A,e){let t=Li(e);if(!N7(t))return zs(t.controlProp,this.variables,this.assets,this.links);let r=A.originalid??A.id,o=this.resultBindingsByNode.get(r)??this.bindings.create("fetchResult");this.resultBindingsByNode.set(r,o),this.preload.addFetch(A,t);let n=this.fetchesByNode.get(A.id)??[];return n.push(Xs(t,this.variables,this.assets,this.links)),this.fetchesByNode.set(A.id,n),g`${o}[${n.length-1}]`}getResultBinding(A){return this.resultBindingsByNode.get(A.originalid??A.id)}getFetchesForNode(A){return this.fetchesByNode.get(A.id)}};var gd=class{constructor(A,e,t,r){this.moduleType=A;this.modulesStore=e;this.submoduleName=t;this.sourceCode=r;I(this,"submoduleFilename");I(this,"submoduleImport");I(this,"bindings",new Er);I(this,"imports");I(this,"declarations",new hr(this.bindings));this.submoduleFilename=Ua(this.submoduleName),this.submoduleImport=Wa(this.submoduleFilename),this.imports=new $r(this.moduleType,this.modulesStore,this.bindings)}get estimatedSize(){return this.declarations.declarationsByteSize}serialize(){let A=Gj.linesFrom(this.imports.statements),e=this.declarations.list();return Gj.sections(A,this.sourceCode,...e)}},Ys=class{constructor(A,e,t){this.moduleType=A;this.modulesStore=e;this.componentSourceNodeId=t;I(this,"submodules",new Set)}create(A){let e=Af(this.componentSourceNodeId,this.submodules.size),t=new gd(this.moduleType,this.modulesStore,e,A);return this.submodules.add(t),t}delete(A){this.submodules.delete(A)}serialize(){let A=new Map;for(let e of this.submodules){let t=e.serialize();A.set(e.submoduleName,t)}return A}};function P0(j){return`${j}ToDisplayName`}var M0="enumToDisplayNameFunctions";function _0(j){if(j?.type!=="enum"||!j.optionTitles)return g`(value) => value`;let A=j.optionTitles;return new V(Gj.lines(g`(value, _locale) => {`,g`switch (value) {`,...j.options.map((e,t)=>{let r=A[t];return g`case ${e}: return ${sA(r)?g`undefined`:r};`}),g`default: return "";`,g`}`,g`}`))}function D0(j){let{locale:A,grouping:e,notation:t,compactDisplay:r,style:o,currency:n,currencyDisplay:a,unit:i,unitDisplay:s,minimumFractionDigits:l,maximumFractionDigits:c,minimumIntegerDigits:u}=j,p={locale:A,notation:t,style:o};switch(Bt(e)&&(p.useGrouping=e),Y(l)&&(p.minimumFractionDigits=l),Y(c)&&(p.maximumFractionDigits=c),Y(u)&&(p.minimumIntegerDigits=u),t==="compact"&&(p.compactDisplay=r),o){case"currency":p.currency=n,p.currencyDisplay=a;break;case"unit":p.unit=i,p.unitDisplay=s;break}return new Nj(p)}var N0=g`(value, options = {}, activeLocale) => {
    const fallbackLocale = "en-US";
    const locale = options.locale || activeLocale || fallbackLocale;
    const {
        useGrouping,
        notation,
        compactDisplay,
        style,
        currency,
        currencyDisplay,
        unit,
        unitDisplay,
        minimumFractionDigits,
        maximumFractionDigits,
        minimumIntegerDigits,
    } = options;
    const formatOptions = {useGrouping, notation, compactDisplay, style, currency, currencyDisplay, unit, unitDisplay, minimumFractionDigits, maximumFractionDigits, minimumIntegerDigits};
    const number = Number(value);
    try {
        return number.toLocaleString(locale, formatOptions);
    } catch {
        try {
            return number.toLocaleString(fallbackLocale, formatOptions);
        } catch {
            return number.toLocaleString();
        }
    }
};
`;function x0(j,A){if(A.length===0)return null;$(j);let e=new Set;for(let r of A){let o=j.create(r);e.add(wA(o))}let t=`{${Array.from(e).join(", ")}}`;return new V(t)}function O0(j,A,e,t){let r=j.name;switch(r){case"contains":case"endsWith":case"equals":case"startsWith":case"greaterThan":case"lessThan":case"isBefore":case"isAfter":case"isIncludedIn":return aA(j.value)?($(e),[e.create(j.value)]):[sA(j.value)?g`undefined`:j.value];case"prefix":case"suffix":{if(aA(j.value))return $(e),[e.create(j.value)];let n=sA(j.value)?g`undefined`:j.value;return j.valueLocalized?($(t,"LocalizedValueCollector is required"),[t.add(n,j.valueLocalized,a=>j.valueLocalized?.[a]?.value)]):[n]}case"toDateString":return[A.getActiveLocaleCode()];case"extractDateSegment":return[j.segment];case"numberToString":return[D0(j),A.getActiveLocaleCode()];case"offsetAndLimitArray":return[j.startOffset,Y(j.limit)?j.limit:g`undefined`];case"isBetweenDates":{let n=[];return aA(j.start)?($(e),n.push(e.create(j.start))):n.push(sA(j.start)?g`undefined`:j.start),aA(j.end)?($(e),n.push(e.create(j.end))):n.push(sA(j.end)?g`undefined`:j.end),n}case"convertFromEnum":case"convertFromString":{let a=function(l){zj(l)&&et(l,c=>a(c)),aA(l)&&n.push(l)};var o=a;let n=[];a(j.default);for(let l of j.cases)a(l.to);let i=x0(e,n),s=e?.getLocale()??g`undefined`;return i?[s,i]:[s]}case"convertFromBoolean":{let a=function(c){zj(c)&&et(c,u=>a(u)),aA(c)&&n.push(c)};var o=a;let n=[];a(j.truthy),a(j.falsy);let i=e?.getLocale()??g`undefined`,s=x0(e,n);return s?[i,s]:[i]}case"enumToDisplayName":return A.variables?[A.variables.getLocale()]:[];case"toString":case"toBoolean":case"toNumber":case"isSet":case"negate":case"reverseArray":case"toResponsiveImage":case"toImageSrc":case"jsonStringify":case"htmlEscape":case"htmlUnescape":case"addImageAlt":case"toZIndex":case"toAxisOverflow":case"toOverflowWithClipFallback":case"numberToPixelString":case"radiusForCorner":case"arrayToArray":case"arrayLength":case"isEven":case"isOdd":case"getGridColumnCSSValue":case"getGridRowCSSValue":case"getNumericColumnGap":return[];default:iA(r,"All value transforms should define their arguments")}}var w0=g`(image, alt) => {
    if (!image || typeof image !== "object") {
        return;
    };
    return { ...image, alt };
};
`;var L0=g`(value) => {
    return Array.isArray(value) ? value.length : 0
}
`;function q0(j){let A=g`item`,e={[yr]:g`${A}?.[${yr}]`};for(let t in j.mapping){let r=j.mapping[t];if($(ce(r)),L7(r.value)){e[t]=g`${A}?.[${r.value.id}]`;continue}r.value}return g`(value) => {
      if (!Array.isArray(value)) return
      return value.map((${A}) => (${e}))
    }`}var V0=g`(a, b) => {
    if (typeof a === "string" && typeof b === "string") {
        return a.toLowerCase().includes(b.toLowerCase());
    }

    if (Array.isArray(a) && typeof b === "string") {
        return a.includes(b);
    }

    return false;
};
`;function uS(j){let A=bt(j.outputType);return wA(g`return ${ut(A)?A:g`undefined`};`)}function K0(j,A,e,t,r,o,n){if(e==="link")return!n||!zj(j)&&!aA(j)?void 0:n.create(j);if(!zj(j))return aA(j)?r.create(j):Uu(e,j,t)?o&&A&&e==="string"?o.add(j,A,a=>A?.[a]?.value):j:Wu(e,t)}function pS(j,A,e,t,r){if(!Qu(j.outputType))return uS(j);let o=K0(j.truthy,j.truthyLocalized,j.outputType,A,e,t,r),n=K0(j.falsy,j.falsyLocalized,j.outputType,A,e,t,r);return Gj.lines(g`if (value) {`,g`return ${o===void 0?g`undefined`:o};`,g`} else {`,g`return ${n===void 0?g`undefined`:n};`,g`}`)}function J0(j,A,e,t,r){$(e),$(t),$(r);let o=new Set;function n(i){if(zj(i)&&et(i,s=>n(s)),aA(i)){$(e);let s=e.create(i);o.add(wA(s))}}n(j.truthy),n(j.falsy);let a=[g`value`,_A.activeLocale];if(o.size>0){let i=`{${Array.from(o).join(", ")}}`;a.push(new V(i))}return new V(Gj.lines(g`(${new V(a.map(wA).join(", "))}) => {`,new V(pS(j,A,e,t,r)),g`}`))}function xo(j,A,e,t,r,o,n){if(e==="link")return!n||!zj(j)&&!aA(j)?void 0:n.create(j);if(!zj(j))return aA(j)?r.create(j):Ju(e,j,t)?o&&e==="string"&&_(j)&&A?o.add(j,A,a=>A?.[a]?.value):j:Hu(e,t)}function H0(j){let A=bt(j.outputType);return wA(g`return ${ut(A)?A:g`undefined`};`)}function kS(j,A,e,t,r,o){if(A?.type!=="enum"||!Vu(j.outputType))return H0(j);let n=new Set,a=xo(j.default,j.defaultLocalized,j.outputType,e,t,r,o);return Gj.lines(g`switch (value) {`,...j.cases.filter(i=>n.has(i.from)||!A.options.includes(i.from)?!1:(n.add(i.from),!0)).map(i=>{let s=xo(i.to,i.toLocalized,j.outputType,e,t,r,o);return g`case ${i.from}: return ${s===void 0?g`undefined`:s};`}),g`default: return ${a===void 0?g`undefined`:a};`,g`}`)}function Q0(j,A,e,t,r,o){$(t),$(r),$(o);let n=new Set;function a(s){if(zj(s)&&et(s,l=>a(l)),aA(s)){$(t);let l=t.create(s);n.add(wA(l))}}j.cases.forEach(s=>{a(s.to)}),a(j.default);let i=[g`value`,_A.activeLocale];if(n.size>0){let s=`{${Array.from(n).join(", ")}}`;i.push(new V(s))}return new V(Gj.lines(g`(${new V(i.map(wA).join(", "))}) => {`,new V(kS(j,A,e,t,r,o)),g`}`))}function mS(j){let A=bt(j.outputType);return wA(g`return ${ut(A)?A:g`undefined`};`)}function fS(j,A,e,t,r){if(!Ku(j.outputType))return mS(j);let o=new Set,n=xo(j.default,j.defaultLocalized,j.outputType,A,e,t,r);return Gj.lines(g`switch (typeof value === "string" ? value.toLowerCase() : value) {`,...j.cases.filter(a=>{let i=a.from.toLowerCase();return o.has(i)?!1:(o.add(i),!0)}).map(a=>{let i=xo(a.to,a.toLocalized,j.outputType,A,e,t,r);return g`case ${a.from.toLowerCase()}: return ${i===void 0?g`undefined`:i};`}),g`default: return ${n===void 0?g`undefined`:n};`,g`}`)}function U0(j,A,e,t,r){$(e),$(t),$(r);let o=new Set;function n(i){if(zj(i)&&et(i,s=>n(s)),aA(i)){$(e);let s=e.create(i);o.add(wA(s))}}j.cases.forEach(i=>{n(i.to)}),n(j.default);let a=[g`value`,_A.activeLocale];if(o.size>0){let i=`{${Array.from(o).join(", ")}}`;a.push(new V(i))}return new V(Gj.lines(g`(${new V(a.map(wA).join(", "))}) => {`,new V(fS(j,A,e,t,r)),g`}`))}var W0=g`(a, b) => {
    return typeof a === "string" && typeof b === "string" && a.toLowerCase().endsWith(b.toLowerCase());
};
`;var z0=g`(a, b) => {
    return (typeof a === "string" && typeof b === "string") ? a.toLowerCase() === b.toLowerCase() : a === b;
};
`;var X0=g`(value, segment = "year") => {
    if (typeof value !== "string") return;
    const date = new Date(value);
    if (isNaN(date.getTime())) return;
    if (segment === "year") return date.getUTCFullYear();
    if (segment === "month") return date.getUTCMonth() + 1;
    if (segment === "day") return date.getUTCDate();
    if (segment === "hour24") return date.getUTCHours();
    if (segment === "hour12") {
        const hour = date.getUTCHours();
        return hour === 0 ? 12 : hour > 12 ? hour - 12 : hour;
    }
    if (segment === "minute") return date.getUTCMinutes();
};
`;var hd=g`spanCount`,Zs=g`optionalColumnCount`,Y0=g`(columnSpan, ${Zs}) => {
    if (columnSpan === "all") return "-1 / 1";
    const ${hd} = Number.isFinite(columnSpan) && columnSpan > 0 ? columnSpan : 1;
    if (Number.isFinite(${Zs}) && ${hd} > ${Zs}) {
        return ${kr`span ${Zs}`};
    }
    return ${kr`span ${hd}`};
};
`;var Z0=g`spanCount`,Ag=g`(rowSpan) => {
    const ${Z0} = Number.isFinite(rowSpan) && rowSpan > 0 ? rowSpan : 1;
    return ${kr`span ${Z0}`}
};
`;var jg=g`(gap) => {
    if (Number.isFinite(gap) && gap >= 0) return gap;
    if (typeof gap !== "string") return 0;
    const firstSegment = gap.split(" ")[0];
    const parsedGap = parseFloat(firstSegment);
    return Number.isFinite(parsedGap) && parsedGap >= 0 ? parsedGap : 0;
};
`;var eg=g`(a, b) => {
    return (typeof a === "number" && typeof b === "number") ? a > b : false;
};
`;var tg=g`(value) => {
    if (typeof value !== "string") return "";
    return value.replaceAll("&", "&amp;").replaceAll("<", "&lt;").replaceAll(">", "&gt;").replaceAll('"', "&quot;").replaceAll("'", "&#39;");
};
`;var rg=g`(value) => {
    if (typeof value !== "string") return "";
    const entities = /&(?:[gl]t|quot|#39|amp|#6[02]|#34|apos|#38);/gu;
    const replacers = { "&lt;": "<", "&gt;": ">", "&quot;": '"', "&#39;": "'", "&amp;": "&", "&#60;": "<", "&#62;": ">", "&#34;": '"', "&apos;": "'", "&#38;": "&" };
    return value.replace(entities, match => replacers[match]);
};
`;var og=g`(dateString, minDateString) => {
    if (typeof dateString !== "string" || typeof minDateString !== "string") return false;

    const date = new Date(dateString);
    if (isNaN(date.getTime())) return false;

    const minDate = new Date(minDateString);
    if (isNaN(minDate.getTime())) return false;

    return date >= minDate;
};
`;var ng=g`(dateString, maxDateString) => {
    if (typeof dateString !== "string" || typeof maxDateString !== "string") return false;

    const date = new Date(dateString);
    if (isNaN(date.getTime())) return false;

    const maxDate = new Date(maxDateString);
    if (isNaN(maxDate.getTime())) return false;

    return date <= maxDate;
};
`;var ig=g`(value, start, end) => {
    if (typeof value !== "string" || typeof start !== "string" || typeof end !== "string") return false;

    const date = new Date(value);
    if (isNaN(date.getTime())) return false;

    const startDate = new Date(start);
    if (isNaN(startDate.getTime())) return false;

    const endDate = new Date(end);
    if (isNaN(endDate.getTime())) return false;

    return date >= startDate && date <= endDate;
};
`;var ag=g`(value) => {
    return typeof value === "number" && value % 2 === 0;
};
`;var sg=g`(a, b) => {
    return b.includes(a);
};
`;var lg=g`(value) => {
    return typeof value === "number" && value % 2 === 1;
};
`;var cg=g`(value) => {
    if (Array.isArray(value)) return value.length > 0;
    return value !== undefined && value !== null && value !== "";
};
`;var dg=g`(value) => {
    const result = JSON.stringify(value)
    if (typeof result === 'string') return result.replace(/<\\/(script|style)/gi, '<\\\\/$1')
    return result
};
`;var ug=g`(a, b) => {
    return (typeof a === "number" && typeof b === "number") ? a < b : false;
};
`;var pg=g`(value) => {
    return !value;
};
`;var kg=g`(value) => {
    if (typeof value !== "number") return value;
    if (!Number.isFinite(value)) return undefined;
    return Math.max(0, value) + "px";
};
`;var mg=g`(value, offset, limit) => {
    if (!Array.isArray(value)) return []
    const end = typeof limit === "number" ? offset + limit : undefined
    return value.slice(offset, end);
};
`;var fg=g`(value, prefix) => {
    if (typeof value === "string" && typeof prefix === "string") {
        return prefix + value;
    } else if (typeof value === "string") {
        return value;
    } else if (typeof prefix === "string") {
        return prefix;
    }
    return "";
};
`;var Eg=g`(value, cornerIndex) => {
    if (typeof value === "number" && Number.isFinite(value)) return Math.max(0, value) + "px";
    if (typeof value !== "string" || typeof cornerIndex !== "number") return undefined;
    const segments = value.split(" ");
    return segments[cornerIndex] || segments[cornerIndex - 2] || segments[0];
};
`;var $g=g`(value) => {
    return Array.isArray(value) ? Array.from(value).reverse() : [];
}
`;var Bg=g`(a, b) => {
    return typeof a === "string" && typeof b === "string" && a.toLowerCase().startsWith(b.toLowerCase());
};
`;var gg=g`(value, suffix) => {
    if (typeof value === "string" && typeof suffix === "string") {
        return value + suffix;
    } else if (typeof value === "string") {
        return value;
    } else if (typeof suffix === "string") {
        return suffix;
    }
    return "";
};
`;var hg=g`(value, overflow) => {
    const isNonScrollable = (o) => o === "visible" || o === "clip" || o === undefined
    return isNonScrollable(value) === isNonScrollable(overflow) ? value : undefined
}`;var Rg=g`(value) => {
    return Boolean(value);
};
`;var Ig=g`value`,Fg=g`activeLocale`;function Gg(j,A){let e=A.dedupe("sharedDateFormatter",new V(Gj.lines(g`(value, formatOptions, locale) => {`,g`  if (typeof value !== "string") return "";`,g`  const date = new Date(value);`,g`  if (isNaN(date.getTime())) return "";`,g`  const fallbackLocale = "en-US";`,g`  try {`,g`      return date.toLocaleString(locale || fallbackLocale, formatOptions);`,g`  } catch {`,g`      return date.toLocaleString(fallbackLocale, formatOptions);`,g`  }`,g`};`))),t=Xu(j.display,j.format,j.dateStyle),r={...zu[t].options,timeZone:"UTC"},o=A.dedupe("dateOptions",new V(wA(r)));return new V(Gj.lines(g`(${Ig}, ${Fg}) => {`,g`return ${V.fn(e,Ig,o,j.locale||Fg)};`,g`};`))}var Sg=g`(value) => {
    if (typeof value === "object" && value !== null && typeof value.src === "string") {
        return value.src;
    };
    return typeof value === "string" ? value : undefined;
};
`;var yg=g`(value) => {
    if (typeof value === "number" && Number.isFinite(value)) return value;
    if (typeof value !== "string") return 0;
    const parsedNumber = parseFloat(value);
    return (typeof parsedNumber === "number" && Number.isFinite(parsedNumber)) ? parsedNumber : 0;
};
`;var ES=`var(${F7}, clip)`,Cg=g`(value) => {${g.joinLines(g`if (value === "clip") return ${ES}`,g`return value`)}};`;var bg=g`(value) => {
    if (typeof value === "object" && value !== null && typeof value.src === "string") {
        return value;
    };
    return typeof value === "string" ? {src: value} : undefined;
};
`;var vg=g`(value) => {
    return typeof value === "string" ? value : String(value);
};
`;var Tg=g`(value) => {${g.joinLines(g`if (value < -1) return -1`,g`if (value > 11) return 11`,g`return value`)}};`;function Pg(j){switch(j){case"isAfter":return og;case"isBefore":return ng;case"isBetweenDates":return ig;case"contains":return V0;case"endsWith":return W0;case"equals":return z0;case"isSet":return cg;case"greaterThan":return eg;case"lessThan":return ug;case"negate":return pg;case"numberToString":return N0;case"startsWith":return Bg;case"toString":return vg;case"toNumber":return yg;case"toBoolean":return Rg;case"extractDateSegment":return X0;case"reverseArray":return $g;case"offsetAndLimitArray":return mg;case"arrayLength":return L0;case"prefix":return fg;case"suffix":return gg;case"toResponsiveImage":return bg;case"toImageSrc":return Sg;case"jsonStringify":return dg;case"htmlEscape":return tg;case"htmlUnescape":return rg;case"addImageAlt":return w0;case"toZIndex":return Tg;case"toAxisOverflow":return hg;case"toOverflowWithClipFallback":return Cg;case"numberToPixelString":return kg;case"radiusForCorner":return Eg;case"isIncludedIn":return sg;case"isEven":return ag;case"isOdd":return lg;case"getGridColumnCSSValue":return Y0;case"getGridRowCSSValue":return Ag;case"getNumericColumnGap":return jg;default:iA(j,"All constant transform names should be implemented")}}function Mg(j,A,e,t,r,o,n){switch(j.name){case"enumToDisplayName":return _0(A);case"convertFromEnum":return Q0(j,A,e,t,r,o);case"convertFromString":return U0(j,e,t,r,o);case"convertFromBoolean":return J0(j,e,t,r,o);case"arrayToArray":return q0(j);case"toDateString":return Gg(j,n);default:iA(j,"All dynamic transform names should be implemented")}}var Xj=Vr(),$S={name:"toString"},BS={name:"toNumber"},gS={name:"toBoolean"},hS={name:"toResponsiveImage"},RS={name:"toImageSrc"},IS={name:"toZIndex"},FS={name:"numberToPixelString"},GS={name:"radiusForCorner"},SS={name:"toAxisOverflow"},yS={name:"toOverflowWithClipFallback"},CS={name:"jsonStringify"},bS={name:"htmlEscape"},vS={name:"htmlUnescape"},TS={name:"addImageAlt"},PS={name:"getGridColumnCSSValue"},MS={name:"getGridRowCSSValue"},_S={name:"getNumericColumnGap"};function DS(j){return V7(j.name)}var Wt=class{constructor(A,e,t,r,o,n,a,i,s){this.fileDeclarations=A;this.componentDeclarations=e;this.imports=t;this.variables=r;this.localizedValues=o;this.links=n;this.fetches=a;this.modulesStore=i;this.type=s}wrapInTransformFunction(A,e,t,r,o){if(q7(e.name)){let n=this.fileDeclarations.dedupe(e.name,Pg(e.name));return V.fn(n,A,...t)}if(DS(e)){if(e.name==="enumToDisplayName"&&r&&r.type==="enum"){let a=this.getImportedEnumToDisplayNameIfPossible(A,r);if(a)return a}let n=Mg(e,r,o,this.variables,this.localizedValues,this.links,this.fileDeclarations);return V.fn(new V(this.fileDeclarations.dedupe(e.name,n)),A,...t)}iA(e.name,"All value transforms should be handled in wrapInTransformFunction")}getImportedEnumToDisplayNameIfPossible(A,e){let t=this.imports,r=this.modulesStore;if(!t||!r)return;let o=Bp(e);if(!o)return;let{dataIdentifier:n,enumFieldKey:a}=o;if(n===hp)return this.variables?.getLocaleName()??g`undefined`;let i=L.dataForIdentifier(n);if(!i||!i.annotations)return;let s="framerEnumToDisplayNameUtils",l=i.annotations?.[s];if(!_(l))return;let c=Number.parseInt(l,10);if(!Y(c))return;let u=oA(n);if(!Rj(u))return;let{importSpecifier:p}=uk(u,this.type,r);if(!p)return;let f=this.variables?.getLocale()??g`undefined`;switch(c){case 1:{let E=P0(a),F=t.addImport(p,{exportSpecifier:E});return V.optionalFn(F,A,f)}case 2:{let E=M0,F=t.addImport(p,{exportSpecifier:E});return V.optionalFn(g`${F}[${a}]`,A,f)}default:throw new Error(`Enum to display name utils, unsupported version: ${c}`)}}wrapInValueTransform(A,e,t,r){return this.wrapInTransformFunction(A,e,O0(e,this,this.variables,this.localizedValues),t,r)}makeTypeSafe(A,e){switch(e){case"string":case"color":return this.wrapInTransformFunction(A,$S,Xj);case"number":return this.wrapInTransformFunction(A,BS,Xj);case"boolean":return this.wrapInTransformFunction(A,gS,Xj);case"array":case"enum":case"link":case"gap":case"padding":case"borderradius":case"image":return A;default:return A}}getActiveLocaleCode(){if(!this.componentDeclarations||!this.imports)return g`undefined`;let A=this.imports.addImport("framer",{exportSpecifier:"useLocaleCode"});return this.componentDeclarations.dedupe("activeLocaleCode",V.fn(A))}createComputedValue(A,e,t){$(this.variables);let r=Wo(A)?e.cache.getVariableControlByReference(A.startValue):void 0,o=Wo(A)?this.variables.create(A.startValue):this.fetches.createFetchBinding(e,A.startValue),n;A.transforms.forEach(i=>{K7(i.name)&&(o=this.wrapInValueTransform(o,i,r,t),n=i)});let a=n?J7(n.name):null;return!a||a.length>1||a[0]!==A.outputType?this.makeTypeSafe(o,A.outputType):o}wrapInToResponsiveImage(A){return this.wrapInTransformFunction(A,hS,Xj)}wrapInToImageSrc(A){return this.wrapInTransformFunction(A,RS,Xj)}wrapInToZIndex(A){return this.wrapInTransformFunction(A,IS,Xj)}wrapInNumberToPixelString(A){return this.wrapInTransformFunction(A,FS,Xj)}wrapInRadiusForCorner(A,e){return this.wrapInTransformFunction(A,GS,[e])}wrapInToAxisOverflow(A,e){return this.wrapInTransformFunction(A,SS,[e])}wrapInToOverflowWithClipFallback(A){return this.wrapInTransformFunction(A,yS,Xj)}wrapInAddImageAlt(A,e){return this.wrapInTransformFunction(A,TS,[e])}wrapInClampRGB(A){return $(this.imports,"ValueTransformCollector: Must have imports to wrap in clampColor."),V.fn(this.imports.addImport("framer",{exportSpecifier:"clampRGB"}),A)}wrapInGetGridColumnCSSValue(A,e){return this.wrapInTransformFunction(A,PS,e?[e]:Xj)}wrapInGetGridRowCSSValue(A){return this.wrapInTransformFunction(A,MS,Xj)}wrapInGetNumericColumnGap(A){return this.wrapInTransformFunction(A,_S,Xj)}wrapInTemplateFilters(A,e){return this.makeTypeSafe(Yk(A,e,{json:t=>this.wrapInTransformFunction(t,CS,Xj),escape:t=>this.wrapInTransformFunction(t,bS,Xj),raw:t=>this.wrapInTransformFunction(t,vS,Xj)}),"string")}};function NS(j){return w(j)||uj(j)||eA(j)||gt(j)||ZA(j)}function Ng(j,A){return g`(key, locale){${g.joinLines(g`while (locale) {${g.joinLines(g`const values = ${j}[locale.id]`,g`if (values) {${g.joinLines(g`const value = ${A?g`values.read()[key]`:g`values[key]`}`,g`if (value) return value`)}}`,g`locale = locale.fallback`)}}`)}}`}var ki,A6=class{constructor(A,e,t){this.entryNode=A;this.variables=e;this.treeStore=t;I(this,"cache",{});I(this,"valueCounter",0);NA(this,ki,!1)}freeze(){FA(this,ki,!0)}add(A,e,t){$(!rA(this,ki),"Cannot add values to a frozen LocalizedValuesCollector.");let r={};if(!e||!NS(this.entryNode))return A;let o;this.variables&&(o=new Sn(this.entryNode));let n=this.treeStore.tree.root.locales??[];for(let c of n){if(!(c.id in e))continue;let u=this.createLocalizedValue(c.id,o,t);ge(u)||(r[c.id]=u)}if(Pe(r))return A;this.variables&&o&&this.variables.merge(o);let a=wA({defaultValue:A,localizedValues:r}),i=this.cache[a];if(i)return i;let s=`v${this.valueCounter++}`,l=V.fn(this.getLocalizedValueBinding,s,_A.activeLocale);if(o&&o.variables.size>0){let c=g.listFrom(o.variables);for(let u in r){let p=r[u];$(!ge(p),"Localized should not be null or undefined"),r[u]=g`({ ${c} }) => ${p}`}l=g`${l}?.({ ${c} })`}for(let c in r){let u=r[c];$(!ge(u),"Localized should not be null or undefined"),this.recordLocalizedValue(c,s,u)}return sA(A)||(l=g`${l} ?? ${A}`),this.cache[a]=l}};ki=new WeakMap;var zt,Dg=class extends A6{constructor(e,t,r,o,n,a,i,s){super(e,t,r);this.imports=o;this.declarations=n;this.fetches=a;this.modulesStore=i;this.moduleType=s;I(this,"submoduleByLocaleId",new Map);I(this,"identifier",`../${Ue("localization",this.entryNode.id)}`);I(this,"submodules");I(this,"bindings",new Er);NA(this,zt);this.submodules=new Ys(this.moduleType,this.modulesStore,this.entryNode.id)}get getLocalizedValueBinding(){return this.imports.addImport(this.identifier,{exportSpecifier:"default",importBinding:"getLocalizedValue"})}canPreloadWithSuspense(){return!eA(this.entryNode)}preloadWithSuspense(){rA(this,zt)||(FA(this,zt,this.bindings.create("usePreloadLocalizedValues")),this.declarations.component.create(V.fn(this.imports.addImport(this.identifier,{exportSpecifier:wA(rA(this,zt))}),_A.activeLocale)))}createLocalizedValue(e,t,r){let o=this.submoduleByLocaleId.get(e)??this.submodules.create(),n=new fo(this.entryNode,o.imports,o.bindings,t,this.treeStore,this.modulesStore),a=r(e,{links:n,variables:t,imports:o.imports,declarations:o.declarations,valueTransforms:new Wt(o.declarations,void 0,o.imports,t,this,n,this.fetches,this.modulesStore,this.moduleType)});if(ge(a)){o&&!this.submoduleByLocaleId.has(e)&&this.submodules.delete(o);return}return this.submoduleByLocaleId.set(e,o),this.canPreloadWithSuspense()&&this.preloadWithSuspense(),a}recordLocalizedValue(e,t,r){let o=this.submoduleByLocaleId.get(e);$(o,"Localization submodule must exist"),o.declarations.create(g`export const ${new V(t)} = ${r}`)}maybeGetUsePreloadDeclarations(e){if(!this.canPreloadWithSuspense()||!rA(this,zt))return[];let t=this.bindings.create("preload"),r=rA(this,zt);return[g`function ${t}(locale) {${g.joinLines(g`const promises = []`,g`while (locale) {${g.joinLines(g`const values = ${e}[locale.id]`,g`if (values) {${g.joinLines(g`const promise = values.preload()`,g`if (promise) promises.push(promise)`)}}`,g`locale = locale.fallback`)}}`,g`if (promises.length > 0) return Promise.all(promises)`)}}`,g`export function ${r}(locale) {${g.joinLines(g`const preloadPromise = ${t}(locale)`,g`if (preloadPromise) throw preloadPromise`)}}`]}values(e){let t={};for(let[r,o]of this.submoduleByLocaleId)if(this.canPreloadWithSuspense()){let n=e.addImport("framer",{exportSpecifier:"LazyValue"});t[r]=V.fn(g`new ${n}`,g`() => import(${o.submoduleImport})`)}else t[r]=e.addImport(o.submoduleImport,{exportSpecifier:"*",importBinding:"localizedValues"});return t}module(e){if(this.freeze(),(this.treeStore.tree.root.locales??[]).length===0||this.submoduleByLocaleId.size===0)return;let r=new $r(this.moduleType,this.modulesStore,this.bindings),o=new hr(this.bindings),n=o.dedupe("valuesByLocaleId",this.values(r));return{type:"localization",revision:e,source:g.joinSections(g.joinLines(...r.statements),...o.list(),g`export default function getLocalizedValue${Ng(n,this.canPreloadWithSuspense())}`,...this.maybeGetUsePreloadDeclarations(n)),artifacts:{submodules:this.submodules.serialize()}}}};zt=new WeakMap;var mi,pi=class extends A6{constructor(e,t,r,o,n,a,i,s,l){super(e,t,r);this.imports=o;this.bindings=n;this.declarations=a;this.fetches=i;this.modulesStore=s;this.moduleType=l;I(this,"valuesByLocaleId",{});NA(this,mi)}get getLocalizedValueBinding(){return rA(this,mi)||FA(this,mi,this.bindings.create("getLocalizedValue")),rA(this,mi)}recordLocalizedValue(e,t,r){let o=this.valuesByLocaleId[e]??{};o[t]=r,this.valuesByLocaleId[e]=o}createLocalizedValue(e,t,r){let o=new fo(this.entryNode,this.imports,this.bindings,t,this.treeStore,this.modulesStore);return r(e,{links:o,variables:t,imports:this.imports,declarations:this.declarations,valueTransforms:new Wt(this.declarations,void 0,this.imports,t,this,o,this.fetches,this.modulesStore,this.moduleType)})}list(){if(this.freeze(),(this.treeStore.tree.root.locales??[]).length===0)return[];let t=this.bindings.create("valuesByLocaleId");return[g`const ${t} = ${this.valuesByLocaleId}`,g`function ${this.getLocalizedValueBinding} ${Ng(t,!1)}`]}};mi=new WeakMap;var Ei,fi=class{constructor(A,e,t,r,o,n,a){this.entryNode=A;this.treeStore=e;this.variables=t;this.declarations=r;this.bindings=o;this.imports=n;this.assets=a;NA(this,Ei,new Map);I(this,"preloadDependencyTree",new Map)}command(A){let e=rA(this,Ei).get(A);if(e)return e;let t=this.bindings.create("pre"+A);return rA(this,Ei).set(A,t),t}addQuery(A,e,t){if(!eA(this.entryNode))return;let{destructured:r,dependencies:o}=this.getVariableDependencies(t),n=g`(${Og(this.command("query"),r)}) => ${V.fn(this.command("query"),e)}`;this.addStatement("query",A,o,V.fn(this.declarations.dedupe("query",n),this.command("query"),r))}addFetch(A,e){if(!eA(this.entryNode))return;let{usedVariables:t}=Bd(e,this.variables);aA(e.controlProp.value)&&t.push(e.controlProp.value);let{destructured:r,dependencies:o}=this.getVariableDependencies(t),n=g`(${Og(this.command("fetch"),r)}) => ${V.fn(this.command("fetch"),Xs(e,this.variables,this.assets,void 0))}`;this.addStatement("fetch",A,o,V.fn(this.declarations.dedupe("query",n),this.command("fetch"),r))}createPromiseList({fetches:A,children:e},t=!1){let r=[];if(t)for(let o of A)r.push(o);for(let[,o]of e){for(let a of o.fetches)r.push(a);if(!o.value)continue;let n=o.value;if(o.children.size===0){r.push(n);continue}r.push(g`${n}.then(async collection => {await Promise.all(collection.flatMap((${LS(o.usedVariables)}) => (${this.createPromiseList(o)})))})`)}return g`[${g.listFrom(r)}]`}getHook(){if(!eA(this.entryNode))return{variants:new Set,hook:void 0};let A={},e=[],t=new Set;for(let[p,f]of this.preloadDependencyTree){if(f.children.size===0&&f.fetches.size===0||!f.variantHasAnyFetches)continue;t.add(p);let E=f.usedVariables.map(F=>this.variables.create(F));e.push(...E),A[p]=this.declarations.dedupe("preload",g`async (${this.command("query")}, ${this.command("fetch")}, ${Rd(E)??g`props`}) => await Promise.all(${this.createPromiseList(f,!0)})`)}if(!t.size)return{variants:new Set,hook:void 0};let r=this.declarations.dedupe("preloadStatements",A),o=this.imports.addImport("react",{exportSpecifier:"*",importBinding:"React"}),n=this.imports.addImport("framer",{exportSpecifier:"usePreloadQuery"}),a=this.imports.addImport("framer",{exportSpecifier:"usePrefetch"}),i=g`variant`,s=g`gestures`,l=g`clearLoadingVariant`,c=g`setGestureState`,u=this.declarations.dedupe("useLoadingVariant",g`(${i}, ${s}, ${l}, ${c}, props?: Record<string, unknown>) => {${g.joinLines(g`const prequery = ${V.fn(n)}`,g`const prefetch = ${V.fn(a)}`,g`${o}.useEffect(() => {${g.joinLines(g`const promise = ${r}[${i}]`,g`if (!promise || !${s}?.[${i}]?.loading) return`,g`promise(prequery, prefetch, props)`,g`.then(() => ${V.fn(l)})`,g`.catch(() => ${V.fn(c,{isError:!0})})`)}}, [${i}])`)}}`);return{variants:t,hook:p=>V.fn(u,_A.baseVariant,p,_A.clearLoadingGesture,_A.setGestureState,Rd(e))}}addStatement(A,e,t,r){let o=this.treeStore.treeIndex.getGroundNodeIdFor(e.id),n=this.treeStore.tree.get(o);if(!n||!MA(n)||Va(n.gesture))return;let a=xg(this.preloadDependencyTree,n.id);A==="fetch"&&(a.variantHasAnyFetches=!0);let i=t.get(this.entryNode.id);i&&a.usedVariables.push(...i);let s=a;for(let l of xS(e,t,A==="fetch")){let c=xg(s.children,l);if(l===e.id){A==="query"&&(c.value=r),A==="fetch"&&c.fetches.add(r);for(let[p,f]of t){let E=c.dependencies.get(p)??[];E.push(...f),c.dependencies.set(p,E)}}let u=t.get(l);u&&c.usedVariables.push(...u),s.children.set(l,c),s=c}this.preloadDependencyTree.set(n.id,a)}getVariableDependencies(A){let e=[],t=new Map;for(let r of A)e.push(this.variables.create(r)),OS(t,r.providerId??this.entryNode.id,r);return{destructured:Rd(e),dependencies:t}}};Ei=new WeakMap;function xS(j,A,e){if(j.cache.ancestorRepeaterIds){if(e){let t=[...j.cache.ancestorRepeaterIds,j.id];for(let r=j.cache.ancestorRepeaterIds.length-1;r>=0;r--){let o=j.cache.ancestorRepeaterIds[r];if(o&&A.has(o))break;t.splice(r,1)}return t}return[...j.cache.ancestorRepeaterIds,j.id]}return[j.id]}function OS(j,A,e){let t=j.get(A)??[];t.push(e),j.set(A,t)}function wS(j){return{id:j,value:void 0,dependencies:new Map,usedVariables:[],children:new Map,fetches:new V.Set,variantHasAnyFetches:!1}}function xg(j,A){return j.get(A)??wS(A)}function Og(...j){let A=[];for(let e of j)e&&A.push(wA(e));return new V(A.join(", "))}function Rd(j){if(j.length!==0)return j.reduce((A,e)=>(A[wA(e)]=e,A),{})}function LS(j){return j.length===0?g``:j.reduce((A,e)=>(A[e.id]=$o(e.id,e.providerId,!1),A),new Nj)}function Id(j,A){if(j===void 0)return"";let e=`<${A}>${j}</${A}>`,r=An(e).querySelector(A);return r instanceof HTMLElement?r.innerHTML:""}function wg(j,A){let e={headStart:"",headEnd:"",bodyEnd:"",bodyStart:""};for(let t of gm){let r=[],o=j[t];if(o&&r.push(o),A)for(let n in A){let a=A[n]?.[t];a?.html&&!a.disabled&&r.push(`<!-- Plugin: ${n} --> ${a.html}`)}e[t]=r.map(n=>qS(n,t)).join(`
`)}return e}function qS(j,A){if(A==="headStart"||A==="headEnd")return Id(j,"head");if(A==="bodyStart"||A==="bodyEnd")return Id(j,"body");_i(A)}var Fd=j=>j;function MeA(j){return j.filter(ce)}var j6=g`params`,Lg={type:"siteMetadata",localIdName:"siteMetadata",localId:Ue("siteMetadata","siteMetadata")};function ltA(j){return{type:"webPageMetadata",localIdName:j,localId:Ue("webPageMetadata",j)}}var ctA=Fd(async(j,A)=>{let{assetMap:e,treeStore:t,modulesStore:r}=A,o=new di(e),n=new Er,a=new $r("siteMetadata",r,n),i=new Sn(j),s=new hr(n),l=new fo(j,a,n,void 0,t,r),c=new fi(j,t,i,s,n,a,o),u=new ui(n,i,c,o,l),p=new pi(j,i,t,a,n,s,u,r,"siteMetadata"),f=new Wt(s,void 0,a,i,p,void 0,u,r,"siteMetadata"),E=Vg(j,o,f,i,p,void 0,void 0);return[{type:"siteMetadata",revision:void 0,source:Kg(j,E,a,s,p,f,i,void 0),artifacts:{assets:o.keys}}]}),dtA=Fd(async(j,A,e)=>{let{treeStore:t,modulesStore:r,assetMap:o}=A,{serializationId:n}=e,a=new di(o),i=new Er,s=new $r("webPageMetadata",r,i),l=new Sn(j),c=new hr(i),u=new fo(j,s,i,void 0,t,r),p=new fi(j,t,l,c,i,s,a),f=new ui(i,l,p,a,u),E=new pi(j,l,t,s,i,c,f,r,"webPageMetadata"),F=new Wt(c,void 0,s,l,E,void 0,f,r,"webPageMetadata"),h=j.getVariableControlMap(t.tree,L,L.activeBundleHash),S=Vg(j,a,F,l,E,VS(t.tree,j,s),KS(s));S.viewport=await JS(j);let v=Object.entries(j.getBreakpointValues()).map(([T,N])=>({hash:Ap(T),mediaQuery:Xk(N)}));S.breakpoints=v;let P=pk(j);return S.elements=P,S.serializationId=n,[{type:"webPageMetadata",source:Kg(j,S,s,c,E,F,l,h),artifacts:{assets:a.keys},revision:j.moduleSourceRevision}]}),qg=/^[a-z_$][\w.$]*$/iu;function utA(j){let A=new Set;function e(t){let r=yl(),o=t.matchAll(r);for(let[,n]of o)n&&qg.test(n)&&A.add(n)}for(let t in j.webMetadata){let r=t,o=j.webMetadata[r];switch(r){case"title":case"description":case"socialImage":_(o)&&e(o),aA(o)&&A.add(o.id);break;case"favicon":case"faviconDark":case"appleTouchIcon":case"googleAnalyticsTrackingId":case"reducedMotion":case"language":case"languageTitle":case"noIndex":case"noIndexSite":case"canonicalURL":case"customCanonicalURL":case"optOutOfHTMLPlugin":case"automaticLocale":case"preserveQueryParams":case"enableFormsUTMTracking":break;default:}}for(let t in j.customHTML){let r=t,o=j.customHTML[r];switch(r){case"headStart":case"headEnd":case"bodyStart":case"bodyEnd":_(o)&&e(o);break;default:}}if(j.titleLocalized)for(let t of Object.values(j.titleLocalized))_(t.value)&&e(t.value);if(j.descriptionLocalized)for(let t of Object.values(j.descriptionLocalized))_(t.value)&&e(t.value);return A}function Vg(j,A,e,t,r,o,n){let a={},i=r.add(Xt(j,j.webMetadata?.title,e,t)??o,j.titleLocalized,(u,p)=>($(p.variables),Xt(j,j.titleLocalized?.[u]?.value,p.valueTransforms,p.variables)));sA(i)||(a.title=i);let s=r.add(Xt(j,j.webMetadata?.description,e,t)??n,j.descriptionLocalized,(u,p)=>($(p.variables),Xt(j,j.descriptionLocalized?.[u]?.value,p.valueTransforms,p.variables)));if(sA(s)||(a.description=s),j.webMetadata?.favicon){let u=A.resolve(j.webMetadata.favicon);$(u,"Favicon is not a valid asset reference"),a.favicon=u.src}let l=j.webMetadata?.socialImage;if(aA(l)){let u=Zj(l.id,j.id),p=t.create(u);a.socialImage=e.wrapInToImageSrc(p)}else if(l){let u=A.resolve(l);$(u,"Social image is not a valid asset reference"),a.socialImage=u.src}j.webMetadata?.noIndex===!0?a.robots="noindex":a.robots="max-image-preview:large",j.webMetadata?.noIndexSite!==void 0&&(a.framerSearch={index:!j.webMetadata?.noIndexSite});let c=wg(j.customHTML??{},gt(j)?j.pluginCustomHTML:void 0);if(c.headStart){let u=Xt(j,c.headStart,e,t,"escape");u&&(a.customHTMLHeadStart=u)}if(c.headEnd){let u=Xt(j,c.headEnd,e,t,"escape");u&&(a.customHTMLHeadEnd=u)}if(c.bodyStart){let u=Xt(j,c.bodyStart,e,t,"escape");u&&(a.customHTMLBodyStart=u)}if(c.bodyEnd){let u=Xt(j,c.bodyEnd,e,t,"escape");u&&(a.customHTMLBodyEnd=u)}return a}function Kg(j,A,e,t,r,o,n,a){let i=n.variableIdsByProviderId.get(j.id),s=[];for(let c of i??[]){let u=g`${j6}?.[${c}]`,p=a?.get(c);if(p&&p.type==="enum"){let F=o.wrapInValueTransform(u,{name:"enumToDisplayName"},p);u=g`${u} !== undefined ? ${F} : undefined`}let f=$o(c,j.id,!0),E=g`const ${f} = ${u}`;s.push(E)}let l=g.joinLines(g`export default function metadata(${j6}, ${_A.activeLocale}) {`,...s,g`return ${A}`,g`}`);return g.joinSections(g.linesFrom(e.statements),...r.list(),...t.list(),l,g`export const metadataVersion = 1`)}function Xt(j,A,e,t,r){if(ge(A))return;let o=yl();return kr.replaceAll(A,o,(n,a)=>{let[i,s]=Zk(a,r);if(!qg.test(i))return n;let l=Zj(i,j.id),c=t.create(l),u=c;return u=e.wrapInTemplateFilters(u,s),g`${c} !== undefined ? ${u} : ${n}`})}function ptA(j,A,e){let t=e?.title,r=e6(j,A);return t||r}function VS(j,A,e){let t=e.addImport(`../${Lg.localId}`,{exportSpecifier:"default",importBinding:"siteMetadata"}),r=g`${t}(${j6}, ${_A.activeLocale}).title`,o=e6(j,A);return g`${r} || ${o}`}function KS(j){let A=j.addImport(`../${Lg.localId}`,{exportSpecifier:"default",importBinding:"siteMetadata"});return g`${A}(${j6}, ${_A.activeLocale}).description`}function e6(j,A){if(Wj(A)){let r=L.dataForIdentifier(A.dataIdentifier);if(r?.name)return r.name+" Detail"}let e=kk(j,A);return Ka(e??"/")}async function JS(j){if(w(j)){let A=j.isLoaded()?j:await j.load();return A?A.getReplicaVariants().length>0?"width=device-width":`width=${A.getPrimaryVariant().width}`:"width=device-width"}return"width=device-width"}function mj(j,A=!1){let e=(A?Bo(j):j).trim();return e===""?0:e.split(/\W+\b/).length}function RtA(j){rr(H6(j),"Array gallery control must be Array of Object controls");let A=j.control,e;for(let t in A.controls){rr(!e,"Multiple item properties found in gallery control");let r=A.controls[t];rr(r?.type==="responsiveimage"),e=[t,r]}return rr(e,"Gallery control must have at least one item property"),e}function ItA(j,A){if(!tn(A)||!A.value)return;let e=A.value[j];if(e?.type==="image")return e}function FtA(j){return j?j.filter(A=>!HS(A)):[]}function HS(j){if(!tn(j)||!j.value)return!1;let A=Object.values(j.value);if(A.length!==1)return!1;let e=A[0];return Eu(e)?sA(e.value):!1}function Jg(j){if(!H6(j))return!1;let A=Object.values(j.control.controls);return A.length!==1?!1:A[0]?.type==="responsiveimage"}function Hg(j){return`${j??"Field"} is required`}function Qg(j,A){return`Exceeded max length by ${Zp(j-A,"character","characters")}`}function btA(j){return`Must have at least ${j.minCount} ${Ug(j)}`}function vtA(j){return`Must have at most ${j.maxCount} ${Ug(j)}`}var TtA="Slug value is already taken and must be unique";function Ug(j){return Jg(j)?"images":"items"}function Wg(j){let A=Dk(j);for(let e of A.querySelectorAll("*"))e.tagName!=="BR"&&(e.removeAttribute("class"),e.removeAttribute("style"),e.removeAttribute("data-styles-preset"));return A.innerHTML}function FrA(j){return j==="hidden"?null:j}var GrA=["new","needsReview","done","hidden"],QS="controlPropKey";function SrA(j){return QS in j}function yrA(j){return"groups"in j}var US="collectionNodeId";function CrA(j){return US in j}var WS={string:!0,richtext:!0,image:!0,enum:!0,link:!0,slug:!0};function zS(j){return j in WS}function Yg(j){return zS(j.type)}var XS={string:!0,richtext:!0,image:!0,link:!0};function Zg(j){return j in XS}function YS(j){return j?j.type==="richtext"?!0:j.type==="RichTextNode"?j.textType==="rich-text":!1:!1}function brA(j){return j?j.type==="image"||j.type==="FrameNode":!1}function vrA(j){return j?j.type==="nodeLink"||j.type==="link":!1}function TrA(j){return j?j.type==="RootNode"||j.type==="WebPageNode":!1}function PrA(j){return j?.type==="slug"||j?.type==="RouteSegmentNode"}function ZS(j){return ge(j)||j===""||ef(j)}function MrA(j,A){if(!j||YS(j))return!1;if(j.value.includes(`
`))return!0;let e=j.localizedValues[A.id];return e?!!e.value?.includes(`
`):!1}function Ah(j,A,e){return A?A.hash!==e||A.needsReview?"needsReview":"done":ZS(j)?"done":"new"}function nj(j,A,e,t,r,o){return Object.fromEntries(A.map(n=>{let a=e[n.id];if(r?.[n.id])return[n.id,"warning"];if(o){let i=o(n);if(i)return[n.id,i]}return[n.id,Ah(j,a,t)]}))}function Sd(j){return A=>j[A.id]?null:"done"}function yd(j,A,e){return t=>{if(_(j)&&A){let r=A[t.id];if(r)return Ah(j,r,e)}return null}}var KA={};Object.freeze(KA);function Ay(j,A,e,t,r,o,n){let a=(i,s,l)=>{if(aA(s)||!_(s)||s.length===0&&!l)return;let c=xA(s),u=l??KA,p=nj(s,o,u,c);n.push({type:j.name,transformId:j.id,keyPath:Qt(A,i),nodeId:r.id,scopeId:t.id,property:i,value:s,controlPropKey:e,controlPropName:void 0,ancestorControlKeyPath:void 0,valueWordCount:mj(s),hash:c,localizedValues:u,localizedValueStatuses:p,managedByPluginButUserEditable:!1})};a("truthy",j.truthy,j.truthyLocalized),a("falsy",j.falsy,j.falsyLocalized)}function jy(j,A,e,t,r,o,n,a){if(A.outputType!=="string")return;for(let c of A.cases){if(Wo(j)&&j.startValue.id===gp)break;if(aA(c.to)||!_(c.to)||c.to.length===0&&!c.toLocalized)continue;let u=xA(c.to),p=c.toLocalized??KA,f=nj(c.to,n,p,u),E=Qt(e,"cases");a.push({type:"convertFromEnum",transformId:A.id,keyPath:ci(E,c.id),nodeId:o.id,scopeId:r.id,caseId:c.id,isDefaultCase:!1,value:c.to,ancestorControlKeyPath:void 0,controlPropKey:t,controlPropName:void 0,valueWordCount:mj(c.to),hash:u,localizedValues:p,localizedValueStatuses:f,managedByPluginButUserEditable:!1})}if(!A.default||aA(A.default)||!_(A.default))return;let i=xA(A.default),s=A.defaultLocalized??KA,l=nj(A.default,n,s,i);a.push({type:"convertFromEnum",transformId:A.id,keyPath:Qt(e,"default"),nodeId:o.id,scopeId:r.id,caseId:null,isDefaultCase:!0,ancestorControlKeyPath:void 0,value:A.default,controlPropKey:t,controlPropName:void 0,valueWordCount:mj(A.default),hash:i,localizedValues:s,localizedValueStatuses:l,managedByPluginButUserEditable:!1})}function r6(j,A,e,t,r,o,n){if(!(!Q7(e.outputType)||e.outputType!=="string")){for(let a of e.transforms)if(H7(a))switch(a.name){case"convertFromEnum":{jy(e,a,t,r,j,A,o,n);break}case"convertFromBoolean":{Ay(a,t,r,j,A,o,n);break}case"prefix":case"suffix":{if(aA(a.value)||a.value.length===0&&!a.valueLocalized)return;let i=xA(a.value),s=a.valueLocalized??KA,l=nj(a.value,o,s,i);n.push({type:a.name,transformId:a.id,keyPath:ci(t,a.id),controlPropKey:r,controlPropName:void 0,ancestorControlKeyPath:void 0,nodeId:A.id,scopeId:j.id,value:a.value,valueWordCount:mj(a.value),hash:i,localizedValues:s,localizedValueStatuses:l,managedByPluginButUserEditable:!1});continue}default:}}}function ey(j,A,e,t,r,o){if(Wr(e.textContent)){if(!UA(j,e,"textContent"))return;r6(A,e,e.textContent,e.id,e.id,t,r);return}if(qA(e.htmlContent)||qA(e.textContent))return;let n=UA(j,e,"html"),a=UA(j,e,"htmlLocalized");if(!n&&!a)return;let i=e.html,s=Bo(i),l=tf(i),c=o==="canvasHtmlAsTextContentIfPossible"?l:"rich-text",u=c==="text"?s:Wg(i);if(c==="text"&&!a&&jj(e)){let h=j.getNode(e.originalid);if(h&&Bo(h.html)===s)return}let f=xA(l===c?u:s),E=e.htmlLocalized??KA,F=nj(u,t,E,f);r.push({type:"RichTextNode",keyPath:`${e.id}_html`,nodeId:e.id,scopeId:A.id,value:u,valueWordCount:mj(u,!0),textType:c,hash:f,localizedValues:E,localizedValueStatuses:F,managedByPluginButUserEditable:!1,inherited:!a})}function zg(j){if(gt(j))return"RootNode";if(w(j))return"WebPageNode";iA(j)}function Xg(j,A,e){let t={};for(let r of j){let o=A[r.id];if(!o||!o.value)continue;let n=Am({collectionData:e,getCollectionDataForIdentifier:L.dataForIdentifier.bind(L),includeCollectionReferences:OA.isOn("collectionReferencesInMetadata"),type:"id",value:o.value});n&&(t[r.id]=n)}return t}function jh(j,A,e,t,r){let o=null;if(w(e)&&(o=L.dataForIdentifier(e.dataIdentifier)),e.webMetadata?.title||e.titleLocalized){let n=e.webMetadata?.title??j.root.webMetadata?.title??"",a=xA(n),i=e.titleLocalized??KA,s=Xg(t,i,o),l=nj(n,t,i,a,s);r.push({type:zg(e),keyPath:`${e.id}_title`,nodeId:e.id,scopeId:A.id,value:n,valueWordCount:mj(n),hash:a,localizedValues:i,localizedValueStatuses:l,managedByPluginButUserEditable:!1,key:"title",dataIdentifier:zr(e)?e.dataIdentifier:void 0,warnings:s})}if(e.webMetadata?.description||e.descriptionLocalized){let n=e.webMetadata?.description??j.root.webMetadata?.description??"",a=xA(n),i=e.descriptionLocalized??KA,s=Xg(t,i,o),l=nj(n,t,i,a,s);r.push({type:zg(e),keyPath:`${e.id}_description`,nodeId:e.id,scopeId:A.id,value:n,valueWordCount:mj(n),hash:a,localizedValues:i,localizedValueStatuses:l,managedByPluginButUserEditable:!1,key:"description",dataIdentifier:zr(e)?e.dataIdentifier:void 0,warnings:s})}}function ty(j,A,e,t,r){if(!no(e)||!_(e.fillImage)||e.fillImage.length===0)return;let o=UA(j,e,"fillImage"),n=UA(j,e,"fillImageLocalized"),a=UA(j,e,"altAttribute"),i=UA(j,e,"altAttributeLocalized");if(!o&&!n&&!a&&!i)return;let s=e.altAttribute??ba,l=xA(s),c=e.altAttributeLocalized??KA,u=e.fillImage,p=xA(u),f=e.fillImageLocalized??KA,E=nj(s,t,c,l,void 0,yd(u,f,p));r.push({type:"FrameNode",keyPath:`${e.id}_fillImageLocalized`,nodeId:e.id,scopeId:A.id,value:s,valueWordCount:mj(s),hash:l,localizedValues:c,localizedValueStatuses:E,managedByPluginButUserEditable:!1,inherited:!i,supportsAlt:!0,image:u,imageHash:p,imageLocalizedValues:f,imageInherited:!n,positionX:y6(e.fillImagePositionX)?e.fillImagePositionX:void 0,positionY:y6(e.fillImagePositionY)?e.fillImagePositionY:void 0,supportsFocalPoint:!0})}function eh(j,A,e,t){if(!OA.isOn("localizedLinks"))return;let r=A.getLink();if(!ja(r))return;let o=r.url,n=xA(o),a=A.linkLocalized??KA,i=nj(o,e,a,n,void 0,Sd(a));t.push({type:"nodeLink",keyPath:`${A.id}_linkLocalized`,nodeId:A.id,scopeId:j.id,value:o,valueWordCount:o?1:0,hash:n,localizedValues:a,localizedValueStatuses:i,managedByPluginButUserEditable:!1,aiTranslationDisabled:!0})}function ry(j,A,e,t,r){ty(j,A,e,t,r),eh(A,e,t,r)}function o6(j){return!!(Zg(j)||j==="array"||j==="object")}function t6(j,A,e){return`${j}.${A}.${e??""}`}function oy(j){if(w(j)&&la(j))return j.layoutTemplateIdentifier;if(W(j))return j.codeComponentIdentifier}function ny(j,A,e,t,r){let o=oy(e);if(!o)return;let n=L.componentForIdentifier(o);if(!n)return;let a=e.getControlProps(n.properties);function i(s,l,c,u=void 0){let p=l.type;if(p==="array"&&G7(l.value)){if(c.type!=="array")return;let f=c.control;for(let E of l.value){if(!o6(E.type))continue;let F=ci(u,E.id);i(s,E,f,F)}}if(p==="object"&&_j(l.value)){if(c.type!=="object")return;for(let f in l.value){let E=l.value[f];if(!E||!o6(E.type))continue;let F=Qt(u,f),h=c.controls[f];h&&i(s,E,h,F)}}if(Zg(p))switch(p){case"string":{if(!UA(j,e,VA(s))||c.type==="string"&&c.preventLocalization||(Wr(l.value)&&r6(A,e,l.value,Qt(e.id,s),s,t,r),!_(l.value)))break;let f=l.value,E=xA(f),F=l.valueLocalized??KA,h=nj(f,t,F,E);r.push({type:"string",keyPath:t6(e.id,s,u),controlPropKey:s,controlPropName:c.title||Xe(s),ancestorControlKeyPath:u,nodeId:e.id,scopeId:A.id,value:f,valueWordCount:mj(f),hash:E,localizedValues:F,localizedValueStatuses:h,managedByPluginButUserEditable:!1});break}case"link":{if(!OA.isOn("localizedLinks")||!UA(j,e,VA(s))||(Wr(l.value)&&r6(A,e,l.value,Qt(e.id,s),s,t,r),!ja(l.value)))break;let f=l.value.url,E=xA(f),F=l.valueLocalized??KA,h=nj(f,t,F,E,void 0,Sd(F));r.push({type:"link",keyPath:t6(e.id,s,u),controlPropKey:s,controlPropName:c.title||Xe(s),ancestorControlKeyPath:u,nodeId:e.id,scopeId:A.id,value:f,valueWordCount:f?1:0,hash:E,localizedValues:F,localizedValueStatuses:h,managedByPluginButUserEditable:!1,aiTranslationDisabled:!0});break}case"richtext":{if(p!=="richtext"||!_(l.value)||c.type==="richtext"&&c.preventLocalization||!UA(j,e,VA(s)))break;let f=l.value,E=xA(f),F=l.valueLocalized??KA,h=nj(f,t,F,E);r.push({type:"richtext",keyPath:t6(e.id,s,u),controlPropKey:s,controlPropName:c.title||Xe(s),ancestorControlKeyPath:u,nodeId:e.id,scopeId:A.id,value:f,valueWordCount:mj(f,!0),hash:E,localizedValues:F,localizedValueStatuses:h,managedByPluginButUserEditable:!1});break}case"image":{if(!l||l.type!=="image"||!_(l.value)||c.type!=="responsiveimage"&&c.type!=="image"||!UA(j,e,VA(s)))break;let f=c.type==="responsiveimage",E=l.alt??ba,F=xA(E),h=f?l.altLocalized??KA:KA,S=l.value,v=xA(S),P=l.valueLocalized??KA,T=nj(E,t,h,F,void 0,yd(S,P,v)),N=c.type==="responsiveimage";r.push({type:"image",keyPath:t6(e.id,s,u),controlPropKey:s,controlPropName:c.title||Xe(s),ancestorControlKeyPath:u,nodeId:e.id,scopeId:A.id,value:E,valueWordCount:mj(E),hash:F,localizedValues:h,localizedValueStatuses:T,managedByPluginButUserEditable:!1,supportsAlt:f,image:S,imageHash:v,imageLocalizedValues:P,supportsFocalPoint:N,positionX:N?l.positionX:void 0,positionY:N?l.positionY:void 0});break}default:}}for(let s in a){let l=a[s];if(!l)continue;let c=n.properties[s];c&&i(s,l,c)}}function iy(j,A,e,t){let r=A.formSelectOptions;if(!(!r||r?.length===0))for(let o of r){let n=o.title;if(!n)continue;let a=o.titleLocalized??KA,i=xA(n),s=nj(n,e,a,i);t.push({type:"FormSelectNode",keyPath:`${A.id}_${o.id}`,nodeId:A.id,optionId:o.id,scopeId:j.id,value:n,valueWordCount:mj(n),hash:i,localizedValues:a,localizedValueStatuses:s,managedByPluginButUserEditable:!1})}}function ay(j,A,e,t,r){let o=`${e.id}_placeholder`;if(qA(e.formInputPlaceholder)){if(aA(e.formInputPlaceholder)||!UA(j,e,"formInputPlaceholder"))return;r6(A,e,e.formInputPlaceholder,o,e.id,t,r);return}if(!e.formInputPlaceholder||!UA(j,e,"formInputPlaceholder"))return;let n=xA(e.formInputPlaceholder),a=e.formInputPlaceholderLocalized??KA;r.push({keyPath:o,type:"FormPlainTextInputNode",nodeId:e.id,scopeId:A.id,value:e.formInputPlaceholder,valueWordCount:mj(e.formInputPlaceholder),hash:xA(e.formInputPlaceholder),localizedValues:a,localizedValueStatuses:nj(e.formInputPlaceholder,t,a,n),managedByPluginButUserEditable:!1})}function sy(j,A,e,t,r,o){w(e)&&jh(j,A,e,t,r),QA(e)&&ey(j,A,e,t,r,o),(W(e)||w(e))&&ny(j,A,e,t,r),pA(e)&&ry(j,A,e,t,r),(ht(e)||RA(e))&&eh(A,e,t,r),Hi(e)&&ay(j,A,e,t,r),Qi(e)&&iy(A,e,t,r)}function Bi(j,A,e,t,r,o){if(A.mutable)return;let n=A.cache.localizationSourceGroup;if(n&&!(n.update!==A.update||n.componentHash!==t||n.locales!==e||n.parentVariables!==r||!Yj(n.subGroups,o))&&!(_a(j,A)&&n.includedLocales!==A.includedLocales))return n}function gi(j,A,e,t,r,o,n){A.mutable||(A.cache.localizationSourceGroup={update:A.update,locales:t,componentHash:r,parentVariables:o,group:e,includedLocales:_a(j,A)?A.includedLocales:void 0,subGroups:n})}function ly(j,A,e,t,r,o){let n=o==="canvasHtmlAsTextContentIfPossible";if(n){let l=Bi(j,A,e,t,lt,void 0);if(l){l.group&&r.push(l.group);return}}let a=[];for(let l of A.walk())sy(j,A,l,e,a,o);let i=_a(j,A),s;if(a.length>0){let l=w(A)?e6(j,A):A.name??"Unknown";w(A)&&A.abTestingParentId&&(l=`${l} \xB7 ${A.name||Ce(A)}`),s={type:"sourceGroup",name:l,groupType:w(A)?"page":ZA(A)?"template":"component",nodeId:A.id,supportsLocaleVisibility:i,includedLocaleIds:i?ql(j,A):void 0,items:a},r.push(s)}n&&gi(j,A,s,e,t,lt,void 0)}function $i(j,A,e){return e?`${j}.${A}.${e}`:`${j}.${A}`}function cy(j){return j.type!=="rich-text"?j.value.length:Bo(j.value).length}function Gd(j,A,e){let t=e.required,r=e.type==="link"?void 0:e.options?.maxLength;if(!t&&!Y(r))return;let o={};for(let n of j){let a=A[n.id];if(!D6(a))continue;let i=cy(a);t&&i===0?o[n.id]=Hg(e.name):Y(r)&&i>r&&(o[n.id]=Qg(i,r))}return o}function dy(j,A,e){let t={};for(let r of j){let o=A[r.id];if(!D6(o))continue;let a=e[r.id]?.get(o.value);a&&a>1&&(t[r.id]="Each item in the Collection must have a unique slug")}return t}function uy(j,A,e,t,r,o,n,a){let i=r.type;switch(i){case"string":{if(aa(r))return;let s;if(n){if(n.type!==i||!_(n.value))return;s=n.value}else{if(Du(r))return;s=r.initialValue}let l=xA(s),c=n?.valueLocalized??KA,u=Gd(e,c,r),p=nj(s,e,c,l,u);return{type:"string",keyPath:$i(A,o,t),nodeId:A,scopeId:j,controlPropKey:o,controlPropName:r.name,ancestorControlKeyPath:t,value:s,valueWordCount:mj(s),hash:l,localizedValues:c,localizedValueStatuses:p,managedByPluginButUserEditable:r.userEditable??!1,warnings:u}}case"link":{if(!n||n.type!==i||!ja(n.value)||!OA.isOn("localizedLinks"))return;let s=n.value.url,l=xA(s),c=n?.valueLocalized??KA,u=Gd(e,c,r),p=nj(s,e,c,l,u);return{type:"link",keyPath:$i(A,o,t),nodeId:A,scopeId:j,controlPropKey:o,controlPropName:r.name,ancestorControlKeyPath:t,value:s,valueWordCount:s?1:0,hash:l,localizedValues:c,localizedValueStatuses:p,managedByPluginButUserEditable:r.userEditable??!1,warnings:u,aiTranslationDisabled:!0}}case"slug":{$(n?.type==="string","expected slug controlType to be a string"),$(_(n.value),"expected slug value to be a string");let s=n.value,l=xA(s),c=n?.valueLocalized??KA,u=dy(e,c,a),p=nj(s,e,c,l,u,Sd(c));return{type:"slug",keyPath:$i(A,o,t),controlPropKey:o,controlPropName:r.name,ancestorControlKeyPath:t,nodeId:A,scopeId:j,value:s,valueWordCount:mj(s),hash:l,localizedValues:c,localizedValueStatuses:p,managedByPluginButUserEditable:r.userEditable??!1,warnings:u}}case"richtext":{let s;if(aa(r))return;if(n){if(n.type!==i||!_(n.value))return;s=n.value}else s=r.initialValue;let l=xA(s),c=n?.valueLocalized??KA,u=Gd(e,c,r),p=nj(s,e,c,l,u);return{type:"richtext",keyPath:$i(A,o,t),nodeId:A,scopeId:j,controlPropKey:o,controlPropName:r.name,ancestorControlKeyPath:t,value:s,valueWordCount:mj(s,!0),hash:l,localizedValues:c,localizedValueStatuses:p,managedByPluginButUserEditable:r.userEditable??!1,warnings:u}}case"image":{let s;if(n){if(n.type!==i||!_(n.value))return;s=n.value}else{if(!_(r.initialValue))return;s=r.initialValue}let l=xA(s),c=n?.valueLocalized??KA,u=n?.alt??ba,p=xA(u),f=n?.altLocalized??KA,E=nj(u,e,f,p,void 0,yd(s,c,l));return{type:"image",keyPath:$i(A,o,t),nodeId:A,scopeId:j,controlPropKey:o,controlPropName:r.name,ancestorControlKeyPath:t,value:u,valueWordCount:mj(u),hash:p,localizedValues:f,localizedValueStatuses:E,supportsAlt:!0,image:s,imageHash:l,imageLocalizedValues:c,managedByPluginButUserEditable:r.userEditable??!1,supportsFocalPoint:!0,positionX:n?.positionX,positionY:n?.positionY}}case"enum":return;default:}}function py(j,A,e,t,r){let o=A.id;function n(a,i,s,l=void 0){if(i&&i.type==="array"){if(s.type!=="array"||qA(i.value))return;for(let u of i.value){if(!o6(u.type)||!tn(u)||!u.value)continue;let p=ci(l,u.id);for(let f of s.itemVariables){let E=u.value[f.id];if(!E||!o6(E.type))continue;let F=Qt(p,f.id);n(a,E,f,F)}}}if(!Yg(s))return;let c=uy(o,A.id,e,l,s,a,i,r);c&&t.push(c)}for(let a of j.variables){if(a.type==="divider")continue;let i=A.getControlProp(a.id);n(a.id,i,a)}}function ky(j,A,e,t,r,o){let n=Bi(j,e,t,st,A.variables,void 0);if(n){n.group&&o.push(n.group);return}let a=[],i=ql(j,e);if(py(A,e,t,a,r),a.length>0){for(let l of a)l.insetLevel=1;let s={type:"sourceGroup",groupType:"collectionItem",collectionName:A.name??"Unknown",collectionNodeId:A.id,supportsLocaleVisibility:!0,includedLocaleIds:i,name:Qm(A,e)??"Unknown",nodeId:e.id,items:a};gi(j,e,s,t,st,A.variables,void 0),o.push(s)}}function my(j,A,e,t){let r=e.name,o=xA(r),n=e.nameLocalized??KA,a=nj(r,t,n,o);return{type:"enum",keyPath:`${j.id}_${A.id}_${e.id}`,nodeId:j.id,scopeId:j.id,variableId:A.id,enumCaseId:e.id,value:r,valueWordCount:mj(r),hash:o,localizedValues:n,localizedValueStatuses:a,managedByPluginButUserEditable:!1}}function fy(j,A,e,t){let r=[],o=Ey(e,A);for(let l of A.getUnsortedChildren())ky(j,A,l,e,o,r);let n=Bi(j,A,e,st,lt,r);if(n){n.group&&t.push(n.group);return}let a=A.variables.filter(Yg);if(a.length===0)return;let i=[];for(let l of a){let c=l.type;switch(c){case"enum":{if(aa(l))break;for(let u of l.cases)i.push(my(A,l,u,e));break}case"string":case"richtext":case"image":case"link":case"slug":break;default:}}let s=i.length>0||r.length>0?{type:"sourceGroup",groupType:"collection",name:A.name??"Unknown",nodeId:A.id,supportsLocaleVisibility:!1,includedLocaleIds:void 0,items:i,groups:r}:void 0;gi(j,A,s,e,st,lt,r),s&&t.push(s)}function Ey(j,A){let e={};for(let r of j)e[r.id]=new Map;let t=A.variables.find(Pu);if(!t)return e;for(let r of A.getUnsortedChildren()){let o=r.getControlProp(t.id);if(o&&($(o.type==="string","expect slug control type to be be of type string"),$(_(o.value),"expected slug control prop value to be string"),!!o.valueLocalized))for(let n in o.valueLocalized){let a=o.valueLocalized[n],i=e[n];if(!i||!a?.value)continue;let s=(i.get(a.value)??0)+1;i.set(a.value,s)}}return e}function $y(j,A,e){let t=Bi(j,j.root,A,st,lt,void 0);if(t){t.group&&e.push(t.group);return}let r=[];jh(j,j.root,j.root,A,r);let o=r.length>0?{type:"sourceGroup",groupType:"settings",name:"Site Settings",nodeId:j.root.id,supportsLocaleVisibility:!1,includedLocaleIds:void 0,items:r}:void 0;gi(j,j.root,o,A,st,lt,void 0),o&&e.push(o)}function By(j,A,e,t){for(let r of A.children)fy(j,r,e,t)}function gy(j,A,e,t){if(A.dataIdentifier)return;let r=xA(A.segment),o=A.segmentLocalized??KA;t.push({keyPath:A.id,type:"RouteSegmentNode",nodeId:A.id,scopeId:j.id,value:A.segment,valueWordCount:mj(A.segment),hash:xA(A.segment),localizedValues:o,localizedValueStatuses:nj(A.segment,e,o,r),managedByPluginButUserEditable:!1})}function hy(j,A,e,t){let r=Bi(j,A,e,st,lt,void 0);if(r){r.group&&t.push(r.group);return}let o=[];for(let a of A.walk())St(a)&&gy(A,a,e,o);let n;o.length>0&&(n={type:"sourceGroup",name:"Page Path Segments",groupType:"routeSegment",nodeId:A.id,supportsLocaleVisibility:!1,includedLocaleIds:void 0,items:o},t.push(n)),gi(j,A,n,e,st,lt,void 0)}function _rA(j,A,e,t){let r=[];if(!A||A.length===0)return r;$y(j,A,r);for(let o of j.root.children)T0(o)&&($(o.isLoaded(),"Scope node must be fully loaded"),ly(j,o,A,e,r,t)),zo(o)&&($(o.isLoaded(),"Scope node must be fully loaded"),By(j,o,A,r)),OA.isOn("localizedPagePaths")&&ju(o)&&hy(j,o,A,r);return r}function DrA(j,A){return Qr(j,A)}function NrA(j,A){return Yj(j,A)}var Ry=gA("wantsNativeTextActions");function th(j=document.activeElement){if(!(j instanceof HTMLElement))return!1;if(j.classList.contains("wantsNativeTextAction")||j instanceof HTMLIFrameElement)return!0;if(j instanceof HTMLInputElement)switch(j.type){case"date":case"datetime-local":case"email":case"month":case"number":case"password":case"search":case"tel":case"text":case"time":case"url":case"week":return!0;case"checkbox":case"color":case"file":case"image":case"radio":case"range":case"reset":case"submit":return!1;default:return Ry.reportErrorOncePerMinute("Unhandled input type: "+j.type),!1}return j instanceof HTMLTextAreaElement||OA.isOn("rightClickOnLinks")&&(j instanceof HTMLAnchorElement||j.closest("a"))?!0:j.isContentEditable}var Yt=Pj(Mi());var ch=Pj(Hr());function Cd(j){return j.wantsActions?j.wantsActions():!0}function bd(j,A,e){return j.wantsAction?j.wantsAction(A,e):!0}function oh(j,A){return j.optionsForAction?j.optionsForAction(A):void 0}var nh;(t=>{function j(r){return new e(r)}t.chain=j;function A(r,o){return r&&r instanceof e?r.actionToTargetMap[o]:r}t.functionTarget=A;class e{constructor(o){I(this,"actionToTargetMap",{});I(this,"wantedActions",[]);this.then(o)}then(o){this.wantedActions=this.wantedActions.concat(o.wantedActions);let n=this.actionToTargetMap,a=o.wantedActions;for(let i of a)n[i]=n[i]||o;return this}wantsAction(o,n){let a=this.actionToTargetMap[o];return!a||!Cd(a)?!1:bd(a,o,n)}optionsForAction(o){let n=this.actionToTargetMap[o];if(n)return oh(n,o)}}})(nh||={});var Or=class extends Event{constructor(){super(...arguments);I(this,"actionIdentifier");I(this,"actionArgument")}};I(Or,"eventType","vekter-action-dispatch-event");var wr=class extends Event{constructor(){super(...arguments);I(this,"invalidatedActions");I(this,"validatedActionStates");I(this,"validatedActionOptions")}};I(wr,"eventType","vekter-action-validation-event");function JrA({target:j,engine:A,children:e,style:t,global:r}){let o=(0,Yt.useRef)(null),n=(0,Yt.useCallback)(s=>{let l=s.actionIdentifier;if(!l)return;let c=nh.functionTarget(j,l);if(!c||!c.wantedActions.includes(l)||!Cd(c))return;let u=c[l];if(!S7(u))return;let p=bd(c,l,s);if(!p||(s.preventDefault(),s.stopPropagation(),p!==!0))return;A.setEditReason(l);let f=u.bind(c);A.scheduler.wrapHandler(f)(s.actionArgument)},[A,j]),a=(0,Yt.useCallback)(s=>{let{invalidatedActions:l,validatedActionStates:c,validatedActionOptions:u}=s;if(!(!l||!c||!u)&&j){for(let p of j.wantedActions)if(l.has(p)){l.delete(p);let f=Cd(j)?bd(j,p,s):!1;if(c[p]=f,f===!0||f===!1){let E=oh(j,p);E&&(u[p]=E)}}l.size===0&&(s.preventDefault(),s.stopPropagation())}},[j]);(0,Yt.useEffect)(()=>{if(!o.current)return;let s=(r?document.documentElement:null)||o.current;return s.addEventListener(Or.eventType,n),s.addEventListener(wr.eventType,a),()=>{s.removeEventListener(Or.eventType,n),s.removeEventListener(wr.eventType,a)}},[r,n,a]);let i=(0,Yt.useCallback)(s=>{!th(s.target)&&!Qj.isDebugBuild&&s.preventDefault()},[]);return(0,ch.jsx)("div",{ref:o,onContextMenu:i,style:t,children:e})}function ih(j,A){let e=document.activeElement;if(!e)throw Error("No active element for action dispatch");let t=new Or(Or.eventType,{bubbles:!0});return t.actionIdentifier=j,t.actionArgument=A,e.dispatchEvent(t)}function Iy(j){let A=document.activeElement;if(!A)throw Error("No active element for action validation");let e=new Set;for(let n of j)e.add(n);let t={},r={},o=new wr(wr.eventType,{bubbles:!0});return o.invalidatedActions=e,o.validatedActionStates=t,o.validatedActionOptions=r,A.dispatchEvent(o),{states:t,options:r}}var ah=[],sh=[];function HrA(j){ah.push(j)}function QrA(j){sh.push(j)}function lh(j){let A=j==="*"?Object.keys(n6):[j];ah.forEach(r=>r());let{states:e,options:t}=Iy(A);Object.assign(n6,e),Object.assign(rh,t);for(let r of A)n6[r]=e[r]||(r==="undo"||r==="redo"||r==="delete"?"native":!1);return sh.forEach(r=>r()),{states:n6,options:rh}}var n6={},rh={};function ZrA({stackElement:j,tree:A}){return j?A.getNodeWithTrait(j.type==="temporary"?j.collectionId:A.getParent(j.itemId)?.id,uj):null}function AoA({treeStore:j,contentManagementStore:A,stackElement:e}){if(!e)return null;if(e.type==="existing")return j.tree.getNodeWithTrait(e.itemId,ue);if(e.type==="temporary")return A.temporaryItemCache.get(e.itemId)??null;iA(e)}function joA(j,A=[]){let e=j.stores.selectionStore.ids.length===1?k6(j.stores.selectionStore.ids,0):void 0,t=Gy(j,A),r=k6(t,0),o=j.tree.getNodeWithTrait(e,ue);if(o){if(!r)return[{itemId:o.id,type:"existing"}];if(r.type==="existing")return r.itemId===o.id?t:($(t.length===1,"Must dismiss overlay stack before changing selection"),[{itemId:o.id,type:"existing"}]);if(r.type==="temporary")throw new Error("Must save temporary item stack before selecting a collection item");iA(r)}if(!r||r.type==="temporary")return t;if(r.type==="existing")return j.stores.chromeStore.mainView!==2?t:($(t.length===1,"Must dismiss overlay stack before de-selecting collection item"),[]);iA(r)}function Gy(j,A){let e=[];for(let t=0;t<A.length;t++){let r=A[t];if(!r)continue;if(r.type==="temporary"&&j.tree.has(r.itemId)&&(r={type:"existing",itemId:r.itemId}),!Sy(j,r))break;e.push(r),t>0&&$(r.type==="existing"||!!r.saveAction,"Temporary items in the stack must have saveAction, except when they are the first")}return e}function Sy(j,A){if(A.type==="temporary")return $(!j.tree.has(A.itemId),"Temporary stack element must not exist in the tree. It should be turned existing before passing it to validateOverlayStackElement."),j.tree.has(A.collectionId)&&j.stores.contentManagementStore.temporaryItemCache.has(A.itemId);if(A.type==="existing")return j.tree.has(A.itemId);iA(A)}function dh(j,A){let e=j.itemVariables.length===1&&j.itemVariables[0]?.type==="image"?j.itemVariables[0]:void 0,t=g`item`,r={[yr]:g`typeof ${t}?.[${yr}] === "string" ? ${t}[${yr}] : undefined`};for(let n of j.itemVariables){let a=ra(n.name);a?r[n.id]=g`${t}?.[${a}] ?? ${t}?.[${n.id}]`:r[n.id]=g`${t}?.[${n.id}]`}let o=A.bindings.create("arrayFromHumanReadable"+j.id);return A.declarations.file.create(g.joinLines(g`const ${o} = (value) => {${g.joinLines(g`if (!Array.isArray(value)) return`,g`return value.map(${t} => {${g.joinLines(e?g`if (typeof ${t} === "string") return { [${e.id}]: ${t} }`:void 0,g`return ${r}`)}})`)}}`)),o}function yy(j){return[j[1],j[0]]}var Cy=new Map(Object.entries(bA).map(yy));function uh(j,A){let e=A.addImport("framer",{exportSpecifier:"ControlType"}),t=Cy.get(j),r=new V(t);return g`${e}.${r}`}var by={boolean:"boolean",number:"number",string:"string",richtext:"string",fusednumber:"any",enum:"string",segmentedenum:"string",color:"string",image:"string",responsiveimage:"{src: string; srcSet?: string; alt?: string}",file:"string",componentinstance:"any",slot:"any",array:"any[]",eventhandler:"any",transition:"Record<string, any>",link:"string",linkrelvalues:"string[] | undefined",pagescope:"string",date:"string",object:"Record<string, any>",font:"Record<string, any> | undefined",scrollsectionref:"React.MutableRefObject<HTMLElement>",customcursor:"string",border:"Record<string, any>",cursor:"string",boxshadow:"string",gap:"string",padding:"string",borderradius:"string",collectionreference:"string | undefined",multicollectionreference:"string[] | undefined",trackingid:"string | undefined",vectorsetitem:"React.ComponentType<any> | undefined"};function vy(j){return j?new V(by[j]):g`any`}var ph="variant";function Ty(j){return!sA(j?.defaultValue)}function Py(j,A){if(!eA(j))return{};$(j.isLoaded(),"Node must be loaded to generate controls");let e=j.getTopLevelVariants();if(e?.length<2)return{};let t=[],r=[];for(let o of e){let n=o.name??Ce(o);t.push(o.id),r.push(n)}return{[ph]:{type:uh("enum",A),title:"Variant",options:t,optionTitles:r}}}function My(j,A,e,t,r){if(j.type==="responsiveimage"&&v6(j)&&b6(j.__vekterDefault)){let{assetReference:o,alt:n}=j.__vekterDefault,a=Il(r?.width,r?.height),i=e.assets.resolveResponsiveImage(o,a,j.__vekterDefault);return i&&_(n)&&(i.alt=n),i}else if(C6(j))switch(j.type){case"responsiveimage":{let o=Il(r?.width,r?.height),n=e.assets.resolveResponsiveImage(j.__defaultAssetReference,o);return n||void 0}case"file":{let o=e.assets.resolve(j.__defaultAssetReference);return o?o.src:void 0}}else{if(A?.type==="array")return A.initialValue?A.initialValue.map(o=>{let n={};if(!o||o.type!=="object"||!_j(o.value))return n;for(let a in o.value){let i=o.value[a];if(!i||i.type!=="image"||!_(i.value))continue;let s=e.assets.resolveResponsiveImage(i.value,void 0,i);s&&(s.alt=i.alt??"",n[a]=s)}return n}):[];if(Ty(j)){let o=j.defaultValue;if(j.type==="vectorsetitem")return $(Tu(o),"Vector set item must be a module export identifier"),e.imports.addModuleImport(o.identifier);if(j.type==="richtext"&&_(o))return af(o,{collectors:e,useFramerMotion:t==="SmartComponent"});if(j.type==="boxshadow"&&Ek(o))return $k(o,"emptyStringWhenEmpty",n=>ot(n)?J6(n):Oi.toFormatString(n));if(ut(o))return ot(o)?J6(o):o}}}function i6(j,A){return g`${j}?: ${A};`}var kh=["id","width","height"],_y=Object.fromEntries(kh.map(j=>{let A=new V(j);return[A,A]}));function Dy(j,A){let e=new Nj(j);return Nj.addSpreadAtEnd(e,A),e}var mh=[{name:_A.style,type:g`Record<string, unknown>`},{name:_A.className,type:g`string`},{name:_A.layoutId,type:g`string | number`}];function Ny(j,{declarations:A}){if(!eA(j)&&!w(j)&&!ZA(j)&&!de(j))return[];$(j.isLoaded(),"Node must be loaded to generate default values and types");let e=mh.map(({name:a,type:i})=>({key:wA(a),type:i6(a,i)})),t=lr(j)?j.getTopLevelVariants():[],r=wA(_A.variant);if(t.length<2)return e.concat({key:r});$(lr(j),"A scope with more than 1 variants must have replica variants.");let o=new Nj;for(let a of t)o[a.name??Ce(a)]=a.id;let n=A.file.dedupe("humanReadableVariantMap",o);return e.concat([{key:r,type:i6(_A.variant,g`keyof typeof ${n}`),value:g`${n}[props.${_A.variant}] ?? props.${_A.variant} ?? ${j.baseVariantId}`}])}function vd(j,A,e){let t=g`props.${new V(j)}`;return A&&(t=g`${A} ?? ${t}`),e&&(t=g`${t} ?? ${e}`),t}function xy(j,{treeStore:A}){if(!w(j)||!mo(A.tree,j))return;let t=oA(j.dataIdentifier);if(!Rj(t))return;let r=j.getVariableDefinitions(A.tree,L,L.activeBundleHash);if(!r||r.length===0)return;let o=new Map;for(let n of r){let a=$o(n.id,j.id,!0);o.set(wA(a),n)}return o}var Oy=[...ck,ph,...kh,...mh.map(({name:j})=>j.toString()),"name"];function wy(j,A,e,t,r,o){let n=new Set(Oy),a=g`props`,i=Object.entries(j).map(([S,{control:v,variable:P}])=>{if(!v)return{key:S};let T=dk(ra(v.title)??S,n),N=new V(T),Q=My(v,P,t,r,o),H=i6(N,vy(v.type)),Z;if(v.type==="enum"&&v.options&&v.optionTitles&&N){let J=new Nj;v.options.forEach((jA,x)=>{if(!_(jA)||!v.optionTitles)return;let z=v.optionTitles[x];_(z)&&(J[z]=jA)});let AA=t.declarations.file.dedupe("humanReadableEnumMap",J);H=i6(N,g`keyof typeof ${AA}`),Z=vd(S,N,Q),Z=g`${AA}[${N}] ?? ${Z}`}else if(P?.type==="array"){let J=dh(P,t),AA=V.fn(J,N);Z=vd(S,AA,Q)}else Z=vd(S,N,Q);return{key:S,name:T,type:H,value:Z}}),s="",l=[],c=new Nj,u=xy(A,e),p={},f={..._y};for(let{key:S,type:v,value:P,name:T}of[...Ny(A,t),...i]){let N=u?.get(S),Q=new V(S);if(N){let H=g`${Q} = ${_A.getFromCurrentRouteData}(${N.id})`;if(mu(N.type)){let Z=bt(N.type);ut(Z)&&(H=g`${H} ?? ${Z}`)}l.push(H)}else l.push(Q);v&&(s+=v),P&&(c[S]=P),T&&(p[S]=T,f[T]=new V(T))}r==="DesignPage"&&l.push(_A.style),Nj.addSpreadAtStart(c,a);let E=t.declarations.file.dedupe("getProps",g`(${Dy(f,a)}) => { return ${c} }`),F=l.join(", "),h=F.length>0?new V(`{ ${F}, ...${_A.restProps} }`):_A.restProps;return{variableMap:Pe(p)?void 0:p,types:new V(s),props:g`const ${h} = ${V.fn(E,a)}`}}function Ly(j,A,e=!1){let t=[],r=fh(j),o=new V.Set(A.variables);for(let n of r){if(n.type==="divider")continue;let a=new V(n.id);!e&&!A.variables.has(a)||(t.push({id:n.id,definition:n}),o.delete(a))}for(let n of o)t.push({id:String(n)});return t}function qy(j,A){let{hidden:e,...t}=j;if(!A)return t;let{description:r,...o}=t;return o}function Vy(j,A,{modulesStore:e,treeStore:t},{imports:r,variables:o},n,a){let{id:i,type:s}=j;switch(s){case"controlReference":{let l=oA(Mu(t.tree,j.entityIdentifier));if(!l||!j.entityIdentifier||!Rj(l))return;let c=r.addModuleImport(l,{composeWithImports:[r.addImport("framer",{exportSpecifier:"getPropertyControls"})]});if(!c)return;let u=new Nj({hidden:g`undefined`,description:g`undefined`});return Nj.addSpreadAtStart(u,g`${c}[${j.controlKey}]`),_(A.title)&&(u.title=A.title),_(A.description)&&(u.description=A.description),A.type==="responsiveimage"&&v6(A)&&b6(A.__vekterDefault)&&(u[b7]=V.fromValue(A.__vekterDefault)),C6(A)?u[C7]=V.fromValue(A.__defaultAssetReference):sA(j.initialValue)||(u.defaultValue=V.fromValue(j.initialValue)),g`${c}?.[${j.controlKey}] && ${u}`}case"nodePropertyControlReference":case"array":case"vectorsetitem":case"boolean":case"color":case"date":case"enum":case"eventhandler":case"file":case"image":case"link":case"linkrelvalues":case"number":case"richtext":case"scrollsectionref":case"customcursor":case"cursor":case"transition":case"boxshadow":case"string":case"border":case"borderradius":case"gap":case"padding":case"collectionreference":case"multicollectionreference":case"trackingid":case"slug":{let l={...qy(A,n),type:uh(A.type,r)};if(a==="vector"&&o){let c=new V(i);l.hidden=!o.variables.has(c)}return l}default:iA(s)}}function fh(j){return nt(j)?j.variables:[]}function Ky(j,A,e,t,r=fh(j)){let o=Py(j,e.imports),n=oa(j),a=[...r];if(uj(j)){let i=Ip(j);a.push(i);let s=Fp(j);a.push(s)}for(let i of a){if(i.type==="divider")continue;let s=Q6(A.treeStore.tree,i);if(Dj(s))continue;$(s.type!=="image","Image variables should become responsive images");let l=Vy(i,s,A,e,n,t);sA(l)||(o[i.id]=l)}if(!Pe(o))return new Nj(o,1)}function OoA(j,A,e,t,r,o){let n={},a=[];for(let{id:i,definition:s}of Jy(j,e.variables)){let l=s?Q6(A.treeStore.tree,s):void 0;n[i]={control:l,variable:s},s&&a.push(s)}return{propertyControls:Ky(j,A,e,r,a),...wy(n,j,A,e,t,o)}}function Jy(j,A){return Ly(j,A,de(j))}var Ri=Pj(_6());function Eh(){return document.body.dataset.framerTheme==="dark"}var $h=oe()?["Control","Option","Shift","CommandOrControl","Command"]:["CommandOrControl","Command","Control","Alt","Shift"];function Td(j){return j?j.split("+").sort((A,e)=>{let t=$h.indexOf(A),r=$h.indexOf(e);return t!==-1&&r!==-1?t-r:t!==-1?-1:r!==-1?1:0}).map(A=>{switch(A){case"Backspace":case"Delete":return oe()?"\u232B":"Del";case"Command":return"\u2318";case"CommandOrControl":return oe()?"\u2318":"Ctrl";case"Control":return oe()?"\u2303":"Ctrl";case"Down":return"\u2193";case"Enter":case"Return":return oe()?"\u21A9":"Enter";case"Left":return"\u2190";case"-":return"\u2013";case"Option":return oe()?"\u2325":"Alt";case"Plus":return oe()?"+":"=";case"Right":return"\u2192";case"Shift":return oe()?"\u21E7":"Shift";case"Up":return"\u2191";case"Escape":return"ESC"}return A}):[]}function Pd(j,A){let e=[];return j.forEach(t=>{let{accelerator:r,acceleratorWindows:o,checked:n,mixed:a,enabled:i,ellipsis:s,role:l,type:c="normal",visible:u,requiresUserInteraction:p,acceleratorLabel:f,acceleratorLabelWindows:E,badge:F,icon:h}=t;if(c==="separator")e.push({type:"separator",visible:u});else if(c==="normal"){let S;i!==void 0&&(S=!i);let v=!oe()&&o!==void 0?o:r,P=!oe()&&E!==void 0?E:f,T=P?Td(P):v?Td(v):void 0,N=t.label;N&&s&&(N+="\u2026");let Q={accelerator:v,acceleratorLabelTokens:T,tokenDelimiter:oe()?void 0:"+",checked:n||a,disabled:S,label:N||"",description:t.description,action:l,type:c,visible:u,requiresUserInteraction:p,badge:F,icon:h};Q.submenu=t.submenu&&Pd(t.submenu,A),A&&A(Q),Q.visible===void 0&&(Q.visible=!0),e.push(Q)}else throw Error(`Unhandled type: ${c}`)}),e}var a6={importFigma:"CommandOrControl+Shift+I",newProject:"Option+CommandOrControl+N",publishSite:"CommandOrControl+Shift+P",openPublishedSite:"CommandOrControl+Shift+O",uploadImage:"Option+CommandOrControl+I",quickActions:"CommandOrControl+K",toggleLocalization:"CommandOrControl+Shift+L",toggleContentManagement:"Option+C",toggleVersionHistory:"Shift+CommandOrControl+H",generateWebPage:"W",undo:"CommandOrControl+Z",redo:"CommandOrControl+Shift+Z",goBack:"CommandOrControl+[",goForward:"CommandOrControl+]",cut:"CommandOrControl+X",copy:"CommandOrControl+C",copyFill:"CommandOrControl+Shift+C",paste:"CommandOrControl+V",delete:"Delete",selectMostRecentPage:"Option+Escape",selectAll:"CommandOrControl+A",selectGroundNode:"CommandOrControl+Escape",selectParent:"Escape",copyStyle:"CommandOrControl+Option+C",pasteStyle:"CommandOrControl+Option+V",pasteInPlace:"CommandOrControl+Shift+V",duplicate:"CommandOrControl+D",toggleLayerLock:"CommandOrControl+L",toggleLayerVisible:"CommandOrControl+;",rename:"CommandOrControl+R",selectSiblings:"CommandOrControl+Shift+A",cycleSelection:"Tab",decycleSelection:"Shift+Tab",fakeSelectChildren:"Enter",zoomIn:"CommandOrControl+Plus",zoomOut:"CommandOrControl+-",resetZoom:"CommandOrControl+0",zoomToFitAll:"CommandOrControl+1",zoomToFitSelection:"CommandOrControl+2",openPanelSearch:"CommandOrControl+F",toggleInterface:"CommandOrControl+.",toggleRulers:"Control+R",toggleGrids:"Control+G",toggleAppearance:"Control+Command+N",showPages:"Option+1",showLayers:"Option+2",showAssets:"Option+3",collapseLayers:"Option+L",startLinkTool:"L",sampleColor:"Control+C",toggleInsert:"I",toggleLibraryModal:"CommandOrControl+/",toolCreateStack:"S",toolCreateFrame:"F",toolCreateRounded:"U",toolCreateImage:"Shift+I",toolCreateVideo:"Shift+V",toolCreateText:"T",toolComment:"C",toolChat:"/",toolZoom:"Z",toolPath:"P",toolScale:"K",toolCreateRectangleShape:"R",toolCreateOvalShape:"O",toolCreateRows:"Shift+R",toolCreateColumns:"Shift+C",toolCreateGrid:"Shift+G",addEnclosingFrame:"CommandOrControl+Return",addEnclosingStack:"CommandOrControl+Option+Return",autoSizeLayout:"Shift+A",removeFramePreservingChildren:"CommandOrControl+Delete",sizeToFitContent:"Control+Option+R",moveForward:"CommandOrControl+Option+Up",moveBackward:"CommandOrControl+Option+Down",moveToFront:"]",moveToBack:"[",alignLeft:"Option+A",alignCenter:"Option+H",alignRight:"Option+D",alignTop:"Option+W",alignMiddle:"Option+V",alignBottom:"Option+S",distributeHorizontal:"Control+Option+H",distributeVertical:"Control+Option+V",unite:"Option+Shift+U",subtract:"Option+Shift+S",intersect:"Option+Shift+I",exclude:"Option+Shift+E",join:"Option+Shift+J",saveCodeFile:"CommandOrControl+S",makeBold:"CommandOrControl+B",makeItalic:"CommandOrControl+I",makeUnderlined:"CommandOrControl+U",chooseFontFamily:"CommandOrControl+T",group:"CommandOrControl+G",ungroup:"CommandOrControl+Shift+G",makeComponent:"CommandOrControl+Option+K",makeCodeComponent:"CommandOrControl+Shift+K",showPreview:"CommandOrControl+P",openFullScreen:"CommandOrControl+Shift+F",toggleHighlightsInLivePreview:"CommandOrControl+Shift+H",reload:"CommandOrControl+R",toggleConsole:"CommandOrControl+I",handleResponsive:"Z",togglePreviewInterface:"CommandOrControl+Shift+F",previewNextBreakpoint:"CommandOrControl+.",previewPreviousBreakpoint:"CommandOrControl+,",runRecentPlugin:"CommandOrControl+Option+P",openDevelopmentPlugin:"CommandOrControl+Option+L",openTextSearchPlugin:"CommandOrControl+Shift+F",openSiteSettings:"Shift+,",saveSiteSettings:"CommandOrControl+S",previousCollectionItem:"CommandOrControl+Up",nextCollectionItem:"CommandOrControl+Down",newCollectionItem:"N",pasteCollection:"CommandOrControl+V"},Md={sampleColor:"",selectGroundNode:"",openFullScreen:"Control+Alt+F",resetZoom:"Shift+0",zoomToFitAll:"Shift+1",zoomToFitSelection:"Shift+2",toggleInterface:"Alt+.",toggleRulers:"Control+Shift+R",toggleGrids:"Alt+G",toggleAppearance:"Alt+N",distributeHorizontal:"Alt+Shift+H",distributeVertical:"Alt+Shift+V"},UoA=j=>Sa?a6[j]:Md[j]??a6[j];var Hy=(0,Ri.List)();async function Qy(j){return{indexPath:(await new Promise(e=>{let{location:t={x:0,y:0},within:r,className:o}=j,n=Pd(j.items,a=>{if("action"in a&&a.action){let{states:i,options:s}=lh(a.action),l=i[a.action],{label:c,checked:u,visible:p}=s[a.action]??{};if(_(c)&&(a.label=c),a.checked===void 0&&Bt(u)&&(a.checked=u),a.visible===void 0&&Bt(p)&&(a.visible=p),a.submenu)return;a.disabled===void 0&&Bt(l)&&(a.disabled=!l)}});sf.show(n,{location:t,within:r,className:o,isDarkMode:Eh(),maxItemsPerMenu:24,expandRight:j.expandRight,onSelection:a=>{let i=Uy(n,a.path);i?.type==="normal"&&i.requiresUserInteraction&&e(a)},enableTranslate:!0}).then(e)}))?.path??[]}}function Uy(j,A){let e;for(let t of A){if(!j||(e=j[t],!e))return;j=e.type==="normal"&&e.submenu||[]}return e}var hi=class hi extends v7("Menu"){constructor(){super();I(this,"_items");I(this,"handlePopupResponse",dm((e,t)=>{if(!e||e.length===0){t&&t();return}let r=this._items,o,n;for(let a of e){if(o=r.get(a),!o)throw Error("Could not find expected menu item");o.editReason!==void 0&&(n=o.editReason),r=o.submenu?._items??Hy}n?bl()?.setEditReason(n):n!==!1&&bl()?.setEditReason(o?.role??Iu(o?.label)),o!==void 0&&o.click!==void 0?o.click():o?.role!==void 0&&ih(o.role,{fromContextMenu:!0})}));this._items=(0,Ri.List)()}static buildFromTemplate(e){let t=new hi;for(let r of e)t.append(new Dd(hi.getItemTemplateWithShortcut(r)));return t}get items(){return this._items.toArray()}append(e){this._items=this._items.push(e)}insert(e,t){this._items=this._items.insert(e,t)}popup(e,t){return new Promise(r=>{let o=JSON.parse(JSON.stringify(this._items.toJS()));Qy({items:o,location:e,within:t?.within,className:t?.className,expandRight:t?.expandRight}).then(n=>this.handlePopupResponse(n.indexPath,t?.onCancel)).catch(yA).finally(r)})}};I(hi,"getItemTemplateWithShortcut",e=>{let{role:t}=e;if(!t)return e;let r={...e};return!Sa&&!e.acceleratorWindows&&(r.acceleratorWindows=Md[t]),e.accelerator||(r.accelerator=a6[t]),r});var _d=hi,Wy={enabled:void 0,visible:void 0,label:void 0,description:void 0,click:void 0,type:"normal",accelerator:void 0,acceleratorWindows:void 0,acceleratorLabel:void 0,acceleratorLabelWindows:void 0,submenu:void 0,checked:void 0,mixed:void 0,role:void 0,requiresUserInteraction:void 0,alternate:void 0,badge:void 0,icon:void 0,editReason:void 0},Dd=class extends(0,Ri.Record)(Wy){constructor(e){e.label&&e.ellipsis&&(e.label=`${e.label}\u2026`),e.submenu!==void 0&&!("__class"in e.submenu&&e.submenu.__class==="Menu")&&(e.submenu=_d.buildFromTemplate(e.submenu));super(e);I(this,"enabled");I(this,"visible");I(this,"label");I(this,"ellipsis");I(this,"checked");I(this,"mixed");I(this,"click");I(this,"role");I(this,"requiresUserInteraction");I(this,"alternate");I(this,"editReason");I(this,"submenu")}toJS(){let e=super.toJS();return e.submenu!==void 0&&(e.submenu=e.submenu._items.toJS()),e}};function inA(j){return{...j,enabled:j.enabled(),click:()=>{j.enabled()&&j.click()}}}function anA(j){return Array.isArray(j)}function cnA(j,A){let e=A.getItemIds(j.id);if(e)return e[0]}export{ff as a,Yl as b,Rf as c,xf as d,LC as e,Jh as f,Nn as g,Qh as h,UC as i,Ke as j,OT as k,xn as l,ac as m,wT as n,wf as o,If as p,fv as q,Mn as r,Ev as s,iR as t,$v as u,Bv as v,gv as w,hv as x,Rv as y,WT as z,zT as A,Je as B,XT as C,YT as D,ZT as E,AP as F,jP as G,eP as H,$R as I,tP as J,Vf as K,sc as L,Cr as M,kP as N,mP as O,gR as P,os as Q,GP as R,SP as S,yP as T,lc as U,CP as V,ns as W,OP as X,wP as Y,LP as Z,ho as _,Hf as $,WP as aa,yv as ba,Cf as ca,Qf as da,bf as ea,Wf as fa,Jv as ga,oc as ha,tc as ia,_n as ja,Ov as ka,wv as la,rc as ma,es as na,Lv as oa,vf as pa,nc as qa,aR as ra,Dn as sa,Xv as ta,Tf as ua,iT as va,_f as wa,aT as xa,sT as ya,lT as za,cT as Aa,dT as Ba,uT as Ca,fT as Da,Xf as Ea,ss as Fa,IM as Ga,U as Ha,ls as Ia,Zf as Ja,Oj as Ka,FD as La,GD as Ma,SD as Na,yD as Oa,rE as Pa,oE as Qa,nE as Ra,OR as Sa,lE as Ta,kc as Ua,eN as Va,cs as Wa,gN as Xa,ds as Ya,hN as Za,pE as _a,kE as $a,mE as ab,us as bb,BE as cb,ks as db,ms as eb,Ro as fb,RE as gb,GE as hb,SE as ib,$s as jb,TE as kb,PE as lb,oO as mb,uO as nb,ME as ob,yO as pb,_E as qb,Bs as rb,Hn as sb,xE as tb,OE as ub,P8 as vb,wE as wb,gs as xb,hs as yb,Qn as zb,KE as Ab,$T as Bb,BT as Cb,Nf as Db,pR as Eb,ts as Fb,fI as Gb,w1 as Hb,L1 as Ib,q1 as Jb,V1 as Kb,WE as Lb,Co as Mb,Is as Nb,be as Ob,rs as Pb,ZE as Qb,Mr as Rb,e$ as Sb,t$ as Tb,o$ as Ub,n$ as Vb,I4 as Wb,F4 as Xb,l$ as Yb,C4 as Zb,d$ as _b,k$ as $b,K4 as ac,J4 as bc,H4 as cc,Q4 as dc,U4 as ec,bs as fc,m$ as gc,yI as hc,f$ as ic,$$ as jc,qL as kc,VL as lc,B$ as mc,KL as nc,g$ as oc,R$ as pc,hq as qc,Tc as rc,OI as sc,Rq as tc,Iq as uc,Fq as vc,Wn as wc,I$ as xc,zn as yc,vc as zc,Gq as Ac,Sq as Bc,yq as Cc,Cq as Dc,LI as Ec,bq as Fc,vq as Gc,G$ as Hc,S$ as Ic,Yq as Jc,Zq as Kc,y$ as Lc,C$ as Mc,v$ as Nc,T$ as Oc,Oc as Pc,V$ as Qc,fF as Rc,ud as Sc,UW as Tc,zG as Uc,pd as Vc,g0 as Wc,h0 as Xc,T0 as Yc,di as Zc,ui as _c,Ys as $c,P0 as ad,M0 as bd,w0 as cd,Wt as dd,Dg as ed,fi as fd,wg as gd,Fd as hd,MeA as id,Lg as jd,ltA as kd,ctA as ld,dtA as md,utA as nd,ptA as od,e6 as pd,JS as qd,RtA as rd,ItA as sd,FtA as td,HS as ud,Jg as vd,Hg as wd,Qg as xd,btA as yd,vtA as zd,TtA as Ad,Qt as Bd,ci as Cd,PX as Dd,FrA as Ed,GrA as Fd,SrA as Gd,yrA as Hd,CrA as Id,YS as Jd,brA as Kd,vrA as Ld,TrA as Md,PrA as Nd,ZS as Od,MrA as Pd,sy as Qd,$i as Rd,uy as Sd,py as Td,my as Ud,Ey as Vd,By as Wd,_rA as Xd,DrA as Yd,NrA as Zd,cnA as _d,Ps as $d,pJ as ae,kJ as be,_r as ce,dH as de,Ns as ee,dB as fe,xs as ge,qF as he,mB as ie,fB as je,EB as ke,e5 as le,S5 as me,BB as ne,gB as oe,hB as pe,y5 as qe,C5 as re,b5 as se,zF as te,v5 as ue,vo as ve,T5 as we,P5 as xe,$B as ye,H$ as ze,CF as Ae,Ms as Be,wc as Ce,Lc as De,w5 as Ee,L5 as Fe,q5 as Ge,V5 as He,K5 as Ie,YF as Je,J5 as Ke,RB as Le,Qc as Me,yB as Ne,eQ as Oe,CB as Pe,DJ as Qe,Z$ as Re,AB as Se,NJ as Te,Nr as Ue,Jt as Ve,dQ as We,Mo as Xe,uQ as Ye,_B as Ze,ei as _e,SQ as $e,cG as af,yQ as bf,dG as cf,uG as df,zc as ef,DB as ff,CQ as gf,NB as hf,bQ as if,pG as jf,kG as kf,DQ as lf,jB as mf,LJ as nf,Yn as of,ed as pf,td as qf,rd as rf,PU as sf,xr as tf,eH as uf,tH as vf,iB as wf,HU as xf,A0 as yf,j0 as zf,QU as Af,UU as Bf,WU as Cf,l0 as Df,xG as Ef,OG as Ff,sB as Gf,kd as Hf,jS as If,I0 as Jf,tS as Kf,lB as Lf,F0 as Mf,G0 as Nf,oS as Of,S0 as Pf,fz as Qf,iS as Rf,fd as Sf,aS as Tf,Yz as Uf,dX as Vf,lS as Wf,cS as Xf,v0 as Yf,th as Zf,nh as _f,JrA as $f,ih as ag,HrA as bg,QrA as cg,lh as dg,ZrA as eg,AoA as fg,joA as gg,Gy as hg,uh as ig,Oy as jg,Ky as kg,OoA as lg,a6 as mg,Md as ng,UoA as og,Td as pg,Pd as qg,_d as rg,inA as sg,anA as tg};
//# sourceMappingURL=https://app.framerstatic.com/chunk-OX5657WM.mjs.map
