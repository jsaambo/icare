import{a as Ms}from"https://app.framerstatic.com/chunk-25JLRM2P.mjs";import"https://app.framerstatic.com/chunk-OOLR22TO.mjs";import{a as Ze}from"https://app.framerstatic.com/chunk-OPDB6D2T.mjs";import{a as Ts}from"https://app.framerstatic.com/chunk-F6ABH7PM.mjs";import{a as Mo,b as As,c as Ds}from"https://app.framerstatic.com/chunk-E5UT5HRA.mjs";import"https://app.framerstatic.com/chunk-YRBVFSEE.mjs";import"https://app.framerstatic.com/chunk-ZE3DJJKM.mjs";import"https://app.framerstatic.com/chunk-ABJCBACI.mjs";import"https://app.framerstatic.com/chunk-Q4ZQNAWB.mjs";import{$c as Is,Ac as gs,Ad as Bs,Gc as Zt,Ic as Rn,Kc as ys,Lc as hs,Mb as ns,Pc as Cs,Qb as rs,Ra as Ya,Rb as An,Rc as ws,Sb as is,Tb as as,Ub as Dn,Va as Ha,Wc as Us,_c as xs,a as vo,ad as bs,b as Ma,c as Ra,cd as Fs,d as _a,dc as ss,dd as Ss,e as Ga,ec as ls,ed as vs,fc as cs,hc as fs,hd as Ps,ib as Ja,ic as ds,id as Es,j as Po,jc as ms,jd as Bo,k as Va,kd as To,l as Eo,n as ko,nb as Qa,nd as Ft,o as Oo,od as ue,p as za,pd as tt,qb as $a,qd as St,r as Wa,rd as Se,sa as Bn,sd as Ao,t as qa,td as Do,u as La,ud as A,v as Ka,va as Tn,vc as ps,wc as us,wd as ks,xd as Os,y as Xa,zc as Mn,zd as Ns}from"https://app.framerstatic.com/chunk-UGIDUVUU.mjs";import"https://app.framerstatic.com/chunk-L5KAX3IT.mjs";import{h as Da}from"https://app.framerstatic.com/chunk-SWX25S2N.mjs";import"https://app.framerstatic.com/chunk-QJT7H37J.mjs";import{a as It}from"https://app.framerstatic.com/chunk-XVGNOOZ4.mjs";import"https://app.framerstatic.com/chunk-WFUCVR7W.mjs";import{A as Ut,C as M,Cb as Ea,E as na,F as aa,G as sa,H as xo,I as Io,J as la,K as ca,L as fa,M as xt,O as bo,P as Fo,Y as ma,ea as pa,pa as ua,tb as xa,ub as Ia,vb as ba,wb as va,xa as Ca,ya as So,z as wt,za as wa}from"https://app.framerstatic.com/chunk-ELWASXRW.mjs";import{a as ha,b as Sa,e as Pa}from"https://app.framerstatic.com/chunk-ZZH45KH5.mjs";import"https://app.framerstatic.com/chunk-B76FVMQ5.mjs";import{D as Fa}from"https://app.framerstatic.com/chunk-U6WR4NBJ.mjs";import"https://app.framerstatic.com/chunk-IHOAENGB.mjs";import"https://app.framerstatic.com/chunk-7LQZYUVJ.mjs";import{Df as da,Od as oa,cb as Hi,da as Xi,ga as b,ha as ji,jb as Qi,pd as ta,tb as $i}from"https://app.framerstatic.com/chunk-OX5657WM.mjs";import"https://app.framerstatic.com/chunk-C25CXIAS.mjs";import{a as Zi}from"https://app.framerstatic.com/chunk-NOA5YT74.mjs";import{j as ea}from"https://app.framerstatic.com/chunk-XOOG2GMT.mjs";import"https://app.framerstatic.com/chunk-BQK5PZHM.mjs";import"https://app.framerstatic.com/chunk-I3QG7GSD.mjs";import"https://app.framerstatic.com/chunk-JRBFLTNY.mjs";import"https://app.framerstatic.com/chunk-N57XNHE3.mjs";import"https://app.framerstatic.com/chunk-WRTBVKKU.mjs";import"https://app.framerstatic.com/chunk-OTIFPWYF.mjs";import"https://app.framerstatic.com/chunk-SE354WOV.mjs";import{i as ra,j as ia}from"https://app.framerstatic.com/chunk-JB3A7NVR.mjs";import"https://app.framerstatic.com/chunk-HTH46QE2.mjs";import"https://app.framerstatic.com/chunk-M77ZNLMM.mjs";import"https://app.framerstatic.com/chunk-HF5XMP3Y.mjs";import"https://app.framerstatic.com/chunk-WAFDZ45U.mjs";import"https://app.framerstatic.com/chunk-ITTAQCRS.mjs";import"https://app.framerstatic.com/chunk-QYISBMAI.mjs";import"https://app.framerstatic.com/chunk-YE25YANI.mjs";import"https://app.framerstatic.com/chunk-P6QIJVDS.mjs";import"https://app.framerstatic.com/chunk-2AK2DUGT.mjs";import{a as bt}from"https://app.framerstatic.com/chunk-EUXVVMX5.mjs";import"https://app.framerstatic.com/chunk-EWEZCJKH.mjs";import{a as Aa}from"https://app.framerstatic.com/chunk-H2MUOIDC.mjs";import{a as Yi,b as et}from"https://app.framerstatic.com/chunk-SQD5XUIU.mjs";import{b as ja}from"https://app.framerstatic.com/chunk-S6DXX62W.mjs";import"https://app.framerstatic.com/chunk-TUN2BKIJ.mjs";import"https://app.framerstatic.com/chunk-D7MEQ7Y3.mjs";import{i as Ki}from"https://app.framerstatic.com/chunk-5CTYCHND.mjs";import"https://app.framerstatic.com/chunk-6ITRUDEE.mjs";import"https://app.framerstatic.com/chunk-YS3B4HMG.mjs";import{a as ts,d as os}from"https://app.framerstatic.com/chunk-IDRDNG72.mjs";import"https://app.framerstatic.com/chunk-HWKTFWOQ.mjs";import"https://app.framerstatic.com/chunk-3YEJT6GO.mjs";import"https://app.framerstatic.com/chunk-2YI7VWM5.mjs";import"https://app.framerstatic.com/chunk-K24ZPX62.mjs";import{a as Xe}from"https://app.framerstatic.com/chunk-7GSEC7H4.mjs";import"https://app.framerstatic.com/chunk-JN3UHYXQ.mjs";import"https://app.framerstatic.com/chunk-OMA2HNXY.mjs";import{a as Za}from"https://app.framerstatic.com/chunk-IE6AATEJ.mjs";import{a as Ta}from"https://app.framerstatic.com/chunk-Z6XRJMQC.mjs";import{b as ya,r as Ua}from"https://app.framerstatic.com/chunk-5KQ3SK2O.mjs";import{e as Xt,f as ga}from"https://app.framerstatic.com/chunk-VSBWNVLJ.mjs";import{a as Ji,j as J}from"https://app.framerstatic.com/chunk-GXDC2KXO.mjs";import"https://app.framerstatic.com/chunk-PABHF7FN.mjs";import{Ac as li,Hg as Ci,Ig as wi,Ja as ii,Ld as On,Md as Nn,Ub as ai,Wg as Ui,_c as ci,ac as si,be as ui,ce as gi,de as yi,ee as hi,id as fi,jd as N,ka as kn,vd as mi,wd as pi}from"https://app.framerstatic.com/chunk-FEMUQY7R.mjs";import"https://app.framerstatic.com/chunk-XP3D7M44.mjs";import"https://app.framerstatic.com/chunk-XFNBDXCA.mjs";import{e as di,f as Fe}from"https://app.framerstatic.com/chunk-XBM64GTP.mjs";import"https://app.framerstatic.com/chunk-Y4KSD2WZ.mjs";import"https://app.framerstatic.com/chunk-2DRY76XI.mjs";import{b as es}from"https://app.framerstatic.com/chunk-54LDZIIU.mjs";import"https://app.framerstatic.com/chunk-KP5P2WBL.mjs";import{Af as yt,Be as D,Bf as ht,Cf as Ct,Dd as ki,Dg as Li,Ef as Uo,He as Ce,I as Si,Kc as Ei,Le as Ni,Oe as Bi,Of as Gi,Qe as Ti,Ye as wo,af as Ai,b as bi,bf as Di,cb as vi,cf as Mi,h as Fi,ig as Vi,jg as zi,kb as Pi,ne as Oi,ng as Wi,og as qi,ve as ce,vf as Ri,wf as _i}from"https://app.framerstatic.com/chunk-D4BIMG4Z.mjs";import{a as No}from"https://app.framerstatic.com/chunk-6OD3X52Q.mjs";import"https://app.framerstatic.com/chunk-CXBV5MVG.mjs";import"https://app.framerstatic.com/chunk-PKXMCYET.mjs";import"https://app.framerstatic.com/chunk-IYBTX7V5.mjs";import"https://app.framerstatic.com/chunk-RWORSJPX.mjs";import{a as Oa}from"https://app.framerstatic.com/chunk-B6BDCZCR.mjs";import{a as X}from"https://app.framerstatic.com/chunk-QFU6OGL3.mjs";import{a as ka,b as Na,c as Ba}from"https://app.framerstatic.com/chunk-CTKJD4ES.mjs";import"https://app.framerstatic.com/chunk-SWNEK4MT.mjs";import{$e as Co,Dd as ri,kc as W,sb as ni}from"https://app.framerstatic.com/chunk-ZI4WEUOX.mjs";import{$b as zr,$h as Zr,Ae as Kr,Aq as po,B as Ve,Be as Xr,Cd as E,Dd as he,Eu as En,G as Ae,Gd as Lr,Hc as Wr,Hd as Lt,Hp as vn,Jc as qr,Jm as Jr,Kp as Pn,Lc as be,Lk as Sn,Ml as co,Mq as uo,N as ze,Nq as go,Ol as $e,Oq as yo,Pq as ho,Sn as Qr,Tl as fo,Tn as $r,Xk as lo,Zk as Yr,_b as Vr,ac as T,gb as Rr,gq as ti,ib as _r,ji as jr,l as Z,la as ye,mm as Hr,mu as gt,vr as Kt,wq as Ke,xq as oi,yb as Gr,yq as mo}from"https://app.framerstatic.com/chunk-Q5MQYIKV.mjs";import"https://app.framerstatic.com/chunk-VXJAAVJQ.mjs";import"https://app.framerstatic.com/chunk-KD4H3DLZ.mjs";import{f as ei}from"https://app.framerstatic.com/chunk-5DSVU7DA.mjs";import"https://app.framerstatic.com/chunk-4DUBS6C5.mjs";import"https://app.framerstatic.com/chunk-XFC6OVIX.mjs";import"https://app.framerstatic.com/chunk-JH66VPYF.mjs";import"https://app.framerstatic.com/chunk-XFC6OVIX.mjs";import"https://app.framerstatic.com/chunk-LH43QRIB.mjs";import{a as B,b as kr}from"https://app.framerstatic.com/chunk-4AQCMAAQ.mjs";import"https://app.framerstatic.com/chunk-IEAVFMRN.mjs";import{c as Or}from"https://app.framerstatic.com/chunk-SSXQNR5C.mjs";import"https://app.framerstatic.com/chunk-4ZPMQ7AD.mjs";import"https://app.framerstatic.com/chunk-POQKH4YA.mjs";import{e as xi,g as Ii,i as H}from"https://app.framerstatic.com/chunk-BL4ITT6Z.mjs";import"https://app.framerstatic.com/chunk-AUNF3KWQ.mjs";import{k as Nr,t as Br,u as Tr}from"https://app.framerstatic.com/chunk-Y3X6G54E.mjs";import{p as qe,q as Le,r as so}from"https://app.framerstatic.com/chunk-RJOTTV32.mjs";import{b as $,d as Dr,e as We,f as ao,i as le,o as Mr}from"https://app.framerstatic.com/chunk-ZQUNXESX.mjs";import{Vc as Ie,a as K,b as U,sc as Ar}from"https://app.framerstatic.com/chunk-BWUNBOFS.mjs";import"https://app.framerstatic.com/chunk-4CB4BQFV.mjs";import{b as Er}from"https://app.framerstatic.com/chunk-ORIFM75E.mjs";import"https://app.framerstatic.com/chunk-66XIMNKS.mjs";import{D as Pr,ba as qt,ca as ut,i as no,l as oe,p as ro}from"https://app.framerstatic.com/chunk-IZV4HDYJ.mjs";import{a as u,b as Wt}from"https://app.framerstatic.com/chunk-WNSBRACC.mjs";import{a as io}from"https://app.framerstatic.com/chunk-LQILWJHN.mjs";import{e as y,f as Re,g as _e,h as G,i as te,j as C,k as Ge,l as Y,m as zt}from"https://app.framerstatic.com/chunk-AHQIRSXG.mjs";var _s=y(U()),Cf={BooleanControlPropRow:Mo,EnumControlPropRow:ps,StringControlPropRow:Zt};function Rs({children:o}){return(0,_s.jsx)(Qa.Provider,{value:Cf,children:o})}var _n="data-chrome";function Gs(o){return o instanceof HTMLElement?o.closest(`[${_n}]`)!==null:!1}function Vs(){return window}function Gn(){return Vs().secureFrameAncestors}function vt(){B(Gn(),"Must have secure frame ancestors.")}var en=y(K());var zs="chromeHidden_c1gxt05z",Ws="nonHudChromeWrapper_n1sd5akc";var Vo=y(K());var Vn=y(U());function qs({collectionItemNode:o,collectionNode:n,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=N(),l=n.getPropertyControls(s.tree)[t];return B(l?.type==="boolean"),(0,Vn.jsx)(A,{title:l.title??"",warningMessage:r,children:(0,Vn.jsx)(ws,{control:l,controlProp:e,fieldId:t,itemId:o.id,onChange:d=>{J(d)&&i(t,d)}})})}var Ls="onPageCMSFieldsModal_o1kosemn",Ks="onPageCMSFieldsModalHeader_o1tcokht",Xs="onPageCMSFieldsModalBody_o11jr4ka",Uf=1,Zs=H.panelPadding+Uf,js="onPageCMSFieldsModalButtonContainer_oaqx903",Pt="button_b1gqim6f";var Ys="wrapper_wje69dc",Hs="input_i1rqgchl",Js="icon_ixghur2",Qs="collectionInputHeight_c1d0unc6";var zn=y(U());function $s({collectionNode:o,controlProp:n,variableId:e,warningMessage:t,onChange:r}){let i=N(),c=o.getPropertyControls(i.tree)[e];B(c?.type==="collectionreference");let l=Qr(c,n);B(!T(l),"Variables are not supported");let d=c.dataIdentifier;function p(m){r(e,{type:"collectionreference",value:m})}return(0,zn.jsx)(A,{title:c.title??"",warningMessage:t,children:(0,zn.jsx)(ns,{large:!0,value:l,onChange:p,className:Hs,dataIdentifier:d,wrapperClassName:Rr(Ys,Qs),iconClassName:Js})})}var Wn=y(U());function el({collectionItemNode:o,collectionNode:n,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=N(),l=n.getPropertyControls(s.tree)[t];return B(l?.type==="color"),(0,Wn.jsx)(A,{title:l.title??"",warningMessage:r,children:(0,Wn.jsx)(xs,{control:l,controlProp:e,fieldId:t,itemId:o.id,onChange:d=>{J(d)&&i(t,d)},ColorPickerPopoutComponent:Ja})})}var qn=y(U());function tl({collectionItemNode:o,collectionNode:n,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=N(),l=n.getPropertyControls(s.tree)[t];return B(l?.type==="date"),(0,qn.jsx)(A,{title:l.title??"",warningMessage:r,children:(0,qn.jsx)(Is,{control:l,controlProp:e,fieldId:t,itemId:o.id,onChange:d=>{J(d)&&i(t,d)},required:!1})})}var Ln=y(U());function ol({collectionItemNode:o,collectionNode:n,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=N(),l=n.getPropertyControls(s.tree)[t];return B(l?.type==="enum"),(0,Ln.jsx)(A,{title:l.title??"",warningMessage:r,children:(0,Ln.jsx)(bs,{control:l,controlProp:e,fieldId:t,itemId:o.id,onChange:d=>{J(d)&&i(t,d)}})})}var Kn=y(U());function nl({collectionItemNode:o,collectionNode:n,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=N(),l=n.getPropertyControls(s.tree)[t];if(B(l?.type==="file"),B(!be(e?.value),"Dynamic values are not supported within required field validation"),e&&e?.type!=="file")return null;let p=(e?.value??"").split(".").pop(),m=!p||l.allowedFileTypes.length===0||l.allowedFileTypes.includes(p);return(0,Kn.jsx)(A,{title:l.title??"",warningMessage:r,showWarningTint:!m,children:(0,Kn.jsx)(Fs,{control:l,controlProp:e,fieldId:t,itemId:o.id,onChange:f=>{J(f)&&i(t,f)},reset:()=>{i(t,{type:"file",value:void 0})}})})}var Xn=y(U());function rl({collectionItemNode:o,collectionNode:n,controlProp:e,variableId:t,onChange:r}){let i=N(),s=Aa(a=>{let h=a(e);h&&r(t,h)}),l=n.getPropertyControls(i.tree)[t];B(l?.type==="array"),B(!e||jr(e));let d=za(e,l,!0),p=Wa(e,l,!0),f=Oo(d??p,l);return(0,Xn.jsx)(A,{title:l.title??"",warningMessage:f,children:(0,Xn.jsx)(Ss,{collectionId:n.id,control:l,fieldId:t,controlProp:e,itemId:o.id,onChange:s,required:!1})})}var Zn=y(U());function il({collectionItemNode:o,collectionNode:n,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=N(),l=n.getPropertyControls(s.tree)[t];return B(l?.type==="responsiveimage"),(0,Zn.jsx)(A,{title:l.title??"",warningMessage:r,children:(0,Zn.jsx)(vs,{control:l,controlProp:e,fieldId:t,itemId:o.id,onChange:d=>{let p=d(e);J(p)&&i(t,p)},reset:()=>{let d={type:"image",value:void 0};i(t,d)}})})}var jn=y(U());function al({collectionItemNode:o,collectionNode:n,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=N(),l=n.getPropertyControls(s.tree)[t];return B(l?.type==="link"),(0,jn.jsx)(A,{title:l.title??"",warningMessage:r,children:(0,jn.jsx)(Ps,{control:l,controlProp:e,fieldId:t,itemId:o.id,onChange:d=>{J(d)&&i(t,d)},reset:()=>{let d={type:"link",value:void 0};i(t,d)}})})}var sl="inputWrapper_i4uywus";var Yn=y(U());function ll({collectionNode:o,controlProp:n,variableId:e,warningMessage:t,onChange:r}){let i=N(),c=o.getPropertyControls(i.tree)[e];u(c?.type==="multicollectionreference");let l=c.dataIdentifier,d=$r(c,n)??[];return u(!T(d),"Variables are not supported"),(0,Yn.jsx)(A,{title:c.title??"",warningMessage:t,children:(0,Yn.jsx)(gs,{large:!0,value:d,onChange:p=>{r(e,{type:"multicollectionreference",value:p})},wrapperClassName:sl,dataIdentifier:l})})}var Hn=y(U());function cl({collectionItemNode:o,collectionNode:n,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=N(),l=n.getPropertyControls(s.tree)[t];return B(l?.type==="number"),(0,Hn.jsx)(A,{title:l.title??"",warningMessage:r,children:(0,Hn.jsx)(Es,{control:l,controlProp:e,fieldId:t,itemId:o.id,onChange:d=>{J(d)&&i(t,d)}})})}var Ro=y(U()),fl=["left","right","auto-vertical"];function dl({collectionNode:o,collectionItemNode:n,controlProp:e,variableId:t,onChange:r,warningMessage:i}){let s=N(),l=o.getPropertyControls(s.tree)[t];u(l?.type==="richtext");let d=e&&Or(e.value)?e.value:void 0,p=a=>{r(t,{type:l.type,value:a})},m=No(()=>Ke(po)),f=so("pasteMarkdown");return(0,Ro.jsx)(A,{title:l.title??"",warningMessage:i,children:f?(0,Ro.jsx)(Bo,{enabled:!0,schema:m,compactTagSelector:!0,defaultValue:d??"",onChange:p,scopeType:"ContentManagement",onUnsavedChange:Xe,popoverAttachmentEdge:fl,fallbackToModalAppearance:!0,saveOnMetaArrowNavigation:!0},n.id):(0,Ro.jsx)(To,{enabled:!0,supportsEmbeds:!0,supportsMedia:!0,compactTagSelector:!0,defaultValue:d??"",onChange:p,scopeType:"ContentManagement",onUnsavedChange:Xe,popoverAttachmentEdge:fl,fallbackToModalAppearance:!0,saveOnMetaArrowNavigation:!0},n.id)})}var _o=y(U());function ml({collectionNode:o,collectionItemNode:n,controlProp:e,variableId:t,onChange:r,warningMessage:i}){let s=N(),l=o.getPropertyControls(s.tree)[t];u(l?.type==="string");let d=e&&$(e.value)?e.value:void 0,p=l.placeholder,m=l.defaultValue??"",f=d??m,a=h=>{r(t,{type:l.type,value:h})};return(0,_o.jsx)(A,{title:l.title??"",warningMessage:i,children:l.displayTextArea?(0,_o.jsx)(Ai,{value:f,onChange:a,constantChange:!0,placeholder:p,minRows:10,maxRows:30,className:Os},n.id):(0,_o.jsx)(Di,{type:l.obscured?"password":"text",value:f,onChange:a,placeholder:p,constantChange:!0,className:Us})})}var P=y(U());function ul({fieldIdsToShow:o,requiredFieldsOnly:n}){let[e,t]=(0,Vo.useState)(()=>new Map),r=e.size>0,i=b(),{treeStore:s}=i.stores,c=Do(),l=Ao(),d=()=>{for(let[h,g]of e)s.tree.current(l)?.setControlProp(h,g);n?i.stores.canvasStore.saveTemporaryCollectionItem():i.stores.projectStore.commitTreeAndSend(),i.stores.modalStore.dismissAll()},p=()=>{vo()||d()},m=Sf({collectionNode:c,collectionItemNode:l,tempControlProps:e,fieldIdsToShow:o});function f(h){let w=c?.getPropertyControls(s.tree)?.[h];if(!w)return;let x=m.get(h);if(x?.type!=="required")return Oo(x,w)}let a=(h,g)=>{u(l,"CollectionItemNode must be present");let w=l.getControlProp(h);t(x=>w?.value===g.value?qt.remove(x,h):ao(w?.value)&&ao(g.value)&&Ea(w.value,g.value)?qt.remove(x,h):pl(w)&&pl(g)?qt.remove(x,h):qt.set(x,h,g))};return(0,P.jsxs)(yt,{hasBackdrop:!0,className:Ls,visible:o.length>0,onDismiss:n?i.stores.modalStore.dismiss:d,onConfirm:p,children:[(0,P.jsx)(ht,{separator:!0,title:n?"Required Fields":"All Fields",className:Ks,children:(0,P.jsx)(Ct,{onDismiss:i.stores.modalStore.dismiss})}),(0,P.jsxs)(Li,{className:Xs,children:[(0,P.jsx)(Gi,{size:0}),o.map(h=>{if(!c||!l)return null;let g=c.getVariable(h);if(!g)return null;let w=e.get(h)??l.getControlProp(h);return(0,P.jsx)(Ff,{variable:g,collectionItemNode:l,collectionNode:c,controlProp:w,onChange:a,getWarningMessage:f},h)})]}),(0,P.jsx)(Uo,{displayDivider:!1,paddingTop:Zs,className:js,gap:H.inputSpacing,children:(0,P.jsxs)(bi,{children:[(0,P.jsxs)(Le,{isOn:"onPageEditingDiscardItems",children:[n?(0,P.jsx)(D,{bold:!0,onClick:i.stores.modalStore.dismiss,className:Pt,children:(0,P.jsx)(Ce,{children:"Cancel"})}):(0,P.jsx)(D,{bold:!0,onClick:i.stores.modalStore.dismiss,className:Pt,children:(0,P.jsx)(Ce,{children:r?"Discard":"Cancel"})}),(0,P.jsx)(D,{bold:!0,type:"submit",variant:"primary",onClick:d,className:Pt,enabled:n?m.size===0:r,children:(0,P.jsx)(Ce,{children:"Save"})})]}),(0,P.jsxs)(Le,{isNotOn:"onPageEditingDiscardItems",children:[(0,P.jsx)(D,{bold:!0,onClick:i.stores.modalStore.dismiss,className:Pt,children:(0,P.jsx)(Ce,{children:n?"Cancel":"Discard"})}),(0,P.jsx)(D,{bold:!0,type:"submit",variant:"primary",onClick:d,className:Pt,enabled:m.size===0||!n,children:(0,P.jsx)(Ce,{children:"Save"})})]})]})})]})}function Ff({variable:o,collectionItemNode:n,collectionNode:e,controlProp:t,onChange:r,getWarningMessage:i}){let s=o.type;switch(s){case"slug":return $e(o)?(0,P.jsx)(ks,{collectionNode:e,collectionItemNode:n,controlProp:t,onChange:r,variable:o,warningMessage:i(o.id)}):null;case"string":return(0,P.jsx)(ml,{collectionNode:e,collectionItemNode:n,controlProp:t,variableId:o.id,onChange:r,warningMessage:i(o.id)});case"richtext":return(0,P.jsx)(dl,{collectionNode:e,collectionItemNode:n,controlProp:t,variableId:o.id,onChange:r,warningMessage:i(o.id)});case"link":return(0,P.jsx)(al,{collectionItemNode:n,collectionNode:e,controlProp:t,variableId:o.id,warningMessage:i(o.id),onChange:r});case"image":return(0,P.jsx)(il,{collectionItemNode:n,collectionNode:e,controlProp:t,variableId:o.id,warningMessage:i(o.id),onChange:r});case"array":return(0,P.jsx)(rl,{collectionItemNode:n,collectionNode:e,controlProp:t,variableId:o.id,onChange:r});case"multicollectionreference":return(0,P.jsx)(ll,{collectionNode:e,controlProp:t,variableId:o.id,warningMessage:i(o.id),onChange:r});case"collectionreference":return(0,P.jsx)($s,{collectionNode:e,controlProp:t,variableId:o.id,warningMessage:i(o.id),onChange:r});case"file":return(0,P.jsx)(nl,{collectionItemNode:n,collectionNode:e,controlProp:t,variableId:o.id,warningMessage:i(o.id),onChange:r});case"date":return(0,P.jsx)(tl,{collectionItemNode:n,collectionNode:e,controlProp:t,variableId:o.id,warningMessage:i(o.id),onChange:r});case"number":return(0,P.jsx)(cl,{collectionItemNode:n,collectionNode:e,controlProp:t,variableId:o.id,warningMessage:i(o.id),onChange:r});case"boolean":return(0,P.jsx)(qs,{collectionItemNode:n,collectionNode:e,controlProp:t,variableId:o.id,warningMessage:i(o.id),onChange:r});case"enum":return(0,P.jsx)(ol,{collectionItemNode:n,collectionNode:e,controlProp:t,variableId:o.id,warningMessage:i(o.id),onChange:r});case"color":return(0,P.jsx)(el,{collectionItemNode:n,collectionNode:e,controlProp:t,variableId:o.id,warningMessage:i(o.id),onChange:r});default:kr(s)}}function Sf({collectionNode:o,collectionItemNode:n,tempControlProps:e,fieldIdsToShow:t}){let r=b(),{tree:i}=r.stores.treeStore.useState(),s=Va(o,n);return(0,Vo.useMemo)(()=>{let c=new Map;if(!o||!n)return c;for(let l of t){let d=o.getVariable(l);if(!d)continue;let m=o.getPropertyControls(i)[l];if(!m)continue;let f=e.get(l)??n.getControlProp(l),a=s.get(l),h;(co(d)||$e(d))&&(h=Eo(d,o.variables,n));let g=ko(d.type,m,f,h,void 0,fo(d),a);g&&c.set(l,g)}return c},[o,n,t,s,i,e])}function pl(o){return!o||Mr(o.value)?!0:$(o.value)?oa(o.value):ao(o.value)?o.value.length===0:!1}var zo=y(K());var gl="editorContainer_e1zu74n";var hl=y(U());function yl({initialHtml:o,onContentChange:n,onEscape:e}){let t=(0,zo.useRef)(null);return(0,zo.useEffect)(()=>{let r;async function i(){let{baseKeymap:s,chainCommands:c,dropCursor:l,gapCursor:d,history:p,keymap:m,redo:f,undo:a,undoInputRule:h}=await xt(),g=qe.isOn("pasteMarkdown")?(I,v,O)=>yo(I,v,O):(I,v,O)=>ho(I,O),w=Ke(mo),x=g(o,w,{plugins:[p(),m({"Mod-z":c(h,a),"Mod-Shift-z":f,"Shift-Enter":xo(w),"Mod-b":Dn(w.marks.bold),"Mod-i":Dn(w.marks.italic),"Shift-Tab":ra(w.nodes.listItem),Tab:c(ia(w.nodes.listItem),()=>!0),Backspace:c(h,Io(w)),Escape:()=>(e?.(),!!e)}),m(s),l({color:"var(--framer-color-text)",width:2}),d(),bo()]}),F,k=new ei(null,{state:x,editable:()=>!0,dispatchTransaction:I=>{let v=k.state.apply(I);if(k.updateState(v),F!==v.doc){let O=qe.isOn("pasteMarkdown")?uo(v.doc,w):go(v.doc);n(O),F=v.doc}}});t.current&&(t.current.innerHTML="",t.current.appendChild(k.dom)),r=k}return i(),()=>r?.destroy()},[o,n,e]),(0,hl.jsx)("div",{ref:t,className:gl})}var j=class{constructor(n){this.engine=n}};var Pf=/^(?<hashes>#{1,6})\s$/u,fe=class o extends j{constructor(e,t,r,i="none"){super(e);this.nodeId=t;this.renderId=r;this.eventSource=i;C(this,"handleOnFocus",()=>this.proseMirrorEditor?.controls.handleOnFocus());C(this,"handleOnBlur",()=>this.proseMirrorEditor?.controls.handleOnBlur());C(this,"proseMirrorEditor",null);C(this,"hasTextFitViewBox",!1);this.engine.beginUndoGroup(),this.start()}getRichTextNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,E)}update(){let e=this.getRichTextNode();if(!e||!o.supportsNode(e)){this.engine.exitTool();return}if(!e.textFitViewBoxSize||this.hasTextFitViewBox)return;let t=hi(this.engine.tree,e);this.engine.stores.projectStore.commitTreeAndSend(),t&&(this.hasTextFitViewBox=!0)}async stop(){let e=this.getRichTextNode();e&&(e.cache.isEditable=!1),this.proseMirrorEditor?.destroy(),this.proseMirrorEditor=null,this.engine.endUndoGroup(),this.engine.stores.toolStore.proseMirrorView=null,this.engine.stores.toolStore.nodeInTextEditor=null}start(){let e=this.getRichTextNode();if(!e)return;this.hasTextFitViewBox=ui(this.engine.tree,e),this.engine.stores.projectStore.commitTreeAndSend();let t=Fo(this.engine.tree,e);if(t.length===0){this.init();return}Ve.loadFonts(t).catch(oe).finally(()=>this.init())}init(){this.startAsync().catch(e=>{oe(e),this.engine.exitTool()})}async startAsync(){let e=this.getRichTextNode();if(!e)return this.engine.exitTool();this.proseMirrorEditor=await this.createProseMirrorEditor(e),e.cache.isEditable=!0,this.engine.stores.toolStore.proseMirrorView=this.proseMirrorEditor.view}async createProseMirrorEditor(e){let{baseKeymap:t,chainCommands:r,createParagraphNear:i,Decoration:s,DecorationSet:c,dropCursor:l,EditorView:d,ellipsis:p,emDash:m,gapCursor:f,history:a,InputRule:h,inputRules:g,keymap:w,liftEmptyBlock:x,liftListItem:F,newlineInCode:k,redo:I,sinkListItem:v,splitBlock:O,splitListItem:Gt,toggleMark:dt,undo:gf,undoInputRule:br}=await xt(),pe=this.engine,L=Ke(mo),yf=r(Gt(L.nodes.listItem),k,i,x,sa(L),aa(L),(z,R)=>O(z,R&&(V=>{let Me=z.selection,mt=this.getRichTextNode();u(mt,"RichTextNode not found");let xe=Me.$from.node(1);if(!Pn(xe)||!(Me.$to.parentOffset===Me.$to.parent.content.size))return R(V);let se={...xe.attrs},Qe=vn(xe)&&se.tag!=="p",Vt=V.mapping.map(z.selection.to),pt=z.selection.$from.marks();if(Qe){let Te=mt.getNodeTextStylePreset(pe.tree,"p")??On(pe.tree,"p")??kn.createDefault("p");Nn(pe,Te),mt.setNodeTextStylePreset(Te),pe.stores.projectStore.commitTreeAndSend(),se.textStylePreset=Te.id,se.tag="p",se.inlineStyles={},se.blockStyles={}}else{let Te=pt.find(ti);se.inlineStyles={...se.inlineStyles,...Te?.attrs.inlineStyles}}V.setNodeMarkup(Vt-1,void 0,se),V.setStoredMarks(pt),Qe&&V.removeStoredMark(L.marks.inlineStyles),R(V)})));function hf(){return pe.exitTool(),!0}u(!T(e.htmlContent),"Can't edit rich text node when htmlContent variable is assigned"),u(!T(e.textContent),"Can't edit rich text node when textContent variable is assigned");let Fr=()=>{let z=this.getRichTextNode();u(z,"RichTextNode not found");let R=z.getNodeInlineCodeStylePreset(pe.tree)??mi(pe.tree)??new si;return pi(pe,R),z.setNodeInlineCodeStylePreset(R),R.id},Sr=(qe.isOn("pasteMarkdown")?(z,R,V)=>yo(z,R,V):(z,R,V)=>ho(z,V))(e.html,L,{plugins:[a(),w({"Mod-z":r(br,gf),"Mod-Shift-z":I,"Shift-Enter":xo(L),"Mod-b":dt(L.marks.bold),"Mod-i":dt(L.marks.italic),"Shift-Tab":F(L.nodes.listItem),Tab:r(v(L.nodes.listItem),()=>!0),Backspace:r(br,Io(L)),Escape:hf,Enter:yf,"Mod-Shift-c":dt(L.marks.inlineCode,{get inlineCodeStylePreset(){return Fr()}})}),w(t),l({color:Ii.cmsRichTextDropCursor,width:H.richTextDropCursor}),f(),bo(),pa({engine:this.engine,schema:L,nodeId:this.nodeId,getRichTextNode:()=>this.getRichTextNode()}),g({rules:[m,p,new h(Pf,(z,R,V,Me)=>{let mt=z.doc.resolve(V),xe=mt.node(1),oo=mt.before(1);if(!Pn(xe))return null;let se=z.tr,Qe="h"+(R.groups?.hashes?.length||1),Vt=this.getRichTextNode();u(Vt,"RichTextNode not found");let pt=Vt.getNodeTextStylePreset(pe.tree,Qe)??On(pe.tree,Qe)??kn.createDefault(Qe),Te=pt.id;return Nn(pe,pt),Vt.setNodeTextStylePreset(pt),pe.stores.projectStore.commitTreeAndSend(),vn(xe)||se.removeMark(oo,oo+xe.nodeSize,L.marks.inlineStyles),se.delete(V,Me),se.setNodeMarkup(oo,L.nodes.textBlock,{...xe.attrs,blockStyles:Te?{}:xe.attrs.blockStyles,inlineStyles:Te?{}:xe.attrs.inlineStyles,textStylePreset:Te,tag:Qe}),se}),la(L),ca(L)]}),...na({markType:L.marks.inlineCode,attrs:{get inlineCodeStylePreset(){return Fr()}}})]}),vr,De=new d(null,{state:Sr,dispatchTransaction:z=>{let R=this.getRichTextNode();u(R,"Node should not be null");let V=De.state.apply(z);if(De.updateState(V),V=gi(V,De,R),vr!==V.doc){let Me=qe.isOn("pasteMarkdown")?uo(V.doc,L):go(V.doc);R.html!==Me&&(o.updateNodeWithBreakpointAwareness({engine:this.engine,html:Me,node:R}),yi(R,De)),vr=V.doc}this.engine.stores.projectStore.commitTreeAndSend()}});return{controls:{handleOnFocus(){De.setProps({decorations(){}})},handleOnBlur(){De.setProps({decorations(z){let R=z.selection;if(R.from!==R.to)return document.getSelection()?.removeAllRanges(),c.create(z.doc,[s.inline(R.from,R.to,{class:"selection",nodeName:"mark"})])}})}},destroy:()=>De.destroy(),state:Sr,view:De}}static updateNodeWithBreakpointAwareness({engine:e,node:t,html:r,breakpointNode:i}){let{tree:s,stores:c}=e,{routeStore:l,canvasStore:d,treeStore:p}=c;i??=ue(l,p,d);let m=t.originalid??t.id,f=!Gr(i)||Hr(i)||!m,a=!Co(s,t,"html"),h=s.getNodeWithTrait(m,E);if(u(h,`originalNode with id ${m} must exist`),f||a){h.set({html:r});return}if(t.getTextContent()===h.getTextContent()){h.set({html:li(h.html,ci(r))});return}t.set({html:r},s,!1,!1)}static supportsNode(e){return E(e)&&!e.htmlContent&&!e.textContent}};var de=y(K());var Cl="modal_m168h77v";var ne=y(U());function wl({richTextNodeId:o}){let n=b(),e=Se(),[t,r]=(0,de.useState)(()=>{let a=ue(n.stores.routeStore,n.stores.treeStore,n.stores.canvasStore);return u(a,"activeOnPageBreakpointNode must exist"),a.id}),i=(0,de.useRef)(new Map),s=(0,de.useMemo)(()=>n.stores.treeStore.tree.getNodeWithTrait(o,E)?.originalid??o,[o]),c=(0,de.useCallback)(()=>n.stores.scopeStore.active.getTopLevelReplicaVariants().find(({id:a})=>t===a),[t]),l=(0,de.useCallback)(()=>{let a=c();if(!a)return;let h=Kt(a.id,s),g=n.stores.treeStore.tree.get(h);return E(g)?g:void 0},[c,s]),d=(0,de.useMemo)(()=>{let a=i.current.get(t);if(a!==void 0)return a;if(t===n.stores.scopeStore.active.getPrimaryVariant().id){let h=n.stores.treeStore.tree.getNodeWithTrait(s,E);return u(h,"originalNode should exist"),h.html}return l()?.html??""},[l,t,s]),p=(0,de.useCallback)(a=>i.current.set(t,a),[t]),m=(0,de.useCallback)(()=>{n.exitTool(),n.stores.modalStore.dismiss()},[]),f=(0,de.useCallback)(()=>{let a=n.stores.scopeStore.active.getPrimaryVariant(),h=i.current.get(a.id);if(h!==void 0){let g=n.stores.treeStore.tree.getNodeWithTrait(s,E);u(g,`originalNode with id ${s} must exist`),g.html!==h&&g.set({html:h})}n.stores.scopeStore.active.getTopLevelReplicaVariants().forEach(g=>{let w=i.current.get(g.id);if(w===void 0)return;let x=Kt(g.id,s),F=n.stores.treeStore.tree.get(x);E(F)&&F.html!==w&&fe.updateNodeWithBreakpointAwareness({breakpointNode:g,engine:n,html:w,node:F})}),i.current.clear(),n.stores.projectStore.commitTreeAndSend(),m()},[m,s]);return(0,ne.jsxs)(yt,{visible:!0,hasBackdrop:!0,onDismiss:m,className:Cl,children:[(0,ne.jsx)(ht,{separator:!0,title:"Responsive Text",children:(0,ne.jsx)(Ct,{onDismiss:m})}),(0,ne.jsxs)(ce,{gap:H.inputSpacing,paddingTop:H.modalPadding,children:[(0,ne.jsx)(qi,{children:e?.getTopLevelVariants().map(a=>(0,ne.jsx)(Wi,{identifier:a.id,title:a.name??a.id,selected:t===a.id,onSelect:r},a.id))}),(0,ne.jsx)(yl,{initialHtml:d,onContentChange:p,onEscape:m})]}),(0,ne.jsxs)(Uo,{displayDivider:!0,children:[(0,ne.jsx)(D,{bold:!0,onClick:m,variant:"default",children:(0,ne.jsx)(Ce,{children:"Cancel"})}),(0,ne.jsx)(D,{bold:!0,onClick:f,variant:"primary",children:(0,ne.jsx)(Ce,{children:"Save"})})]})]})}var Wo=y(K());var Ul="modal_m1cvfiap",xl="form_f1nz04q2",Il="scroll_syo0l7n",bl="width100_w9541mz",Jn="editor_e73gufq";var je=y(U()),Fl=["left","right","auto-vertical"];function vl({controlKey:o,nodeId:n}){let e=N(),t=()=>{e.stores.modalStore.dismiss()},r=It(()=>{let a=e.stores.treeStore.tree.get(n);return!Lt(a)&&!he(a)?null:a},[n],["Tree"]),i=It(()=>{let f=e.tree.getScopeNodeFor(r);return f?$i(f):null},[r],["Tree"]),s=It(()=>{if(Lt(r)){let f=r?.parentid,a=e.stores.treeStore.tree,h=a.getNodeWithTrait(f,Lr);if(!h)return null;let w=h.getPropertyControls(a)[o];return w?.type==="richtext"?w:null}if(he(r)){let f=Z.reactComponentForIdentifier(r.codeComponentIdentifier);if(!f)return null;let a=f.properties[o];return a?.type==="richtext"?a:null}return null},[o,r],["Tree","ActiveBundle"]),c=(0,Wo.useMemo)(()=>{if(!r)return"";let f=Sl(r,o);return $(f?.value)?f.value:""},[r,o]),l=!!i&&!!r&&s?.type==="richtext",d=f=>{if(!r)return;let a=e.stores.treeStore.tree.current(r);if(!a)return;let h,g=Sl(r,o);g?h={...g,value:f}:h={type:"richtext",value:f},Lt(a),a.setControlProp(o,h),u(ji(e),"Only on-page engine can commit tree"),e.stores.projectStore.commitTreeAndSend()};(0,Wo.useEffect)(()=>{l||e.stores.modalStore.dismiss()},[l]);let p=No(()=>Ke(lo(r)?po:oi)),m=so("pasteMarkdown");return l?(0,je.jsxs)(yt,{visible:!0,hasBackdrop:!0,onDismiss:t,className:Ul,formClassName:xl,children:[(0,je.jsx)(ht,{separator:!0,title:s.title??"Unknown",className:bl,children:(0,je.jsx)(Ct,{onDismiss:t})}),(0,je.jsx)(Mi,{className:Il,children:m?(0,je.jsx)(Bo,{enabled:!0,schema:p,className:Jn,defaultValue:c,onChange:d,scopeType:i,onUnsavedChange:Xe,popoverAttachmentEdge:Fl,fallbackToModalAppearance:!0,saveOnMetaArrowNavigation:!0}):(0,je.jsx)(To,{enabled:!0,supportsEmbeds:lo(r),supportsMedia:lo(r),className:Jn,defaultValue:c,onChange:d,scopeType:i,onUnsavedChange:Xe,popoverAttachmentEdge:Fl,fallbackToModalAppearance:!0,saveOnMetaArrowNavigation:!0})})]}):null}function Sl(o,n){if(Lt(o)){let e=o.getControlProp(n);return e?.type==="richtext"&&$(e.value)?e:null}if(he(o)){let e=Z.reactComponentForIdentifier(o.codeComponentIdentifier);if(!e)return null;let r=o.getControlProps(e.properties)[n];if(r?.type==="richtext"&&$(r.value))return r}return null}var jt=y(U()),Of={AcquireAddonModal:null,AcquireAdvancedAnalyticsTrialModal:null,AddToLibrary:null,BatchTranslate:null,CodeFileCreation:null,CompleteSignup:null,ComponentIsolationModal:null,Confirmation:fs,ConfirmBatchTranslateAll:null,ConfirmDefaultLanguage:null,ConfirmDeleteCollectionItems:null,ConfirmDestructiveFeedbackAction:null,ConfirmDraftCollectionItem:null,ConfirmDraftLocale:null,ConfirmDraftPage:null,ConfirmPublishAbTest:null,ConfirmPublishDraftCollectionItem:null,ConfirmPublishDraftLocale:null,ConfirmPublishDraftPage:null,ConfirmRemoveTriggerEvent:null,ConfirmUpdatingAbVariants:null,ConvertToCMSPage:null,CreateAbTest:null,CreateComponent:null,CreateLayoutTemplate:null,CreateManagedCollection:null,CreateTeam:null,DashboardAddRedirect:null,DashboardEditRedirect:null,CustomBreakpoint:null,DeleteCodeFile:null,DeleteCustomFont:null,DeleteEntityFolder:null,DeleteFile:null,DeleteMultipleCodeFiles:null,DeleteMultipleEntityFolders:null,DeprecatedDrafts:null,DuplicateProjectWithVersion:null,DuplicateWebPage:null,FigmaImportTutorial:null,FlexToYearly:null,ImageCrop:ds,ImageFocalPoint:ms,ImportFigma:null,ImportRedirects:null,LoadingFullDocument:null,LocaleReady:null,LocaleSettings:null,LocalizationGlossary:null,None:null,NudgePreferences:null,OnPageCMSFieldsModal:ul,OnPageRichTextEditor:vl,OnPageRichTextVariantOverride:wl,OverrideFile:null,PasteFromFigma:null,PlanCancellation:null,PluginCustomHTML:null,PluginFromURL:null,PluginWithModePicker:null,PublishModule:null,QuickActions:null,RemoveTeamLibraryModule:null,ReplaceTextStylePreset:null,ReplaceWebPage:null,SelectProjectToUpgrade:null,Shortcuts:null,StopAbTest:null,SubscriptionNotInOrder:null,TransferProject:null,UnlinkComponent:null,UnsavedChanges:null,UnsupportedFileSize:null,UnsupportedFileType:null,UpgradeDocument:null,UpsellEnterprise:null,UpsellFeature:null,Variables:null,VectorImport:null,VectorSetCreation:null,Welcome:null};function Pl(){let n=b().stores.modalStore.useState(e=>e.stack);return n.map((e,t)=>{if(e.type==="None")return null;let r=Of[e.type];u(r,`Modal is missing: ${e.type}`);let{type:i,...s}=e,c=t===n.length-1,l=e.type+t;return(0,jt.jsx)(Ni,{allowFocusTrap:c,children:(0,jt.jsx)(_i.Provider,{value:Da(i),children:(0,jt.jsx)(Ri.Provider,{value:c?"visible":"hidden",children:(0,jt.jsx)(r,{...s})})})},l)})}function kl({accessStore:o,routeStore:n},e){let t=o.access;u(t.status==="success","Can't open Framer if project access is not successful");let r=e??n.projectLinkNodeId,i=`${io().app}/projects/${t.data.projectSlug}?node=${r}`;window.open(`https://www.framer.com/open-in-app?url=${encodeURIComponent(i)}`,"_blank")}var Ml=y(K());var Ol="toolbar_t49i6vy",ot="button_bjwo6qr",kt="buttonSecondary_b1qwl3y9",Nl="mainContentContainer_m1wta5up",Bl="mainContent_m69kutt",Qn="secondaryText_sdjdrec",Tl="logoIcon_l9efojb";var qo={slug:!0,string:!0,richtext:!0,link:!0,image:!0,array:!0,multicollectionreference:!0,collectionreference:!0,file:!0,date:!0,number:!0,boolean:!0,enum:!0,color:!0};var S=y(U());function Rl(){let o=b(),{routeStore:n,treeStore:e,canvasStore:t,projectStore:r,modalStore:i}=o.stores,{finishedEditing:s}=t.useState(),{hasPermanentlyFailed:c}=r.useState(),l=s?.isNewItem?"Page saved":"Site saved",d=(0,Ml.useCallback)(()=>{let h=St(n,e,t);u(h,"Collection node must exist");let w=qa(h).flatMap(x=>{let F=x.type;return qo[F]!==void 0?x.id:[]});o.exitTool(),i.set({type:"OnPageCMSFieldsModal",fieldIdsToShow:w,requiredFieldsOnly:!1,source:"on_page_hud"})},[n,e,t,i,o]),p=()=>{i.set({type:"Confirmation",title:"Discard Changes",description:"All changes will be lost. This action cannot be undone.",confirmLabel:"Discard",cancelLabel:"Cancel",variant:"destructive",source:"on_page_hud",onConfirm:()=>{t.discardTemporaryCollectionItem()}})},m=Ao(),f=Do(),a=!!m?.privateToUserId;return(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)("div",{className:Ol,children:[(0,S.jsx)(Le,{isOn:"onPageEditingDiscardItems",children:a?(0,S.jsxs)(D,{className:X(ot,kt),onClick:p,children:[(0,S.jsx)(ki,{}),"Discard Page"]}):(0,S.jsx)(Dl,{finishedEditing:s})}),(0,S.jsx)(Le,{isNotOn:"onPageEditingDiscardItems",children:(0,S.jsx)(Dl,{finishedEditing:s})}),(0,S.jsxs)("div",{className:Nl,children:[(0,S.jsx)(Al,{desktopText:"Click to edit",mobileText:"Tap to edit",secondaryText:"Changes are auto-saved",isVisible:!s}),(0,S.jsx)(Al,{desktopText:l,mobileText:l,secondaryText:`A notification was sent to your collaborators. ${s?.isNewItem?"The page":"Changes"} will be visible when the project is published.`,isVisible:!!s})]}),(0,S.jsxs)(ce,{direction:"row",gap:10,children:[f&&!a&&!f.managedByPlugin&&!s&&(0,S.jsxs)(D,{className:X(ot,kt),enabled:!c,onClick:()=>t.createTemporaryCollectionItem(),"aria-label":"Add Page",children:[(0,S.jsx)(Ei,{}),(0,S.jsx)(Lo,{desktopText:"Add Page",mobileText:"Page"})]}),a&&!c&&(0,S.jsxs)(D,{className:X(ot,kt),onClick:d,children:[(0,S.jsx)(Tf,{}),"Show All Fields"]}),s?(0,S.jsxs)(D,{className:X(ot,kt),onClick:()=>t.handleDismissFinishEditing(),children:[(0,S.jsx)(Bf,{}),"Go Back to Site"]}):(0,S.jsxs)(D,{variant:"primary",className:ot,onClick:()=>t.handleFinishEditing(),children:[(0,S.jsx)(Si,{"aria-hidden":"true"}),(0,S.jsx)(Lo,{desktopText:"Finish Editing",mobileText:"Done"})]})]})]})})}function Al({desktopText:o,mobileText:n,secondaryText:e,isVisible:t}){return(0,S.jsx)(Ar,{children:t&&(0,S.jsxs)(Ie.div,{className:Bl,initial:{marginTop:10,opacity:0},animate:{marginTop:0,opacity:1},exit:{marginTop:-10,opacity:0},children:[(0,S.jsx)(Lo,{desktopText:o,mobileText:n}),(0,S.jsx)("span",{className:Qn,children:"\xB7"}),(0,S.jsx)("span",{className:Qn,children:e})]})})}function Lo({desktopText:o,mobileText:n}){let e=Za(`(max-width: ${xi.tabletSmall}px)`);return!n&&e?null:(0,S.jsx)("span",{children:e?n:o})}function Dl({finishedEditing:o}){let n=b(),e=()=>{kl(n.stores,o?.isNewItem?o.nodeId:void 0)};return(0,S.jsxs)(D,{className:X(ot,kt),onClick:e,"aria-label":"Open in Framer",children:[(0,S.jsx)(vi,{"aria-hidden":"true",className:Tl}),(0,S.jsx)(Lo,{desktopText:"Open in Framer"})]})}function Bf(){return(0,S.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"9",height:"9",fill:"none",children:[(0,S.jsx)("path",{d:"M 1.5 7.5 L 8 1",fill:"transparent",strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),(0,S.jsx)("path",{d:"M 3 1 L 8 1 L 8 6",fill:"transparent",strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})]})}function Tf(){return(0,S.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"11",height:"11",fill:"none",children:[(0,S.jsx)("path",{d:"M1 5.5s1.5-3 4.5-3 4.5 3 4.5 3-1.5 3-4.5 3-4.5-3-4.5-3Z",fill:"transparent",strokeWidth:"1.5",stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round"}),(0,S.jsx)("path",{d:"M5.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Z",fill:"#fff"})]})}var ve=class extends j{constructor(e,t,r,i){super(e);this.nodeId=t;this.renderId=r;this.eventSource=i}getNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,gt)||this.engine.tree.getNodeWithTrait(this.nodeId,E)}getVariableInfo(){let e=this.getNode();if(!e)return;let t=En(e);if(!t)return;let r=e.cache.getRenderInstance(this.renderId);if(r)return M(this.engine.tree,this.engine.stores.treeStore.sandboxCollectionData,t,"collectionreference",r.collectionItemId)}getControlProp(){return this.getVariableInfo()?.controlProp}changeValue(e){let t=this.getVariableInfo();if(!t)return;let{collectionItemNode:r,controlProp:i}=t;i.value!==e&&r.setControlProp(t.variableDefinition.id,{...i,value:e})}static supportsNode(e,t,r){let i=En(t);if(!i)return!1;let s=t.cache.getRenderInstance(r);return s?!!M(e.tree,e.stores.treeStore.sandboxCollectionData,i,"collectionreference",s.collectionItemId):!1}};var Pe=class o extends j{constructor(e,t,r){super(e);this.nodeId=t;this.renderId=r}getCodeComponentNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,he)}getEditableControls(){let e=this.getCodeComponentNode();if(e)return o.getEditableControls(this.engine,e,this.renderId)}update(){let e=this.engine,t=this.getCodeComponentNode();(!t||!o.supportsNode(e,t,this.renderId))&&e.exitTool()}stop(){let{modalStore:e}=this.engine.stores;e.stack.some(({type:r})=>r==="OnPageRichTextEditor")&&e.dismissAll()}static getEditableControls(e,t,r){let i=t.cache.getRenderInstance(r);if(!i)return no();let s=Z.reactComponentForIdentifier(t.codeComponentIdentifier);if(!s)return no();let c=t.getControlProps(s.properties);if(!c)return no();let l=[],d=hs(e,t.codeComponentIdentifier);if(Kr(t)&&d)if(Xr(t)){let p=M(e.tree,e.stores.treeStore.sandboxCollectionData,t.dynamicVectorSetIdentifier,"vectorsetitem",i.collectionItemId);p&&l.push({type:"collection",controlKey:"dynamicVectorSetIdentifier",variableInfo:p})}else Pr(t.codeComponentIdentifier)&&l.push({type:"vectorSetItem",codeComponentIdentifier:t.codeComponentIdentifier});for(let p in c){let m=c[p];if(!m)continue;let f=s.properties[p];if(f){if(m.type==="string"){if(T(m.value)){let a=M(e.tree,e.stores.treeStore.sandboxCollectionData,m.value,m.type,i.collectionItemId);if(!a)continue;l.push({type:"collection",controlKey:p,variableInfo:a})}else if(!be(m.value)){u(f.type==="string");let a=Ut(f);u(a,"Reduced control prop should not be null"),wt(a,m,f),l.push({type:"component",controlKey:p,controlDescription:f,controlProp:m,reducedControlProp:a})}}if(m.type==="richtext"){if(T(m.value)){let a=M(e.tree,e.stores.treeStore.sandboxCollectionData,m.value,m.type,i.collectionItemId);if(!a)continue;l.push({type:"collection",controlKey:p,variableInfo:a})}else if(!be(m.value)){u(f.type==="richtext");let a=Ut(f);u(a,"Reduced control prop should not be null"),wt(a,m,f),l.push({type:"component",controlKey:p,controlDescription:f,controlProp:m,reducedControlProp:a})}}if(m.type==="image"){if(T(m.value)){let a=M(e.tree,e.stores.treeStore.sandboxCollectionData,m.value,m.type,i.collectionItemId);if(!a)continue;l.push({type:"collection",controlKey:p,variableInfo:a})}else if(!be(m.value)){u(f.type==="image"||f.type==="responsiveimage");let a=Ut(f);u(a,"Reduced control prop should not be null"),wt(a,m,f),l.push({type:"component",controlKey:p,controlDescription:f,controlProp:m,reducedControlProp:a})}}if(m.type==="date"){if(T(m.value)){let a=M(e.tree,e.stores.treeStore.sandboxCollectionData,m.value,"date",i.collectionItemId);if(!a)continue;l.push({type:"collection",controlKey:p,variableInfo:a})}else if(!be(m.value)){u(f.type==="date");let a=Ut(f);u(a,"Reduced control prop should not be null"),wt(a,m,f),l.push({type:"component",controlKey:p,controlDescription:f,controlProp:m,reducedControlProp:a})}}if(m.type==="vectorsetitem"){if(T(m.value)){let a=M(e.tree,e.stores.treeStore.sandboxCollectionData,m.value,"vectorsetitem",i.collectionItemId);if(!a)continue;l.push({type:"collection",controlKey:p,variableInfo:a})}else if(!be(m.value)){u(f.type==="vectorsetitem");let a=Ut(f);u(a,"Reduced control prop should not be null"),wt(a,m,f),l.push({type:"component",controlKey:p,controlDescription:f,controlProp:m,reducedControlProp:a})}}if(m.type==="link"&&T(m.value)){let a=M(e.tree,e.stores.treeStore.sandboxCollectionData,m.value,"link",i.collectionItemId);if(!a)continue;l.push({type:"collection",controlKey:p,variableInfo:a})}if(m.type==="boolean"&&T(m.value)){let a=M(e.tree,e.stores.treeStore.sandboxCollectionData,m.value,"boolean",i.collectionItemId);if(!a)continue;l.push({type:"collection",controlKey:p,variableInfo:a})}}}return l}static supportsNode(e,t,r){return he(t)?o.getEditableControls(e,t,r).length>0:!1}};var Ee=class o extends j{constructor(e,t,r,i){super(e);this.nodeId=t;this.renderId=r;this.eventSource=i}getRichTextNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,E)}getVariableInfo(){let e=this.getRichTextNode();if(!e)return;let t=e.cache.getRenderInstance(this.renderId);if(!t)return;let r=o.getVariableReference(e);if(r)return M(this.engine.tree,this.engine.stores.treeStore.sandboxCollectionData,r,"date",t.collectionItemId)}getControlProp(){return this.getVariableInfo()?.controlProp}changeValue(e){let t=this.getVariableInfo();if(!t)return;let{collectionItemNode:r,variableDefinition:i,controlProp:s}=t;s.value!==e&&(r.setControlProp(i.id,{...s,value:e}),this.engine.stores.projectStore.commitTreeAndSend())}update(){let e=this.engine,t=this.getRichTextNode();(!t||!o.supportsNode(e,t,this.renderId))&&e.exitTool()}static getVariableReference(e){let t=e.textContent;if(!qr(t))return;let r=t.startValue;if(T(r))return r}static supportsNode(e,t,r){if(!E(t))return!1;let i=o.getVariableReference(t);if(!i)return!1;let s=t.cache.getRenderInstance(r);return s?!!M(e.tree,e.stores.treeStore.sandboxCollectionData,i,"date",s.collectionItemId):!1}};var ke=class o extends j{constructor(e,t,r){super(e);this.nodeId=t;this.renderId=r}update(){let e=this.engine,t=e.tree.get(this.nodeId);(!t||!o.supportsNode(e,t,this.renderId))&&e.exitTool()}static supportsNode(e,t,r){if(!gt(t))return!1;if(T(t.fillImage)){let i=t.cache.getRenderInstance(r);return i?!!M(e.tree,e.stores.treeStore.sandboxCollectionData,t.fillImage,"image",i.collectionItemId):!1}return!Wr(t.fillImage)}};var we=class o extends j{constructor(e,t,r,i){super(e);this.nodeId=t;this.renderId=r;this.eventSource=i;C(this,"controls");this.engine.beginUndoGroup(),xt().then(s=>{e.stores.toolStore.proseMirror??=s})}getRichTextNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,E)}getVariableReference(){let e=this.getRichTextNode();if(!e)return;let t=e.htmlContent;if(T(t))return t}getVariableInfo(){let e=this.getRichTextNode();if(!e)return;let t=e.cache.getRenderInstance(this.renderId);if(!t)return;let r=this.getVariableReference();if(r)return M(this.engine.tree,this.engine.stores.treeStore.sandboxCollectionData,r,"richtext",t.collectionItemId)}getControlProp(){return this.getVariableInfo()?.controlProp}changeValue(e){let t=this.getVariableInfo();if(!t)return;let{collectionItemNode:r,variableDefinition:i,controlProp:s}=t;s.value!==e&&(r.setControlProp(i.id,{...s,value:e}),this.engine.stores.projectStore.commitTreeAndSend())}update(){let e=this.engine,t=this.getRichTextNode();if(!t||!o.supportsNode(e,t,this.renderId))e.exitTool();else{let r=this.getVariableInfo();this.engine.stores.toolStore.validateCollectionControl(r)}}stop(){this.engine.endUndoGroup(),this.engine.stores.toolStore.nodeInTextEditor=void 0}static supportsNode(e,t,r){if(!E(t)||!T(t.htmlContent))return!1;let i=t.cache.getRenderInstance(r);return i?!!M(e.tree,e.stores.treeStore.sandboxCollectionData,t.htmlContent,"richtext",i.collectionItemId):!1}};var Ue=class o extends j{constructor(e,t,r,i){super(e);this.nodeId=t;this.renderId=r;this.eventSource=i;this.engine.beginUndoGroup();let s=this.getRichTextNode();u(s,"Missing rich text node");let c=Fo(this.engine.tree,s);Ve.loadFonts(c).catch(oe)}getRichTextNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,E)}getVariableReference(){let e=this.getRichTextNode();if(!e)return;let t=e.textContent;if(T(t))return t}getVariableInfo(){let e=this.getRichTextNode();if(!e)return;let t=e.cache.getRenderInstance(this.renderId);if(!t)return;let r=this.getVariableReference();if(r)return M(this.engine.tree,this.engine.stores.treeStore.sandboxCollectionData,r,"string",t.collectionItemId)}getControlProp(){return this.getVariableInfo()?.controlProp}changeValue(e){let t=this.getVariableInfo();if(!t)return;let{collectionItemNode:r,variableDefinition:i,controlProp:s}=t;s.value!==e&&(r.setControlProp(i.id,{...s,value:e}),this.engine.stores.projectStore.commitTreeAndSend())}update(){let e=this.engine,t=this.getRichTextNode();if(!t||!o.supportsNode(e,t,this.renderId))e.exitTool();else{let r=this.getVariableInfo();this.engine.stores.toolStore.validateCollectionControl(r)}}stop(){this.engine.endUndoGroup(),this.engine.stores.toolStore.nodeInTextEditor=null}static supportsNode(e,t,r){if(!E(t)||!T(t.textContent))return!1;let i=t.cache.getRenderInstance(r);return i?!!M(e.tree,e.stores.treeStore.sandboxCollectionData,t.textContent,"string",i.collectionItemId):!1}};var Oe=class o extends j{update(){let n=this.engine,{routeStore:e,canvasStore:t,treeStore:r,mouseStore:i,toolStore:s}=n.stores,c=ue(e,r,t);if(!c)return;if(i.isHoveringChrome){s.highlightedRenderId=void 0;return}let l=r.tree,d=i.canvasMousePosition,p=l.getNodeRendersAtPoint(c,d,!0),m=wi(p,l),a=m.filter(w=>o.isSelectableNode(n,w.node,w.renderId)).at(-1);if(a){n.stores.toolStore.highlightedRenderId=a.renderId;return}let g=m.filter(w=>o.isUnexpectedlyUnselectableNode(n,w.node,w.renderId)).at(-1);if(g){s.highlightedRenderId=g.renderId;return}s.highlightedRenderId=void 0}static isSelectableNode(n,e,t){return Pe.supportsNode(n,e,t)||Ee.supportsNode(n,e,t)||ke.supportsNode(n,e,t)||fe.supportsNode(e)||we.supportsNode(n,e,t)||Ue.supportsNode(n,e,t)||ve.supportsNode(n,e,t)}static isUnexpectedlyUnselectableNode(n,e,t){return o.isSelectableNode(n,e,t)?!1:ni(e)||he(e)}};var _l;(function(o){o[o.None=0]="None",o[o.Mutable=1]="Mutable",o[o.Watching=2]="Watching",o[o.RecursedCheck=4]="RecursedCheck",o[o.Recursed=8]="Recursed",o[o.Dirty=16]="Dirty",o[o.Pending=32]="Pending"})(_l||(_l={}));function Gl({update:o,notify:n,unwatched:e}){let t=0;return{link:r,unlink:i,propagate:s,checkDirty:d,endTracking:l,startTracking:c,shallowPropagate:p};function r(f,a){let h=a.depsTail;if(h!==void 0&&h.dep===f)return;let g;if(a.flags&4&&(g=h!==void 0?h.nextDep:a.deps,g!==void 0&&g.dep===f)){g.version=t,a.depsTail=g;return}let w=f.subsTail;if(w!==void 0&&w.version===t&&w.sub===a)return;let x=a.depsTail=f.subsTail={version:t,dep:f,sub:a,prevDep:h,nextDep:g,prevSub:w,nextSub:void 0};g!==void 0&&(g.prevDep=x),h!==void 0?h.nextDep=x:a.deps=x,w!==void 0?w.nextSub=x:f.subs=x}function i(f,a=f.sub){let h=f.dep,g=f.prevDep,w=f.nextDep,x=f.nextSub,F=f.prevSub;return w!==void 0?w.prevDep=g:a.depsTail=g,g!==void 0?g.nextDep=w:a.deps=w,x!==void 0?x.prevSub=F:h.subsTail=F,F!==void 0?F.nextSub=x:(h.subs=x)===void 0&&e(h),w}function s(f){let a=f.nextSub,h;e:do{let g=f.sub,w=g.flags;if(w&3&&(w&60?w&12?w&4?!(w&48)&&m(f,g)?(g.flags=w|40,w&=1):w=0:g.flags=w&-9|32:w=0:g.flags=w|32,w&2&&n(g),w&1)){let x=g.subs;if(x!==void 0){f=x,x.nextSub!==void 0&&(h={value:a,prev:h},a=f.nextSub);continue}}if((f=a)!==void 0){a=f.nextSub;continue}for(;h!==void 0;)if(f=h.value,h=h.prev,f!==void 0){a=f.nextSub;continue e}break}while(!0)}function c(f){++t,f.depsTail=void 0,f.flags=f.flags&-57|4}function l(f){let a=f.depsTail,h=a!==void 0?a.nextDep:f.deps;for(;h!==void 0;)h=i(h,f);f.flags&=-5}function d(f,a){let h,g=0;e:do{let w=f.dep,x=w.flags,F=!1;if(a.flags&16)F=!0;else if((x&17)===17){if(o(w)){let k=w.subs;k.nextSub!==void 0&&p(k),F=!0}}else if((x&33)===33){(f.nextSub!==void 0||f.prevSub!==void 0)&&(h={value:f,prev:h}),f=w.deps,a=w,++g;continue}if(!F&&f.nextDep!==void 0){f=f.nextDep;continue}for(;g;){--g;let k=a.subs,I=k.nextSub!==void 0;if(I?(f=h.value,h=h.prev):f=k,F){if(o(a)){I&&p(k),a=f.sub;continue}}else a.flags&=-33;if(a=f.sub,f.nextDep!==void 0){f=f.nextDep;continue e}F=!1}return F}while(!0)}function p(f){do{let a=f.sub,h=f.nextSub,g=a.flags;(g&48)===32&&(a.flags=g|16,g&2&&n(a)),f=h}while(f!==void 0)}function m(f,a){let h=a.depsTail;if(h!==void 0){let g=a.deps;do{if(g===f)return!0;if(g===h)break;g=g.nextDep}while(g!==void 0)}return!1}}var $n=[],{link:Yt,unlink:er,propagate:Af,checkDirty:Vl,endTracking:zl,startTracking:Wl,shallowPropagate:ql}=Gl({update(o){return"getter"in o?jl(o):Yl(o,o.value)},notify:Hl,unwatched(o){if("getter"in o){let n=o.deps;if(n!==void 0){o.flags=17;do n=er(n,o);while(n!==void 0)}}else"previousValue"in o||$l.call(o)}}),or=0,Ko=0,tr=0,Ye,Xo;function Ot(o){let n=Ye;return Ye=o,n}function Ll(){++or}function Kl(){--or||Ql()}function Xl(o){return Mf.bind({previousValue:o,value:o,subs:void 0,subsTail:void 0,flags:1})}function nr(o){return Df.bind({value:void 0,subs:void 0,subsTail:void 0,deps:void 0,depsTail:void 0,flags:17,getter:o})}function Zl(o){let n={fn:o,subs:void 0,subsTail:void 0,deps:void 0,depsTail:void 0,flags:2};Ye!==void 0?Yt(n,Ye):Xo!==void 0&&Yt(n,Xo);let e=Ot(n);try{n.fn()}finally{Ot(e)}return $l.bind(n)}function jl(o){let n=Ot(o);Wl(o);try{let e=o.value;return e!==(o.value=o.getter(e))}finally{Ot(n),zl(o)}}function Yl(o,n){return o.flags=1,o.previousValue!==(o.previousValue=n)}function Hl(o){let n=o.flags;if(!(n&64)){o.flags=n|64;let e=o.subs;e!==void 0?Hl(e.sub):$n[tr++]=o}}function Jl(o,n){if(n&16||n&32&&Vl(o.deps,o)){let t=Ot(o);Wl(o);try{o.fn()}finally{Ot(t),zl(o)}return}else n&32&&(o.flags=n&-33);let e=o.deps;for(;e!==void 0;){let t=e.dep,r=t.flags;r&64&&Jl(t,t.flags=r&-65),e=e.nextDep}}function Ql(){for(;Ko<tr;){let o=$n[Ko];$n[Ko++]=void 0,Jl(o,o.flags&=-65)}Ko=0,tr=0}function Df(){let o=this.flags;if(o&16||o&32&&Vl(this.deps,this)){if(jl(this)){let n=this.subs;n!==void 0&&ql(n)}}else o&32&&(this.flags=o&-33);return Ye!==void 0?Yt(this,Ye):Xo!==void 0&&Yt(this,Xo),this.value}function Mf(...o){if(o.length){let n=o[0];if(this.value!==(this.value=n)){this.flags=17;let e=this.subs;e!==void 0&&(Af(e),or||Ql())}}else{let n=this.value;if(this.flags&16&&Yl(this,n)){let e=this.subs;e!==void 0&&ql(e)}return Ye!==void 0&&Yt(this,Ye),n}}function $l(){let o=this.deps;for(;o!==void 0;)o=er(o,this);let n=this.subs;n!==void 0&&er(n),this.flags=0}var Zo=y(K());function me(o=Object.is){return(n,e)=>{let t=new WeakMap;return{get(){let r=t.get(this);return u(r,"Signal must exist"),r()},set(r){let i=t.get(this);u(i,"Signal must exist");let s=i();if(!o(s,r))return this.scheduler.signalChanges(this),i(r)},init(r){let i=Xl(r);t.set(this,i)}}}}function ec(o=Object.is){return(n,e)=>{let t=new WeakMap;return function(){let r=t.get(this);if(r)return r();let i=nr(s=>{let c=n.call(this);return le(s)?c:o(s,c)?s:c});return t.set(this,i),i()}}}function jo(o,n,e=Object.is){let t=(0,Zo.useMemo)(()=>{let r=nr(i=>{let s=o();return le(i)?s:e(i,s)?i:s});return{subscribe(i){return Zl(()=>{r(),i()})},getSnapshot(){return r()}}},[...n,e]);return(0,Zo.useSyncExternalStore)(t.subscribe,t.getSnapshot)}function tc(){Ll()}function oc(){Kl()}var ac=y(K());var nc="container_ci35ri5",rc="shockwaveMask_suurpvn",ic="shockwaveNodeHighlight_s1xlu29h";var Yo=y(U()),sc=(0,ac.memo)(function(){let n=b(),e=jo(()=>n.stores.editableNodeHighlightStore.editableNodesHighlight,[]);return e?(0,Yo.jsx)(Ie.div,{className:X(nc,rc),initial:{"--radius":`${e.minRadius}px`},animate:{"--radius":`${e.maxRadius}px`},transition:{duration:e.animationDuration/1e3,ease:"easeOut"},style:{top:e.minY,height:e.maxY-e.minY,"--x":`${e.originX}px`,"--y":`${e.originY}px`,"--gradient-size":`${e.gradientSize}px`},children:(0,Yo.jsx)("div",{style:{position:"absolute",top:-e.minY},children:e.highlights.map(t=>(0,Yo.jsx)("div",{className:ic,style:{width:t.width,height:t.height,transform:t.transform,transformOrigin:"top left"}},t.renderId))})},e.animationId):null});var lc="hudContainer_h1czcor4";var Ho=y(K());var cc=y(K()),fc=y(U()),Q=(0,cc.forwardRef)(function({tree:n,node:e,renderId:t,style:r,...i},s){let c=n.getRect(e,void 0,void 0,void 0,t),l=n.transformMatrixToNode(e,void 0,void 0,t);return(0,fc.jsx)("div",{...i,ref:s,style:{position:"absolute",width:c.width,height:c.height,transformOrigin:"top left",transform:l.toString(),...r}})});var rr=y(U());function dc({tool:o}){let{renderId:n}=o,e=b(),t=e.tree,r=(0,Ho.useRef)(null),i=o.getNode();if(Gf(r,()=>{e.exitTool()}),!!i)return(0,rr.jsx)(Q,{ref:r,tree:t,node:i,renderId:n,children:(0,rr.jsx)(rs,{tool:o,node:i,renderId:n})})}function Gf(o,n){(0,Ho.useEffect)(()=>{let e=t=>{!o.current||o.current.contains(t.target)||n()};return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}},[o,n])}var mc=y(K());function Nt(o){let n=b(),{domLayoutUpdate:e,tree:t}=n.stores.treeStore.useState();return(0,mc.useMemo)(()=>{let r=t.getNode(o);if(!r)return;let i=ue(n.stores.routeStore,n.stores.treeStore,n.stores.canvasStore);if(!i)return;let s=e;return Vf(n,i,r)},[e,o,t])}function Vf(o,n,e){let{tree:t}=o.stores.treeStore,r=t.convertFrameToCanvas(e),i=t.getNodesInRect(n,r,!0),s=[],c=n.cache.layoutTemplateRects;if(c)for(let[x,F]of c)!F.canvasRect||!ze.intersects(F.canvasRect,r)||s.push(new ai({zIndex:F.domRect.zIndex,id:x,parentid:n.id}));let l=i.concat(s),d=Ci(l,t,{[n.id]:s}),p=d.findIndex(x=>x.id===e.id);if(p===-1)return;let m=d.slice(p+1);if(m.length===0)return;let a=t.transformMatrixToNode(e).inverse(),{windowMousePositionOnToolEntry:h}=o.stores.toolStore,g=h?{x:h.x+window.scrollX,y:h.y+window.scrollY,width:1,height:1}:void 0,w=`M ${-He},${-He} L ${-He},${r.height+He} L ${r.width+He},${r.height+He} L ${r.width+He},${-He} Z`;for(let x of m){let F=c?.get(x.id),k=t.convertFrameToCanvas(x);if(g&&ze.intersects(g,k))continue;let I;F?.canvasCorners?I=F.canvasCorners:I=t.convertCornerPointsToCanvas(x);let v=I[0];v&&I.push(v);for(let{x:O,y:Gt}of I){let dt=new DOMPoint(O,Gt).matrixTransform(a);w+=` L ${dt.x},${dt.y}`}w+=" Z"}return`path("${w}")`}var He=100;var pc="validationBadge_v1r7rm12";var Qo=y(U());function zf(o){return o.message}function Jo({validationWarning:o}){if(!o)return null;let n=zf(o);return(0,Qo.jsxs)("div",{className:pc,children:[(0,Qo.jsx)(Oi,{width:10,height:10}),n]})}var Ht=y(U());function uc({tool:o}){let{nodeId:n,renderId:e}=o,t=b(),{treeStore:r,toolStore:i}=t.stores,{validationWarning:s}=t.stores.toolStore.useState(),{tree:c}=r.useState(),l=Nt(n),d=Se(),{proseMirror:p}=i.useState(),m=c.getNodeWithTrait(n,E);if(!m||!d||!p)return;function f(a){a.target===a.currentTarget&&t.exitTool()}return(0,Ht.jsxs)(Q,{tree:c,node:m,renderId:e,children:[(0,Ht.jsx)(Jo,{validationWarning:s}),(0,Ht.jsx)(ss,{tool:o,scopeNode:d,node:m,renderId:e,proseMirror:p,zoom:1,onClickOutside:f,hasValidationWarning:!!s,style:{clipPath:l}})]})}var Bt=y(K());var gc="popover_p6dts5z",yc="popoverWithModalInFront_pcmqzkm";var $o="nodeHighlight_nbqylm8",hc="visuallyHidden_v1pcr3uc",Cc="pointerCursor_p1mivvux",wc="textCursor_t42x8tu",Uc="notAllowedCursor_n1atul0u",xc="background_b1i0g06w";var q=y(U()),qf=["bottom","top","right","left"],Lf={x:H.inputSpacing,y:H.inputSpacing};function bc({tool:o}){let[n,e]=(0,Bt.useState)(null),t=b(),r=t.stores.modalStore.useState(a=>a.active.type!=="None"),[i,s]=(0,Bt.useState)(!1);!i&&r&&s(!0);let{tree:c}=t.stores.treeStore.useState(),l=c.getNodeWithTrait(o.nodeId,Yr),d=(0,Bt.useMemo)(()=>{let a=c;return o.getEditableControls()},[o,c]);function p(){t.exitTool()}let m=l?.id,f=(0,Bt.useMemo)(()=>m?[m]:[],[m]);if(!(!l||!d||d.length===0))return(0,q.jsx)(Q,{tree:c,node:l,ref:e,renderId:o.renderId,className:$o,children:(0,q.jsx)(wo,{anchor:n,alignSelf:"center",attachTo:qf,offset:Lf,onClose:p,showArrow:!0,arrow:{anchor:n,alignSelf:"center"},fallbackToModalAppearance:!0,backdropTintEnabled:!1,className:X(gc,r&&yc),focusTrapEnabled:!r,animateAppear:!i,zIndex:21,children:(0,q.jsx)(is,{displayDivider:!0,title:Kf(l),onClose:p,children:(0,q.jsx)(ce,{gap:0,paddingTop:H.inputSpacing,paddingBottom:H.inputSpacing,paddingLeft:H.panelPadding,paddingRight:H.panelPadding,children:d.map(a=>{if(a.type==="vectorSetItem")return(0,q.jsx)(ys,{nodeIds:f,supportsVariables:!1,dynamicVectorSetIdentifier:void 0,codeComponentIdentifier:a.codeComponentIdentifier},"vectorSet");if(a.type==="component")switch(a.controlDescription.type){case"string":return u(a.reducedControlProp.type==="string"),(0,q.jsx)(Zt,{nodeIds:f,controlKey:a.controlKey,control:a.controlDescription,controlProp:a.reducedControlProp,onChange:(I,v)=>{u(a.controlProp.type==="string");let O=v(a.controlProp);ye(O,a.controlProp)||(l.setControlProp(I,O),t.stores.projectStore.commitTreeAndSend())}},a.controlKey);case"richtext":return u(a.reducedControlProp.type==="richtext"),(0,q.jsx)(Bn,{title:a.controlDescription.title??"Unknown",children:(0,q.jsx)(D,{title:"Edit Content",className:Tn,onClick:()=>{t.stores.modalStore.set({type:"OnPageRichTextEditor",controlKey:a.controlKey,nodeId:o.nodeId,source:"on_page_hud"})}})},a.controlKey);case"image":case"responsiveimage":return u(a.reducedControlProp.type==="image"||a.reducedControlProp.type==="responsiveimage"),(0,q.jsx)(Mn,{nodeIds:f,controlKey:a.controlKey,control:a.controlDescription,controlProp:a.reducedControlProp,onChange:(I,v)=>{u(g.type==="image");let O=v(g);ye(O,g)||(l.setControlProp(I,O),t.stores.projectStore.commitTreeAndSend())},onUpload:async(I,v)=>{let O=await I;if(!O)return;u(a.controlProp.type==="image");let Gt=us(a.controlProp,O);l.setControlProp(v,Gt),t.stores.projectStore.commitTreeAndSend()}},a.controlKey);case"date":return u(a.reducedControlProp.type==="date"),(0,q.jsx)(An,{controlKey:a.controlKey,control:a.controlDescription,controlProp:a.reducedControlProp,onChange:(I,v)=>{u(I.type==="date"),!ye(I,g)&&(l.setControlProp(v,I),t.stores.projectStore.commitTreeAndSend())}},a.controlKey);case"vectorsetitem":return u(a.reducedControlProp.type==="vectorsetitem"),(0,q.jsx)(Rn,{controlKey:a.controlKey,control:a.controlDescription,controlProp:a.reducedControlProp,onChange:(I,v)=>{u(I.type==="vectorsetitem"),!ye(I,a.controlProp)&&(l.setControlProp(v,I),t.stores.projectStore.commitTreeAndSend())}},a.controlKey);default:Wt(a.controlDescription)}let{variableInfo:h}=a,{controlProp:g,controlDescription:w,collectionItemNode:x,variableDefinition:F,reducedControlProp:k}=h;switch(g.type){case"string":return u(w.type==="string"),u(k.type==="string"),(0,q.jsx)(Zt,{nodeIds:f,controlKey:F.id,control:w,controlProp:k,onChange:(I,v)=>{u(g.type==="string");let O=v(g);ye(O,g)||(x.setControlProp(I,O),t.stores.projectStore.commitTreeAndSend())}},a.controlKey);case"richtext":return u(w.type==="richtext"),u(k.type==="richtext"),(0,q.jsx)(Bn,{title:w.title||zr(F.id),children:(0,q.jsx)(D,{title:"Edit Content",className:Tn,onClick:()=>{t.stores.modalStore.set({type:"OnPageRichTextEditor",controlKey:F.id,nodeId:x.id,source:"on_page_hud"})}})},a.controlKey);case"image":return u(w.type==="responsiveimage"),u(k.type==="responsiveimage"),(0,q.jsx)(Mn,{nodeIds:f,controlKey:F.id,control:w,controlProp:k,onChange:(I,v)=>{u(g.type==="image");let O=v(g);ye(O,g)||(x.setControlProp(I,O),t.stores.projectStore.commitTreeAndSend())},onUpload:async(I,v)=>{let O=await I;O&&(x.setControlProp(v,{type:"image",value:O}),t.stores.projectStore.commitTreeAndSend())}},a.controlKey);case"date":return u(w.type==="date"),u(k.type==="date"),(0,q.jsx)(An,{controlKey:F.id,control:w,controlProp:k,onChange:(I,v)=>{u(I.type==="date"),u(g.type==="date"),!ye(I,g)&&(x.setControlProp(v,I),t.stores.projectStore.commitTreeAndSend())}},a.controlKey);case"link":return u(w.type==="link"),u(k.type==="link"),(0,q.jsx)(Ds,{controlKey:F.id,control:w,controlProp:k,onChange:(I,v)=>{u(g.type==="link");let O=v(g);ye(O,g)||(x.setControlProp(I,O),t.stores.projectStore.commitTreeAndSend())}},a.controlKey);case"boolean":return u(w.type==="boolean"),u(k.type==="boolean"),(0,q.jsx)(Mo,{nodeIds:f,controlKey:F.id,control:w,controlProp:k,onChange:(I,v)=>{u(I.type==="boolean"),u(g.type==="boolean"),!ye(I,g)&&(x.setControlProp(v,I),t.stores.projectStore.commitTreeAndSend())}},a.controlKey);case"vectorsetitem":return u(w.type==="vectorsetitem"),u(k.type==="vectorsetitem"),(0,q.jsx)(Rn,{controlKey:F.id,control:w,controlProp:k,onChange:(I,v)=>{u(I.type==="vectorsetitem"),u(g.type==="vectorsetitem"),!ye(I,g)&&(x.setControlProp(v,I),t.stores.projectStore.commitTreeAndSend())}},a.controlKey);default:Wt(g)}})})})})})}function Kf(o){let n=Z.reactComponentForIdentifier(o.codeComponentIdentifier);return n?n.name:"Component"}var Jt=y(K());var ir=y(U());function Fc({tool:o}){let{nodeId:n,renderId:e}=o,t=b(),r=t.tree,i=(0,Jt.useRef)(null),s=Se(),c=r.getNodeWithTrait(n,E);if(Xf(i,()=>{t.exitTool()}),(0,Jt.useEffect)(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="auto"})),!!c&&s)return(0,ir.jsx)(Q,{ref:i,tree:r,node:c,renderId:e,children:(0,ir.jsx)(as,{tool:o,scopeNode:s,node:c,renderId:e,backdropEnabled:!0})})}function Xf(o,n){(0,Jt.useEffect)(()=>{function e(t){o.current&&!o.current.contains(t.target)&&n()}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[o,n])}var ar=y(K());var nt=y(U());function Sc(){let o=b(),{tree:n}=o.stores.treeStore.useState(),{highlightedRenderId:e}=o.stores.toolStore.useState(),t=jo(()=>o.stores.mouseStore.lastUpdateType==="scroll",[]),r=Xt(e),i=n.get(r),s=Zf(i,e),c=(0,ar.useCallback)(()=>{o.stores.editableNodeHighlightStore.highlight(o,{type:"clickOnVoid"})},[]),l=!!i&&!!e&&Oe.isUnexpectedlyUnselectableNode(o,i,e),d=!!i&&!!e&&(fe.supportsNode(i)||we.supportsNode(o,i,e)||Ue.supportsNode(o,i,e));return(0,nt.jsxs)(nt.Fragment,{children:[(0,nt.jsx)("div",{className:X(xc,l&&Uc),onClick:c}),i&&e&&!l&&(0,nt.jsx)(Q,{tree:n,node:i,renderId:e,className:X($o,t&&hc,d?wc:Cc),onClick:s})]})}function Zf(o,n){let e=b();return(0,ar.useCallback)(()=>{if(!(!o||!n)){if(Pe.supportsNode(e,o,n))return e.startComponentInstanceEditTool(o.id,n);if(Ee.supportsNode(e,o,n))return e.startDateVariableEditTool(o.id,n,"mouse");if(ke.supportsNode(e,o,n))return e.startImageEditTool(o.id,n);if(fe.supportsNode(o))return e.startRichTextEditTool(o.id,n,"mouse");if(we.supportsNode(e,o,n))return e.startRichTextVariableEditTool(o.id,n,"mouse");if(Ue.supportsNode(e,o,n))return e.startStringVariableEditTool(o.id,n,"mouse");if(ve.supportsNode(e,o,n))return e.startCollectionReferenceVariableEditTool(o.id,n,"mouse")}},[o,n])}var re=y(K());var vc="popout_pqnmppj";var ge=y(U()),Yf=["right","left"],Hf={x:15,y:0};function Pc({tool:o}){let{nodeId:n,renderId:e}=o,[t,r]=(0,re.useState)(null),i=b(),{tree:s}=i.stores.treeStore.useState(),c=s.getNodeWithTrait(n,gt);function l(){i.exitTool()}if(c)return(0,ge.jsx)(Q,{tree:s,node:c,renderId:e,ref:r,children:(0,ge.jsxs)(wo,{anchor:t,alignSelf:"center",attachTo:Yf,offset:Hf,onClose:l,showArrow:!0,arrow:{anchor:t,alignSelf:"center"},fallbackToModalAppearance:!0,backdropTintEnabled:!1,children:[(0,ge.jsx)(Vi,{disableDivider:!0,onClose:l,children:(0,ge.jsx)(zi,{title:"Image"})}),(0,ge.jsx)("div",{className:vc,children:be(c.fillImage)?(0,ge.jsx)(Jf,{node:c,dynamicValue:c.fillImage,renderId:e}):(0,ge.jsx)($f,{node:c})})]})})}function Jf({node:o,dynamicValue:n,renderId:e}){return u(T(n),"Expected variable reference"),(0,ge.jsx)(Qf,{node:o,variableReference:n,renderId:e})}function Qf({node:o,variableReference:n,renderId:e}){let t=b(),r=t.stores.treeStore.useState(p=>{let m=o.cache.getRenderInstance(e);return M(p.tree,p.sandboxCollectionData,n,"image",m?.collectionItemId)});u(r,"Variable info must exist");let{collectionItemNode:i,reducedControlProp:s,controlProp:c}=r;u(s.type==="responsiveimage","Expected reduced responsive image");let l=(0,re.useCallback)(p=>{i.set(Sn({[n.id]:p(c)})),t.stores.projectStore.commitTreeAndSend()},[i,n,c]),d=(0,re.useCallback)(()=>{i.set(Sn({[n.id]:{type:"image",value:void 0}})),t.stores.projectStore.commitTreeAndSend()},[i,n]);return(0,ge.jsx)($a,{controlProp:s,onChange:l,onRemove:d,maxExtraImages:0})}function $f({node:o}){let n=b(),e=(0,re.useMemo)(()=>{let p={...Ma(),..._a()};return Ra(o,p),Ga(o,p),p},[o]),t=(0,re.useCallback)(async p=>{let[m]=await p;m&&(Fa(o,m),n.stores.projectStore.commitTreeAndSend())},[o]),r=(0,re.useCallback)(p=>{$(o.fillImage)&&(o.set({fillImage:Tr(o.fillImage,p)}),n.stores.projectStore.commitTreeAndSend())},[o]),i=(0,re.useCallback)(p=>{ri(o)&&(o.set({altAttribute:p}),n.stores.projectStore.commitTreeAndSend())},[o]),s=(0,re.useCallback)(p=>{o.set({fillImageResize:p}),n.stores.projectStore.commitTreeAndSend()},[o]),c=(0,re.useCallback)(p=>{o.set({fillImageTileSize:p}),n.stores.projectStore.commitTreeAndSend()},[o]),l=(0,re.useCallback)((p,m)=>{o.set({fillImagePositionX:p,fillImagePositionY:m}),n.stores.projectStore.commitTreeAndSend()},[o]),d=(0,re.useCallback)(()=>{o.set({fillImage:void 0}),n.stores.projectStore.commitTreeAndSend()},[o]);return(0,ge.jsx)(Ya,{...e,imageReferences:e.fillImages,altText:e.altAttribute,onChangeImages:t,onChangeAssetSize:r,onChangeAltText:i,onChangeImageResize:s,onChangeFillImageSize:c,onChangeImagePosition:l,onRemoveImage:d})}var Oc=y(K());var Ec="warningButton_w1uyyr5z",kc="warningButtonIcon_w1z0oe1i";var Qt=y(U());function Nc({richTextNode:o,webPageNode:n}){let e=b(),{modalStore:t,treeStore:r}=e.stores,{tree:i}=r.useState();return(0,Oc.useMemo)(()=>{let c=i.getNodeWithTrait(o.originalid??o.id,E);return u(c,"originalNode must exist"),n.getTopLevelReplicaVariants().some(l=>{let d=Kt(l.id,c.id),p=i.get(d);return E(p)&&Co(i,p,"html")&&p.getTextContent()!==c.getTextContent()})},[i,o,n])?(0,Qt.jsxs)(Fi,{className:Ec,onClick:()=>{e.exitTool(),t.set({richTextNodeId:o.id,source:"on_page_hud",type:"OnPageRichTextVariantOverride"})},children:[(0,Qt.jsx)(Pi,{viewBox:"0 0 12 12",className:kc}),(0,Qt.jsx)(Ce,{children:"Responsive Text"})]}):null}var Bc="warningContainer_w1v62ead";var rt=y(U());function Tc({tool:o}){let{nodeId:n,renderId:e}=o,t=b(),{treeStore:r,toolStore:i}=t.stores,{tree:s}=r.useState(),c=Nt(n),l=s.getNodeWithTrait(n,E),d=Se();return!l||!d||!i.proseMirrorView?null:(0,rt.jsxs)(Q,{tree:s,node:l,renderId:e,children:[(0,rt.jsx)(Le,{isOn:"onPageRichTextBreakpointOverride",children:(0,rt.jsx)("div",{className:Bc,children:(0,rt.jsx)(Nc,{richTextNode:l,webPageNode:d})})}),(0,rt.jsx)(ls,{tool:o,scopeNode:d,node:l,renderId:e,editorView:i.proseMirrorView,zoom:1,handleOutsideClick:p=>{p.target===p.currentTarget&&t.exitTool()},style:{clipPath:c}})]})}var $t=y(U());function Ac({tool:o}){let{nodeId:n,renderId:e}=o,t=b(),{tree:r}=t.stores.treeStore.useState(),{validationWarning:i}=t.stores.toolStore.useState(),s=Nt(n),c=r.getNodeWithTrait(n,E),l=Se();return!l||!c?null:(0,$t.jsxs)(Q,{tree:r,node:c,renderId:e,children:[(0,$t.jsx)(Jo,{validationWarning:i}),(0,$t.jsx)(cs,{tool:o,scopeNode:l,node:c,renderId:e,zoom:1,onClickOutside:d=>{d.target===d.currentTarget&&t.exitTool()},hasValidationWarning:!!i,style:{clipPath:s}})]})}var ie=y(U());function Dc(){let{treeStore:o,sandboxStore:n}=b().stores,{canvasHeight:e}=n.useState(),t=o.useState(r=>r.tree.getPresetsListNode());return(0,ie.jsxs)("div",{className:lc,style:{height:e??"initial"},children:[(0,ie.jsx)(sc,{}),(0,ie.jsx)(od,{}),(0,ie.jsx)(Ta,{presetsListNode:t})]})}function od(){let{toolStore:o,canvasStore:n,projectStore:e,modalStore:t}=b().stores,{tool:r}=o.useState(),{finishedEditing:i}=n.useState(),{hasPermanentlyFailed:s}=e.useState(),c=t.useState(l=>l.active.type!=="None");if(!s&&!i&&!c){if(r instanceof Oe)return(0,ie.jsx)(Sc,{});if(r instanceof ke)return(0,ie.jsx)(Pc,{tool:r});if(r instanceof fe)return(0,ie.jsx)(Tc,{tool:r});if(r instanceof we)return(0,ie.jsx)(uc,{tool:r});if(r instanceof Ue)return(0,ie.jsx)(Ac,{tool:r});if(r instanceof Ee)return(0,ie.jsx)(Fc,{tool:r});if(r instanceof ve)return(0,ie.jsx)(dc,{tool:r});if(r instanceof Pe)return(0,ie.jsx)(bc,{tool:r})}}var Ne=y(U());function Mc(){vt();let o=b(),{isHidden:n}=o.stores.canvasStore.useState();return(0,en.useEffect)(()=>{let e=({data:t})=>{if(We(t)&&t.apiVersion===1){let{type:r,position:i}=t;r==="showCanvas"&&We(i)&&Dr(i.top)&&(window.scrollTo({behavior:"instant",top:i.top}),setTimeout(()=>{o.stores.canvasStore.isHidden=!1,o.startHighlightTool(),o.stores.editableNodeHighlightStore.highlight(o,{type:"start"})},0))}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[]),(0,en.useEffect)(()=>{let{sandboxStore:e}=o.stores;n?e.hide():e.show()},[n]),nd(n),As({channel:Er,toast:et}),(0,Ne.jsx)(Ti,{children:(0,Ne.jsxs)("div",{className:X(n&&zs),children:[(0,Ne.jsx)(Dc,{}),(0,Ne.jsxs)("div",{className:Ws,[_n]:"true",children:[(0,Ne.jsx)(Rl,{}),(0,Ne.jsx)(Pl,{}),(0,Ne.jsx)(Yi,{padding:80}),(0,Ne.jsx)(Bs,{ref:o.stores.projectStore.filePickerRef})]})]})})}function nd(o){let n=b();(0,en.useEffect)(()=>{if(o)return;let e=new Ha;e.set("CommandOrControl+Z",n.undo.bind(n),"undo"),e.set("CommandOrControl+Shift+Z",n.redo.bind(n),"redo");function t(r){if(vo())return;let i=e.get(r);i&&(i.action(r),r.preventDefault(),r.stopPropagation())}return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[o])}var Rc=y(K());function _c(){(0,Rc.useEffect)(()=>{let o=n=>{if(!We(n.data))return;let{apiVersion:e,type:t}=n.data;e===1&&t==="enterOnPageEditing"&&Fe("editor_bar_interaction",{page:"editor-bar-project-page",id:"editor-bar-enter-on-page-editing"})};return window.addEventListener("message",o),()=>window.removeEventListener("message",o)},[])}var mr=y(K());var Tt="https://app.framerstatic.com/framer-logo-blue-23OMXQLR.png";var on="button_b9jl8lf",nn="editorBarButtonPrimary_eptse9g";var Gc="backdrop_bzafg2a",Vc="container_cnhgigm",zc="textContainer_t1ookr3o",Wc="title_tyol4w7",qc="subtitle_s7fryoi",Lc="button_by9jupw",Kc="buttonsContainer_b18g1n4a",Xc="closeModal_c1gc3a0q";var At=y(U());function Zc({width:o=10,height:n=10,className:e}){return(0,At.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:o,height:n,fill:"none",className:e,"aria-hidden":"true",children:(0,At.jsxs)("g",{transform:"translate(2 2)",children:[(0,At.jsx)("path",{d:"M 0 0 L 6 6",fill:"transparent",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),(0,At.jsx)("path",{d:"M 0 6 L 6 0",fill:"transparent",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})})}var ae=y(U());function ad({children:o,onClick:n,disabled:e,layoutId:t,duration:r}){return(0,ae.jsx)(Ie.div,{layout:"position",layoutId:t,style:{width:"100%"},transition:{duration:r,type:"spring",bounce:.2,delay:0},children:(0,ae.jsx)(D,{type:"button",className:Lc,onClick:n,enabled:!e,children:o})})}function Dt({logo:o,title:n,subtitle:e,buttons:t,showLearnMoreButton:r}){let i=()=>{window.open("https://www.framer.com/help/articles/on-page-editing","_blank")},s=()=>{window.parent.postMessage({apiVersion:1,type:"sandboxReadyState",data:{status:"ready"}},"*"),window.parent.postMessage({apiVersion:1,type:"exitFullscreen",position:{top:window.scrollY}},"*")};return(0,ae.jsx)(ce,{className:Gc,onClick:s,children:(0,ae.jsxs)(ce,{className:Vc,justifyContent:"center",alignItems:"center",onClick:c=>c.stopPropagation(),children:[(0,ae.jsx)(ce,{onClick:s,className:Xc,children:(0,ae.jsx)(Zc,{})}),(0,ae.jsxs)(ce,{className:zc,gap:15,alignItems:"center",justifyContent:"center",children:[o,(0,ae.jsxs)(ce,{gap:5,alignItems:"center",justifyContent:"center",children:[(0,ae.jsx)(Ie.span,{layout:!0,className:Wc,children:n}),(0,ae.jsx)(Ie.p,{layout:!0,className:qc,children:e})]})]}),t||r?(0,ae.jsxs)(ce,{className:Kc,gap:10,children:[r?(0,ae.jsx)(ad,{onClick:i,children:"Learn More"}):null,t||null]}):null]})})}var rn=y(U());function jc(){let o=b();bt("editor_bar_impression",{page:"editor-bar-cookie-prompt"});async function n(){Fe("editor_bar_interaction",{page:"editor-bar-cookie-prompt",id:"editor-bar-allow-cookies"});try{await document.requestStorageAccess()}finally{await o.stores.accessStore.refresh()}}return(0,rn.jsx)(Dt,{logo:(0,rn.jsx)("img",{decoding:"async",width:36,src:Tt,alt:"Framer Logo"}),title:"Edit Page",subtitle:"Continuing may require granting permissions in a browser dialog.",buttons:(0,rn.jsx)(D,{className:X(on,nn),onClick:n,variant:"primary",children:"Continue"}),showLearnMoreButton:!0})}var cr=y(U());function Yc({children:o,onClick:n,disabled:e,layoutId:t,duration:r,className:i}){return(0,cr.jsx)(Ie.div,{layout:"position",layoutId:t,style:{width:"100%"},transition:{duration:r,type:"spring",bounce:.2,delay:0},children:(0,cr.jsx)(D,{type:"button",className:X(on,i),onClick:n,enabled:!e,children:o})})}var Hc="loginButtonLoading_l4nhz4u";var Mt=y(U());function Jc(){let o=b(),{isLoginInProgress:n}=o.stores.loginStore.useState();bt("editor_bar_impression",{page:"editor-bar-guest-page"});async function e(){Fe("editor_bar_interaction",{page:"editor-bar-guest-page",id:"editor-bar-login"}),await o.stores.loginStore.login()}return(0,Mt.jsx)(Dt,{logo:(0,Mt.jsx)("img",{decoding:"async",width:36,height:36,src:Tt,alt:"Framer Logo"}),title:"Edit Page",subtitle:"Edit the page directly in the browser, without opening the app.",buttons:(0,Mt.jsx)(Yc,{onClick:e,disabled:n,className:nn,children:n?(0,Mt.jsx)("div",{className:Hc,children:(0,Mt.jsx)(Ns,{})}):"Continue"}),showLearnMoreButton:!0})}var fr=y(U()),ld="Page Edit",cd="To edit, ask the site owner for access to the project",fd="To edit, ask the site owner for content editing permissions";function dr({reason:o}){return bt("editor_bar_impression",{page:"editor-bar-no-access-page"}),(0,fr.jsx)(Dt,{logo:(0,fr.jsx)("img",{decoding:"async",width:36,src:Tt,alt:"Framer Logo"}),title:ld,subtitle:o==="no-permission"?fd:cd,showLearnMoreButton:!0})}var eo=y(U());function Qc(){let o=b(),{access:n}=o.stores.accessStore.useState();switch(n.status){case"no-auth":return(0,eo.jsx)(Jc,{});case"unknown":return(0,eo.jsx)(jc,{});case"no-access":return(0,eo.jsx)(dr,{reason:"no-access"});case"no-permission":return(0,eo.jsx)(dr,{reason:"no-permission"});case"success":case"error":return null;default:Wt(n)}}var it=y(U());function $c(){let o=b(),{shouldRenderOnPageCanvas:n}=o.stores.accessStore.useState(),e=It(()=>o.stores.routeStore.webPageNodeId,[],[o.stores.routeStore]);return(0,mr.useEffect)(()=>{e&&o.stores.sandboxStore.waitForInitialLoad(e).then(()=>{window.parent.postMessage({apiVersion:1,type:"sandboxReadyState",data:{status:"ready"}},"*")}).catch(oe)},[e]),(0,mr.useEffect)(()=>{o.performanceTracker.reportEditorBarReady()}),_c(),(0,it.jsxs)(it.Fragment,{children:[(0,it.jsx)(Qc,{}),n&&(0,it.jsx)(Mc,{})]})}var an=class{constructor(n){this.engine=n;C(this,"state",0);C(this,"changes",new Zi)}get inRendering(){return this.state===3}render(){if(this.state!==1)return;let n=this.changes,e=this.engine.stores;try{this.state=2,n.has(e.treeStore,e.routeStore)&&So(e.treeStore.tree,e.treeStore.layoutCache,e.treeStore.sandboxCollectionData,e.treeStore.sandboxVisibility,Z.activeBundleHash,e.routeStore.localeId,void 0,e.routeStore.webPageNodeId),e.toolStore.tool?.update?.(),e.undoRedoManager.processScheduledEndUndoGroup({}),this.state=3,e.sandboxStore.update(),n.signalAllObservers(),oc()}finally{this.state=0}}signalChanges(n){if(this.changes.addChanges(n),this.state!==0)return;this.state=1;let e=this.render.bind(this);setTimeout(e,0),tc()}wrapHandler(n,e){let{projectStore:t}=this.engine.stores;return function(...r){let i=n.apply(this,r);return t.commitTreeAndSend(e!=="nonUserEvent"),i}}process(n,e){this.wrapHandler(n,e)()}processWhenReady(n,e){this.wrapHandler(n,e)()}async processWhenReadyAsync(n,e){return this.wrapHandler(n,e)()}runWhenIdle(n){requestIdleCallback(n)}runWithFullyLoadedTree(n,e){u(e.runInBackground,"Only background tasks are supported in the OnPageEngine for now.");let t=this.engine.tree.getService("loader"),r=()=>{n(),this.engine.stores.projectStore.commitTreeAndSend()};if(!t)return r(),Xe;let i=t.prioritizeLoadingAllData({operationName:e.name,operationInBackground:!0,doNotTrack:e.doNotTrack}),s=t.afterAllDataLoaded(r);return()=>{i(),s()}}runBeforeNextFrame(n){requestAnimationFrame(n)}};var sn=class extends W{constructor(e,t,r){super();this.projectStore=e;this.hostnameStore=t;this.siteId=r;C(this,"_access")}get access(){return u(this._access,"Access not initialized"),this._access}get projectId(){return ef(this.access)}get canEditContent(){let e=this.access;return e.status!=="success"?!1:e.data.permissions?.canEditContent==="on"}get shouldRenderOnPageCanvas(){return Gn()&&this.canEditContent}async set(e){if(this._access=e,this.shouldRenderOnPageCanvas){let t=ef(e);e.userId&&t&&(this.projectStore.loadProject(e.userId,t),this.hostnameStore.loadHostnames(t).catch(oe))}di.setUserId(e.userId??"null")}async refresh(){let e=await Ts(this.siteId);await this.set(e)}},dd=/^(?<name>.+--)?(?<id>[a-z0-9]{20})(?<hash>-[a-z0-9]+)?$/iu;function ef(o){if(o.status==="success")return dd.exec(o.data.projectSlug)?.groups?.id}var tf,of,at,pr,ur;of=[me()],tf=[me()];var st=class{constructor(n){this.scheduler=n;Y(this,pr,G(at,8,this,[])),G(at,11,this);Y(this,ur,G(at,12,this)),G(at,15,this);C(this,"assetMap",new Nr)}get assets(){return this._assets}get assetService(){return this._assetService}setAssetService(n){this._assetService=n,Br(n,e=>{e.assets&&(this._assets=e.assets,this.assetMap.set(e.assets),Ve.importCustomFonts(e.assets,qe.isOn("customFontImprovements")))})}};at=Re(null),pr=new WeakMap,ur=new WeakMap,te(at,4,"_assets",of,st,pr),te(at,4,"_assetService",tf,st,ur),_e(at,st);async function nf(o){return Ki.post("/edit/notifications/page-edited",o)}var ln=class extends W{constructor(e,t,r,i,s,c,l,d){super();this.accessStore=e;this.routeStore=t;this.treeStore=r;this.projectStore=i;this.modalStore=s;this.undoRedoManager=c;this.exitTool=l;this.onChangeRoute=d;C(this,"isHidden",!0);C(this,"finishedEditing",null);C(this,"_screenWidth",window.innerWidth);C(this,"_temporaryCollectionItemNodeId");window.addEventListener("resize",()=>{this._screenWidth=window.innerWidth})}get screenWidth(){return this._screenWidth}get temporaryCollectionItemNodeId(){return this._temporaryCollectionItemNodeId}set temporaryCollectionItemNodeId(e){this._temporaryCollectionItemNodeId=e,this.onChangeRoute()}async sendNotification(e){let t=this.accessStore.projectId;u(t,"Project ID must exist");let r=Ft(this.routeStore,this.treeStore);u(r,"Web page node must exist");let i=tt(this.routeStore,this.treeStore,this),s;if(i){let c=St(this.routeStore,this.treeStore,this);u(c,"Collection item exists, so its parent collection must exist"),u(c.name,"Collection node must have a name"),s={notificationType:e,projectId:t,webPageNodeId:r.id,collectionItemNodeId:i.id,collectionItemTitle:md(c,i),collectionTitle:c.name,pageType:"cms-detail"}}else s={notificationType:e,projectId:t,webPageNodeId:r.id,pageTitle:r.webMetadata?.title||ta(this.treeStore.tree,r),pageType:"static"};await nf(s)}createTemporaryCollectionItem(){let e=St(this.routeStore,this.treeStore,this);if(!e)return;let t=this.accessStore.access?.userId;u(t,"User must be logged in");let r=e.getPrivateItemForUser(t);if(r)this.temporaryCollectionItemNodeId=r.id;else{let i=ii.create({isDraft:!0,privateToUserId:t});this.treeStore.tree.insertNode(i,e.id,0),this.temporaryCollectionItemNodeId=i.id,Xa(e,i),this.projectStore.commitTreeAndSend()}}discardTemporaryCollectionItem(){let e=tt(this.routeStore,this.treeStore,this);u(e,"Collection item node must exist"),u(e.id===this.temporaryCollectionItemNodeId,"Collection item must be temporary"),this.treeStore.tree.remove(e.id),this.projectStore.commitTreeAndSend(),this.clearTemporaryItem(),this.exitFullscreen()}saveTemporaryCollectionItem(){let e=tt(this.routeStore,this.treeStore,this);u(e,"Collection item node must exist"),u(e.id===this.temporaryCollectionItemNodeId,"Collection item must be temporary"),e?.set({privateToUserId:void 0}),this.projectStore.commitTreeAndSend(),this.finishEditingWithChanges(e.id,!0)}handleFinishEditing(){this.exitTool();let e=tt(this.routeStore,this.treeStore,this);if(!!!e?.privateToUserId){if(!this.treeStore.hasChanged()){this.handleDismissFinishEditing();return}let d=this.routeStore.projectLinkNodeId;if(!d)return;this.finishEditingWithChanges(d,!1);return}let r=St(this.routeStore,this.treeStore,this);if(u(r&&e,"Collection node and collection item node must exist"),!e.hasData()){this.discardTemporaryCollectionItem();return}let i=Po(r,e);Ka(r,e,i)&&this.projectStore.commitTreeAndSend();let l=La(this.treeStore.tree,r,e,i).flatMap(d=>{let p=d.type;return qo[p]!==void 0?d.id:[]});l.length>0?this.modalStore.set({type:"OnPageCMSFieldsModal",fieldIdsToShow:l,requiredFieldsOnly:!0,source:"on_page_hud"}):this.saveTemporaryCollectionItem()}finishEditingWithChanges(e,t){this.finishedEditing={isNewItem:t,nodeId:e},Fe("editor_bar_interaction",{page:"editor-bar-project-page",id:"editor-bar-finish-editing-with-changes"});let r=t?"page-created":"page-edited";this.sendNotification(r).catch(oe)}handleDismissFinishEditing(){this.clearTemporaryItem(),this.undoRedoManager.clearUndoStack(),this.exitFullscreen()}exitFullscreen(){window.parent.postMessage({apiVersion:1,type:"exitFullscreen",position:{top:window.scrollY}},"*"),this.isHidden=!0}clearTemporaryItem(){this.finishedEditing=null,this.temporaryCollectionItemNodeId=void 0}};function md(o,n){let e=o.variables.find($e);if(e?.associatedStringVariable){let t=n.getControlProp(e.associatedStringVariable);if(t&&t.type==="string"&&$(t.value)&&t.value.trim())return t.value.trim()}return"a new page"}var cn=class{updateComponentLoader(n,e){Z.setModuleRevision(e,0);for(let t of n)Z.updateEntity(t.identifier,t)}};var pd=0,rf,fn,gr,_t;rf=[me()];var Rt=class{constructor(n){this.scheduler=n;Y(this,gr,G(fn,8,this)),G(fn,11,this);Y(this,_t);window.addEventListener("resize",()=>{this._editableNodesHighlight&&(this._editableNodesHighlight=void 0)})}get editableNodesHighlight(){return this._editableNodesHighlight}onChangeRoute(){this._editableNodesHighlight&&(this._editableNodesHighlight=void 0)}cleanupAnimationOnFinish(n){Ge(this,_t)&&clearTimeout(Ge(this,_t)),zt(this,_t,window.setTimeout(()=>{this._editableNodesHighlight=void 0},n+100))}highlight(n,{type:e}){let t=ue(n.stores.routeStore,n.stores.treeStore,n.stores.canvasStore);if(!t)return;let r=[],i={x:0,y:window.scrollY,width:window.innerWidth,height:window.innerHeight},s=1/0,c=-1/0,l=!1;for(let d of t.walk())for(let[p]of d.cache.iterateRenderInstances()){if(!Oe.isSelectableNode(n,d,p))continue;l=!0;let m=n.tree.convertFrameToCanvas(d,void 0,p);if(!ud(i,m))continue;s=Math.min(s,m.y),c=Math.max(c,m.y+m.height);let f=n.tree.getRect(d,void 0,void 0,void 0,p),a=n.tree.transformMatrixToNode(d,void 0,void 0,p);r.push({renderId:p,width:f.width,height:f.height,transform:a.toString(),centerX:m.x+m.width/2,centerY:m.y+m.height/2})}if(r.length===0)et({key:"editable-nodes-highlight-empty",type:"add",text:l?"Editable content is out of view, scroll to reveal it":"Content is not editable on this page",variant:"info"}),this._editableNodesHighlight=void 0;else{let d=e==="clickOnVoid",p=d?n.stores.mouseStore.windowMousePosition.x:i.width,m=d?n.stores.mouseStore.windowMousePosition.y:i.height/2,f=d?n.stores.mouseStore.canvasMousePosition.y:n.stores.mouseStore.scrollPosition.y,a=400,h=Math.max(p,window.innerWidth-p),g=Math.max(m,window.innerHeight-m),w=Math.sqrt(h**2+g**2)+a,x=Math.max(500,e==="clickOnVoid"?w:w*2),F=5,k=Math.max(0,Math.floor(s-F)),I=Math.ceil(c+F),v=gd(r,w,p,f);this._editableNodesHighlight={animationId:`editable-nodes-highlight-${pd++}`,minY:k,maxY:I,originX:p,originY:m-k+i.y,highlights:r,minRadius:v,maxRadius:w,gradientSize:a,animationDuration:x},this.cleanupAnimationOnFinish(x)}}};fn=Re(null),gr=new WeakMap,_t=new WeakMap,te(fn,4,"_editableNodesHighlight",rf,Rt,gr),_e(fn,Rt);function ud(o,n){return!(n.x>=ze.maxX(o)||ze.maxX(n)<=o.x||n.y>=ze.maxY(o)||ze.maxY(n)<=o.y)}function gd(o,n,e,t){let r=1/0;for(let i of o){let s=Math.sqrt(i.width**2+i.height**2),c=Math.abs(i.centerX-e),l=Math.abs(i.centerY-t),d=Math.sqrt(c**2+l**2),p=Math.max(0,d-s/2);r=Math.min(r,p)}return Number.isFinite(r)&&r<n?r:0}var dn=class extends ba{constructor(){super(...arguments);C(this,"hostnames")}get customHostnameString(){return this.hostnames?.find(e=>e.type==="custom")?.hostname}get defaultHostnameString(){return this.hostnames?.find(e=>e.type==="default")?.hostname}async loadHostnames(e){let{hostnames:t}=await Ia(e);this.hostnames=t}};var mn=class extends W{constructor(e){super();this.sandboxStore=e}async ensureModuleEvaluatedInSandbox(e){await(await this.sandboxStore.getModulesRuntime()).loadModule(e.value)}hasModuleForIdentifier(e){return!!Z.componentForIdentifier(e.value)}};var pn=class extends W{constructor(e){super();this.accessStore=e;C(this,"isLoginInProgress",!1)}login(){let e=window.open(`${io().login}?closeAfterSuccess=true`,"_blank");return e?this.startLoginWindowClosedPolling(e):Promise.resolve()}startLoginWindowClosedPolling(e){return this.isLoginInProgress=!0,new Promise(r=>{let i=setInterval(async()=>{e.closed&&(clearInterval(i),await this.accessStore.refresh(),this.isLoginInProgress=!1,r())},500)})}};var af,sf,lf,cf,ff,ee,yr,hr,Cr,wr;ff=[me()],cf=[me(Ae.isEqual)],lf=[me(Ae.isEqual)],sf=[ec(Ae.isEqual)],af=[me()];var Be=class{constructor(n){this.scheduler=n;G(ee,5,this);Y(this,yr,G(ee,8,this)),G(ee,11,this);Y(this,hr,G(ee,12,this,Ae(0,0))),G(ee,15,this);Y(this,Cr,G(ee,16,this,Ae(0,0))),G(ee,19,this);Y(this,wr,G(ee,20,this,!1)),G(ee,23,this);let e=this.onMouseMove.bind(this);document.addEventListener("mousemove",e);let t=this.onScroll.bind(this);document.addEventListener("scroll",t)}get lastUpdateType(){return this._lastUpdateType}get scrollPosition(){return this._scrollPosition}get windowMousePosition(){return this._windowMousePosition}get canvasMousePosition(){return Ae.add(this.windowMousePosition,this.scrollPosition)}get isHoveringChrome(){return this._isHoveringChrome}onScroll(){this._scrollPosition=Ae(window.scrollX,window.scrollY),this._lastUpdateType="scroll"}onMouseMove(n){this._isHoveringChrome=Gs(n.target),this._windowMousePosition=Ae(n.clientX,n.clientY),this._lastUpdateType="mouseMove"}};ee=Re(null),yr=new WeakMap,hr=new WeakMap,Cr=new WeakMap,wr=new WeakMap,te(ee,4,"_lastUpdateType",ff,Be,yr),te(ee,4,"_scrollPosition",cf,Be,hr),te(ee,4,"_windowMousePosition",lf,Be,Cr),te(ee,2,"canvasMousePosition",sf,Be),te(ee,4,"_isHoveringChrome",af,Be,wr),_e(ee,Be);var un=class extends W{constructor(){super(...arguments);C(this,"colorModel","HEX")}};var df=y(K());var gn=class extends W{constructor(e,t){super();this.assetStore=e;this.treeStore=t;C(this,"_hasPermanentlyFailed",!1);C(this,"project");C(this,"projectPromise",new ut);C(this,"filePickerRef",(0,df.createRef)())}get hasPermanentlyFailed(){return this._hasPermanentlyFailed}getProject(){return this.projectPromise}get resourceLimits(){}get featureFlags(){}get projectLicenseType(){return"freeSite"}loadProject(e,t){vt(),!this.project&&(this.project=new Ms(this.treeStore.timeline,e,t),this.project.connect(),this.project.document.on("disconnect",this.onDisconnect,this),this.project.connection.on("disconnect",this.onDisconnect,this),this.project.document.on("update",r=>{this.treeStore.newTreeAfterRemoteUpdate(r)}),this.assetStore.setAssetService(this.project.assetService),this.projectPromise.resolve(this.project))}onDisconnect(e){Pa(e)||(this._hasPermanentlyFailed=!0,e==="ClientNeedsUpdate"?et({type:"add",variant:"warning",text:"A new version of Framer is available. Please reload the page to continue working.",key:"client-outdated",duration:1/0,icon:"warning",showCloseButton:"never"}):et({type:"add",variant:"error",text:"Connection error: "+e,key:"connection-error",duration:1/0,icon:"error",showCloseButton:"never"}))}commitTreeAndSend(e=!0){u(this.project,"Project must be initialized"),u(!this.hasPermanentlyFailed,"Project is permanently failed");let t=this.treeStore.timeline.commitLocalTree();this.treeStore.newTreeAfterLocalUpdate(t,e),this.project.maybeSend()}};var mf,pf,lt,Ur,xr;pf=[me()],mf=[me()];var ct=class{constructor(n,e){this.scheduler=n;this.onChangeRoute=e;C(this,"localeId",Zr);Y(this,Ur,G(lt,8,this)),G(lt,11,this);Y(this,xr,G(lt,12,this)),G(lt,15,this);let t=({data:r})=>{if(We(r)&&r.apiVersion===1){let{type:i,nodeIds:s}=r;if(i==="updateNodeIds"&&We(s)&&$(s.webPageNodeId)){let{webPageNodeId:c,collectionItemNodeId:l}=s;this._webPageNodeId=c,this._collectionItemNodeId=$(l)?l:void 0,this.onChangeRoute()}}};window.addEventListener("message",t),window.parent.postMessage({apiVersion:1,type:"initializeComponent",component:"OnPageActiveRouteStore"},"*")}get collectionItemNodeId(){return this._collectionItemNodeId}get webPageNodeId(){return this._webPageNodeId}get projectLinkNodeId(){return this._collectionItemNodeId??this._webPageNodeId}};lt=Re(null),Ur=new WeakMap,xr=new WeakMap,te(lt,4,"_collectionItemNodeId",pf,ct,Ur),te(lt,4,"_webPageNodeId",mf,ct,xr),_e(lt,ct);var uf="iframe_icxp2h1";var yn=class extends W{constructor(e,t,r,i){super();this.componentsStore=e;this.treeStore=t;this.performanceTracker=r;this.updateGenerator=i;C(this,"config",Hi.onPageCanvas);C(this,"iframe");C(this,"remoteSandbox");C(this,"remoteControlsVisibility",new ut);C(this,"remoteModulesRuntime",new ut);C(this,"_canvasHeight");C(this,"webPageNodeIdToInitialLoadPromise",new Map);window.addEventListener("scroll",()=>{this.remoteSandbox?.scrollTo({behavior:"instant",top:window.scrollY})})}getControlsVisibility(){return this.remoteControlsVisibility}getModulesRuntime(){return this.remoteModulesRuntime}get canvasHeight(){return this._canvasHeight}loadSandbox(){vt(),u(!this.iframe,"Sandbox already loaded");let e=document.createElement("iframe");e.src=this.config.url,e.allow=es,e.sandbox.add("allow-scripts","allow-same-origin"),e.tabIndex=-1,e.id="canvas_sandbox",e.className=uf;let t=this.initializeSandbox.bind(this,e);e.addEventListener("load",t),this.iframe=e,this.hide(),document.body.append(e)}getInitialLoadPromise(e){let t=this.webPageNodeIdToInitialLoadPromise.get(e)??new ut;return this.webPageNodeIdToInitialLoadPromise.set(e,t),t}async waitForInitialLoad(e){this.performanceTracker.reportCanvasLoaderViewed(),await this.getInitialLoadPromise(e)}async initializeSandbox(e){let t=e.contentWindow;u(t,"Sandbox didn't load correctly");let r=new Ji(Ze);r.setLocal(Ze.channels.componentsStore,this.componentsStore),r.setLocal(Ze.channels.sandboxStore,this),r.setLocal(Ze.channels.treeStore,this.treeStore);let i=r.getRemote(Ze.channels.sandbox),s=r.getRemote(Ze.channels.controlsVisibility),c=r.getRemote(Ze.channels.modulesRuntime);await r.connect({target:t,url:this.config.origin}),this.remoteSandbox=i,this.remoteControlsVisibility.resolve(s),this.remoteModulesRuntime.resolve(c)}onHeightChange(e){this._canvasHeight=e}onInitialLoadComplete(e){this.performanceTracker.reportCanvasReady(),this.getInitialLoadPromise(e).resolve()}update(){let e=this.remoteSandbox;if(!e)return;let t=this.updateGenerator.getUpdate();ro(t)||e.update(t)}hide(){u(this.iframe,"Sandbox not loaded"),this.iframe.setAttribute("aria-hidden","true")}show(){u(this.iframe,"Sandbox not loaded"),this.iframe.removeAttribute("aria-hidden")}};var hn=class extends W{constructor(e,t){super();this.routeStore=e;this.treeStore=t}get active(){let e=Ft(this.routeStore,this.treeStore);return B(e,"webPageNode must be defined"),e}};var ft,to,Cn=class extends W{constructor(e,t){super();this.treeStore=e;this.mouseStore=t;C(this,"highlightedRenderId");C(this,"nodeInTextEditor");C(this,"proseMirror");C(this,"proseMirrorView",null);Y(this,ft);Y(this,to);C(this,"validationWarning")}get tool(){return Ge(this,ft)}set tool(e){zt(this,to,this.mouseStore.windowMousePosition),Ge(this,ft)!==e&&(Ge(this,ft)?.stop?.(),zt(this,ft,e))}get windowMousePositionOnToolEntry(){return Ge(this,to)}validateCollectionControl(e){let t="required";if(!e)return;let{collectionItemNode:r,variableDefinition:i,collectionNode:s,controlDescription:c,controlProp:l}=e,d;(co(i)||$e(i))&&(d=Eo(i,s.variables,r));let p=Po(s,r),m=i.type,f=ko(m,c,l,d,void 0,fo(i),p.get(i.id));this.validationWarning=f?.type===t?void 0:f}};ft=new WeakMap,to=new WeakMap;var wn=class extends W{constructor(e,t){super();this.routeStore=e;this.undoRedoManager=t;C(this,"layoutCache",new ua);C(this,"sandboxCollectionData",new ga("editor"));C(this,"sandboxVisibility",new ya("editor"));C(this,"_tree",Ui.createEmpty());C(this,"_domLayoutUpdate",0);C(this,"timeline",new ha(this.tree));C(this,"treeIndexes",new Ir(this))}get tree(){return this._tree}get domLayoutUpdate(){return this._domLayoutUpdate}get remoteTreeVersion(){return this.timeline.remoteTreeVersion}getChangesForUndo(){let e=this.timeline.getLatestChangesForUndo();return e?e.filter(t=>!t.ignoreInUndo):[]}hasChanged(){return this.undoRedoManager.getUndoBufferSize()>0}getPartialIndexes(){return this.treeIndexes}getLoadedIndexes(){let e=this.tree.getService("loader");if(e){let t=e.numberOfScopesToLoad();throw new Error(`Some scopes are still loading: ${t} scopes left to load`)}return this.treeIndexes}onLayoutMeasure(e){let t=this.layoutCache.processLayoutMeasurements(e);t.size===0||wa(this.tree,this.layoutCache,t).size===0||this._domLayoutUpdate++}onSandboxRendered(e){let t=new Set;if(e.collectionUpdates){let r=this.sandboxCollectionData.import(e.collectionUpdates);for(let i of r){let s=Xt(i);t.add(s)}}if(e.visibilityUpdates){let r=this.sandboxVisibility.import(e.visibilityUpdates);for(let i of r){let s=Xt(i);t.add(s)}}if(t.size>0){let r=Ca(this.tree,t);So(this.tree,this.layoutCache,this.sandboxCollectionData,this.sandboxVisibility,Z.activeBundleHash,this.routeStore.localeId,void 0,r)}e.layoutMeasurements&&this.onLayoutMeasure(e.layoutMeasurements)}newTreeAfterRemoteUpdate(e){e.inEditor=!0,this._tree!==e&&(this._tree=e)}newTreeAfterLocalUpdate(e,t){if(e.inEditor=!0,this._tree===e)return;this._tree=e;let r=this.getChangesForUndo();t&&r.length>0&&this.undoRedoManager.addUndoEntry({changes:r})}},Ir=class{constructor(n){this.treeStore=n;C(this,"codeComponentNodeCache");C(this,"richTextNodeCache")}get codeComponents(){let n=this.treeStore.tree;if(this.codeComponentNodeCache?.tree===n)return this.codeComponentNodeCache.codeComponentNodes;let e=[];for(let t of n.root.walk())he(t)&&e.push(t);return this.codeComponentNodeCache={tree:n,codeComponentNodes:e},e}get richTextNodes(){let n=this.treeStore.tree;if(this.richTextNodeCache?.tree===n)return this.richTextNodeCache.richTextNodes;let e=[];for(let t of n.root.walk())E(t)&&e.push(t);return this.richTextNodeCache={tree:n,richTextNodes:e},e}};var Un=class extends Sa{};var xn=class{constructor(n,e,t){C(this,"accessStore");C(this,"assetStore");C(this,"canvasStore");C(this,"componentsStore");C(this,"contextMenuStore");C(this,"editableNodeHighlightStore");C(this,"hostnameStore");C(this,"loadedExternalModulesStore");C(this,"loginStore");C(this,"modalStore");C(this,"modulesStore");C(this,"mouseStore");C(this,"persistedUserDefaults");C(this,"projectStore");C(this,"routeStore");C(this,"sandboxStore");C(this,"scopeStore");C(this,"toolStore");C(this,"treeStore");C(this,"undoRedoManager",new Un);C(this,"vectorsStore");this.assetStore=new st(e),this.editableNodeHighlightStore=new Rt(e),this.routeStore=new ct(e,()=>n.onChangeRoute()),this.componentsStore=new cn,this.contextMenuStore=xa.new(e,e),this.hostnameStore=dn.new(e),this.modalStore=Xi.new(e,e),this.treeStore=wn.new(e,this.routeStore,this.undoRedoManager),this.projectStore=gn.new(e,this.assetStore,this.treeStore),this.accessStore=sn.new(e,this.projectStore,this.hostnameStore,t),this.loginStore=pn.new(e,this.accessStore),this.mouseStore=new Be(e),this.toolStore=Cn.new(e,this.treeStore,this.mouseStore),this.canvasStore=ln.new(e,this.accessStore,this.routeStore,this.treeStore,this.projectStore,this.modalStore,this.undoRedoManager,()=>n.exitTool(),()=>n.onChangeRoute()),this.scopeStore=hn.new(e,this.routeStore,this.treeStore),this.sandboxStore=yn.new(e,this.componentsStore,this.treeStore,n.performanceTracker,n.sandboxUpdateGenerator),this.loadedExternalModulesStore=mn.new(e,this.sandboxStore),this.modulesStore=da.new(e,e,this.treeStore,this.loadedExternalModulesStore,{codeEditorPreviewVisible:!1,mainView:0},this.projectStore.getProject().then(r=>r.modulesAPI),()=>{throw new Error("Can't make document readonly")},async r=>{await(await this.sandboxStore.getModulesRuntime()).insertTemporaryImportMap(r)},async()=>{throw new Error("Can't load all local modules")}),this.persistedUserDefaults=un.new(e),this.vectorsStore=va.new(e,this.modulesStore)}};var In=class{constructor(){C(this,"editorBarReadyAt");C(this,"canvasReadyAt");C(this,"canvasLoaderViewedAt")}get editorBarReadyMs(){let n=hd();if(!(le(n)||le(this.editorBarReadyAt)))return this.editorBarReadyAt-n}get canvasReadyMs(){if(!(le(this.canvasReadyAt)||le(this.editorBarReadyAt)))return this.canvasReadyAt-this.editorBarReadyAt}get perceivedCanvasLoadMs(){if(!le(this.canvasReadyAt))return le(this.canvasLoaderViewedAt)?0:Math.min(this.canvasReadyAt-this.canvasLoaderViewedAt,0)}reportEditorBarReady(){this.editorBarReadyAt=Date.now()}reportCanvasLoaderViewed(){this.canvasLoaderViewedAt=Date.now()}reportCanvasReady(){this.canvasReadyAt=Date.now(),this.sendCanvasLoadedEvent()}sendCanvasLoadedEvent(){let{canvasReadyMs:n,editorBarReadyMs:e,perceivedCanvasLoadMs:t}=this;le(n)||le(e)||le(t)||Fe("editor_bar_canvas_loaded",{editorBarReadyMs:e,canvasReadyMs:n,perceivedCanvasLoadMs:t})}};function hd(){let o=new URLSearchParams(window.location.search).get("loadStart");if(!o)return;let n=Number(o);if(!Number.isNaN(n))return n}var bn=class{constructor(n){this.engine=n;C(this,"partialTreeSender");C(this,"previousWebPageNodeId");C(this,"previousCollectionItemNodeId");C(this,"previousBreakpointNodeId");C(this,"previousStylePresetBreakpointClassNames");C(this,"previousLocalModules");C(this,"previousDependenciesModule");C(this,"previousAssets");C(this,"previousNodeInTextEditor")}getUpdate(){let{canvasStore:n,modulesStore:e,routeStore:t,assetStore:r,treeStore:i,toolStore:s}=this.engine.stores,c={},l=Ft(t,i)?.id;l!==this.previousWebPageNodeId&&(this.previousWebPageNodeId=l,c.webPageNodeId=l);let d=tt(t,i,n)?.id;d!==this.previousCollectionItemNodeId&&(this.previousCollectionItemNodeId=d,c.collectionItemNodeId=d);let p=ue(t,i,n)?.id;p!==this.previousBreakpointNodeId&&(this.previousBreakpointNodeId=p,c.breakpointNodeId=p);let m=i.tree.getPresetsListNode(),f=Cd(m,n.screenWidth);f!==this.previousStylePresetBreakpointClassNames&&(this.previousStylePresetBreakpointClassNames=f,c.stylePresetBreakpointClassNames=f);let a=e.localModules;a!==this.previousLocalModules&&(this.previousLocalModules=a,c.localModules=new Map(a));let h=e.dependenciesModule;h!==this.previousDependenciesModule&&(this.previousDependenciesModule=h,c.dependenciesModule=h);let g=r.assets;g!==this.previousAssets&&(this.previousAssets=g,c.assets=g),this.partialTreeSender??=new Qi(i.timeline,"canvas");let w=this.partialTreeSender.update(l);ro(w)||(c.partialTreeUpdate=w);let x=s.nodeInTextEditor??null;return x!==this.previousNodeInTextEditor&&(this.previousNodeInTextEditor=x,c.nodeInTextEditor=x),c}},Cd=Vr((o,n)=>{let e=ts(o);return os(e,n)});var Fn=class{constructor(n){this.siteId=n;C(this,"name","OnPageEngine");C(this,"sandboxUpdateGenerator",new bn(this));C(this,"performanceTracker",new In);C(this,"scheduler",new an(this));C(this,"stores");this.stores=new xn(this,this.scheduler,n),this.stores.projectStore.getProject().then(e=>{u(this.stores.assetStore.assetService,"assetsService must be initialized"),ma(this,this.stores.assetStore.assetService,this.stores.projectStore.filePickerRef),ea(e.api,this.stores.assetStore.assetService),this.stores.modulesStore.initialize().catch(oe),e.connection.on("connect",t=>{t&&this.stores.modulesStore.refresh().catch(oe)})})}get tree(){return this.stores.treeStore.tree}startHighlightTool(){this.stores.toolStore.tool=new Oe(this)}startComponentInstanceEditTool(n,e){this.stores.toolStore.tool=new Pe(this,n,e)}startDateVariableEditTool(n,e,t){this.stores.toolStore.tool=new Ee(this,n,e,t)}startCollectionReferenceVariableEditTool(n,e,t){this.stores.toolStore.tool=new ve(this,n,e,t)}startImageEditTool(n,e){this.stores.toolStore.tool=new ke(this,n,e)}startRichTextEditTool(n,e,t){this.stores.toolStore.tool=new fe(this,n,e,t)}startRichTextVariableEditTool(n,e,t){this.stores.toolStore.tool=new we(this,n,e,t)}startStringVariableEditTool(n,e,t){this.stores.toolStore.tool=new Ue(this,n,e,t)}exitTool(){this.startHighlightTool()}onChangeRoute(){this.stores.editableNodeHighlightStore.onChangeRoute(),this.exitTool()}getStateToken(){return this.stores.undoRedoManager.getUndoBufferSize()}undo(){let{undoRedoManager:n,toolStore:e,projectStore:t}=this.stores;e.tool?.undo?e.tool.undo():n.peekUndo()&&(n.undo(this.tree),t.commitTreeAndSend(!1))}redo(){let{undoRedoManager:n,toolStore:e,projectStore:t}=this.stores;e.tool?.redo?e.tool.redo():n.peekRedo()&&(n.redo(this.tree),t.commitTreeAndSend(!1))}beginUndoGroup(){this.stores.undoRedoManager.beginUndoGroup()}endUndoGroup(){this.stores.undoRedoManager.scheduleEndUndoGroup()}};var Je=y(U());_r({enableFontStore:!0,fetchGoogleFontsList:Ba,fetchFontshareFontsList:Na,fetchBuiltInFontsList:ka});async function ib(o,n){let e=new Fn(n);await e.stores.accessStore.set(o),e.stores.sandboxStore.loadSandbox(),Ua(e.stores.assetStore.assetMap),Ve.importFramerFonts(Jr),fa(),Object.assign(window,{engine:e,componentLoader:Z}),Oa((0,Je.jsx)(fi.Provider,{value:e,children:(0,Je.jsx)(ja,{forceDarkMode:!0,children:(0,Je.jsx)(Bi,{mode:"onPageEditing",children:(0,Je.jsxs)(Rs,{children:[(0,Je.jsx)($c,{}),(0,Je.jsx)(Cs,{})]})})})}),document.getElementById("root"))}export{ib as renderEditorBar};
//# sourceMappingURL=https://app.framerstatic.com/render-KQR5QIMK.mjs.map
